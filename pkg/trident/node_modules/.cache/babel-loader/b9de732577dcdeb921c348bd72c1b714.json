{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/thread-loader/dist/cjs.js!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--2-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/promptRemove/management.cattle.io.project.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/promptRemove/management.cattle.io.project.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/pkg/trident/babel.config.js","mtime":1716430386784},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/thread-loader/dist/cjs.js","mtime":1716430465967},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbWFwU3RhdGUsIG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgUFJPSkVDVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsKaW1wb3J0IHsgTUFOQUdFTUVOVCwgTkFNRVNQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IENoZWNrYm94IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9DaGVja2JveCc7CmltcG9ydCB7IHJlc291cmNlTmFtZXMgfSBmcm9tICdAc2hlbGwvdXRpbHMvc3RyaW5nJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQcm9qZWN0QW5kTmFtZXNwYWNlc1Byb21wdFJlbW92ZScsCiAgY29tcG9uZW50czogewogICAgQ2hlY2tib3gKICB9LAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQogICAgfSwKICAgIHR5cGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgYXN5bmMgZmV0Y2goKSB7CiAgICB0aGlzLmFsbE5hbWVzcGFjZXMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9maW5kQWxsJywgewogICAgICB0eXBlOiBOQU1FU1BBQ0UKICAgIH0pOwogICAgdGhpcy5hbGxQcm9qZWN0cyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7CiAgICAgIHR5cGU6IE1BTkFHRU1FTlQuUFJPSkVDVAogICAgfSk7CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGVsZXRlUHJvamVjdE5hbWVzcGFjZXM6IGZhbHNlLAogICAgICBhbGxOYW1lc3BhY2VzOiBbXSwKICAgICAgYWxsUHJvamVjdHM6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKCdhY3Rpb24tbWVudScsIFsndG9SZW1vdmUnXSksCiAgICAuLi5tYXBHZXR0ZXJzKHsKICAgICAgdDogJ2kxOG4vdCcKICAgIH0pLAogICAgLi4ubWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10pLAogICAgY3VycmVudFByb2plY3QoKSB7CiAgICAgIGlmICh0aGlzLmFsbFByb2plY3RzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVbMF07CiAgICAgIH0KICAgICAgcmV0dXJuIHt9OwogICAgfSwKICAgIGZpbHRlcmVkTmFtZXNwYWNlcygpIHsKICAgICAgaWYgKHRoaXMuY3VycmVudFByb2plY3QpIHsKICAgICAgICByZXR1cm4gdGhpcy5hbGxOYW1lc3BhY2VzLmZpbHRlcihuID0+IHsKICAgICAgICAgIHZhciBfdGhpcyRjdXJyZW50UHJvamVjdCQ7CiAgICAgICAgICByZXR1cm4gbi5tZXRhZGF0YS5sYWJlbHNbUFJPSkVDVF0gPT09ICgoX3RoaXMkY3VycmVudFByb2plY3QkID0gdGhpcy5jdXJyZW50UHJvamVjdC5tZXRhZGF0YSkgPT09IG51bGwgfHwgX3RoaXMkY3VycmVudFByb2plY3QkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRjdXJyZW50UHJvamVjdCQubmFtZSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIFtdOwogICAgfSwKICAgIHBsdXNNb3JlKCkgewogICAgICBjb25zdCByZW1haW5pbmcgPSB0aGlzLmZpbHRlcmVkTmFtZXNwYWNlcy5sZW5ndGggPiA1ID8gdGhpcy5maWx0ZXJlZE5hbWVzcGFjZXMubGVuZ3RoIC0gNSA6IDA7CiAgICAgIHJldHVybiB0aGlzLnQoJ3Byb21wdFJlbW92ZS5hbmRPdGhlcnMnLCB7CiAgICAgICAgY291bnQ6IHJlbWFpbmluZwogICAgICB9KTsKICAgIH0sCiAgICBkaXNwbGF5TmFtZSgpIHsKICAgICAgdmFyIF90aGlzJGN1cnJlbnRQcm9qZWN0OwogICAgICByZXR1cm4gKF90aGlzJGN1cnJlbnRQcm9qZWN0ID0gdGhpcy5jdXJyZW50UHJvamVjdCkgPT09IG51bGwgfHwgX3RoaXMkY3VycmVudFByb2plY3QgPT09IHZvaWQgMCB8fCAoX3RoaXMkY3VycmVudFByb2plY3QgPSBfdGhpcyRjdXJyZW50UHJvamVjdC5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRjdXJyZW50UHJvamVjdCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkY3VycmVudFByb2plY3QuZGlzcGxheU5hbWU7CiAgICB9LAogICAgbmFtZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLmZpbHRlcmVkTmFtZXNwYWNlcy5tYXAob2JqID0+IG9iai5uYW1lRGlzcGxheSkuc2xpY2UoMCwgNSk7CiAgICB9LAogICAgY2FuTWFuYWdlTmFtZXNwYWNlcygpIHsKICAgICAgdmFyIF90aGlzJGZpbHRlcmVkTmFtZXNwYTsKICAgICAgLy8gT25seSBhZG1pbnMgYW5kIGNsdXN0ZXIgb3duZXJzIGNhbiBzZWUgbmFtZXNwYWNlcyBvdXRzaWRlIG9mIHByb2plY3RzCiAgICAgIC8vIEJVVCBjbHVzdGVyIG1lbWJlcnMgY2FuIGFsc28gbWFuYWdlIHByb2plY3RzIGFuZCBuYW1lc3BhY2VzIGFuZCBtYXkgd2FudCB0byBub3QgZGVsZXRlIHRoZSBuYW1lc3BhY2VzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvamVjdAogICAgICAvLyBhcyBwZXIgaHR0cHM6Ly9naXRodWIuY29tL3JhbmNoZXIvZGFzaGJvYXJkL2lzc3Vlcy85NTE3IGRlc3BpdGUgdGhlIG5hbWVzcGFjZXMgY2Fubm90IGJlIHNlZW4gYWZ0ZXJ3YXJkcyAocHJvamVjdGxlc3MpCiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDbHVzdGVyLmNhblVwZGF0ZSB8fCB0aGlzLmN1cnJlbnRQcm9qZWN0LmNhbkRlbGV0ZSAmJiB0aGlzLmZpbHRlcmVkTmFtZXNwYWNlcy5sZW5ndGggJiYgKChfdGhpcyRmaWx0ZXJlZE5hbWVzcGEgPSB0aGlzLmZpbHRlcmVkTmFtZXNwYWNlc1swXSkgPT09IG51bGwgfHwgX3RoaXMkZmlsdGVyZWROYW1lc3BhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRmaWx0ZXJlZE5hbWVzcGEuY2FuRGVsZXRlKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIHJlc291cmNlTmFtZXMsCiAgICByZW1vdmUoKSB7CiAgICAgIC8vIERlbGV0ZSBhbGwgb2YgdGhyZSBuYW1lc3BhY2VzIGFuZCByZXR1cm4gZmFsc2UgLSB0aGlzIHRlbGxzIHRoZSBwcm9tcHQgcmVtb3ZlIGRpYWxvZyB0byBjb250aW51ZSBhbmQgZGVsZXRlIHRoZSBwcm9qZWN0CiAgICAgIC8vIERlbGV0ZSBhbGwgbmFtZXNwYWNlcyBpZiB0aGUgdXNlciB3b3VsZG4ndCBiZSBhYmxlIHRvIHNlZSB0aGVtIGFmdGVyIGRlbGV0aW5nIHRoZSBwcm9qZWN0CiAgICAgIGlmICh0aGlzLmRlbGV0ZVByb2plY3ROYW1lc3BhY2VzIHx8ICF0aGlzLmNhbk1hbmFnZU5hbWVzcGFjZXMpIHsKICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwodGhpcy5maWx0ZXJlZE5hbWVzcGFjZXMubWFwKG4gPT4gbi5yZW1vdmUoKSkpLnRoZW4oKCkgPT4gZmFsc2UpOwogICAgICB9CgogICAgICAvLyBSZXR1cm4gZmFsc2Ugc28gdGhhdCB0aGUgbWFpbiBwcm9tcHRSZW1vdmFsIHdpbGwgY29udGludWUgdG8gcmVtb3ZlIHRoZSBwcm9qZWN0CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9Cn07"},{"version":3,"names":["mapState","mapGetters","PROJECT","MANAGEMENT","NAMESPACE","Checkbox","resourceNames","name","components","props","value","type","Array","default","String","required","fetch","allNamespaces","$store","dispatch","allProjects","data","deleteProjectNamespaces","computed","t","currentProject","filteredNamespaces","filter","n","_this$currentProject$","metadata","labels","plusMore","remaining","length","count","displayName","_this$currentProject","spec","names","map","obj","nameDisplay","slice","canManageNamespaces","_this$filteredNamespa","currentCluster","canUpdate","canDelete","methods","remove","Promise","all","then"],"sources":["../../node_modules/@rancher/shell/promptRemove/management.cattle.io.project.vue"],"sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { PROJECT } from '@shell/config/labels-annotations';\nimport { MANAGEMENT, NAMESPACE } from '@shell/config/types';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { resourceNames } from '@shell/utils/string';\n\nexport default {\n  name: 'ProjectAndNamespacesPromptRemove',\n\n  components: { Checkbox },\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    }\n  },\n\n  async fetch() {\n    this.allNamespaces = await this.$store.dispatch('cluster/findAll', { type: NAMESPACE });\n    this.allProjects = await this.$store.dispatch('management/findAll', { type: MANAGEMENT.PROJECT });\n  },\n\n  data() {\n    return {\n      deleteProjectNamespaces: false,\n      allNamespaces:           [],\n      allProjects:             [],\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n    ...mapGetters(['currentCluster']),\n\n    currentProject() {\n      if ( this.allProjects) {\n        return this.value[0];\n      }\n\n      return {};\n    },\n\n    filteredNamespaces() {\n      if (this.currentProject) {\n        return this.allNamespaces.filter((n) => n.metadata.labels[PROJECT] === this.currentProject.metadata?.name);\n      }\n\n      return [];\n    },\n\n    plusMore() {\n      const remaining = this.filteredNamespaces.length > 5 ? this.filteredNamespaces.length - 5 : 0;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n\n    displayName() {\n      return this.currentProject?.spec?.displayName;\n    },\n\n    names() {\n      return this.filteredNamespaces.map((obj) => obj.nameDisplay).slice(0, 5);\n    },\n\n    canManageNamespaces() {\n      // Only admins and cluster owners can see namespaces outside of projects\n      // BUT cluster members can also manage projects and namespaces and may want to not delete the namespaces associated with the project\n      // as per https://github.com/rancher/dashboard/issues/9517 despite the namespaces cannot be seen afterwards (projectless)\n      return this.currentCluster.canUpdate || (this.currentProject.canDelete && this.filteredNamespaces.length && this.filteredNamespaces[0]?.canDelete);\n    }\n  },\n  methods: {\n    resourceNames,\n    remove() {\n      // Delete all of thre namespaces and return false - this tells the prompt remove dialog to continue and delete the project\n      // Delete all namespaces if the user wouldn't be able to see them after deleting the project\n      if (this.deleteProjectNamespaces || !this.canManageNamespaces) {\n        return Promise.all(this.filteredNamespaces.map((n) => n.remove())).then(() => false);\n      }\n\n      // Return false so that the main promptRemoval will continue to remove the project\n      return false;\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <div>\n      <div class=\"mb-10\">\n        {{ t('promptRemove.attemptingToRemove', { type }) }} <span class=\"display-name\">{{ `${displayName}.` }}</span>\n        <template v-if=\"!canManageNamespaces\">\n          <span class=\"delete-warning\"> {{ t('promptRemove.willDeleteAssociatedNamespaces') }}</span> <br>\n          <div\n            v-clean-html=\"resourceNames(names, plusMore, t)\"\n            class=\"mt-10\"\n          />\n        </template>\n      </div>\n      <div\n        v-if=\"filteredNamespaces.length > 0 && canManageNamespaces\"\n        class=\"mt-20 remove-project-dialog\"\n      >\n        <Checkbox\n          v-model=\"deleteProjectNamespaces\"\n          :label=\"t('promptRemove.deleteAssociatedNamespaces')\"\n        />\n        <div class=\"mt-10 ml-20\">\n          <span v-clean-html=\"resourceNames(names, plusMore, t)\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.delete-warning{\n    color: var(--error)\n}\n.remove-project-dialog {\n  border: 1px solid var(--border);\n  padding: 10px;\n  border-radius: 5px;\n\n  .display-name {\n    font-weight: bold;\n  }\n}\n</style>\n"],"mappings":"AACA,SAAAA,QAAA,EAAAC,UAAA;AACA,SAAAC,OAAA;AACA,SAAAC,UAAA,EAAAC,SAAA;AACA,SAAAC,QAAA;AACA,SAAAC,aAAA;AAEA;EACAC,IAAA;EAEAC,UAAA;IAAAH;EAAA;EAEAI,KAAA;IACAC,KAAA;MACAC,IAAA,EAAAC,KAAA;MACAC,OAAA,EAAAA,CAAA;QACA;MACA;IACA;IAEAF,IAAA;MACAA,IAAA,EAAAG,MAAA;MACAC,QAAA;IACA;EACA;EAEA,MAAAC,MAAA;IACA,KAAAC,aAAA,cAAAC,MAAA,CAAAC,QAAA;MAAAR,IAAA,EAAAP;IAAA;IACA,KAAAgB,WAAA,cAAAF,MAAA,CAAAC,QAAA;MAAAR,IAAA,EAAAR,UAAA,CAAAD;IAAA;EACA;EAEAmB,KAAA;IACA;MACAC,uBAAA;MACAL,aAAA;MACAG,WAAA;IACA;EACA;EAEAG,QAAA;IACA,GAAAvB,QAAA;IACA,GAAAC,UAAA;MAAAuB,CAAA;IAAA;IACA,GAAAvB,UAAA;IAEAwB,eAAA;MACA,SAAAL,WAAA;QACA,YAAAV,KAAA;MACA;MAEA;IACA;IAEAgB,mBAAA;MACA,SAAAD,cAAA;QACA,YAAAR,aAAA,CAAAU,MAAA,CAAAC,CAAA;UAAA,IAAAC,qBAAA;UAAA,OAAAD,CAAA,CAAAE,QAAA,CAAAC,MAAA,CAAA7B,OAAA,QAAA2B,qBAAA,QAAAJ,cAAA,CAAAK,QAAA,cAAAD,qBAAA,uBAAAA,qBAAA,CAAAtB,IAAA;QAAA;MACA;MAEA;IACA;IAEAyB,SAAA;MACA,MAAAC,SAAA,QAAAP,kBAAA,CAAAQ,MAAA,YAAAR,kBAAA,CAAAQ,MAAA;MAEA,YAAAV,CAAA;QAAAW,KAAA,EAAAF;MAAA;IACA;IAEAG,YAAA;MAAA,IAAAC,oBAAA;MACA,QAAAA,oBAAA,QAAAZ,cAAA,cAAAY,oBAAA,gBAAAA,oBAAA,GAAAA,oBAAA,CAAAC,IAAA,cAAAD,oBAAA,uBAAAA,oBAAA,CAAAD,WAAA;IACA;IAEAG,MAAA;MACA,YAAAb,kBAAA,CAAAc,GAAA,CAAAC,GAAA,IAAAA,GAAA,CAAAC,WAAA,EAAAC,KAAA;IACA;IAEAC,oBAAA;MAAA,IAAAC,qBAAA;MACA;MACA;MACA;MACA,YAAAC,cAAA,CAAAC,SAAA,SAAAtB,cAAA,CAAAuB,SAAA,SAAAtB,kBAAA,CAAAQ,MAAA,MAAAW,qBAAA,QAAAnB,kBAAA,iBAAAmB,qBAAA,uBAAAA,qBAAA,CAAAG,SAAA;IACA;EACA;EACAC,OAAA;IACA3C,aAAA;IACA4C,OAAA;MACA;MACA;MACA,SAAA5B,uBAAA,UAAAsB,mBAAA;QACA,OAAAO,OAAA,CAAAC,GAAA,MAAA1B,kBAAA,CAAAc,GAAA,CAAAZ,CAAA,IAAAA,CAAA,CAAAsB,MAAA,KAAAG,IAAA;MACA;;MAEA;MACA;IACA;EACA;AACA"}]}