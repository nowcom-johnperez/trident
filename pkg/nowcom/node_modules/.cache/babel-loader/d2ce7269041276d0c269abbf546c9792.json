{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/thread-loader/dist/cjs.js!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--2-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/AlertTable.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/AlertTable.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/pkg/nowcom/babel.config.js","mtime":1716430386791},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/thread-loader/dist/cjs.js","mtime":1716430465967},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGlzRW1wdHkgZnJvbSAnbG9kYXNoL2lzRW1wdHknOwppbXBvcnQgUG9sbGVyIGZyb20gJ0BzaGVsbC91dGlscy9wb2xsZXInOwppbXBvcnQgU29ydGFibGVUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Tb3J0YWJsZVRhYmxlJzsKaW1wb3J0IHsgRU5EUE9JTlRTIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKY29uc3QgQUxFUlRNQU5BR0VSX1BPTExfUkFURV9NUyA9IDMwMDAwOwpjb25zdCBNQVhfRkFJTFVSRVMgPSAyOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgU29ydGFibGVUYWJsZQogIH0sCiAgcHJvcHM6IHsKICAgIG1vbml0b3JpbmdOYW1lc3BhY2U6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnY2F0dGxlLW1vbml0b3Jpbmctc3lzdGVtJwogICAgfSwKICAgIGFsZXJ0U2VydmljZUVuZHBvaW50OiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ3JhbmNoZXItbW9uaXRvcmluZy1hbGVydG1hbmFnZXInCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgY29uc3QgZXZlbnRIZWFkZXJzID0gW3sKICAgICAgbmFtZTogJ3NldmVyaXR5JywKICAgICAgbGFiZWw6ICdTZXZlcml0eScsCiAgICAgIGxhYmVsS2V5OiAnbW9uaXRvcmluZy5vdmVydmlldy5hbGVydHNMaXN0LnNldmVyaXR5LmxhYmVsJywKICAgICAgdmFsdWU6ICdsYWJlbHMuc2V2ZXJpdHknLAogICAgICBzb3J0OiBbJ2xhYmVscy5zZXZlcml0eScsICdsYWJlbHMuYWxlcnRuYW1lJ10sCiAgICAgIHdpZHRoOiAxMjUKICAgIH0sIHsKICAgICAgbmFtZTogJ25hbWUnLAogICAgICBsYWJlbDogJ05hbWUnLAogICAgICBsYWJlbEtleTogJ2dlbmVyaWMubmFtZScsCiAgICAgIHZhbHVlOiAnbGFiZWxzLmFsZXJ0bmFtZScsCiAgICAgIHNvcnQ6IFsnbGFiZWxzLmFsZXJ0bmFtZScsICdsYWJlbHMuc2V2ZXJpdHknXQogICAgfSwgewogICAgICBuYW1lOiAnbWVzc2FnZScsCiAgICAgIGxhYmVsOiAnbWVzc2FnZScsCiAgICAgIGxhYmVsS2V5OiAnbW9uaXRvcmluZy5vdmVydmlldy5hbGVydHNMaXN0Lm1lc3NhZ2UubGFiZWwnLAogICAgICB2YWx1ZTogJ2Fubm90YXRpb25zJywKICAgICAgZm9ybWF0dGVyOiAnUnVuQm9va0xpbmsnLAogICAgICBzb3J0OiBbJ2Fubm90YXRpb25zLm1lc3NhZ2UnLCAnbGFiZWxzLmFsZXJ0bmFtZScsICdsYWJlbHMuc2V2ZXJpdHknXQogICAgfV07CiAgICByZXR1cm4gewogICAgICBhbGVydE1hbmFnZXJQb2xsZXI6IG5ldyBQb2xsZXIodGhpcy5sb2FkQWxlcnRNYW5hZ2VyRXZlbnRzLCBBTEVSVE1BTkFHRVJfUE9MTF9SQVRFX01TLCBNQVhfRkFJTFVSRVMpLAogICAgICBhbGxBbGVydHM6IFtdLAogICAgICBldmVudEhlYWRlcnMKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10pCiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5mZXRjaERlcHMoKTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLmFsZXJ0TWFuYWdlclBvbGxlci5zdG9wKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBsb2FkQWxlcnRNYW5hZ2VyRXZlbnRzKCkgewogICAgICBjb25zdCBpblN0b3JlID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY3VycmVudFByb2R1Y3QnXS5pblN0b3JlOwogICAgICBjb25zdCBhbGVydHNFdmVudHMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaChgJHtpblN0b3JlfS9yZXF1ZXN0YCwgewogICAgICAgIHVybDogYC9rOHMvY2x1c3RlcnMvJHt0aGlzLmN1cnJlbnRDbHVzdGVyLmlkfS9hcGkvdjEvbmFtZXNwYWNlcy8ke3RoaXMubW9uaXRvcmluZ05hbWVzcGFjZX0vc2VydmljZXMvaHR0cDoke3RoaXMuYWxlcnRTZXJ2aWNlRW5kcG9pbnR9OjkwOTMvcHJveHkvYXBpL3YxL2FsZXJ0c2AKICAgICAgfSk7CiAgICAgIGlmIChhbGVydHNFdmVudHMuZGF0YSkgewogICAgICAgIHRoaXMuYWxsQWxlcnRzID0gYWxlcnRzRXZlbnRzLmRhdGE7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBmZXRjaERlcHMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgYW0gPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9maW5kJywgewogICAgICAgICAgdHlwZTogRU5EUE9JTlRTLAogICAgICAgICAgaWQ6IGAke3RoaXMubW9uaXRvcmluZ05hbWVzcGFjZX0vJHt0aGlzLmFsZXJ0U2VydmljZUVuZHBvaW50fWAKICAgICAgICB9KTsKICAgICAgICBpZiAoIWlzRW1wdHkoYW0pICYmICFpc0VtcHR5KGFtLnN1YnNldHMpKSB7CiAgICAgICAgICB0aGlzLmFsZXJ0TWFuYWdlclBvbGxlci5zdGFydCgpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCB7fQogICAgfQogIH0KfTs="},{"version":3,"names":["isEmpty","Poller","SortableTable","ENDPOINTS","mapGetters","ALERTMANAGER_POLL_RATE_MS","MAX_FAILURES","components","props","monitoringNamespace","type","String","default","alertServiceEndpoint","data","eventHeaders","name","label","labelKey","value","sort","width","formatter","alertManagerPoller","loadAlertManagerEvents","allAlerts","computed","mounted","fetchDeps","beforeDestroy","stop","methods","inStore","$store","getters","alertsEvents","dispatch","url","currentCluster","id","am","subsets","start"],"sources":["../../node_modules/@rancher/shell/components/AlertTable.vue"],"sourcesContent":["<script>\nimport isEmpty from 'lodash/isEmpty';\nimport Poller from '@shell/utils/poller';\nimport SortableTable from '@shell/components/SortableTable';\nimport { ENDPOINTS } from '@shell/config/types';\nimport { mapGetters } from 'vuex';\nconst ALERTMANAGER_POLL_RATE_MS = 30000;\nconst MAX_FAILURES = 2;\n\nexport default {\n  components: { SortableTable },\n\n  props: {\n    monitoringNamespace: {\n      type:    String,\n      default: 'cattle-monitoring-system'\n    },\n    alertServiceEndpoint: {\n      type:    String,\n      default: 'rancher-monitoring-alertmanager'\n    },\n  },\n\n  data() {\n    const eventHeaders = [\n      {\n        name:     'severity',\n        label:    'Severity',\n        labelKey: 'monitoring.overview.alertsList.severity.label',\n        value:    'labels.severity',\n        sort:     ['labels.severity', 'labels.alertname'],\n        width:    125,\n      },\n      {\n        name:     'name',\n        label:    'Name',\n        labelKey: 'generic.name',\n        value:    'labels.alertname',\n        sort:     ['labels.alertname', 'labels.severity'],\n      },\n      {\n        name:      'message',\n        label:     'message',\n        labelKey:  'monitoring.overview.alertsList.message.label',\n        value:     'annotations',\n        formatter: 'RunBookLink',\n        sort:      ['annotations.message', 'labels.alertname', 'labels.severity'],\n      },\n    ];\n\n    return {\n      alertManagerPoller: new Poller(\n        this.loadAlertManagerEvents,\n        ALERTMANAGER_POLL_RATE_MS,\n        MAX_FAILURES\n      ),\n      allAlerts: [],\n      eventHeaders\n    };\n  },\n  computed: { ...mapGetters(['currentCluster']) },\n\n  mounted() {\n    this.fetchDeps();\n  },\n\n  beforeDestroy() {\n    this.alertManagerPoller.stop();\n  },\n\n  methods: {\n    async loadAlertManagerEvents() {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const alertsEvents = await this.$store.dispatch(\n        `${ inStore }/request`,\n        { url: `/k8s/clusters/${ this.currentCluster.id }/api/v1/namespaces/${ this.monitoringNamespace }/services/http:${ this.alertServiceEndpoint }:9093/proxy/api/v1/alerts` }\n      );\n\n      if (alertsEvents.data) {\n        this.allAlerts = alertsEvents.data;\n      }\n    },\n\n    async fetchDeps() {\n      try {\n        const am = await this.$store.dispatch('cluster/find', { type: ENDPOINTS, id: `${ this.monitoringNamespace }/${ this.alertServiceEndpoint }` });\n\n        if (!isEmpty(am) && !isEmpty(am.subsets)) {\n          this.alertManagerPoller.start();\n        }\n      } catch {\n\n      }\n    },\n  }\n};\n</script>\n\n<template>\n  <SortableTable\n    :rows=\"allAlerts\"\n    :headers=\"eventHeaders\"\n    :search=\"false\"\n    :table-actions=\"false\"\n    :row-actions=\"false\"\n    :paging=\"true\"\n    :rows-per-page=\"10\"\n    default-sort-by=\"name\"\n    key-field=\"id\"\n  />\n</template>\n"],"mappings":"AACA,OAAAA,OAAA;AACA,OAAAC,MAAA;AACA,OAAAC,aAAA;AACA,SAAAC,SAAA;AACA,SAAAC,UAAA;AACA,MAAAC,yBAAA;AACA,MAAAC,YAAA;AAEA;EACAC,UAAA;IAAAL;EAAA;EAEAM,KAAA;IACAC,mBAAA;MACAC,IAAA,EAAAC,MAAA;MACAC,OAAA;IACA;IACAC,oBAAA;MACAH,IAAA,EAAAC,MAAA;MACAC,OAAA;IACA;EACA;EAEAE,KAAA;IACA,MAAAC,YAAA,IACA;MACAC,IAAA;MACAC,KAAA;MACAC,QAAA;MACAC,KAAA;MACAC,IAAA;MACAC,KAAA;IACA,GACA;MACAL,IAAA;MACAC,KAAA;MACAC,QAAA;MACAC,KAAA;MACAC,IAAA;IACA,GACA;MACAJ,IAAA;MACAC,KAAA;MACAC,QAAA;MACAC,KAAA;MACAG,SAAA;MACAF,IAAA;IACA,EACA;IAEA;MACAG,kBAAA,MAAAtB,MAAA,CACA,KAAAuB,sBAAA,EACAnB,yBAAA,EACAC,YACA;MACAmB,SAAA;MACAV;IACA;EACA;EACAW,QAAA;IAAA,GAAAtB,UAAA;EAAA;EAEAuB,QAAA;IACA,KAAAC,SAAA;EACA;EAEAC,cAAA;IACA,KAAAN,kBAAA,CAAAO,IAAA;EACA;EAEAC,OAAA;IACA,MAAAP,uBAAA;MACA,MAAAQ,OAAA,QAAAC,MAAA,CAAAC,OAAA,mBAAAF,OAAA;MACA,MAAAG,YAAA,cAAAF,MAAA,CAAAG,QAAA,CACA,GAAAJ,OAAA,YACA;QAAAK,GAAA,wBAAAC,cAAA,CAAAC,EAAA,2BAAA9B,mBAAA,uBAAAI,oBAAA;MAAA,CACA;MAEA,IAAAsB,YAAA,CAAArB,IAAA;QACA,KAAAW,SAAA,GAAAU,YAAA,CAAArB,IAAA;MACA;IACA;IAEA,MAAAc,UAAA;MACA;QACA,MAAAY,EAAA,cAAAP,MAAA,CAAAG,QAAA;UAAA1B,IAAA,EAAAP,SAAA;UAAAoC,EAAA,UAAA9B,mBAAA,SAAAI,oBAAA;QAAA;QAEA,KAAAb,OAAA,CAAAwC,EAAA,MAAAxC,OAAA,CAAAwC,EAAA,CAAAC,OAAA;UACA,KAAAlB,kBAAA,CAAAmB,KAAA;QACA;MACA,SAEA;IACA;EACA;AACA"}]}