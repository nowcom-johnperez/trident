{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/ResourceYaml.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/ResourceYaml.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBqc3lhbWwgZnJvbSAnanMteWFtbCc7CmltcG9ydCBZYW1sRWRpdG9yLCB7IEVESVRPUl9NT0RFUyB9IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1lhbWxFZGl0b3InOwppbXBvcnQgRmlsZVNlbGVjdG9yIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vRmlsZVNlbGVjdG9yJzsKaW1wb3J0IEZvb3RlciBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0Zvb3Rlcic7CmltcG9ydCB7IEFOTk9UQVRJT05TX1RPX0ZPTEQgfSBmcm9tICdAc2hlbGwvY29uZmlnL2xhYmVscy1hbm5vdGF0aW9ucyc7CmltcG9ydCB7IGVuc3VyZVJlZ2V4IH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IHR5cGVPZiB9IGZyb20gJ0BzaGVsbC91dGlscy9zb3J0JzsKCmltcG9ydCB7CiAgX0NSRUFURSwKICBfVklFVywKICBQUkVWSUVXLAogIF9GTEFHR0VELAogIF9VTkZMQUcsCiAgX0VESVQsCn0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyBCRUZPUkVfU0FWRV9IT09LUywgQUZURVJfU0FWRV9IT09LUyB9IGZyb20gJ0BzaGVsbC9taXhpbnMvY2hpbGQtaG9vayc7CmltcG9ydCB7IGV4Y2VwdGlvblRvRXJyb3JzQXJyYXkgfSBmcm9tICdAc2hlbGwvdXRpbHMvZXJyb3InOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEZvb3RlciwKICAgIEZpbGVTZWxlY3RvciwKICAgIFlhbWxFZGl0b3IKICB9LAoKICBwcm9wczogewogICAgbW9kZTogewogICAgICB0eXBlOiAgICAgU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCgogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIGluaXRpYWxZYW1sRm9yRGlmZjogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6IG51bGwsCiAgICB9LAoKICAgIHlhbWw6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIGRvbmVSb3V0ZTogewogICAgICB0eXBlOiAgICBbU3RyaW5nLCBPYmplY3RdLAogICAgICBkZWZhdWx0OiBudWxsLAogICAgfSwKCiAgICBvZmZlclByZXZpZXc6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgIH0sCgogICAgcGFyZW50UGFyYW1zOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogbnVsbCwKICAgIH0sCgogICAgZG9uZU92ZXJyaWRlOiB7CiAgICAgIHR5cGU6ICAgIFtGdW5jdGlvbiwgT2JqZWN0XSwKICAgICAgZGVmYXVsdDogbnVsbAogICAgfSwKCiAgICBzaG93Rm9vdGVyOiB7CiAgICAgIHR5cGU6ICAgIEJvb2xlYW4sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCgogICAgYXBwbHlIb29rczogewogICAgICB0eXBlOiAgICBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogbnVsbCwKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgLy8gSW5pdGlhbCBsb2FkIHdpdGggYSBwcmV2aWV3IHNob3dpbmcgbm8gZGlmZiBpc24ndCB2ZXJ5IHVzZWZ1bAogICAgdGhpcy4kcm91dGVyLmFwcGx5UXVlcnkoeyBbUFJFVklFV106IF9VTkZMQUcgfSk7CgogICAgcmV0dXJuIHsKICAgICAgaW5pdGlhbFlhbWw6ICB0aGlzLmluaXRpYWxZYW1sRm9yRGlmZiB8fCB0aGlzLnlhbWwsCiAgICAgIGN1cnJlbnRZYW1sOiAgdGhpcy55YW1sLAogICAgICBzaG93UHJldmlldzogIGZhbHNlLAogICAgICBlcnJvcnM6ICAgICAgIG51bGwsCiAgICAgIGNtOiAgICAgICAgICAgbnVsbCwKICAgICAgaW5pdGlhbFJlYWR5OiB0cnVlCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBzY2hlbWEoKSB7CiAgICAgIGNvbnN0IGluU3RvcmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50U3RvcmUnXSh0aGlzLnZhbHVlLnR5cGUpOwoKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbYCR7IGluU3RvcmUgfS9zY2hlbWFGb3JgXSggdGhpcy52YWx1ZS50eXBlICk7CiAgICB9LAoKICAgIGlzQ3JlYXRlKCkgewogICAgICByZXR1cm4gdGhpcy5tb2RlID09PSBfQ1JFQVRFOwogICAgfSwKCiAgICBpc1ZpZXcoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9WSUVXOwogICAgfSwKCiAgICBpc0VkaXQoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9FRElUOwogICAgfSwKCiAgICBlZGl0b3JNb2RlKCkgewogICAgICAvLyBJbmNsdWRlIHRoZSBtb2RlIGluIHRoZSByb3V0ZSBhcyBhIGRlcGVuZGVuY3kKICAgICAgLy8gb2YgdGhpcyBjb21wdXRlZCBwcm9wZXJ0eSBzbyB0aGF0IHRoZSBlZGl0b3IKICAgICAgLy8gdG9nZ2xlcyB3aGVuIHlvdSBuYXZpZ2F0ZSBiYWNrIGFuZCBmb3J0aCBiZXR3ZWVuCiAgICAgIC8vIGVkaXQgYW5kIHZpZXcuCiAgICAgIGlmICggdGhpcy4kcm91dGUucXVlcnkubW9kZSA9PT0gX1ZJRVcgfHwgKHRoaXMuaXNWaWV3ICYmICh0aGlzLiRyb3V0ZS5xdWVyeS5tb2RlICE9PSBfRURJVCB8fCB0aGlzLiRyb3V0ZS5xdWVyeS5tb2RlICE9PSBfVklFVykpKSB7CiAgICAgICAgcmV0dXJuIEVESVRPUl9NT0RFUy5WSUVXX0NPREU7CiAgICAgIH0gZWxzZSBpZiAoIHRoaXMuc2hvd1ByZXZpZXcgKSB7CiAgICAgICAgcmV0dXJuIEVESVRPUl9NT0RFUy5ESUZGX0NPREU7CiAgICAgIH0KCiAgICAgIHJldHVybiBFRElUT1JfTU9ERVMuRURJVF9DT0RFOwogICAgfSwKCiAgICBjYW5EaWZmKCkgewogICAgICByZXR1cm4gdGhpcy5pbml0aWFsWWFtbCAhPT0gdGhpcy5jdXJyZW50WWFtbDsKICAgIH0sCiAgfSwKCiAgd2F0Y2g6IHsKICAgIHlhbWwobmV1KSB7CiAgICAgIGlmICggdGhpcy5tb2RlID09PSBfVklFVyApIHsKICAgICAgICB0aGlzLmN1cnJlbnRZYW1sID0gbmV1OwogICAgICB9CiAgICB9LAoKICAgIG1vZGUobmV1LCBvbGQpIHsKICAgICAgLy8gaWYgdGhpcyBjb21wb25lbnQgaXMgY2hhbmdpbmcgZnJvbSB2aWV3aW5nIGEgcmVzb3VyY2UgdG8gJ2NyZWF0aW5nJyB0aGF0IHJlc291cmNlLCBpdCBtdXN0IGFjdHVhbGx5IGJlIGNsb25pbmcKICAgICAgLy8gY2xlYW4geWFtbCBhY2NvcmRpbmdseQogICAgICBpZiAobmV1ID09PSBfQ1JFQVRFICYmIG9sZCA9PT0gX1ZJRVcpIHsKICAgICAgICB0aGlzLmN1cnJlbnRZYW1sID0gdGhpcy52YWx1ZS5jbGVhbllhbWwodGhpcy55YW1sLCBuZXUpOwogICAgICB9CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgb25JbnB1dCh5YW1sKSB7CiAgICAgIHRoaXMuY3VycmVudFlhbWwgPSB5YW1sOwogICAgICB0aGlzLm9uUmVhZHkodGhpcy5jbSk7CiAgICB9LAoKICAgIG9uUmVhZHkoY20pIHsKICAgICAgaWYgKCF0aGlzLmluaXRpYWxSZWFkeSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLmluaXRpYWxSZWFkeSA9IGZhbHNlOwoKICAgICAgdGhpcy5jbSA9IGNtOwoKICAgICAgaWYgKCB0aGlzLmlzRWRpdCApIHsKICAgICAgICBjbS5mb2xkTGluZXNNYXRjaGluZygvXnN0YXR1czpccyokLyk7CiAgICAgIH0KCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcGFyc2VkID0ganN5YW1sLmxvYWQodGhpcy5jdXJyZW50WWFtbCk7CiAgICAgICAgY29uc3QgYW5ub3RhdGlvbnMgPSBPYmplY3Qua2V5cyhwYXJzZWQ/Lm1ldGFkYXRhPy5hbm5vdGF0aW9ucyB8fCB7fSk7CiAgICAgICAgY29uc3QgcmVnZXhlcyA9IEFOTk9UQVRJT05TX1RPX0ZPTEQubWFwKCh4KSA9PiBlbnN1cmVSZWdleCh4KSk7CgogICAgICAgIGxldCBmb2xkQW5ub3RhdGlvbnMgPSBmYWxzZTsKCiAgICAgICAgZm9yICggY29uc3QgayBvZiBhbm5vdGF0aW9ucyApIHsKICAgICAgICAgIGlmICggZm9sZEFubm90YXRpb25zICkgewogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKCBjb25zdCByZWdleCBvZiByZWdleGVzICkgewogICAgICAgICAgICBpZiAoIGsubWF0Y2gocmVnZXgpICkgewogICAgICAgICAgICAgIGZvbGRBbm5vdGF0aW9ucyA9IHRydWU7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICggZm9sZEFubm90YXRpb25zICkgewogICAgICAgICAgY20uZm9sZExpbmVzTWF0Y2hpbmcoL15ccythbm5vdGF0aW9uczpccyokLyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7fQoKICAgICAgY20uZm9sZExpbmVzTWF0Y2hpbmcoL21hbmFnZWRGaWVsZHMvKTsKCiAgICAgIC8vIHJlZ2FyZGxlc3Mgb2YgZWRpdCBvciBjcmVhdGUgd2Ugc2hvdWxkIHByb2JhYmx5IGZvbGQgYWxsIHRoZSBjb21tZW50cyBzbyB0aGV5IGRvbnQgZ2V0IG91dCBvZiBoYW5kLgogICAgICBjb25zdCBzYXZlZCA9IGNtLmdldE1vZGUoKS5mb2xkOwoKICAgICAgY20uZ2V0TW9kZSgpLmZvbGQgPSAneWFtbGNvbW1lbnRzJzsKICAgICAgY20uZXhlY0NvbW1hbmQoJ2ZvbGRBbGwnKTsKICAgICAgY20uZ2V0TW9kZSgpLmZvbGQgPSBzYXZlZDsKICAgIH0sCgogICAgb25DaGFuZ2VzKGNtLCBjaGFuZ2VzKSB7CiAgICAgIGlmICggY2hhbmdlcy5sZW5ndGggIT09IDEgKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBjaGFuZ2UgPSBjaGFuZ2VzWzBdOwoKICAgICAgaWYgKCBjaGFuZ2UuZnJvbS5saW5lICE9PSBjaGFuZ2UudG8ubGluZSApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGxldCBsaW5lID0gY2hhbmdlLmZyb20ubGluZTsKICAgICAgbGV0IHN0ciA9IGNtLmdldExpbmUobGluZSk7CiAgICAgIGxldCBtYXhJbmRlbnQgPSBpbmRlbnRDaGFycyhzdHIpOwoKICAgICAgaWYgKCBtYXhJbmRlbnQgPT09IG51bGwgKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjbS5yZXBsYWNlUmFuZ2UoJycsIHsgbGluZSwgY2g6IDAgfSwgeyBsaW5lLCBjaDogMSB9LCAnK2lucHV0Jyk7CgogICAgICB3aGlsZSAoIGxpbmUgPiAwICkgewogICAgICAgIGxpbmUtLTsKICAgICAgICBzdHIgPSBjbS5nZXRMaW5lKGxpbmUpOwogICAgICAgIGNvbnN0IGluZGVudCA9IGluZGVudENoYXJzKHN0cik7CgogICAgICAgIGlmICggaW5kZW50ID09PSBudWxsICkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBpZiAoIGluZGVudCA8IG1heEluZGVudCApIHsKICAgICAgICAgIGNtLnJlcGxhY2VSYW5nZSgnJywgeyBsaW5lLCBjaDogMCB9LCB7IGxpbmUsIGNoOiAxIH0sICcraW5wdXQnKTsKCiAgICAgICAgICBpZiAoIGluZGVudCA9PT0gMCApIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgbWF4SW5kZW50ID0gaW5kZW50OwogICAgICAgIH0KICAgICAgfQoKICAgICAgZnVuY3Rpb24gaW5kZW50Q2hhcnMoc3RyKSB7CiAgICAgICAgY29uc3QgbWF0Y2ggPSBzdHIubWF0Y2goL14jKFxzKykvKTsKCiAgICAgICAgaWYgKCBtYXRjaCApIHsKICAgICAgICAgIHJldHVybiBtYXRjaFsxXS5sZW5ndGg7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgfSwKCiAgICB1cGRhdGVWYWx1ZSh2YWx1ZSkgewogICAgICB0aGlzLiRyZWZzLnlhbWxlZGl0b3IudXBkYXRlVmFsdWUodmFsdWUpOwogICAgfSwKCiAgICBwcmV2aWV3KCkgewogICAgICB0aGlzLnVwZGF0ZVZhbHVlKHRoaXMuY3VycmVudFlhbWwpOwogICAgICB0aGlzLnNob3dQcmV2aWV3ID0gdHJ1ZTsKICAgICAgdGhpcy4kcm91dGVyLmFwcGx5UXVlcnkoeyBbUFJFVklFV106IF9GTEFHR0VEIH0pOwogICAgfSwKCiAgICB1bnByZXZpZXcoKSB7CiAgICAgIHRoaXMuc2hvd1ByZXZpZXcgPSBmYWxzZTsKICAgICAgdGhpcy4kcm91dGVyLmFwcGx5UXVlcnkoeyBbUFJFVklFV106IF9VTkZMQUcgfSk7CiAgICB9LAoKICAgIGFzeW5jIHNhdmUoYnV0dG9uRG9uZSkgewogICAgICBjb25zdCB5YW1sID0gdGhpcy52YWx1ZS55YW1sRm9yU2F2ZSh0aGlzLmN1cnJlbnRZYW1sKSB8fCB0aGlzLmN1cnJlbnRZYW1sOwoKICAgICAgdHJ5IHsKICAgICAgICBpZiAoIHRoaXMuYXBwbHlIb29rcyApIHsKICAgICAgICAgIGF3YWl0IHRoaXMuYXBwbHlIb29rcyhCRUZPUkVfU0FWRV9IT09LUyk7CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgYXdhaXQgdGhpcy52YWx1ZS5zYXZlWWFtbCh5YW1sKTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIHJldHVybiBvbkVycm9yLmNhbGwodGhpcywgZXJyKTsKICAgICAgICB9CgogICAgICAgIGlmICggdGhpcy5hcHBseUhvb2tzICkgewogICAgICAgICAgYXdhaXQgdGhpcy5hcHBseUhvb2tzKEFGVEVSX1NBVkVfSE9PS1MpOwogICAgICAgIH0KCiAgICAgICAgYnV0dG9uRG9uZSh0cnVlKTsKICAgICAgICB0aGlzLmRvbmUoKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgcmV0dXJuIG9uRXJyb3IuY2FsbCh0aGlzLCBlcnIpOwogICAgICB9CgogICAgICBmdW5jdGlvbiBvbkVycm9yKGVycikgewogICAgICAgIGlmICggZXJyICYmIGVyci5yZXNwb25zZSAmJiBlcnIucmVzcG9uc2UuZGF0YSApIHsKICAgICAgICAgIGNvbnN0IGJvZHkgPSBlcnIucmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICBpZiAoIGJvZHkgJiYgYm9keS5tZXNzYWdlICkgewogICAgICAgICAgICB0aGlzLmVycm9ycyA9IFtib2R5Lm1lc3NhZ2VdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5lcnJvcnMgPSBbZXJyXTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lcnJvcnMgPSBbZXJyXTsKICAgICAgICB9CgogICAgICAgIGJ1dHRvbkRvbmUoZmFsc2UpOwoKICAgICAgICB0aGlzLiRlbWl0KCdlcnJvcicsIGV4Y2VwdGlvblRvRXJyb3JzQXJyYXkoZXJyKSk7CiAgICAgIH0KICAgIH0sCgogICAgZG9uZSgpIHsKICAgICAgaWYgKHRoaXMuZG9uZU92ZXJyaWRlKSB7CiAgICAgICAgcmV0dXJuIHR5cGVvZiAodGhpcy5kb25lT3ZlcnJpZGUpID09PSAnZnVuY3Rpb24nID8gdGhpcy5kb25lT3ZlcnJpZGUoKSA6IHRoaXMuJHJvdXRlci5yZXBsYWNlKHRoaXMuZG9uZU92ZXJyaWRlKTsKICAgICAgfQogICAgICBpZiAoICF0aGlzLmRvbmVSb3V0ZSApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKHR5cGVPZih0aGlzLmRvbmVSb3V0ZSkgPT09ICdvYmplY3QnKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UodGhpcy5kb25lUm91dGUpOwoKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoewogICAgICAgIG5hbWU6ICAgdGhpcy5kb25lUm91dGUsCiAgICAgICAgcGFyYW1zOiB7IHJlc291cmNlOiB0aGlzLnZhbHVlLnR5cGUgfQogICAgICB9KTsKICAgIH0sCgogICAgb25GaWxlU2VsZWN0ZWQodmFsdWUpIHsKICAgICAgY29uc3QgY29tcG9uZW50ID0gdGhpcy4kcmVmcy55YW1sZWRpdG9yOwoKICAgICAgaWYgKGNvbXBvbmVudCkgewogICAgICAgIGNvbXBvbmVudC51cGRhdGVWYWx1ZSh2YWx1ZSk7CiAgICAgIH0KICAgIH0sCgogIH0KfTsK"},{"version":3,"sources":["ResourceYaml.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"ResourceYaml.vue","sourceRoot":"../../node_modules/@rancher/shell/components","sourcesContent":["<script>\nimport jsyaml from 'js-yaml';\nimport YamlEditor, { EDITOR_MODES } from '@shell/components/YamlEditor';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport Footer from '@shell/components/form/Footer';\nimport { ANNOTATIONS_TO_FOLD } from '@shell/config/labels-annotations';\nimport { ensureRegex } from '@shell/utils/string';\nimport { typeOf } from '@shell/utils/sort';\n\nimport {\n  _CREATE,\n  _VIEW,\n  PREVIEW,\n  _FLAGGED,\n  _UNFLAG,\n  _EDIT,\n} from '@shell/config/query-params';\nimport { BEFORE_SAVE_HOOKS, AFTER_SAVE_HOOKS } from '@shell/mixins/child-hook';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\n\nexport default {\n  components: {\n    Footer,\n    FileSelector,\n    YamlEditor\n  },\n\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n\n    value: {\n      type:     Object,\n      required: true,\n    },\n\n    initialYamlForDiff: {\n      type:    String,\n      default: null,\n    },\n\n    yaml: {\n      type:     String,\n      required: true,\n    },\n\n    doneRoute: {\n      type:    [String, Object],\n      default: null,\n    },\n\n    offerPreview: {\n      type:    Boolean,\n      default: true,\n    },\n\n    parentParams: {\n      type:    Object,\n      default: null,\n    },\n\n    doneOverride: {\n      type:    [Function, Object],\n      default: null\n    },\n\n    showFooter: {\n      type:    Boolean,\n      default: true\n    },\n\n    applyHooks: {\n      type:    Function,\n      default: null,\n    }\n  },\n\n  data() {\n    // Initial load with a preview showing no diff isn't very useful\n    this.$router.applyQuery({ [PREVIEW]: _UNFLAG });\n\n    return {\n      initialYaml:  this.initialYamlForDiff || this.yaml,\n      currentYaml:  this.yaml,\n      showPreview:  false,\n      errors:       null,\n      cm:           null,\n      initialReady: true\n    };\n  },\n\n  computed: {\n    schema() {\n      const inStore = this.$store.getters['currentStore'](this.value.type);\n\n      return this.$store.getters[`${ inStore }/schemaFor`]( this.value.type );\n    },\n\n    isCreate() {\n      return this.mode === _CREATE;\n    },\n\n    isView() {\n      return this.mode === _VIEW;\n    },\n\n    isEdit() {\n      return this.mode === _EDIT;\n    },\n\n    editorMode() {\n      // Include the mode in the route as a dependency\n      // of this computed property so that the editor\n      // toggles when you navigate back and forth between\n      // edit and view.\n      if ( this.$route.query.mode === _VIEW || (this.isView && (this.$route.query.mode !== _EDIT || this.$route.query.mode !== _VIEW))) {\n        return EDITOR_MODES.VIEW_CODE;\n      } else if ( this.showPreview ) {\n        return EDITOR_MODES.DIFF_CODE;\n      }\n\n      return EDITOR_MODES.EDIT_CODE;\n    },\n\n    canDiff() {\n      return this.initialYaml !== this.currentYaml;\n    },\n  },\n\n  watch: {\n    yaml(neu) {\n      if ( this.mode === _VIEW ) {\n        this.currentYaml = neu;\n      }\n    },\n\n    mode(neu, old) {\n      // if this component is changing from viewing a resource to 'creating' that resource, it must actually be cloning\n      // clean yaml accordingly\n      if (neu === _CREATE && old === _VIEW) {\n        this.currentYaml = this.value.cleanYaml(this.yaml, neu);\n      }\n    }\n  },\n\n  methods: {\n    onInput(yaml) {\n      this.currentYaml = yaml;\n      this.onReady(this.cm);\n    },\n\n    onReady(cm) {\n      if (!this.initialReady) {\n        return;\n      }\n      this.initialReady = false;\n\n      this.cm = cm;\n\n      if ( this.isEdit ) {\n        cm.foldLinesMatching(/^status:\\s*$/);\n      }\n\n      try {\n        const parsed = jsyaml.load(this.currentYaml);\n        const annotations = Object.keys(parsed?.metadata?.annotations || {});\n        const regexes = ANNOTATIONS_TO_FOLD.map((x) => ensureRegex(x));\n\n        let foldAnnotations = false;\n\n        for ( const k of annotations ) {\n          if ( foldAnnotations ) {\n            break;\n          }\n\n          for ( const regex of regexes ) {\n            if ( k.match(regex) ) {\n              foldAnnotations = true;\n              break;\n            }\n          }\n        }\n\n        if ( foldAnnotations ) {\n          cm.foldLinesMatching(/^\\s+annotations:\\s*$/);\n        }\n      } catch (e) {}\n\n      cm.foldLinesMatching(/managedFields/);\n\n      // regardless of edit or create we should probably fold all the comments so they dont get out of hand.\n      const saved = cm.getMode().fold;\n\n      cm.getMode().fold = 'yamlcomments';\n      cm.execCommand('foldAll');\n      cm.getMode().fold = saved;\n    },\n\n    onChanges(cm, changes) {\n      if ( changes.length !== 1 ) {\n        return;\n      }\n\n      const change = changes[0];\n\n      if ( change.from.line !== change.to.line ) {\n        return;\n      }\n\n      let line = change.from.line;\n      let str = cm.getLine(line);\n      let maxIndent = indentChars(str);\n\n      if ( maxIndent === null ) {\n        return;\n      }\n\n      cm.replaceRange('', { line, ch: 0 }, { line, ch: 1 }, '+input');\n\n      while ( line > 0 ) {\n        line--;\n        str = cm.getLine(line);\n        const indent = indentChars(str);\n\n        if ( indent === null ) {\n          break;\n        }\n\n        if ( indent < maxIndent ) {\n          cm.replaceRange('', { line, ch: 0 }, { line, ch: 1 }, '+input');\n\n          if ( indent === 0 ) {\n            break;\n          }\n\n          maxIndent = indent;\n        }\n      }\n\n      function indentChars(str) {\n        const match = str.match(/^#(\\s+)/);\n\n        if ( match ) {\n          return match[1].length;\n        }\n\n        return null;\n      }\n    },\n\n    updateValue(value) {\n      this.$refs.yamleditor.updateValue(value);\n    },\n\n    preview() {\n      this.updateValue(this.currentYaml);\n      this.showPreview = true;\n      this.$router.applyQuery({ [PREVIEW]: _FLAGGED });\n    },\n\n    unpreview() {\n      this.showPreview = false;\n      this.$router.applyQuery({ [PREVIEW]: _UNFLAG });\n    },\n\n    async save(buttonDone) {\n      const yaml = this.value.yamlForSave(this.currentYaml) || this.currentYaml;\n\n      try {\n        if ( this.applyHooks ) {\n          await this.applyHooks(BEFORE_SAVE_HOOKS);\n        }\n\n        try {\n          await this.value.saveYaml(yaml);\n        } catch (err) {\n          return onError.call(this, err);\n        }\n\n        if ( this.applyHooks ) {\n          await this.applyHooks(AFTER_SAVE_HOOKS);\n        }\n\n        buttonDone(true);\n        this.done();\n      } catch (err) {\n        return onError.call(this, err);\n      }\n\n      function onError(err) {\n        if ( err && err.response && err.response.data ) {\n          const body = err.response.data;\n\n          if ( body && body.message ) {\n            this.errors = [body.message];\n          } else {\n            this.errors = [err];\n          }\n        } else {\n          this.errors = [err];\n        }\n\n        buttonDone(false);\n\n        this.$emit('error', exceptionToErrorsArray(err));\n      }\n    },\n\n    done() {\n      if (this.doneOverride) {\n        return typeof (this.doneOverride) === 'function' ? this.doneOverride() : this.$router.replace(this.doneOverride);\n      }\n      if ( !this.doneRoute ) {\n        return;\n      }\n      if (typeOf(this.doneRoute) === 'object') {\n        this.$router.replace(this.doneRoute);\n\n        return;\n      }\n      this.$router.replace({\n        name:   this.doneRoute,\n        params: { resource: this.value.type }\n      });\n    },\n\n    onFileSelected(value) {\n      const component = this.$refs.yamleditor;\n\n      if (component) {\n        component.updateValue(value);\n      }\n    },\n\n  }\n};\n</script>\n\n<template>\n  <div class=\"root resource-yaml\">\n    <YamlEditor\n      ref=\"yamleditor\"\n      v-model=\"currentYaml\"\n      :initial-yaml-values=\"initialYaml\"\n      class=\"yaml-editor flex-content\"\n      :editor-mode=\"editorMode\"\n      @onInput=\"onInput\"\n      @onReady=\"onReady\"\n      @onChanges=\"onChanges\"\n    />\n    <slot\n      name=\"yamlFooter\"\n      :currentYaml=\"currentYaml\"\n      :showPreview=\"showPreview\"\n      :yamlPreview=\"preview\"\n      :yamlSave=\"save\"\n      :yamlUnpreview=\"unpreview\"\n    >\n      <Footer\n        v-if=\"showFooter\"\n        :mode=\"mode\"\n        :errors=\"errors\"\n        @save=\"save\"\n        @done=\"done\"\n      >\n        <template\n          v-if=\"!isView\"\n          #left\n        >\n          <FileSelector\n            class=\"btn role-secondary\"\n            :label=\"t('generic.readFromFile')\"\n            @selected=\"onFileSelected\"\n          />\n        </template>\n        <template\n          v-if=\"!isView\"\n          #middle\n        >\n          <button\n            v-if=\"showPreview\"\n            type=\"button\"\n            class=\"btn role-secondary\"\n            @click=\"unpreview\"\n          >\n            <t k=\"resourceYaml.buttons.continue\" />\n          </button>\n          <button\n            v-else-if=\"offerPreview\"\n            :disabled=\"!canDiff\"\n            type=\"button\"\n            class=\"btn role-secondary\"\n            @click=\"preview\"\n          >\n            <t k=\"resourceYaml.buttons.diff\" />\n          </button>\n        </template>\n      </Footer>\n    </slot>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n.flex-content {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n}\n</style>\n\n<style lang=\"scss\">\n.resource-yaml {\n  .yaml-editor {\n    min-height: 200px;\n  }\n\n  footer .actions {\n    text-align: right;\n  }\n}\n\n</style>\n"]}]}