{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/stream.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/stream.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmV4cG9ydCBmdW5jdGlvbiBzdHJlYW1Kc29uKHVybCwgb3B0LCBvbkRhdGEpIHsKICBvcHQgPSBvcHQgfHwge307CiAgb3B0Lm1ldGhvZCA9IG9wdC5tZXRob2QgfHwgJ2dldCc7CiAgb3B0LmhlYWRlcnMgPSBvcHQuaGVhZGVycyB8fCB7fTsKICBvcHQuaGVhZGVycy5hY2NlcHQgPSAnYXBwbGljYXRpb24vanNvbmwnOwogIHZhciBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7CiAgdmFyIGJ1ZiA9ICcnOwogIHJldHVybiBmZXRjaCh1cmwsIG9wdCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICBpZiAocmVzLnN0YXR1cyA+PSA0MDApIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgU3RyZWFtaW5nJywgcmVzKTsKICAgICAgdmFyIG91dCA9IHsKICAgICAgICBtZXNzYWdlOiAnRXJyb3IgU3RyZWFtaW5nJwogICAgICB9OwogICAgICBvdXQucmVzcG9uc2UgPSByZXM7CiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChvdXQpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHJlcy5ib2R5LmdldFJlYWRlcigpOwogICAgfQogIH0pLnRoZW4oZnVuY3Rpb24gKHJlYWRlcikgewogICAgcmV0dXJuIHJlYWRlci5yZWFkKCkudGhlbihmdW5jdGlvbiBwcm9jZXNzKF9yZWYpIHsKICAgICAgdmFyIHZhbHVlID0gX3JlZi52YWx1ZSwKICAgICAgICBkb25lID0gX3JlZi5kb25lOwogICAgICBpZiAoZG9uZSkgewogICAgICAgIG9uRGF0YShKU09OLnBhcnNlKGJ1ZikpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBidWYgKz0gZGVjb2Rlci5kZWNvZGUodmFsdWUsIHsKICAgICAgICBzdHJlYW06IHRydWUKICAgICAgfSk7CiAgICAgIHZhciBsaW5lcyA9IGJ1Zi5zcGxpdCgvW1xyXG5dKD89LikvKTsKICAgICAgYnVmID0gbGluZXMucG9wKCk7CiAgICAgIGxpbmVzLm1hcChKU09OLnBhcnNlKS5mb3JFYWNoKG9uRGF0YSk7CiAgICAgIHJldHVybiByZWFkZXIucmVhZCgpLnRoZW4ocHJvY2Vzcyk7CiAgICB9KTsKICB9KTsKfQpleHBvcnQgZnVuY3Rpb24gc3RyZWFtaW5nU3VwcG9ydGVkKCkgewogIHZhciBzdXBwb3J0ZWQgPSB0eXBlb2YgVGV4dERlY29kZXIgIT09ICd1bmRlZmluZWQnOwoKICAvLyBjb25zb2xlLmxvZygnU3RyZWFtaW5nIFN1cHBvcnRlZDogJywgc3VwcG9ydGVkKTsKCiAgcmV0dXJuIHN1cHBvcnRlZDsKfQ=="},{"version":3,"names":["streamJson","url","opt","onData","method","headers","accept","decoder","TextDecoder","buf","fetch","then","res","status","console","error","out","message","response","Promise","reject","body","getReader","reader","read","process","_ref","value","done","JSON","parse","decode","stream","lines","split","pop","map","forEach","streamingSupported","supported"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/stream.js"],"sourcesContent":["export function streamJson(url, opt, onData) {\n  opt = opt || {};\n  opt.method = opt.method || 'get';\n  opt.headers = opt.headers || {};\n  opt.headers.accept = 'application/jsonl';\n\n  const decoder = new TextDecoder();\n  let buf = '';\n\n  return fetch(url, opt)\n    .then((res) => {\n      if ( res.status >= 400 ) {\n        // eslint-disable-next-line no-console\n        console.error('Error Streaming', res);\n\n        const out = { message: 'Error Streaming' };\n\n        out.response = res;\n\n        return Promise.reject(out);\n      } else {\n        return res.body.getReader();\n      }\n    }).then((reader) => {\n      return reader.read().then(function process({ value, done }) {\n        if (done) {\n          onData(JSON.parse(buf));\n\n          return;\n        }\n\n        buf += decoder.decode(value, { stream: true });\n        const lines = buf.split(/[\\r\\n](?=.)/);\n\n        buf = lines.pop();\n        lines.map(JSON.parse).forEach(onData);\n\n        return reader.read().then(process);\n      });\n    });\n}\n\nexport function streamingSupported() {\n  const supported = typeof TextDecoder !== 'undefined';\n\n  // console.log('Streaming Supported: ', supported);\n\n  return supported;\n}\n"],"mappings":";;;;;;;AAAA,OAAO,SAASA,UAAUA,CAACC,GAAG,EAAEC,GAAG,EAAEC,MAAM,EAAE;EAC3CD,GAAG,GAAGA,GAAG,IAAI,CAAC,CAAC;EACfA,GAAG,CAACE,MAAM,GAAGF,GAAG,CAACE,MAAM,IAAI,KAAK;EAChCF,GAAG,CAACG,OAAO,GAAGH,GAAG,CAACG,OAAO,IAAI,CAAC,CAAC;EAC/BH,GAAG,CAACG,OAAO,CAACC,MAAM,GAAG,mBAAmB;EAExC,IAAMC,OAAO,GAAG,IAAIC,WAAW,CAAC,CAAC;EACjC,IAAIC,GAAG,GAAG,EAAE;EAEZ,OAAOC,KAAK,CAACT,GAAG,EAAEC,GAAG,CAAC,CACnBS,IAAI,CAAC,UAACC,GAAG,EAAK;IACb,IAAKA,GAAG,CAACC,MAAM,IAAI,GAAG,EAAG;MACvB;MACAC,OAAO,CAACC,KAAK,CAAC,iBAAiB,EAAEH,GAAG,CAAC;MAErC,IAAMI,GAAG,GAAG;QAAEC,OAAO,EAAE;MAAkB,CAAC;MAE1CD,GAAG,CAACE,QAAQ,GAAGN,GAAG;MAElB,OAAOO,OAAO,CAACC,MAAM,CAACJ,GAAG,CAAC;IAC5B,CAAC,MAAM;MACL,OAAOJ,GAAG,CAACS,IAAI,CAACC,SAAS,CAAC,CAAC;IAC7B;EACF,CAAC,CAAC,CAACX,IAAI,CAAC,UAACY,MAAM,EAAK;IAClB,OAAOA,MAAM,CAACC,IAAI,CAAC,CAAC,CAACb,IAAI,CAAC,SAASc,OAAOA,CAAAC,IAAA,EAAkB;MAAA,IAAfC,KAAK,GAAAD,IAAA,CAALC,KAAK;QAAEC,IAAI,GAAAF,IAAA,CAAJE,IAAI;MACtD,IAAIA,IAAI,EAAE;QACRzB,MAAM,CAAC0B,IAAI,CAACC,KAAK,CAACrB,GAAG,CAAC,CAAC;QAEvB;MACF;MAEAA,GAAG,IAAIF,OAAO,CAACwB,MAAM,CAACJ,KAAK,EAAE;QAAEK,MAAM,EAAE;MAAK,CAAC,CAAC;MAC9C,IAAMC,KAAK,GAAGxB,GAAG,CAACyB,KAAK,CAAC,aAAa,CAAC;MAEtCzB,GAAG,GAAGwB,KAAK,CAACE,GAAG,CAAC,CAAC;MACjBF,KAAK,CAACG,GAAG,CAACP,IAAI,CAACC,KAAK,CAAC,CAACO,OAAO,CAAClC,MAAM,CAAC;MAErC,OAAOoB,MAAM,CAACC,IAAI,CAAC,CAAC,CAACb,IAAI,CAACc,OAAO,CAAC;IACpC,CAAC,CAAC;EACJ,CAAC,CAAC;AACN;AAEA,OAAO,SAASa,kBAAkBA,CAAA,EAAG;EACnC,IAAMC,SAAS,GAAG,OAAO/B,WAAW,KAAK,WAAW;;EAEpD;;EAEA,OAAO+B,SAAS;AAClB"}]}