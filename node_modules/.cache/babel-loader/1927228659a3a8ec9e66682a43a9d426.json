{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/plugins/steve/resourceWatcher.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/plugins/steve/resourceWatcher.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5jb25zdHJ1Y3QuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanMiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2dldCBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKZnVuY3Rpb24gb3duS2V5cyhlLCByKSB7IHZhciB0ID0gT2JqZWN0LmtleXMoZSk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBvID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTsgciAmJiAobyA9IG8uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGUsIHIpLmVudW1lcmFibGU7IH0pKSwgdC5wdXNoLmFwcGx5KHQsIG8pOyB9IHJldHVybiB0OyB9CmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQoZSkgeyBmb3IgKHZhciByID0gMTsgciA8IGFyZ3VtZW50cy5sZW5ndGg7IHIrKykgeyB2YXIgdCA9IG51bGwgIT0gYXJndW1lbnRzW3JdID8gYXJndW1lbnRzW3JdIDoge307IHIgJSAyID8gb3duS2V5cyhPYmplY3QodCksICEwKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IF9kZWZpbmVQcm9wZXJ0eShlLCByLCB0W3JdKTsgfSkgOiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGUsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHQpKSA6IG93bktleXMoT2JqZWN0KHQpKS5mb3JFYWNoKGZ1bmN0aW9uIChyKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLCByLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHQsIHIpKTsgfSk7IH0gcmV0dXJuIGU7IH0KZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC52YWx1ZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7Ci8qKgogKiBJbXBvcnRzIGluIGEgd29ya2VyIGNhbm5vdCBpbmNsdWRlIGV4cG9ydHMgZnJvbSB0aGUgZmlsZSBpbnZva2luZyB0aGUgd29ya2VyIG9yIGZyb20gZmlsZXMgaW1wb3J0aW5nIHRoZSBpbnZva2luZyBmaWxlLgogKi8KCmltcG9ydCBTb2NrZXQsIHsgTk9fV0FUQ0gsIE5PX1NDSEVNQSwgRVZFTlRfQ09OTkVDVEVELCBSRVZJU0lPTl9UT09fT0xEIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3NvY2tldCc7CmV4cG9ydCB2YXIgV0FUQ0hfU1RBVFVTRVMgPSB7CiAgLyoqCiAgICogd2F0Y2ggaGFzIGJlZW4gYXNrZWQgZm9yIHRoaXMgcmVzb3VyY2UgYnV0IG5vdCByZXF1ZXN0IGhhcyBub3Qgc3VjY2Vzc2Z1bGx5IGJlZW4gc2VudAogICAqLwogIFdBVENIX1BFTkRJTkc6ICdwZW5kaW5nJywKICAvKioKICAgKiByZXF1ZXN0ZWQgYnV0IG5vdCBjb25maXJtZWQgYnkgdGhlIHNvY2tldCB5ZXQKICAgKi8KICBXQVRDSF9SRVFVRVNURUQ6ICdyZXF1ZXN0ZWQnLAogIC8qKgogICAqIGNvbmZpcm1lZCBhcyBhY3RpdmUgYnkgdGhlIHNvY2tldAogICAqLwogIFdBVENISU5HOiAnd2F0Y2hpbmcnLAogIC8qKgogICAqIHRlbXBvcmFyaWx5IHN0b3BwZWQgdmlhIG1lc3NhZ2UgZnJvbSB0aGUgc29ja2V0LCBhIHdhdGNoIHNob3VsZCBpbW1lZGlhdGVseSBiZSB0cmlnZ2VyZWQgYnV0IHRoZSBtYWludGVuYW5jZSBjeWNsZSB3aWxsIHBpY2sgaXQgdXAgaWYgdGhhdCBkb2Vzbid0IGhhcHBlbi4KICAgKi8KICBTVE9QUEVEOiAnc3RvcHBlZCcsCiAgLyoqCiAgICogc3RvcCBoYXMgYmVlbiBhc2tlZCBmb3IgdGhpcyByZXNvdXJjZSwgYnV0IHJlcXVlc3QgaGFzIG5vdCBzdWNjZXNzZnVsbHkgYmVlbiBzZW50CiAgICovCiAgUkVNT1ZFX1BFTkRJTkc6ICdyZW1vdmVkX3BlbmRpbmcnLAogIC8qKgogICAqIHN0b3AgcmVxdWVzdCBoYXMgYmVlbiBzZW50IHRvIHRoZSBzb2NrZXQgb3IgaXQncyBiZWVuIHN0b3BwZWQgYnkgdGhlIHNvY2tldCBpdHNlbGYgYW5kIGlzIG5vdyBhd2FpdGluZyBhIHJlc291cmNlLnN0b3AgbWVzc2FnZQogICAqLwogIFJFTU9WRV9SRVFVRVNURUQ6ICdyZW1vdmVkX3JlcXVlc3RlZCcKfTsKZXhwb3J0IHZhciBrZXlGb3JTdWJzY3JpYmUgPSBmdW5jdGlvbiBrZXlGb3JTdWJzY3JpYmUoKSB7CiAgdmFyIF9yZWYgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9LAogICAgcmVzb3VyY2VUeXBlID0gX3JlZi5yZXNvdXJjZVR5cGUsCiAgICB0eXBlID0gX3JlZi50eXBlLAogICAgbmFtZXNwYWNlID0gX3JlZi5uYW1lc3BhY2UsCiAgICBpZCA9IF9yZWYuaWQsCiAgICBzZWxlY3RvciA9IF9yZWYuc2VsZWN0b3I7CiAgcmV0dXJuIFtyZXNvdXJjZVR5cGUgfHwgdHlwZSwgbmFtZXNwYWNlLCBpZCwgc2VsZWN0b3JdIC8vIGVhY2ggd2F0Y2ggcGFyYW0gaW4gYW4gYXJyYXkKICAuZmlsdGVyKGZ1bmN0aW9uIChwYXJhbSkgewogICAgcmV0dXJuICEhcGFyYW07CiAgfSkgLy8gZmlsdGVyIG91dCBhbGwgdGhlIGVtcHR5IG9uZXMgLy8gdGhlIGZpbHRlciBtYWtlcyB0aGVzZSBrZXlzIG5lYXRlcgogIC5qb2luKCcvJyk7IC8vIGpvaW4gaW50byBhIHN0cmluZyBzbyB3ZSBjYW4gdXNlIGl0IGFzIGFuIG9iamVjdCBrZXkKfTsKZXhwb3J0IHZhciB3YXRjaEtleUZyb21NZXNzYWdlID0gZnVuY3Rpb24gd2F0Y2hLZXlGcm9tTWVzc2FnZShtc2cpIHsKICB2YXIgcmVzb3VyY2VUeXBlID0gbXNnLnJlc291cmNlVHlwZSwKICAgIG5hbWVzcGFjZSA9IG1zZy5uYW1lc3BhY2UsCiAgICBpZCA9IG1zZy5pZCwKICAgIHNlbGVjdG9yID0gbXNnLnNlbGVjdG9yOwogIHZhciB3YXRjaE9iamVjdCA9IHsKICAgIHJlc291cmNlVHlwZTogcmVzb3VyY2VUeXBlLAogICAgaWQ6IGlkLAogICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UsCiAgICBzZWxlY3Rvcjogc2VsZWN0b3IKICB9OwogIHJldHVybiBrZXlGb3JTdWJzY3JpYmUod2F0Y2hPYmplY3QpOwp9Owp2YXIgV0FUQ0hfUEVORElORyA9IFdBVENIX1NUQVRVU0VTLldBVENIX1BFTkRJTkcsCiAgV0FUQ0hfUkVRVUVTVEVEID0gV0FUQ0hfU1RBVFVTRVMuV0FUQ0hfUkVRVUVTVEVELAogIFdBVENISU5HID0gV0FUQ0hfU1RBVFVTRVMuV0FUQ0hJTkcsCiAgUkVNT1ZFX1BFTkRJTkcgPSBXQVRDSF9TVEFUVVNFUy5SRU1PVkVfUEVORElORywKICBSRVFVRVNURURfUkVNT1ZFID0gV0FUQ0hfU1RBVFVTRVMuUkVRVUVTVEVEX1JFTU9WRTsKdmFyIFJlc291cmNlV2F0Y2hlciA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1NvY2tldCkgewogIF9pbmhlcml0cyhSZXNvdXJjZVdhdGNoZXIsIF9Tb2NrZXQpOwogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVzb3VyY2VXYXRjaGVyKTsKICBmdW5jdGlvbiBSZXNvdXJjZVdhdGNoZXIodXJsKSB7CiAgICB2YXIgX3RoaXM7CiAgICB2YXIgYXV0b1JlY29ubmVjdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdHJ1ZTsKICAgIHZhciBmcmFtZVRpbWVvdXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IG51bGw7CiAgICB2YXIgcHJvdG9jb2wgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IG51bGw7CiAgICB2YXIgbWF4VHJpZXMgPSBhcmd1bWVudHMubGVuZ3RoID4gNCAmJiBhcmd1bWVudHNbNF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1s0XSA6IG51bGw7CiAgICB2YXIgY3NyZiA9IGFyZ3VtZW50cy5sZW5ndGggPiA1ID8gYXJndW1lbnRzWzVdIDogdW5kZWZpbmVkOwogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlc291cmNlV2F0Y2hlcik7CiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHVybCwgYXV0b1JlY29ubmVjdCwgZnJhbWVUaW1lb3V0LCBwcm90b2NvbCwgbWF4VHJpZXMsIHRydWUpOwogICAgX3RoaXMud2F0Y2hlcyA9IHt9OwogICAgX3RoaXMuc3RhdHVzID0gJyc7CiAgICBfdGhpcy5kZWJ1Z1dhdGNoZXIgPSBmYWxzZTsKICAgIF90aGlzLmNzcmYgPSB2b2lkIDA7CiAgICBfdGhpcy5iYXNlVXJsID0gc2VsZi5sb2NhdGlvbi5vcmlnaW4gKyB1cmwucmVwbGFjZSgnc3Vic2NyaWJlJywgJycpOwogICAgX3RoaXMuY3NyZiA9IGNzcmY7CiAgICBfdGhpcy5hZGRFdmVudExpc3RlbmVyKEVWRU5UX0NPTk5FQ1RFRCwgZnVuY3Rpb24gKGUpIHsKICAgICAgX3RoaXMudHJhY2UoRVZFTlRfQ09OTkVDVEVELCAnOiBwcm9jZXNzaW5nIHByZXZpb3VzbHkgcmVxdWVzdGVkIG9yIHdhdGNoZWQgcmVzb3VyY2VzJyk7CiAgICAgIE9iamVjdC52YWx1ZXMoX3RoaXMud2F0Y2hlcykuZm9yRWFjaChmdW5jdGlvbiAod2F0Y2gpIHsKICAgICAgICB2YXIgc3RhdHVzID0gd2F0Y2guc3RhdHVzLAogICAgICAgICAgZXJyb3IgPSB3YXRjaC5lcnJvcjsKICAgICAgICB2YXIgd2F0Y2hLZXkgPSBrZXlGb3JTdWJzY3JpYmUod2F0Y2gpOwogICAgICAgIGlmIChbV0FUQ0hfUEVORElORywgV0FUQ0hfUkVRVUVTVEVELCBXQVRDSElOR10uaW5jbHVkZXMoc3RhdHVzKSAmJiAhZXJyb3IpIHsKICAgICAgICAgIF90aGlzLnRyYWNlKEVWRU5UX0NPTk5FQ1RFRCwgJzogcmUtd2F0Y2hpbmcgcHJldmlvdXNseSByZXF1aXJlZCByZXNvdXJjZScsIHdhdGNoS2V5LCBzdGF0dXMpOwogICAgICAgICAgX3RoaXMud2F0Y2hlc1t3YXRjaEtleV0uc3RhdHVzID0gV0FUQ0hfUEVORElORzsKICAgICAgICAgIF90aGlzLndhdGNoKHdhdGNoS2V5KTsKICAgICAgICB9IGVsc2UgaWYgKFtSRU1PVkVfUEVORElOR10uaW5jbHVkZXMoc3RhdHVzKSkgewogICAgICAgICAgX3RoaXMudHJhY2UoRVZFTlRfQ09OTkVDVEVELCAnOiB1bi13YXRjaGluZyBwcmV2aW91c2x5IHdhdGNoZWQgcmVzb3VyY2UnLCB3YXRjaEtleSwgc3RhdHVzKTsKICAgICAgICAgIF90aGlzLndhdGNoZXNbd2F0Y2hLZXldLnN0YXR1cyA9IFJFTU9WRV9QRU5ESU5HOwogICAgICAgICAgX3RoaXMudW53YXRjaCh3YXRjaEtleSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0pOwogICAgcmV0dXJuIF90aGlzOwogIH0KICBfY3JlYXRlQ2xhc3MoUmVzb3VyY2VXYXRjaGVyLCBbewogICAga2V5OiAidHJhY2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHRyYWNlKCkgewogICAgICB2YXIgX2NvbnNvbGU7CiAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykgewogICAgICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07CiAgICAgIH0KICAgICAgdGhpcy5kZWJ1Z1dhdGNoZXIgJiYgKF9jb25zb2xlID0gY29uc29sZSkuaW5mby5hcHBseShfY29uc29sZSwgWydSZXNvdXJjZSBXYXRjaGVyOiddLmNvbmNhdChhcmdzKSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZQogICAgfQogIH0sIHsKICAgIGtleTogInNldERlYnVnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXREZWJ1ZyhvbikgewogICAgICB0aGlzLmRlYnVnV2F0Y2hlciA9ICEhb247CiAgICB9CiAgfSwgewogICAga2V5OiAid2F0Y2hFeGlzdHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdhdGNoRXhpc3RzKHdhdGNoS2V5KSB7CiAgICAgIHZhciBfdGhpcyR3YXRjaGVzOwogICAgICByZXR1cm4gISEoKF90aGlzJHdhdGNoZXMgPSB0aGlzLndhdGNoZXMpICE9PSBudWxsICYmIF90aGlzJHdhdGNoZXMgIT09IHZvaWQgMCAmJiBfdGhpcyR3YXRjaGVzW3dhdGNoS2V5XSk7CiAgICB9CiAgfSwgewogICAga2V5OiAid2F0Y2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdhdGNoKHdhdGNoS2V5LCBwcm92aWRlZFJlc291cmNlVmVyc2lvbiwgcHJvdmlkZWRSZXNvdXJjZVZlcnNpb25UaW1lKSB7CiAgICAgIHZhciBfdGhpcyR3YXRjaGVzMiwgX3RoaXMkd2F0Y2hlczMsIF90aGlzJHdhdGNoZXM1LCBfdGhpcyR3YXRjaGVzNiwgX3RoaXMkd2F0Y2hlczcsIF90aGlzJHdhdGNoZXM4LCBfdGhpcyR3YXRjaGVzOSwgX3RoaXMkd2F0Y2hlczEwLCBfdGhpcyR3YXRjaGVzMTE7CiAgICAgIHZhciBwcm92aWRlZEtleVBhcnRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB7fTsKICAgICAgdmFyIHByb3ZpZGVkU2tpcFJlc291cmNlVmVyc2lvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ID8gYXJndW1lbnRzWzRdIDogdW5kZWZpbmVkOwogICAgICB2YXIgcHJvdmlkZWRSZXNvdXJjZVR5cGUgPSBwcm92aWRlZEtleVBhcnRzLnJlc291cmNlVHlwZSwKICAgICAgICBwcm92aWRlZElkID0gcHJvdmlkZWRLZXlQYXJ0cy5pZCwKICAgICAgICBwcm92aWRlZE5hbWVzcGFjZSA9IHByb3ZpZGVkS2V5UGFydHMubmFtZXNwYWNlLAogICAgICAgIHByb3ZpZGVkU2VsZWN0b3IgPSBwcm92aWRlZEtleVBhcnRzLnNlbGVjdG9yLAogICAgICAgIHByb3ZpZGVkRm9yY2UgPSBwcm92aWRlZEtleVBhcnRzLmZvcmNlOwogICAgICB0aGlzLnRyYWNlKCd3YXRjaDonLCAncmVxdWVzdGVkJywgd2F0Y2hLZXkpOwogICAgICBpZiAoW1dBVENIX1JFUVVFU1RFRCwgV0FUQ0hJTkddLmluY2x1ZGVzKChfdGhpcyR3YXRjaGVzMiA9IHRoaXMud2F0Y2hlcykgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczIgPT09IHZvaWQgMCB8fCAoX3RoaXMkd2F0Y2hlczIgPSBfdGhpcyR3YXRjaGVzMlt3YXRjaEtleV0pID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3YXRjaGVzMi5zdGF0dXMpKSB7CiAgICAgICAgdGhpcy50cmFjZSgnd2F0Y2g6JywgJ2FscmVhZHkgcmVxdWVzdGVkIG9yIHdhdGNoaW5nLCBhYm9ydGluZycsIHdhdGNoS2V5KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCFwcm92aWRlZEZvcmNlICYmIChfdGhpcyR3YXRjaGVzMyA9IHRoaXMud2F0Y2hlcykgIT09IG51bGwgJiYgX3RoaXMkd2F0Y2hlczMgIT09IHZvaWQgMCAmJiAoX3RoaXMkd2F0Y2hlczMgPSBfdGhpcyR3YXRjaGVzM1t3YXRjaEtleV0pICE9PSBudWxsICYmIF90aGlzJHdhdGNoZXMzICE9PSB2b2lkIDAgJiYgX3RoaXMkd2F0Y2hlczMuZXJyb3IpIHsKICAgICAgICB2YXIgX3RoaXMkd2F0Y2hlczQ7CiAgICAgICAgaWYgKCgoX3RoaXMkd2F0Y2hlczQgPSB0aGlzLndhdGNoZXMpID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXM0ID09PSB2b2lkIDAgfHwgKF90aGlzJHdhdGNoZXM0ID0gX3RoaXMkd2F0Y2hlczRbd2F0Y2hLZXldKSA9PT0gbnVsbCB8fCBfdGhpcyR3YXRjaGVzNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkd2F0Y2hlczQuZXJyb3IucmVhc29uKSAhPT0gUkVWSVNJT05fVE9PX09MRCkgewogICAgICAgICAgdGhpcy50cmFjZSgnd2F0Y2g6JywgJ2luIGVycm9yLCBhYm9ydGluZycsIHdhdGNoS2V5KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciByZXNvdXJjZVR5cGUgPSBwcm92aWRlZFJlc291cmNlVHlwZSB8fCAoKF90aGlzJHdhdGNoZXM1ID0gdGhpcy53YXRjaGVzKSA9PT0gbnVsbCB8fCBfdGhpcyR3YXRjaGVzNSA9PT0gdm9pZCAwIHx8IChfdGhpcyR3YXRjaGVzNSA9IF90aGlzJHdhdGNoZXM1W3dhdGNoS2V5XSkgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHdhdGNoZXM1LnJlc291cmNlVHlwZSk7CiAgICAgIHZhciBpZCA9IHByb3ZpZGVkSWQgfHwgKChfdGhpcyR3YXRjaGVzNiA9IHRoaXMud2F0Y2hlcykgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczYgPT09IHZvaWQgMCB8fCAoX3RoaXMkd2F0Y2hlczYgPSBfdGhpcyR3YXRjaGVzNlt3YXRjaEtleV0pID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXM2ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3YXRjaGVzNi5pZCk7CiAgICAgIHZhciBuYW1lc3BhY2UgPSBwcm92aWRlZE5hbWVzcGFjZSB8fCAoKF90aGlzJHdhdGNoZXM3ID0gdGhpcy53YXRjaGVzKSA9PT0gbnVsbCB8fCBfdGhpcyR3YXRjaGVzNyA9PT0gdm9pZCAwIHx8IChfdGhpcyR3YXRjaGVzNyA9IF90aGlzJHdhdGNoZXM3W3dhdGNoS2V5XSkgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHdhdGNoZXM3Lm5hbWVzcGFjZSk7CiAgICAgIHZhciBzZWxlY3RvciA9IHByb3ZpZGVkU2VsZWN0b3IgfHwgKChfdGhpcyR3YXRjaGVzOCA9IHRoaXMud2F0Y2hlcykgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczggPT09IHZvaWQgMCB8fCAoX3RoaXMkd2F0Y2hlczggPSBfdGhpcyR3YXRjaGVzOFt3YXRjaEtleV0pID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXM4ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3YXRjaGVzOC5zZWxlY3Rvcik7CiAgICAgIHZhciBza2lwUmVzb3VyY2VWZXJzaW9uID0gKChfdGhpcyR3YXRjaGVzOSA9IHRoaXMud2F0Y2hlcykgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczkgPT09IHZvaWQgMCB8fCAoX3RoaXMkd2F0Y2hlczkgPSBfdGhpcyR3YXRjaGVzOVt3YXRjaEtleV0pID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXM5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3YXRjaGVzOS5za2lwUmVzb3VyY2VWZXJzaW9uKSB8fCBwcm92aWRlZFNraXBSZXNvdXJjZVZlcnNpb247CiAgICAgIHZhciB3YXRjaE9iamVjdCA9IHsKICAgICAgICByZXNvdXJjZVR5cGU6IHJlc291cmNlVHlwZSwKICAgICAgICBpZDogaWQsCiAgICAgICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UsCiAgICAgICAgc2VsZWN0b3I6IHNlbGVjdG9yCiAgICAgIH07CiAgICAgIHZhciByZXNvdXJjZVZlcnNpb25UaW1lID0gcHJvdmlkZWRSZXNvdXJjZVZlcnNpb25UaW1lIHx8ICgoX3RoaXMkd2F0Y2hlczEwID0gdGhpcy53YXRjaGVzKSA9PT0gbnVsbCB8fCBfdGhpcyR3YXRjaGVzMTAgPT09IHZvaWQgMCB8fCAoX3RoaXMkd2F0Y2hlczEwID0gX3RoaXMkd2F0Y2hlczEwW3dhdGNoS2V5XSkgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczEwID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3YXRjaGVzMTAucmVzb3VyY2VWZXJzaW9uVGltZSk7CiAgICAgIHZhciByZXNvdXJjZVZlcnNpb24gPSBwcm92aWRlZFJlc291cmNlVmVyc2lvbiB8fCAoKF90aGlzJHdhdGNoZXMxMSA9IHRoaXMud2F0Y2hlcykgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczExID09PSB2b2lkIDAgfHwgKF90aGlzJHdhdGNoZXMxMSA9IF90aGlzJHdhdGNoZXMxMVt3YXRjaEtleV0pID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXMxMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkd2F0Y2hlczExLnJlc291cmNlVmVyc2lvbik7CiAgICAgIHZhciBzdWNjZXNzID0gdGhpcy5zZW5kKEpTT04uc3RyaW5naWZ5KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgd2F0Y2hPYmplY3QpLCB7fSwgewogICAgICAgIHJlc291cmNlVmVyc2lvbjogIXNraXBSZXNvdXJjZVZlcnNpb24gPyByZXNvdXJjZVZlcnNpb24gOiB1bmRlZmluZWQKICAgICAgfSkpKTsKICAgICAgdGhpcy53YXRjaGVzW3dhdGNoS2V5XSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgd2F0Y2hPYmplY3QpLCB7fSwgewogICAgICAgIHN0YXR1czogc3VjY2VzcyA/IFdBVENIX1NUQVRVU0VTLldBVENIX1JFUVVFU1RFRCA6IFdBVENIX1NUQVRVU0VTLldBVENIX1BFTkRJTkcsCiAgICAgICAgcmVzb3VyY2VWZXJzaW9uOiByZXNvdXJjZVZlcnNpb24sCiAgICAgICAgcmVzb3VyY2VWZXJzaW9uVGltZTogcmVzb3VyY2VWZXJzaW9uVGltZSwKICAgICAgICBza2lwUmVzb3VyY2VWZXJzaW9uOiBza2lwUmVzb3VyY2VWZXJzaW9uCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInVud2F0Y2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVud2F0Y2god2F0Y2hLZXkpIHsKICAgICAgdmFyIF90aGlzJHdhdGNoZXMxMjsKICAgICAgdmFyIHdhdGNoID0gKChfdGhpcyR3YXRjaGVzMTIgPSB0aGlzLndhdGNoZXMpID09PSBudWxsIHx8IF90aGlzJHdhdGNoZXMxMiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkd2F0Y2hlczEyW3dhdGNoS2V5XSkgfHwge307CiAgICAgIHZhciByZXNvdXJjZVR5cGUgPSB3YXRjaC5yZXNvdXJjZVR5cGUsCiAgICAgICAgaWQgPSB3YXRjaC5pZCwKICAgICAgICBuYW1lc3BhY2UgPSB3YXRjaC5uYW1lc3BhY2UsCiAgICAgICAgc2VsZWN0b3IgPSB3YXRjaC5zZWxlY3RvcjsKICAgICAgdmFyIHdhdGNoT2JqZWN0ID0gewogICAgICAgIHJlc291cmNlVHlwZTogcmVzb3VyY2VUeXBlLAogICAgICAgIGlkOiBpZCwKICAgICAgICBuYW1lc3BhY2U6IG5hbWVzcGFjZSwKICAgICAgICBzZWxlY3Rvcjogc2VsZWN0b3IKICAgICAgfTsKICAgICAgaWYgKHJlc291cmNlVHlwZSAmJiB0aGlzLndhdGNoZXNbd2F0Y2hLZXldLnN0YXR1cyAhPT0gUkVRVUVTVEVEX1JFTU9WRSkgewogICAgICAgIHZhciBzdWNjZXNzID0gdGhpcy5zZW5kKEpTT04uc3RyaW5naWZ5KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgd2F0Y2hPYmplY3QpLCB7fSwgewogICAgICAgICAgc3RvcDogdHJ1ZQogICAgICAgIH0pKSk7CiAgICAgICAgdGhpcy53YXRjaGVzW3dhdGNoS2V5XS5zdGF0dXMgPSBzdWNjZXNzID8gUkVRVUVTVEVEX1JFTU9WRSA6IFJFTU9WRV9QRU5ESU5HOwogICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBIYW5kbGVzIG1lc3NhZ2UgZnJvbSBCYWNrZW5kIHRvIFVJCiAgICAgKi8KICB9LCB7CiAgICBrZXk6ICJfb25tZXNzYWdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfb25tZXNzYWdlKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpcyR3YXRjaGVzMTMsIF90aGlzJHdhdGNoZXMxNDsKICAgICAgdmFyIF9KU09OJHBhcnNlID0gSlNPTi5wYXJzZShldmVudC5kYXRhKSwKICAgICAgICBldmVudE5hbWUgPSBfSlNPTiRwYXJzZS5uYW1lLAogICAgICAgIHJlc291cmNlVHlwZSA9IF9KU09OJHBhcnNlLnJlc291cmNlVHlwZSwKICAgICAgICB0eXBlID0gX0pTT04kcGFyc2UuZGF0YS50eXBlLAogICAgICAgIGlkID0gX0pTT04kcGFyc2UuaWQsCiAgICAgICAgbmFtZXNwYWNlID0gX0pTT04kcGFyc2UubmFtZXNwYWNlLAogICAgICAgIHNlbGVjdG9yID0gX0pTT04kcGFyc2Uuc2VsZWN0b3IsCiAgICAgICAgZGF0YSA9IF9KU09OJHBhcnNlLmRhdGE7CiAgICAgIHZhciB3YXRjaEtleSA9IGtleUZvclN1YnNjcmliZSh7CiAgICAgICAgcmVzb3VyY2VUeXBlOiByZXNvdXJjZVR5cGUsCiAgICAgICAgdHlwZTogdHlwZSwKICAgICAgICBpZDogaWQsCiAgICAgICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UsCiAgICAgICAgc2VsZWN0b3I6IHNlbGVjdG9yCiAgICAgIH0pOwogICAgICBpZiAoZXZlbnROYW1lID09PSAncmVzb3VyY2Uuc3RhcnQnICYmICgoX3RoaXMkd2F0Y2hlczEzID0gdGhpcy53YXRjaGVzKSA9PT0gbnVsbCB8fCBfdGhpcyR3YXRjaGVzMTMgPT09IHZvaWQgMCB8fCAoX3RoaXMkd2F0Y2hlczEzID0gX3RoaXMkd2F0Y2hlczEzW3dhdGNoS2V5XSkgPT09IG51bGwgfHwgX3RoaXMkd2F0Y2hlczEzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyR3YXRjaGVzMTMuc3RhdHVzKSA9PT0gV0FUQ0hfUkVRVUVTVEVEKSB7CiAgICAgICAgdGhpcy53YXRjaGVzW3dhdGNoS2V5XS5zdGF0dXMgPSBXQVRDSElORzsKICAgICAgICBkZWxldGUgdGhpcy53YXRjaGVzW3dhdGNoS2V5XS5lcnJvcjsKICAgICAgfSBlbHNlIGlmIChldmVudE5hbWUgPT09ICdyZXNvdXJjZS5zdG9wJyAmJiAoX3RoaXMkd2F0Y2hlczE0ID0gdGhpcy53YXRjaGVzKSAhPT0gbnVsbCAmJiBfdGhpcyR3YXRjaGVzMTQgIT09IHZvaWQgMCAmJiBfdGhpcyR3YXRjaGVzMTRbd2F0Y2hLZXldKSB7CiAgICAgICAgdmFyIF90aGlzJHdhdGNoZXMkd2F0Y2hLZTsKICAgICAgICAvLyBGaW5kIHNvbWUgd2F5IHRvIHJlc29sdmUgdGhlIGNvcnJlY3QgcmVzb3VyY2VWZXJzaW9uIGZyb20gd2l0aGluIHRoZSByZXNvdXJjZVdhdGNoZXIgdW50aWwgdGhlbjoKICAgICAgICAvLyByZXNldCB0aGUgd2F0Y2ggaW4gdGhlIHJlc291cmNlV2F0Y2hlciwgd2UnbGwgaGFuZGxlIHJlY292ZXJ5IHVwIHRoZSBjaGFpbi4gRm9yIG5vdwogICAgICAgIC8vIGRpc3BhdGNoIHRoZSBldmVudCB0byB0aGUgaG9zdCBwcm9jZXNzIHdoaWNoIHNob3VsZCBoYXZlIGEgaGFuZGxlciBmb3IgcmVzb3VyY2Uuc3RvcAoKICAgICAgICAvLyBpZiAodGhpcy53YXRjaGVzPy5bd2F0Y2hLZXldPy5zdGF0dXMgPT09IFJFUVVFU1RFRF9SRU1PVkUpIHsKICAgICAgICB0aGlzLndhdGNoZXNbd2F0Y2hLZXldID0gewogICAgICAgICAgZXJyb3I6IChfdGhpcyR3YXRjaGVzJHdhdGNoS2UgPSB0aGlzLndhdGNoZXNbd2F0Y2hLZXldKSA9PT0gbnVsbCB8fCBfdGhpcyR3YXRjaGVzJHdhdGNoS2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHdhdGNoZXMkd2F0Y2hLZS5lcnJvcgogICAgICAgIH07CiAgICAgICAgLy8gfSBlbHNlIHsKICAgICAgICAvLyAgIHRoaXMud2F0Y2hlc1t3YXRjaEtleV0uc3RhdHVzID0gU1RPUFBFRDsKICAgICAgICAvLyAgIGRlbGV0ZSB0aGlzLndhdGNoZXNbd2F0Y2hLZXldLnJlc291cmNlVmVyc2lvbjsKICAgICAgICAvLyAgIGRlbGV0ZSB0aGlzLndhdGNoZXNbd2F0Y2hLZXldLnJlc291cmNlVmVyc2lvblRpbWU7CiAgICAgICAgLy8gICB0aGlzLndhdGNoKHdhdGNoS2V5KTsKICAgICAgICAvLyAgIHRoaXMuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoRVZFTlRfTUVTU0FHRSwgeyBkZXRhaWw6IGV2ZW50IH0pKTsKICAgICAgICAvLyB9CiAgICAgIH0gZWxzZSBpZiAoZXZlbnROYW1lID09PSAncmVzb3VyY2UuZXJyb3InKSB7CiAgICAgICAgdmFyIF9kYXRhJGVycm9yOwogICAgICAgIHZhciBlcnIgPSBkYXRhID09PSBudWxsIHx8IGRhdGEgPT09IHZvaWQgMCB8fCAoX2RhdGEkZXJyb3IgPSBkYXRhLmVycm9yKSA9PT0gbnVsbCB8fCBfZGF0YSRlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2RhdGEkZXJyb3IudG9Mb3dlckNhc2UoKTsKICAgICAgICBpZiAodGhpcy53YXRjaGVzW3dhdGNoS2V5XSAmJiBlcnIuaW5jbHVkZXMoJ3dhdGNoIG5vdCBhbGxvd2VkJykpIHsKICAgICAgICAgIHRoaXMud2F0Y2hlc1t3YXRjaEtleV0uZXJyb3IgPSB7CiAgICAgICAgICAgIHR5cGU6IHJlc291cmNlVHlwZSwKICAgICAgICAgICAgcmVhc29uOiBOT19XQVRDSAogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKHRoaXMud2F0Y2hlc1t3YXRjaEtleV0gJiYgZXJyLmluY2x1ZGVzKCdmYWlsZWQgdG8gZmluZCBzY2hlbWEnKSkgewogICAgICAgICAgLy8gVGhpcyBjYW4gaGFwcGVuIHdoZW4gdGhlIGNhdHRsZS1jbHVzdGVyLWFnZW50IGdvZXMgZG93biAocmVkZXBsb3kgZGVwbG95bWVudCwga2lsbCBwb2QsIGV0YykKICAgICAgICAgIC8vIFRoZSBwcmV2aW91cyBtZXRob2Qgd2FzIGp1c3QgdG8gdHJhY2sgdGhlIGVycm9yIGFuZCBibG9jayBhbnkgZnVydGhlciBhdHRlbXB0cyB0byB3YXRjaCAoY2FuV2F0Y2gpCiAgICAgICAgICAvLyBUaGlzIG1ldGhvZCBtZWFucyB3ZSBjYW4gcmV0cnkgb24gdGhlIG5leHQgZmluZFggKHNob3VsZCBiZSBzYWZlLCB1bmxlc3MgdGhlcmUgYXJlIG90aGVyIHVzZSBjYXNlcy4uLikKCiAgICAgICAgICB0aGlzLndhdGNoZXNbd2F0Y2hLZXldLmVycm9yID0gewogICAgICAgICAgICB0eXBlOiByZXNvdXJjZVR5cGUsCiAgICAgICAgICAgIHJlYXNvbjogTk9fU0NIRU1BCiAgICAgICAgICB9OwogICAgICAgIH0gZWxzZSBpZiAoZXJyLmluY2x1ZGVzKCd0b28gb2xkJykpIHsKICAgICAgICAgIGRlbGV0ZSB0aGlzLndhdGNoZXNbd2F0Y2hLZXldLnJlc291cmNlVmVyc2lvbjsKICAgICAgICAgIGRlbGV0ZSB0aGlzLndhdGNoZXNbd2F0Y2hLZXldLnJlc291cmNlVmVyc2lvblRpbWU7CiAgICAgICAgICBkZWxldGUgdGhpcy53YXRjaGVzW3dhdGNoS2V5XS5za2lwUmVzb3VyY2VWZXJzaW9uOwogICAgICAgICAgdGhpcy53YXRjaGVzW3dhdGNoS2V5XS5lcnJvciA9IHsKICAgICAgICAgICAgdHlwZTogcmVzb3VyY2VUeXBlLAogICAgICAgICAgICByZWFzb246IFJFVklTSU9OX1RPT19PTEQKICAgICAgICAgIH07CiAgICAgICAgICAvLyBOZWVkcyB0byBtYXRjaCBzdWIgcmVzeW5jV2F0Y2ggcGFyYW1zCiAgICAgICAgICB0aGlzLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdyZXN5bmMnLCB7CiAgICAgICAgICAgIGRldGFpbDogewogICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgIHJlc291cmNlVHlwZTogcmVzb3VyY2VUeXBlLAogICAgICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICAgICAgbmFtZXNwYWNlOiBuYW1lc3BhY2UsCiAgICAgICAgICAgICAgICBzZWxlY3Rvcjogc2VsZWN0b3IKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgICAgdGhpcy50cmFjZSgnX29ubWVzc2FnZTonLCAnbmV3IGVycm9yJywgdGhpcy53YXRjaGVzW3dhdGNoS2V5XS5lcnJvcik7CiAgICAgIH0KICAgICAgX2dldChfZ2V0UHJvdG90eXBlT2YoUmVzb3VyY2VXYXRjaGVyLnByb3RvdHlwZSksICJfb25tZXNzYWdlIiwgdGhpcykuY2FsbCh0aGlzLCBldmVudCk7CiAgICB9CiAgfV0pOwogIHJldHVybiBSZXNvdXJjZVdhdGNoZXI7Cn0oU29ja2V0KTsKZXhwb3J0IHsgUmVzb3VyY2VXYXRjaGVyIGFzIGRlZmF1bHQgfTs="},{"version":3,"names":["Socket","NO_WATCH","NO_SCHEMA","EVENT_CONNECTED","REVISION_TOO_OLD","WATCH_STATUSES","WATCH_PENDING","WATCH_REQUESTED","WATCHING","STOPPED","REMOVE_PENDING","REMOVE_REQUESTED","keyForSubscribe","_ref","arguments","length","undefined","resourceType","type","namespace","id","selector","filter","param","join","watchKeyFromMessage","msg","watchObject","REQUESTED_REMOVE","ResourceWatcher","_Socket","_inherits","_super","_createSuper","url","_this","autoReconnect","frameTimeout","protocol","maxTries","csrf","_classCallCheck","call","watches","status","debugWatcher","baseUrl","self","location","origin","replace","addEventListener","e","trace","Object","values","forEach","watch","error","watchKey","includes","unwatch","_createClass","key","value","_console","_len","args","Array","_key","console","info","apply","concat","setDebug","on","watchExists","_this$watches","providedResourceVersion","providedResourceVersionTime","_this$watches2","_this$watches3","_this$watches5","_this$watches6","_this$watches7","_this$watches8","_this$watches9","_this$watches10","_this$watches11","providedKeyParts","providedSkipResourceVersion","providedResourceType","providedId","providedNamespace","providedSelector","providedForce","force","_this$watches4","reason","skipResourceVersion","resourceVersionTime","resourceVersion","success","send","JSON","stringify","_objectSpread","_this$watches12","stop","_onmessage","event","_this$watches13","_this$watches14","_JSON$parse","parse","data","eventName","name","_this$watches$watchKe","_data$error","err","toLowerCase","dispatchEvent","CustomEvent","detail","_get","_getPrototypeOf","prototype","default"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/plugins/steve/resourceWatcher.js"],"sourcesContent":["/**\n * Imports in a worker cannot include exports from the file invoking the worker or from files importing the invoking file.\n */\n\nimport Socket, {\n  NO_WATCH,\n  NO_SCHEMA,\n  EVENT_CONNECTED,\n  REVISION_TOO_OLD\n} from '@shell/utils/socket';\n\nexport const WATCH_STATUSES = {\n  /**\n   * watch has been asked for this resource but not request has not successfully been sent\n   */\n  WATCH_PENDING:    'pending',\n  /**\n   * requested but not confirmed by the socket yet\n   */\n  WATCH_REQUESTED:  'requested',\n  /**\n   * confirmed as active by the socket\n   */\n  WATCHING:         'watching',\n  /**\n   * temporarily stopped via message from the socket, a watch should immediately be triggered but the maintenance cycle will pick it up if that doesn't happen.\n   */\n  STOPPED:          'stopped',\n  /**\n   * stop has been asked for this resource, but request has not successfully been sent\n   */\n  REMOVE_PENDING:   'removed_pending',\n  /**\n   * stop request has been sent to the socket or it's been stopped by the socket itself and is now awaiting a resource.stop message\n   */\n  REMOVE_REQUESTED: 'removed_requested'\n};\n\nexport const keyForSubscribe = ({\n  resourceType, type, namespace, id, selector\n} = {}) => {\n  return [(resourceType || type), namespace, id, selector] // each watch param in an array\n    .filter((param) => !!param) // filter out all the empty ones // the filter makes these keys neater\n    .join('/'); // join into a string so we can use it as an object key\n};\n\nexport const watchKeyFromMessage = (msg) => {\n  const {\n    resourceType,\n    namespace,\n    id,\n    selector\n  } = msg;\n\n  const watchObject = {\n    resourceType,\n    id,\n    namespace,\n    selector\n  };\n\n  return keyForSubscribe(watchObject);\n};\n\nconst {\n  WATCH_PENDING, WATCH_REQUESTED, WATCHING, REMOVE_PENDING, REQUESTED_REMOVE\n} = WATCH_STATUSES;\n\nexport default class ResourceWatcher extends Socket {\n  watches = {};\n  status = '';\n  debugWatcher = false;\n  csrf;\n\n  constructor(url, autoReconnect = true, frameTimeout = null, protocol = null, maxTries = null, csrf) {\n    super(url, autoReconnect, frameTimeout, protocol, maxTries, true);\n    this.baseUrl = self.location.origin + url.replace('subscribe', '');\n    this.csrf = csrf;\n\n    this.addEventListener(EVENT_CONNECTED, (e) => {\n      this.trace(EVENT_CONNECTED, ': processing previously requested or watched resources');\n\n      Object.values(this.watches).forEach((watch) => {\n        const { status, error } = watch;\n        const watchKey = keyForSubscribe(watch);\n\n        if ([WATCH_PENDING, WATCH_REQUESTED, WATCHING].includes(status) && !error) {\n          this.trace(EVENT_CONNECTED, ': re-watching previously required resource', watchKey, status);\n          this.watches[watchKey].status = WATCH_PENDING;\n          this.watch(watchKey);\n        } else if ([REMOVE_PENDING].includes(status)) {\n          this.trace(EVENT_CONNECTED, ': un-watching previously watched resource', watchKey, status);\n          this.watches[watchKey].status = REMOVE_PENDING;\n          this.unwatch(watchKey);\n        }\n      });\n    });\n  }\n\n  trace(...args) {\n    this.debugWatcher && console.info('Resource Watcher:', ...args); // eslint-disable-line no-console\n  }\n\n  setDebug(on) {\n    this.debugWatcher = !!on;\n  }\n\n  watchExists(watchKey) {\n    return !!this.watches?.[watchKey];\n  }\n\n  watch(watchKey, providedResourceVersion, providedResourceVersionTime, providedKeyParts = {}, providedSkipResourceVersion) {\n    const {\n      resourceType: providedResourceType,\n      id: providedId,\n      namespace: providedNamespace,\n      selector: providedSelector,\n      force: providedForce,\n    } = providedKeyParts;\n\n    this.trace('watch:', 'requested', watchKey);\n\n    if ([WATCH_REQUESTED, WATCHING].includes(this.watches?.[watchKey]?.status)) {\n      this.trace('watch:', 'already requested or watching, aborting', watchKey);\n\n      return;\n    }\n\n    if (!providedForce && this.watches?.[watchKey]?.error) {\n      if (this.watches?.[watchKey]?.error.reason !== REVISION_TOO_OLD) {\n        this.trace('watch:', 'in error, aborting', watchKey);\n      }\n\n      return;\n    }\n\n    const resourceType = providedResourceType || this.watches?.[watchKey]?.resourceType;\n    const id = providedId || this.watches?.[watchKey]?.id;\n    const namespace = providedNamespace || this.watches?.[watchKey]?.namespace;\n    const selector = providedSelector || this.watches?.[watchKey]?.selector;\n    const skipResourceVersion = this.watches?.[watchKey]?.skipResourceVersion || providedSkipResourceVersion;\n\n    const watchObject = {\n      resourceType,\n      id,\n      namespace,\n      selector\n    };\n\n    const resourceVersionTime = providedResourceVersionTime || this.watches?.[watchKey]?.resourceVersionTime;\n    const resourceVersion = providedResourceVersion || this.watches?.[watchKey]?.resourceVersion;\n\n    const success = this.send(JSON.stringify({\n      ...watchObject,\n      resourceVersion: !skipResourceVersion ? resourceVersion : undefined\n    }));\n\n    this.watches[watchKey] = {\n      ...watchObject,\n      status: success ? WATCH_STATUSES.WATCH_REQUESTED : WATCH_STATUSES.WATCH_PENDING,\n      resourceVersion,\n      resourceVersionTime,\n      skipResourceVersion\n    };\n  }\n\n  unwatch(watchKey) {\n    const watch = this.watches?.[watchKey] || {};\n    const {\n      resourceType, id, namespace, selector\n    } = watch;\n    const watchObject = {\n      resourceType,\n      id,\n      namespace,\n      selector\n    };\n\n    if (resourceType && this.watches[watchKey].status !== REQUESTED_REMOVE) {\n      const success = this.send(JSON.stringify({\n        ...watchObject,\n        stop: true\n      }));\n\n      this.watches[watchKey].status = success ? REQUESTED_REMOVE : REMOVE_PENDING;\n    }\n  }\n\n  /**\n   * Handles message from Backend to UI\n   */\n  _onmessage(event) {\n    const {\n      name: eventName, resourceType, data: { type }, id, namespace, selector, data\n    } = JSON.parse(event.data);\n    const watchKey = keyForSubscribe({\n      resourceType,\n      type,\n      id,\n      namespace,\n      selector\n    });\n\n    if (eventName === 'resource.start' && this.watches?.[watchKey]?.status === WATCH_REQUESTED) {\n      this.watches[watchKey].status = WATCHING;\n      delete this.watches[watchKey].error;\n    } else if (eventName === 'resource.stop' && this.watches?.[watchKey]) {\n      // Find some way to resolve the correct resourceVersion from within the resourceWatcher until then:\n      // reset the watch in the resourceWatcher, we'll handle recovery up the chain. For now\n      // dispatch the event to the host process which should have a handler for resource.stop\n\n      // if (this.watches?.[watchKey]?.status === REQUESTED_REMOVE) {\n      this.watches[watchKey] = { error: this.watches[watchKey]?.error };\n      // } else {\n      //   this.watches[watchKey].status = STOPPED;\n      //   delete this.watches[watchKey].resourceVersion;\n      //   delete this.watches[watchKey].resourceVersionTime;\n      //   this.watch(watchKey);\n      //   this.dispatchEvent(new CustomEvent(EVENT_MESSAGE, { detail: event }));\n      // }\n    } else if (eventName === 'resource.error') {\n      const err = data?.error?.toLowerCase();\n\n      if ( this.watches[watchKey] && err.includes('watch not allowed') ) {\n        this.watches[watchKey].error = { type: resourceType, reason: NO_WATCH };\n      } else if ( this.watches[watchKey] && err.includes('failed to find schema') ) {\n        // This can happen when the cattle-cluster-agent goes down (redeploy deployment, kill pod, etc)\n        // The previous method was just to track the error and block any further attempts to watch (canWatch)\n        // This method means we can retry on the next findX (should be safe, unless there are other use cases...)\n\n        this.watches[watchKey].error = { type: resourceType, reason: NO_SCHEMA };\n      } else if ( err.includes('too old') ) {\n        delete this.watches[watchKey].resourceVersion;\n        delete this.watches[watchKey].resourceVersionTime;\n        delete this.watches[watchKey].skipResourceVersion;\n        this.watches[watchKey].error = { type: resourceType, reason: REVISION_TOO_OLD };\n        // Needs to match sub resyncWatch params\n        this.dispatchEvent(new CustomEvent('resync', {\n          detail: {\n            data: {\n              resourceType, id, namespace, selector\n            }\n          }\n        }));\n      }\n      this.trace('_onmessage:', 'new error', this.watches[watchKey].error);\n    }\n\n    super._onmessage(event);\n  }\n}\n"],"mappings":"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"}]}