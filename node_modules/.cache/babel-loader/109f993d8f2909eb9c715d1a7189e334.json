{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/cloud-credential/azure.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/cloud-credential/azure.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsKaW1wb3J0IHsgTGFiZWxlZElucHV0IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9MYWJlbGVkSW5wdXQnOwppbXBvcnQgeyBhenVyZUVudmlyb25tZW50cyB9IGZyb20gJ0BzaGVsbC9tYWNoaW5lLWNvbmZpZy9henVyZSc7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CnZhciBBWlVSRV9FUlJPUl9NU0dfUkVHRVggPSAvXi4qTWVzc2FnZT1cIiguKilcIiQvOwp2YXIgQVpVUkVfRVJST1JfSlNPTl9SRUdFWCA9IC9eLipSZXNwb25zZSBib2R5OiAoey4qfSkvOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgTGFiZWxlZElucHV0OiBMYWJlbGVkSW5wdXQsCiAgICBMYWJlbGVkU2VsZWN0OiBMYWJlbGVkU2VsZWN0CiAgfSwKICBtaXhpbnM6IFtDcmVhdGVFZGl0Vmlld10sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIGlmICghdGhpcy52YWx1ZS5kZWNvZGVkRGF0YS5lbnZpcm9ubWVudCkgewogICAgICB0aGlzLnZhbHVlLnNldERhdGEoJ2Vudmlyb25tZW50JywgJ0F6dXJlUHVibGljQ2xvdWQnKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIGF6dXJlRW52aXJvbm1lbnRzOiBhenVyZUVudmlyb25tZW50cwogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICAndmFsdWUuZGVjb2RlZERhdGEuY2xpZW50SWQnOiBmdW5jdGlvbiB2YWx1ZURlY29kZWREYXRhQ2xpZW50SWQobmV1KSB7CiAgICAgIHRoaXMuJGVtaXQoJ3ZhbGlkYXRpb25DaGFuZ2VkJywgISFuZXUpOwogICAgfSwKICAgICd2YWx1ZS5kZWNvZGVkRGF0YS5jbGllbnRTZWNyZXQnOiBmdW5jdGlvbiB2YWx1ZURlY29kZWREYXRhQ2xpZW50U2VjcmV0KG5ldSkgewogICAgICB0aGlzLiRlbWl0KCd2YWxpZGF0aW9uQ2hhbmdlZCcsICEhbmV1KTsKICAgIH0sCiAgICAndmFsdWUuZGVjb2RlZERhdGEuc3Vic2NyaXB0aW9uSWQnOiBmdW5jdGlvbiB2YWx1ZURlY29kZWREYXRhU3Vic2NyaXB0aW9uSWQobmV1KSB7CiAgICAgIHRoaXMuJGVtaXQoJ3ZhbGlkYXRpb25DaGFuZ2VkJywgISFuZXUpOwogICAgfSwKICAgICd2YWx1ZS5kZWNvZGVkRGF0YS5lbnZpcm9ubWVudCc6IGZ1bmN0aW9uIHZhbHVlRGVjb2RlZERhdGFFbnZpcm9ubWVudChuZXUpIHsKICAgICAgdGhpcy4kZW1pdCgndmFsaWRhdGlvbkNoYW5nZWQnLCAhIW5ldSk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB0ZXN0OiBmdW5jdGlvbiB0ZXN0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBfdGhpcyR2YWx1ZSRkZWNvZGVkRGEsIGNsaWVudElkLCBjbGllbnRTZWNyZXQsIHN1YnNjcmlwdGlvbklkLCBlbnZpcm9ubWVudCwgbXNnTWF0Y2gsIGpzb25NYXRjaCwgZXJyb3JPYmo7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX3RoaXMkdmFsdWUkZGVjb2RlZERhID0gX3RoaXMudmFsdWUuZGVjb2RlZERhdGEsIGNsaWVudElkID0gX3RoaXMkdmFsdWUkZGVjb2RlZERhLmNsaWVudElkLCBjbGllbnRTZWNyZXQgPSBfdGhpcyR2YWx1ZSRkZWNvZGVkRGEuY2xpZW50U2VjcmV0LCBzdWJzY3JpcHRpb25JZCA9IF90aGlzJHZhbHVlJGRlY29kZWREYS5zdWJzY3JpcHRpb25JZCwgZW52aXJvbm1lbnQgPSBfdGhpcyR2YWx1ZSRkZWNvZGVkRGEuZW52aXJvbm1lbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9yZXF1ZXN0JywgewogICAgICAgICAgICAgICAgdXJsOiAnL21ldGEvYWtzQ2hlY2tDcmVkZW50aWFscycsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgY2xpZW50SWQ6IGNsaWVudElkLAogICAgICAgICAgICAgICAgICBjbGllbnRTZWNyZXQ6IGNsaWVudFNlY3JldCwKICAgICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uSWQ6IHN1YnNjcmlwdGlvbklkLAogICAgICAgICAgICAgICAgICBlbnZpcm9ubWVudDogZW52aXJvbm1lbnQKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICByZWRpcmVjdFVuYXV0aG9yaXplZDogZmFsc2UKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHRydWUpOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDc7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICBpZiAoIV9jb250ZXh0LnQwLmVycm9yKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gVHJ5IGFuZCBwYXJzZSB0aGUgcmVzcG9uc2UgZnJvbSBBenVyZSBhIGNvdXBsZSBvZiB3YXlzCiAgICAgICAgICAgICAgbXNnTWF0Y2ggPSBfY29udGV4dC50MC5lcnJvci5tYXRjaChBWlVSRV9FUlJPUl9NU0dfUkVHRVgpOwogICAgICAgICAgICAgIGlmICghKChtc2dNYXRjaCA9PT0gbnVsbCB8fCBtc2dNYXRjaCA9PT0gdm9pZCAwID8gdm9pZCAwIDogbXNnTWF0Y2gubGVuZ3RoKSA9PT0gMikpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgICBlcnJvcnM6IFttc2dNYXRjaFsxXV0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBqc29uTWF0Y2ggPSBfY29udGV4dC50MC5lcnJvci5tYXRjaChBWlVSRV9FUlJPUl9KU09OX1JFR0VYKTsKICAgICAgICAgICAgICBpZiAoISgoanNvbk1hdGNoID09PSBudWxsIHx8IGpzb25NYXRjaCA9PT0gdm9pZCAwID8gdm9pZCAwIDoganNvbk1hdGNoLmxlbmd0aCkgPT09IDIpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE3OwogICAgICAgICAgICAgIGVycm9yT2JqID0gSlNPTi5wYXJzZShqc29uTWF0Y2hbMV0pOwogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgIGVycm9yczogW2Vycm9yT2JqLmVycm9yX2Rlc2NyaXB0aW9uXQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyMjsKICAgICAgICAgICAgICBfY29udGV4dC50MSA9IF9jb250ZXh0WyJjYXRjaCJdKDE3KTsKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CiAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzEsIDddLCBbMTcsIDIyXV0pOwogICAgICB9KSkoKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["CreateEditView","LabeledInput","azureEnvironments","LabeledSelect","AZURE_ERROR_MSG_REGEX","AZURE_ERROR_JSON_REGEX","components","mixins","data","value","decodedData","environment","setData","watch","valueDecodedDataClientId","neu","$emit","valueDecodedDataClientSecret","valueDecodedDataSubscriptionId","valueDecodedDataEnvironment","methods","test","_this","_asyncToGenerator","regeneratorRuntime","mark","_callee","_this$value$decodedDa","clientId","clientSecret","subscriptionId","msgMatch","jsonMatch","errorObj","wrap","_callee$","_context","prev","next","$store","dispatch","url","method","redirectUnauthorized","abrupt","t0","error","match","length","errors","JSON","parse","error_description","t1","stop"],"sources":["node_modules/@rancher/shell/cloud-credential/azure.vue"],"sourcesContent":["<script>\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport { azureEnvironments } from '@shell/machine-config/azure';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\n\nconst AZURE_ERROR_MSG_REGEX = /^.*Message=\\\"(.*)\\\"$/;\nconst AZURE_ERROR_JSON_REGEX = /^.*Response body: ({.*})/;\n\nexport default {\n  components: { LabeledInput, LabeledSelect },\n  mixins:     [CreateEditView],\n\n  data() {\n    if ( !this.value.decodedData.environment ) {\n      this.value.setData('environment', 'AzurePublicCloud');\n    }\n\n    return { azureEnvironments };\n  },\n\n  watch: {\n    'value.decodedData.clientId'(neu) {\n      this.$emit('validationChanged', !!neu);\n    },\n    'value.decodedData.clientSecret'(neu) {\n      this.$emit('validationChanged', !!neu);\n    },\n    'value.decodedData.subscriptionId'(neu) {\n      this.$emit('validationChanged', !!neu);\n    },\n    'value.decodedData.environment'(neu) {\n      this.$emit('validationChanged', !!neu);\n    },\n  },\n\n  methods: {\n    async test() {\n      const {\n        clientId,\n        clientSecret,\n        subscriptionId,\n        environment,\n      } = this.value.decodedData;\n\n      try {\n        await this.$store.dispatch('management/request', {\n          url:    '/meta/aksCheckCredentials',\n          method: 'POST',\n          data:   {\n            clientId,\n            clientSecret,\n            subscriptionId,\n            environment,\n          },\n          redirectUnauthorized: false,\n        });\n\n        return true;\n      } catch (e) {\n        if (e.error) {\n          // Try and parse the response from Azure a couple of ways\n          const msgMatch = e.error.match(AZURE_ERROR_MSG_REGEX);\n\n          if (msgMatch?.length === 2) {\n            return { errors: [msgMatch[1]] };\n          } else {\n            const jsonMatch = e.error.match(AZURE_ERROR_JSON_REGEX);\n\n            if (jsonMatch?.length === 2) {\n              try {\n                const errorObj = JSON.parse(jsonMatch[1]);\n\n                return { errors: [errorObj.error_description] };\n              } catch (e) {}\n            }\n          }\n        }\n\n        // Can't parse error, so go with the generic 'auth failed' error message\n        return false;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <section>\n    <div class=\"row mb-10\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          :value=\"value.decodedData.environment\"\n          :mode=\"mode\"\n          :options=\"azureEnvironments\"\n          option-key=\"value\"\n          option-label=\"value\"\n          :searchable=\"false\"\n          :required=\"true\"\n          :label=\"t('cluster.credential.azure.environment.label')\"\n          data-testid=\"azure-cloud-credentials-environment\"\n          @input=\"value.setData('environment', $event)\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.subscriptionId\"\n          label-key=\"cluster.credential.azure.subscriptionId.label\"\n          type=\"text\"\n          :mode=\"mode\"\n          :required=\"true\"\n          data-testid=\"azure-cloud-credentials-subscription-id\"\n          @input=\"value.setData('subscriptionId', $event)\"\n        />\n      </div>\n    </div>\n    <div class=\"row mb-10\">\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.clientId\"\n          label-key=\"cluster.credential.azure.clientId.label\"\n          type=\"text\"\n          :mode=\"mode\"\n          :required=\"true\"\n          data-testid=\"azure-cloud-credentials-client-id\"\n          @input=\"value.setData('clientId', $event)\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          :value=\"value.decodedData.clientSecret\"\n          label-key=\"cluster.credential.azure.clientSecret.label\"\n          type=\"password\"\n          :mode=\"mode\"\n          :required=\"true\"\n          data-testid=\"azure-cloud-credentials-client-secret\"\n          @input=\"value.setData('clientSecret', $event)\"\n        />\n      </div>\n    </div>\n  </section>\n</template>\n"],"mappings":"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"}]}