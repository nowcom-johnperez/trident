{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/validators/role-template.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/validators/role-template.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCB7IFJCQUMgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IGlzRW1wdHkgZnJvbSAnbG9kYXNoL2lzRW1wdHknOwpleHBvcnQgZnVuY3Rpb24gcm9sZVRlbXBsYXRlUnVsZXMoKSB7CiAgdmFyIHJ1bGVzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTsKICB2YXIgZ2V0dGVycyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogIHZhciBlcnJvcnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICB2YXIgdmFsaWRhdG9yQXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDogW107CiAgaWYgKHJ1bGVzLnNvbWUoZnVuY3Rpb24gKHJ1bGUpIHsKICAgIHJldHVybiBpc0VtcHR5KHJ1bGUudmVyYnMpOwogIH0pKSB7CiAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubWlzc2luZ1ZlcmInKSk7CiAgfQogIGlmIChydWxlcy5zb21lKGZ1bmN0aW9uIChydWxlKSB7CiAgICB2YXIgX3J1bGUkcmVzb3VyY2VzLCBfcnVsZSRub25SZXNvdXJjZVVSTHM7CiAgICByZXR1cm4gKChfcnVsZSRyZXNvdXJjZXMgPSBydWxlLnJlc291cmNlcykgPT09IG51bGwgfHwgX3J1bGUkcmVzb3VyY2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfcnVsZSRyZXNvdXJjZXMubGVuZ3RoKSAmJiAoKF9ydWxlJG5vblJlc291cmNlVVJMcyA9IHJ1bGUubm9uUmVzb3VyY2VVUkxzKSA9PT0gbnVsbCB8fCBfcnVsZSRub25SZXNvdXJjZVVSTHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ydWxlJG5vblJlc291cmNlVVJMcy5sZW5ndGgpOwogIH0pKSB7CiAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubm9SZXNvdXJjZUFuZE5vblJlc291cmNlJykpOwogIH0KICBpZiAodmFsaWRhdG9yQXJnc1swXSA9PT0gUkJBQy5ST0xFKSB7CiAgICBpZiAocnVsZXMuc29tZShmdW5jdGlvbiAocnVsZSkgewogICAgICByZXR1cm4gaXNFbXB0eShydWxlLnJlc291cmNlcyk7CiAgICB9KSkgewogICAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubWlzc2luZ1Jlc291cmNlJykpOwogICAgfQogICAgaWYgKHJ1bGVzLnNvbWUoZnVuY3Rpb24gKHJ1bGUpIHsKICAgICAgcmV0dXJuIGlzRW1wdHkocnVsZS5hcGlHcm91cHMpOwogICAgfSkpIHsKICAgICAgZXJyb3JzLnB1c2goZ2V0dGVyc1snaTE4bi90J10oJ3ZhbGlkYXRpb24ucm9sZVRlbXBsYXRlLnJvbGVUZW1wbGF0ZVJ1bGVzLm1pc3NpbmdBcGlHcm91cCcpKTsKICAgIH0KICB9IGVsc2UgaWYgKHJ1bGVzLnNvbWUoZnVuY3Rpb24gKHJ1bGUpIHsKICAgIHZhciBfcnVsZSRyZXNvdXJjZXMyLCBfcnVsZSRub25SZXNvdXJjZVVybHM7CiAgICByZXR1cm4gKChfcnVsZSRyZXNvdXJjZXMyID0gcnVsZS5yZXNvdXJjZXMpID09PSBudWxsIHx8IF9ydWxlJHJlc291cmNlczIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ydWxlJHJlc291cmNlczIubGVuZ3RoKSAmJiAoKF9ydWxlJG5vblJlc291cmNlVXJscyA9IHJ1bGUubm9uUmVzb3VyY2VVcmxzKSA9PT0gbnVsbCB8fCBfcnVsZSRub25SZXNvdXJjZVVybHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9ydWxlJG5vblJlc291cmNlVXJscy5sZW5ndGgpOwogIH0pKSB7CiAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubm9SZXNvdXJjZUFuZE5vblJlc291cmNlJykpOwogIH0KICBpZiAocnVsZXMuc29tZShmdW5jdGlvbiAocnVsZSkgewogICAgcmV0dXJuIGlzRW1wdHkocnVsZS5yZXNvdXJjZXMpICYmIGlzRW1wdHkocnVsZS5ub25SZXNvdXJjZVVSTHMpICYmIGlzRW1wdHkocnVsZS5hcGlHcm91cHMpOwogIH0pKSB7CiAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5yb2xlVGVtcGxhdGUucm9sZVRlbXBsYXRlUnVsZXMubWlzc2luZ09uZVJlc291cmNlJykpOwogIH0KfQ=="},{"version":3,"names":["RBAC","isEmpty","roleTemplateRules","rules","arguments","length","undefined","getters","errors","validatorArgs","some","rule","verbs","push","_rule$resources","_rule$nonResourceURLs","resources","nonResourceURLs","ROLE","apiGroups","_rule$resources2","_rule$nonResourceUrls","nonResourceUrls"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/validators/role-template.js"],"sourcesContent":["import { RBAC } from '@shell/config/types';\r\nimport isEmpty from 'lodash/isEmpty';\r\n\r\nexport function roleTemplateRules(rules = [], getters, errors, validatorArgs = []) {\r\n  if (rules.some((rule) => isEmpty(rule.verbs))) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingVerb'));\r\n  }\r\n\r\n  if (rules.some((rule) => rule.resources?.length && rule.nonResourceURLs?.length)) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.noResourceAndNonResource'));\r\n  }\r\n\r\n  if (validatorArgs[0] === RBAC.ROLE) {\r\n    if (rules.some((rule) => isEmpty(rule.resources))) {\r\n      errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingResource'));\r\n    }\r\n    if (rules.some((rule) => isEmpty(rule.apiGroups))) {\r\n      errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingApiGroup'));\r\n    }\r\n  } else if (rules.some((rule) => rule.resources?.length && rule.nonResourceUrls?.length)) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.noResourceAndNonResource'));\r\n  }\r\n\r\n  if (rules.some((rule) => isEmpty(rule.resources) && isEmpty(rule.nonResourceURLs) && isEmpty(rule.apiGroups))) {\r\n    errors.push(getters['i18n/t']('validation.roleTemplate.roleTemplateRules.missingOneResource'));\r\n  }\r\n}\r\n"],"mappings":";AAAA,SAASA,IAAI,QAAQ,qBAAqB;AAC1C,OAAOC,OAAO,MAAM,gBAAgB;AAEpC,OAAO,SAASC,iBAAiBA,CAAA,EAAkD;EAAA,IAAjDC,KAAK,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;EAAA,IAAEG,OAAO,GAAAH,SAAA,CAAAC,MAAA,OAAAD,SAAA,MAAAE,SAAA;EAAA,IAAEE,MAAM,GAAAJ,SAAA,CAAAC,MAAA,OAAAD,SAAA,MAAAE,SAAA;EAAA,IAAEG,aAAa,GAAAL,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,EAAE;EAC/E,IAAID,KAAK,CAACO,IAAI,CAAC,UAACC,IAAI;IAAA,OAAKV,OAAO,CAACU,IAAI,CAACC,KAAK,CAAC;EAAA,EAAC,EAAE;IAC7CJ,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,uDAAuD,CAAC,CAAC;EACzF;EAEA,IAAIJ,KAAK,CAACO,IAAI,CAAC,UAACC,IAAI;IAAA,IAAAG,eAAA,EAAAC,qBAAA;IAAA,OAAK,EAAAD,eAAA,GAAAH,IAAI,CAACK,SAAS,cAAAF,eAAA,uBAAdA,eAAA,CAAgBT,MAAM,OAAAU,qBAAA,GAAIJ,IAAI,CAACM,eAAe,cAAAF,qBAAA,uBAApBA,qBAAA,CAAsBV,MAAM;EAAA,EAAC,EAAE;IAChFG,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,oEAAoE,CAAC,CAAC;EACtG;EAEA,IAAIE,aAAa,CAAC,CAAC,CAAC,KAAKT,IAAI,CAACkB,IAAI,EAAE;IAClC,IAAIf,KAAK,CAACO,IAAI,CAAC,UAACC,IAAI;MAAA,OAAKV,OAAO,CAACU,IAAI,CAACK,SAAS,CAAC;IAAA,EAAC,EAAE;MACjDR,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,2DAA2D,CAAC,CAAC;IAC7F;IACA,IAAIJ,KAAK,CAACO,IAAI,CAAC,UAACC,IAAI;MAAA,OAAKV,OAAO,CAACU,IAAI,CAACQ,SAAS,CAAC;IAAA,EAAC,EAAE;MACjDX,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,2DAA2D,CAAC,CAAC;IAC7F;EACF,CAAC,MAAM,IAAIJ,KAAK,CAACO,IAAI,CAAC,UAACC,IAAI;IAAA,IAAAS,gBAAA,EAAAC,qBAAA;IAAA,OAAK,EAAAD,gBAAA,GAAAT,IAAI,CAACK,SAAS,cAAAI,gBAAA,uBAAdA,gBAAA,CAAgBf,MAAM,OAAAgB,qBAAA,GAAIV,IAAI,CAACW,eAAe,cAAAD,qBAAA,uBAApBA,qBAAA,CAAsBhB,MAAM;EAAA,EAAC,EAAE;IACvFG,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,oEAAoE,CAAC,CAAC;EACtG;EAEA,IAAIJ,KAAK,CAACO,IAAI,CAAC,UAACC,IAAI;IAAA,OAAKV,OAAO,CAACU,IAAI,CAACK,SAAS,CAAC,IAAIf,OAAO,CAACU,IAAI,CAACM,eAAe,CAAC,IAAIhB,OAAO,CAACU,IAAI,CAACQ,SAAS,CAAC;EAAA,EAAC,EAAE;IAC7GX,MAAM,CAACK,IAAI,CAACN,OAAO,CAAC,QAAQ,CAAC,CAAC,8DAA8D,CAAC,CAAC;EAChG;AACF"}]}