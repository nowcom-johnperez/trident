{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/promptRemove/mixin/roleDeletionCheck.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/promptRemove/mixin/roleDeletionCheck.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanMiOwppbXBvcnQgX3RvQ29uc3VtYWJsZUFycmF5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuYWRkLWFsbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZGVsZXRlLWFsbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZGlmZmVyZW5jZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZXZlcnkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuZmluZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuaW50ZXJzZWN0aW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5pcy1kaXNqb2ludC1mcm9tLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5pcy1zdWJzZXQtb2YuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LmlzLXN1cGVyc2V0LW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5qb2luLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnNldC5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuc29tZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5zZXQuc3ltbWV0cmljLWRpZmZlcmVuY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc2V0LnVuaW9uLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmZ1bmN0aW9uIG93bktleXMoZSwgcikgeyB2YXIgdCA9IE9iamVjdC5rZXlzKGUpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgbyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7IHIgJiYgKG8gPSBvLmZpbHRlcihmdW5jdGlvbiAocikgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLCByKS5lbnVtZXJhYmxlOyB9KSksIHQucHVzaC5hcHBseSh0LCBvKTsgfSByZXR1cm4gdDsgfQpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKGUpIHsgZm9yICh2YXIgciA9IDE7IHIgPCBhcmd1bWVudHMubGVuZ3RoOyByKyspIHsgdmFyIHQgPSBudWxsICE9IGFyZ3VtZW50c1tyXSA/IGFyZ3VtZW50c1tyXSA6IHt9OyByICUgMiA/IG93bktleXMoT2JqZWN0KHQpLCAhMCkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBfZGVmaW5lUHJvcGVydHkoZSwgciwgdFtyXSk7IH0pIDogT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhlLCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyh0KSkgOiBvd25LZXlzKE9iamVjdCh0KSkuZm9yRWFjaChmdW5jdGlvbiAocikgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgciwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LCByKSk7IH0pOyB9IHJldHVybiBlOyB9CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IHJlc291cmNlTmFtZXMgfSBmcm9tICdAc2hlbGwvdXRpbHMvc3RyaW5nJzsKaW1wb3J0IHsgTUFOQUdFTUVOVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBTVUJUWVBFX01BUFBJTkcgfSBmcm9tICdAc2hlbGwvbW9kZWxzL21hbmFnZW1lbnQuY2F0dGxlLmlvLnJvbGV0ZW1wbGF0ZSc7CnZhciBDTFVTVEVSID0gU1VCVFlQRV9NQVBQSU5HLkNMVVNURVIua2V5OwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHdhcm5pbmc6ICcnLAogICAgICBpbmZvOiAnJwogICAgfTsKICB9LAogIGNvbXB1dGVkOiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbWFwU3RhdGUoJ2FjdGlvbi1tZW51JywgWyd0b1JlbW92ZSddKSksIG1hcEdldHRlcnMoewogICAgdDogJ2kxOG4vdCcKICB9KSksIHt9LCB7CiAgICBuYW1lczogZnVuY3Rpb24gbmFtZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLnRvUmVtb3ZlLm1hcChmdW5jdGlvbiAob2JqKSB7CiAgICAgICAgcmV0dXJuIG9iai5uYW1lRGlzcGxheTsKICAgICAgfSkuc2xpY2UoMCwgNSk7CiAgICB9LAogICAgcGx1c01vcmU6IGZ1bmN0aW9uIHBsdXNNb3JlKCkgewogICAgICB2YXIgcmVtYWluaW5nID0gdGhpcy50b1JlbW92ZS5sZW5ndGggLSB0aGlzLm5hbWVzLmxlbmd0aDsKICAgICAgcmV0dXJuIHRoaXMudCgncHJvbXB0UmVtb3ZlLmFuZE90aGVycycsIHsKICAgICAgICBjb3VudDogcmVtYWluaW5nCiAgICAgIH0pOwogICAgfQogIH0pLAogIHdhdGNoOiB7CiAgICB2YWx1ZTogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ldSkgewogICAgICAgIHRoaXMuaGFuZGxlUm9sZURlbGV0aW9uQ2hlY2sobmV1LCBuZXVbMF0udHlwZSwgdGhpcy4kcm91dGUuaGFzaCk7CiAgICAgIH0sCiAgICAgIGltbWVkaWF0ZTogdHJ1ZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgcmVzb3VyY2VOYW1lczogcmVzb3VyY2VOYW1lcywKICAgIGhhbmRsZVJvbGVEZWxldGlvbkNoZWNrOiBmdW5jdGlvbiBoYW5kbGVSb2xlRGVsZXRpb25DaGVjayhyb2xlc1RvUmVtb3ZlLCByZXNvdXJjZVR5cGUsIHF1ZXJ5SGFzaCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICByZXR1cm4gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciByZXNvdXJjZVRvQ2hlY2ssIHByb3BUb01hdGNoLCBudW1iZXJPZlJvbGVzV2l0aEJpbmRzLCB1bmlxdWVVc2Vyc1dpdGhCaW5kcywgX3VzZXJzJGRhdGEsIHJlcXVlc3QsIHVzZXJzLCB1c2VyTWFwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF90aGlzLndhcm5pbmcgPSAnJzsKICAgICAgICAgICAgICBudW1iZXJPZlJvbGVzV2l0aEJpbmRzID0gMDsKICAgICAgICAgICAgICB1bmlxdWVVc2Vyc1dpdGhCaW5kcyA9IG5ldyBTZXQoKTsKICAgICAgICAgICAgICBfdGhpcy5pbmZvID0gX3RoaXMudCgncmJhYy5nbG9iYWxSb2xlcy53YWl0aW5nJywgewogICAgICAgICAgICAgICAgY291bnQ6IHJvbGVzVG9SZW1vdmUubGVuZ3RoCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSByZXNvdXJjZVR5cGU7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IF9jb250ZXh0LnQwID09PSBNQU5BR0VNRU5ULkdMT0JBTF9ST0xFID8gNyA6IDEwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgcmVzb3VyY2VUb0NoZWNrID0gTUFOQUdFTUVOVC5HTE9CQUxfUk9MRV9CSU5ESU5HOwogICAgICAgICAgICAgIHByb3BUb01hdGNoID0gJ2dsb2JhbFJvbGVOYW1lJzsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDEzKTsKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBpZiAocXVlcnlIYXNoLmluY2x1ZGVzKENMVVNURVIpKSB7CiAgICAgICAgICAgICAgICByZXNvdXJjZVRvQ2hlY2sgPSBNQU5BR0VNRU5ULkNMVVNURVJfUk9MRV9URU1QTEFURV9CSU5ESU5HOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXNvdXJjZVRvQ2hlY2sgPSBNQU5BR0VNRU5ULlBST0pFQ1RfUk9MRV9URU1QTEFURV9CSU5ESU5HOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBwcm9wVG9NYXRjaCA9ICdyb2xlVGVtcGxhdGVOYW1lJzsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJicmVhayIsIDEzKTsKICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTM7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgIHJldHVybiBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvcmVxdWVzdCcsIHsKICAgICAgICAgICAgICAgIHVybDogIi92MS8iLmNvbmNhdChyZXNvdXJjZVRvQ2hlY2spLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JwogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICByZXF1ZXN0ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9yZXF1ZXN0JywgewogICAgICAgICAgICAgICAgdXJsOiAiL3YxLyIuY29uY2F0KE1BTkFHRU1FTlQuVVNFUiksCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgIHVzZXJzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICB1c2VyTWFwID0gKF91c2VycyRkYXRhID0gdXNlcnMuZGF0YSkgPT09IG51bGwgfHwgX3VzZXJzJGRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF91c2VycyRkYXRhLnJlZHVjZShmdW5jdGlvbiAobWFwLCB1c2VyKSB7CiAgICAgICAgICAgICAgICBpZiAodXNlci51c2VybmFtZSkgewogICAgICAgICAgICAgICAgICBtYXBbdXNlci5pZF0gPSB1c2VyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG1hcDsKICAgICAgICAgICAgICB9LCB7fSk7CiAgICAgICAgICAgICAgaWYgKHJlcXVlc3QuZGF0YSAmJiByZXF1ZXN0LmRhdGEubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICByb2xlc1RvUmVtb3ZlLmZvckVhY2goZnVuY3Rpb24gKHRvUmVtb3ZlKSB7CiAgICAgICAgICAgICAgICAgIHZhciB1c2VkUm9sZXMgPSByZXF1ZXN0LmRhdGEuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1bcHJvcFRvTWF0Y2hdID09PSB0b1JlbW92ZS5pZDsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGlmICh1c2VkUm9sZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXF1ZVVzZXJzID0gX3RvQ29uc3VtYWJsZUFycmF5KG5ldyBTZXQodXNlZFJvbGVzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0udXNlck5hbWU7CiAgICAgICAgICAgICAgICAgICAgfSkuZmlsdGVyKGZ1bmN0aW9uICh1c2VyKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlck1hcFt1c2VyXTsKICAgICAgICAgICAgICAgICAgICB9KSkpOwogICAgICAgICAgICAgICAgICAgIGlmICh1bmlxdWVVc2Vycy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgIG51bWJlck9mUm9sZXNXaXRoQmluZHMrKzsKICAgICAgICAgICAgICAgICAgICAgIHVuaXF1ZVVzZXJzLmZvckVhY2goZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuaXF1ZVVzZXJzV2l0aEJpbmRzLmFkZCh1c2VyKTsKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAobnVtYmVyT2ZSb2xlc1dpdGhCaW5kcyAmJiB1bmlxdWVVc2Vyc1dpdGhCaW5kcy5zaXplKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLmluZm8gPSAnJzsKICAgICAgICAgICAgICAgICAgX3RoaXMud2FybmluZyA9IF90aGlzLnQoJ3JiYWMuZ2xvYmFsUm9sZXMudXNlcnNCb3VuZCcsIHsKICAgICAgICAgICAgICAgICAgICBjb3VudDogdW5pcXVlVXNlcnNXaXRoQmluZHMuc2l6ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLmluZm8gPSBfdGhpcy50KCdyYmFjLmdsb2JhbFJvbGVzLm5vdEJvdW5kJywgbnVsbCwgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIF90aGlzLmluZm8gPSBfdGhpcy50KCdyYmFjLmdsb2JhbFJvbGVzLm5vdEJvdW5kJywgbnVsbCwgdHJ1ZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyNDoKICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjQ7CiAgICAgICAgICAgICAgX2NvbnRleHQudDEgPSBfY29udGV4dFsiY2F0Y2giXSgxMyk7CiAgICAgICAgICAgICAgX3RoaXMuaW5mbyA9IF90aGlzLnQoJ3JiYWMuZ2xvYmFsUm9sZXMudW5hYmxlVG9DaGVjaycpOwogICAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxMywgMjRdXSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"names":["mapState","mapGetters","resourceNames","MANAGEMENT","SUBTYPE_MAPPING","CLUSTER","key","data","warning","info","computed","_objectSpread","t","names","toRemove","map","obj","nameDisplay","slice","plusMore","remaining","length","count","watch","value","handler","neu","handleRoleDeletionCheck","type","$route","hash","immediate","methods","rolesToRemove","resourceType","queryHash","_this","_asyncToGenerator","regeneratorRuntime","mark","_callee","resourceToCheck","propToMatch","numberOfRolesWithBinds","uniqueUsersWithBinds","_users$data","request","users","userMap","wrap","_callee$","_context","prev","next","Set","t0","GLOBAL_ROLE","GLOBAL_ROLE_BINDING","abrupt","includes","CLUSTER_ROLE_TEMPLATE_BINDING","PROJECT_ROLE_TEMPLATE_BINDING","$store","dispatch","url","concat","method","root","sent","USER","reduce","user","username","id","forEach","usedRoles","filter","item","uniqueUsers","_toConsumableArray","userName","add","size","t1","stop"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/promptRemove/mixin/roleDeletionCheck.js"],"sourcesContent":["import { mapState, mapGetters } from 'vuex';\nimport { resourceNames } from '@shell/utils/string';\nimport { MANAGEMENT } from '@shell/config/types';\nimport { SUBTYPE_MAPPING } from '@shell/models/management.cattle.io.roletemplate';\nconst CLUSTER = SUBTYPE_MAPPING.CLUSTER.key;\n\nexport default {\n  data() {\n    return {\n      warning: '',\n      info:    '',\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    names() {\n      return this.toRemove.map((obj) => obj.nameDisplay).slice(0, 5);\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n  watch: {\n    value: {\n      handler(neu) {\n        this.handleRoleDeletionCheck(neu, neu[0].type, this.$route.hash);\n      },\n      immediate: true\n    }\n  },\n  methods: {\n    resourceNames,\n    async handleRoleDeletionCheck(rolesToRemove, resourceType, queryHash) {\n      this.warning = '';\n      let resourceToCheck;\n      let propToMatch;\n      let numberOfRolesWithBinds = 0;\n      const uniqueUsersWithBinds = new Set();\n\n      this.info = this.t('rbac.globalRoles.waiting', { count: rolesToRemove.length });\n\n      switch (resourceType) {\n      case MANAGEMENT.GLOBAL_ROLE:\n        resourceToCheck = MANAGEMENT.GLOBAL_ROLE_BINDING;\n        propToMatch = 'globalRoleName';\n        break;\n      default:\n        if (queryHash.includes(CLUSTER)) {\n          resourceToCheck = MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING;\n        } else {\n          resourceToCheck = MANAGEMENT.PROJECT_ROLE_TEMPLATE_BINDING;\n        }\n        propToMatch = 'roleTemplateName';\n        break;\n      }\n\n      try {\n        const request = await this.$store.dispatch('management/request', {\n          url:    `/v1/${ resourceToCheck }`,\n          method: 'get',\n        }, { root: true });\n\n        // We need to fetch the users here in order to get an accurate count when selecting global roles.\n        const users = await this.$store.dispatch('management/request', {\n          url:    `/v1/${ MANAGEMENT.USER }`,\n          method: 'get',\n        }, { root: true });\n\n        const userMap = users.data?.reduce((map, user) => {\n          if ( user.username ) {\n            map[user.id] = user;\n          }\n\n          return map;\n        }, {});\n\n        if (request.data && request.data.length) {\n          rolesToRemove.forEach((toRemove) => {\n            const usedRoles = request.data.filter((item) => item[propToMatch] === toRemove.id);\n\n            if (usedRoles.length) {\n              const uniqueUsers = [...new Set(usedRoles.map((item) => item.userName).filter((user) => userMap[user]))];\n\n              if (uniqueUsers.length) {\n                numberOfRolesWithBinds++;\n                uniqueUsers.forEach((user) => uniqueUsersWithBinds.add(user));\n              }\n            }\n          });\n\n          if (numberOfRolesWithBinds && uniqueUsersWithBinds.size) {\n            this.info = '';\n            this.warning = this.t('rbac.globalRoles.usersBound', { count: uniqueUsersWithBinds.size });\n          } else {\n            this.info = this.t('rbac.globalRoles.notBound', null, true);\n          }\n        } else {\n          this.info = this.t('rbac.globalRoles.notBound', null, true);\n        }\n      } catch (e) {\n        this.info = this.t('rbac.globalRoles.unableToCheck');\n      }\n    },\n  },\n};\n"],"mappings":"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"}]}