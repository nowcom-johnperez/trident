{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/auth/oidc.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/auth/oidc.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuc3RyaW5nLnJlcGxhY2UtYWxsLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgQXV0aENvbmZpZyBmcm9tICdAc2hlbGwvbWl4aW5zL2F1dGgtY29uZmlnJzsKaW1wb3J0IENydVJlc291cmNlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NydVJlc291cmNlJzsKaW1wb3J0IHsgTGFiZWxlZElucHV0IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9MYWJlbGVkSW5wdXQnOwppbXBvcnQgeyBCYW5uZXIgfSBmcm9tICdAY29tcG9uZW50cy9CYW5uZXInOwppbXBvcnQgQWxsb3dlZFByaW5jaXBhbHMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvYXV0aC9BbGxvd2VkUHJpbmNpcGFscyc7CmltcG9ydCBGaWxlU2VsZWN0b3IgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9GaWxlU2VsZWN0b3InOwppbXBvcnQgQXV0aEJhbm5lciBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9hdXRoL0F1dGhCYW5uZXInOwppbXBvcnQgeyBSYWRpb0dyb3VwIH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9SYWRpbyc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBMb2FkaW5nOiBMb2FkaW5nLAogICAgQ3J1UmVzb3VyY2U6IENydVJlc291cmNlLAogICAgTGFiZWxlZElucHV0OiBMYWJlbGVkSW5wdXQsCiAgICBCYW5uZXI6IEJhbm5lciwKICAgIEFsbG93ZWRQcmluY2lwYWxzOiBBbGxvd2VkUHJpbmNpcGFscywKICAgIEZpbGVTZWxlY3RvcjogRmlsZVNlbGVjdG9yLAogICAgQXV0aEJhbm5lcjogQXV0aEJhbm5lciwKICAgIFJhZGlvR3JvdXA6IFJhZGlvR3JvdXAKICB9LAogIG1peGluczogW0NyZWF0ZUVkaXRWaWV3LCBBdXRoQ29uZmlnXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY3VzdG9tRW5kcG9pbnQ6IHsKICAgICAgICB2YWx1ZTogZmFsc2UsCiAgICAgICAgbGFiZWxzOiBbdGhpcy50KCdhdXRoQ29uZmlnLm9pZGMuY3VzdG9tRW5kcG9pbnQuc3RhbmRhcmQnKSwgdGhpcy50KCdhdXRoQ29uZmlnLm9pZGMuY3VzdG9tRW5kcG9pbnQuY3VzdG9tJyldLAogICAgICAgIG9wdGlvbnM6IFtmYWxzZSwgdHJ1ZV0KICAgICAgfSwKICAgICAga2V5Y2xvYWtVcmxzOiB7CiAgICAgICAgdXJsOiBudWxsLAogICAgICAgIHJlYWxtOiBudWxsCiAgICAgIH0KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdEFyZ3M6IGZ1bmN0aW9uIHRBcmdzKCkgewogICAgICByZXR1cm4gewogICAgICAgIGJhc2VVcmw6IHRoaXMuc2VydmVyU2V0dGluZywKICAgICAgICBwcm92aWRlcjogdGhpcy5kaXNwbGF5TmFtZSwKICAgICAgICB1c2VybmFtZTogdGhpcy5wcmluY2lwYWwubG9naW5OYW1lIHx8IHRoaXMucHJpbmNpcGFsLm5hbWUKICAgICAgfTsKICAgIH0sCiAgICB0b1NhdmU6IGZ1bmN0aW9uIHRvU2F2ZSgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBlbmFibGVkOiB0cnVlLAogICAgICAgIG9pZGNDb25maWc6IHRoaXMubW9kZWwKICAgICAgfTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAna2V5Y2xvYWtVcmxzLnVybCc6IGZ1bmN0aW9uIGtleWNsb2FrVXJsc1VybCgpIHsKICAgICAgdGhpcy51cGRhdGVJc3N1ZXJFbmRwb2ludCgpOwogICAgfSwKICAgICdrZXljbG9ha1VybHMucmVhbG0nOiBmdW5jdGlvbiBrZXljbG9ha1VybHNSZWFsbSgpIHsKICAgICAgdGhpcy51cGRhdGVJc3N1ZXJFbmRwb2ludCgpOwogICAgfSwKICAgICdtb2RlbC5lbmFibGVkJzogZnVuY3Rpb24gbW9kZWxFbmFibGVkKG5ldSkgewogICAgICAvLyBDb3ZlciBjYXNlIHdoZXJlIG9pZGMgZ2V0cyBkaXNhYmxlZCBhbmQgd2UgcmV0dXJuIHRvIHRoZSBlZGl0IHNjcmVlbiB3aXRoIGEgcmVzZXQgbW9kZWwKICAgICAgaWYgKCFuZXUpIHsKICAgICAgICB0aGlzLmtleWNsb2FrVXJscyA9IHsKICAgICAgICAgIHVybDogbnVsbCwKICAgICAgICAgIHJlYWxtOiBudWxsCiAgICAgICAgfTsKICAgICAgICB0aGlzLmN1c3RvbUVuZHBvaW50LnZhbHVlID0gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBlZGl0Q29uZmlnOiBmdW5jdGlvbiBlZGl0Q29uZmlnKG5ldSwgb2xkKSB7CiAgICAgIC8vIENvdmVyIHVzZSBjYXNlIHdoZXJlIHVzZXIgZWRpdHMgZXhpc3Rpbmcgb2lkYyAoa2V5Y2xvYWtVcmxzIGFyZW4ndCBwZXJzaXN0ZWQsIHNvIGlmIHdlIGhhdmUgaXNzdWVyICYgYXV0aEVuZHBvaW50IHNldCBjdXN0b20gZW5kcG9pbnRzIHRvIHRydWUpCiAgICAgIGlmICghb2xkICYmIG5ldSkgewogICAgICAgIHRoaXMuY3VzdG9tRW5kcG9pbnQudmFsdWUgPSAhdGhpcy5rZXljbG9ha1VybHMudXJsICYmICF0aGlzLmtleWNsb2FrVXJscy5hdXRoRW5kcG9pbnQgJiYgISF0aGlzLm1vZGVsLmlzc3VlciAmJiAhIXRoaXMubW9kZWwuYXV0aEVuZHBvaW50OwogICAgICB9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB1cGRhdGVJc3N1ZXJFbmRwb2ludDogZnVuY3Rpb24gdXBkYXRlSXNzdWVyRW5kcG9pbnQoKSB7CiAgICAgIGlmICghdGhpcy5rZXljbG9ha1VybHMudXJsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHZhciB1cmwgPSB0aGlzLmtleWNsb2FrVXJscy51cmwucmVwbGFjZUFsbCgnICcsICcnKTsKICAgICAgdGhpcy5tb2RlbC5pc3N1ZXIgPSAiIi5jb25jYXQodXJsLCAiL2F1dGgvcmVhbG1zLyIpLmNvbmNhdCh0aGlzLmtleWNsb2FrVXJscy5yZWFsbSB8fCAnJyk7CiAgICAgIHRoaXMubW9kZWwuYXV0aEVuZHBvaW50ID0gIiIuY29uY2F0KHRoaXMubW9kZWwuaXNzdWVyIHx8ICcnLCAiL3Byb3RvY29sL29wZW5pZC1jb25uZWN0L2F1dGgiKTsKICAgIH0KICB9Cn07"},{"version":3,"names":["Loading","CreateEditView","AuthConfig","CruResource","LabeledInput","Banner","AllowedPrincipals","FileSelector","AuthBanner","RadioGroup","components","mixins","data","customEndpoint","value","labels","t","options","keycloakUrls","url","realm","computed","tArgs","baseUrl","serverSetting","provider","displayName","username","principal","loginName","name","toSave","enabled","oidcConfig","model","watch","keycloakUrlsUrl","updateIssuerEndpoint","keycloakUrlsRealm","modelEnabled","neu","editConfig","old","authEndpoint","issuer","methods","replaceAll","concat"],"sources":["node_modules/@rancher/shell/edit/auth/oidc.vue"],"sourcesContent":["<script>\nimport Loading from '@shell/components/Loading';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport AuthConfig from '@shell/mixins/auth-config';\nimport CruResource from '@shell/components/CruResource';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport { Banner } from '@components/Banner';\nimport AllowedPrincipals from '@shell/components/auth/AllowedPrincipals';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport AuthBanner from '@shell/components/auth/AuthBanner';\nimport { RadioGroup } from '@components/Form/Radio';\n\nexport default {\n  components: {\n    Loading,\n    CruResource,\n    LabeledInput,\n    Banner,\n    AllowedPrincipals,\n    FileSelector,\n    AuthBanner,\n    RadioGroup\n  },\n\n  mixins: [CreateEditView, AuthConfig],\n  data() {\n    return {\n      customEndpoint: {\n        value:  false,\n        labels: [\n          this.t('authConfig.oidc.customEndpoint.standard'),\n          this.t('authConfig.oidc.customEndpoint.custom'),\n        ],\n        options: [\n          false,\n          true\n        ]\n      },\n      keycloakUrls: {\n        url:   null,\n        realm: null\n      }\n    };\n  },\n\n  computed: {\n    tArgs() {\n      return {\n        baseUrl:  this.serverSetting,\n        provider: this.displayName,\n        username: this.principal.loginName || this.principal.name,\n      };\n    },\n\n    toSave() {\n      return {\n        enabled:    true,\n        oidcConfig: this.model\n      };\n    },\n\n  },\n  watch: {\n    'keycloakUrls.url'() {\n      this.updateIssuerEndpoint();\n    },\n    'keycloakUrls.realm'() {\n      this.updateIssuerEndpoint();\n    },\n    'model.enabled'(neu) {\n      // Cover case where oidc gets disabled and we return to the edit screen with a reset model\n      if (!neu) {\n        this.keycloakUrls = {\n          url:   null,\n          realm: null\n        };\n        this.customEndpoint.value = false;\n      }\n    },\n    editConfig(neu, old) {\n      // Cover use case where user edits existing oidc (keycloakUrls aren't persisted, so if we have issuer & authEndpoint set custom endpoints to true)\n      if (!old && neu) {\n        this.customEndpoint.value = (!this.keycloakUrls.url && !this.keycloakUrls.authEndpoint) && (!!this.model.issuer && !!this.model.authEndpoint);\n      }\n    }\n  },\n\n  methods: {\n    updateIssuerEndpoint() {\n      if (!this.keycloakUrls.url) {\n        return;\n      }\n      const url = this.keycloakUrls.url.replaceAll(' ', '');\n\n      this.model.issuer = `${ url }/auth/realms/${ this.keycloakUrls.realm || '' }`;\n      this.model.authEndpoint = `${ this.model.issuer || '' }/protocol/openid-connect/auth`;\n    },\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <CruResource\n      :cancel-event=\"true\"\n      :done-route=\"doneRoute\"\n      :mode=\"mode\"\n      :resource=\"model\"\n      :subtypes=\"[]\"\n      :validation-passed=\"true\"\n      :finish-button-mode=\"model.enabled ? 'edit' : 'enable'\"\n      :can-yaml=\"false\"\n      :errors=\"errors\"\n      :show-cancel=\"showCancel\"\n      @error=\"e=>errors = e\"\n      @finish=\"save\"\n      @cancel=\"cancel\"\n    >\n      <template v-if=\"model.enabled && !isEnabling && !editConfig\">\n        <AuthBanner\n          :t-args=\"tArgs\"\n          :disable=\"disable\"\n          :edit=\"goToEdit\"\n        >\n          <template slot=\"rows\">\n            <tr><td>{{ t(`authConfig.oidc.rancherUrl`) }}: </td><td>{{ model.rancherUrl }}</td></tr>\n            <tr><td>{{ t(`authConfig.oidc.clientId`) }}: </td><td>{{ model.clientId }}</td></tr>\n            <tr><td>{{ t(`authConfig.oidc.issuer`) }}: </td><td>{{ model.issuer }}</td></tr>\n            <tr><td>{{ t(`authConfig.oidc.authEndpoint`) }}: </td><td>{{ model.authEndpoint }}</td></tr>\n          </template>\n        </AuthBanner>\n\n        <hr>\n\n        <AllowedPrincipals\n          :provider=\"NAME\"\n          :auth-config=\"model\"\n          :mode=\"mode\"\n        />\n      </template>\n\n      <template v-else>\n        <Banner\n          v-if=\"!model.enabled\"\n          :label=\"t('authConfig.stateBanner.disabled', tArgs)\"\n          color=\"warning\"\n        />\n\n        <h3>{{ t(`authConfig.oidc.${NAME}`) }}</h3>\n\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.clientId\"\n              :label=\"t(`authConfig.oidc.clientId`)\"\n              :mode=\"mode\"\n              required\n            />\n          </div>\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.clientSecret\"\n              :label=\"t(`authConfig.oidc.clientSecret`)\"\n              :mode=\"mode\"\n              required\n            />\n          </div>\n        </div>\n\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.privateKey\"\n              :label=\"t(`authConfig.oidc.key.label`)\"\n              :placeholder=\"t(`authConfig.oidc.key.placeholder`)\"\n              :mode=\"mode\"\n              type=\"multiline\"\n            />\n            <FileSelector\n              class=\"role-tertiary add mt-5\"\n              :label=\"t('generic.readFromFile')\"\n              :mode=\"mode\"\n              @selected=\"$set(model, 'privateKey', $event)\"\n            />\n          </div>\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.certificate\"\n              :label=\"t(`authConfig.oidc.cert.label`)\"\n              :placeholder=\"t(`authConfig.oidc.cert.placeholder`)\"\n              :mode=\"mode\"\n              type=\"multiline\"\n            />\n            <FileSelector\n              class=\"role-tertiary add mt-5\"\n              :label=\"t('generic.readFromFile')\"\n              :mode=\"mode\"\n              @selected=\"$set(model, 'certificate', $event)\"\n            />\n          </div>\n        </div>\n\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <RadioGroup\n              v-model=\"customEndpoint.value\"\n              name=\"customEndpoint\"\n              label-key=\"authConfig.oidc.customEndpoint.label\"\n              :labels=\"customEndpoint.labels\"\n              :options=\"customEndpoint.options\"\n            >\n              <template #label>\n                <h4>{{ t('authConfig.oidc.customEndpoint.label') }}</h4>\n              </template>\n            </RadioGroup>\n          </div>\n        </div>\n\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"keycloakUrls.url\"\n              :label=\"t(`authConfig.oidc.keycloak.url`)\"\n              :mode=\"mode\"\n              :required=\"!customEndpoint.value\"\n              :disabled=\"customEndpoint.value\"\n            />\n          </div>\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"keycloakUrls.realm\"\n              :label=\"t(`authConfig.oidc.keycloak.realm`)\"\n              :mode=\"mode\"\n              :required=\"!customEndpoint.value\"\n              :disabled=\"customEndpoint.value\"\n            />\n          </div>\n        </div>\n\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.rancherUrl\"\n              :label=\"t(`authConfig.oidc.rancherUrl`)\"\n              :mode=\"mode\"\n              required\n              :disabled=\"!customEndpoint.value\"\n            />\n          </div>\n        </div>\n\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.issuer\"\n              :label=\"t(`authConfig.oidc.issuer`)\"\n              :mode=\"mode\"\n              required\n              :disabled=\"!customEndpoint.value\"\n            />\n          </div>\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"model.authEndpoint\"\n              :label=\"t(`authConfig.oidc.authEndpoint`)\"\n              :mode=\"mode\"\n              required\n              :disabled=\"!customEndpoint.value\"\n            />\n          </div>\n        </div>\n      </template>\n      <div\n        v-if=\"!model.enabled\"\n        class=\"row\"\n      >\n        <div class=\"col span-12\">\n          <Banner\n            v-clean-html=\"t('authConfig.associatedWarning', tArgs, true)\"\n            color=\"info\"\n          />\n        </div>\n      </div>\n    </CruResource>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n  .banner {\n    display: block;\n\n    &::v-deep code {\n      padding: 0 3px;\n      margin: 0 3px;\n    }\n  }\n</style>\n"],"mappings":";;;;;AACA,OAAAA,OAAA;AACA,OAAAC,cAAA;AACA,OAAAC,UAAA;AACA,OAAAC,WAAA;AACA,SAAAC,YAAA;AACA,SAAAC,MAAA;AACA,OAAAC,iBAAA;AACA,OAAAC,YAAA;AACA,OAAAC,UAAA;AACA,SAAAC,UAAA;AAEA;EACAC,UAAA;IACAV,OAAA,EAAAA,OAAA;IACAG,WAAA,EAAAA,WAAA;IACAC,YAAA,EAAAA,YAAA;IACAC,MAAA,EAAAA,MAAA;IACAC,iBAAA,EAAAA,iBAAA;IACAC,YAAA,EAAAA,YAAA;IACAC,UAAA,EAAAA,UAAA;IACAC,UAAA,EAAAA;EACA;EAEAE,MAAA,GAAAV,cAAA,EAAAC,UAAA;EACAU,IAAA,WAAAA,KAAA;IACA;MACAC,cAAA;QACAC,KAAA;QACAC,MAAA,GACA,KAAAC,CAAA,6CACA,KAAAA,CAAA,0CACA;QACAC,OAAA,GACA,OACA;MAEA;MACAC,YAAA;QACAC,GAAA;QACAC,KAAA;MACA;IACA;EACA;EAEAC,QAAA;IACAC,KAAA,WAAAA,MAAA;MACA;QACAC,OAAA,OAAAC,aAAA;QACAC,QAAA,OAAAC,WAAA;QACAC,QAAA,OAAAC,SAAA,CAAAC,SAAA,SAAAD,SAAA,CAAAE;MACA;IACA;IAEAC,MAAA,WAAAA,OAAA;MACA;QACAC,OAAA;QACAC,UAAA,OAAAC;MACA;IACA;EAEA;EACAC,KAAA;IACA,6BAAAC,gBAAA;MACA,KAAAC,oBAAA;IACA;IACA,+BAAAC,kBAAA;MACA,KAAAD,oBAAA;IACA;IACA,0BAAAE,aAAAC,GAAA;MACA;MACA,KAAAA,GAAA;QACA,KAAAtB,YAAA;UACAC,GAAA;UACAC,KAAA;QACA;QACA,KAAAP,cAAA,CAAAC,KAAA;MACA;IACA;IACA2B,UAAA,WAAAA,WAAAD,GAAA,EAAAE,GAAA;MACA;MACA,KAAAA,GAAA,IAAAF,GAAA;QACA,KAAA3B,cAAA,CAAAC,KAAA,SAAAI,YAAA,CAAAC,GAAA,UAAAD,YAAA,CAAAyB,YAAA,WAAAT,KAAA,CAAAU,MAAA,WAAAV,KAAA,CAAAS,YAAA;MACA;IACA;EACA;EAEAE,OAAA;IACAR,oBAAA,WAAAA,qBAAA;MACA,UAAAnB,YAAA,CAAAC,GAAA;QACA;MACA;MACA,IAAAA,GAAA,QAAAD,YAAA,CAAAC,GAAA,CAAA2B,UAAA;MAEA,KAAAZ,KAAA,CAAAU,MAAA,MAAAG,MAAA,CAAA5B,GAAA,mBAAA4B,MAAA,MAAA7B,YAAA,CAAAE,KAAA;MACA,KAAAc,KAAA,CAAAS,YAAA,MAAAI,MAAA,MAAAb,KAAA,CAAAU,MAAA;IACA;EACA;AACA"}]}