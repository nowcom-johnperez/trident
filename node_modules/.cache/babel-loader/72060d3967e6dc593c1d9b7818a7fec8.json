{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/plugins/dashboard-store/normalize.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/plugins/dashboard-store/normalize.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLnRvLWpzb24uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luLmpzIjsKaW1wb3J0IHsgU0NIRU1BIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IGFwcGx5Q2hhbmdlc2V0LCBjaGFuZ2VzZXQsIGNoYW5nZXNldENvbmZsaWN0cyB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwpleHBvcnQgdmFyIEtFWV9GSUVMRF9GT1IgPSBfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KHt9LCBTQ0hFTUEsICdfaWQnKSwgImRlZmF1bHQiLCAnaWQnKTsKZXhwb3J0IGZ1bmN0aW9uIGtleUZpZWxkRm9yKHR5cGUpIHsKICByZXR1cm4gS0VZX0ZJRUxEX0ZPUlt0eXBlXSB8fCBLRVlfRklFTERfRk9SWydkZWZhdWx0J107Cn0KZXhwb3J0IGZ1bmN0aW9uIG5vcm1hbGl6ZVR5cGUodHlwZSkgewogIHZhciBfdHlwZTsKICB0eXBlID0gKCgoX3R5cGUgPSB0eXBlKSA9PT0gbnVsbCB8fCBfdHlwZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3R5cGUudHlwZSkgfHwgdHlwZSB8fCAnJykudG9Mb3dlckNhc2UoKTsKICByZXR1cm4gdHlwZTsKfQoKLy8gRGV0ZWN0IGFuZCByZXNvbHZlIGNvbmZsaWN0cyBmcm9tIGEgNDA5IHJlc3BvbnNlLgovLyBJZiB0aGV5IGFyZSByZXNvbHZlZCwgcmV0dXJuIGEgZmFsc2UteSB2YWx1ZQovLyBFbHNlIHRoZXkgY2FuJ3QgYmUgcmVzb2x2ZWQsIHJldHVybiBhbiBhcnJheSBvZiBlcnJvcnMgdG8gc2hvdyB0byB0aGUgdXNlci4KZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUNvbmZsaWN0KF94LCBfeDIsIF94MywgX3g0LCBfeDUsIF94NikgewogIHJldHVybiBfaGFuZGxlQ29uZmxpY3QuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQpmdW5jdGlvbiBfaGFuZGxlQ29uZmxpY3QoKSB7CiAgX2hhbmRsZUNvbmZsaWN0ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGluaXRpYWxWYWx1ZUpTT04sIHZhbHVlLCBsaXZlVmFsdWUsIHJvb3RHZXR0ZXJzLCBzdG9yZSwgc3RvcmVOYW1lc3BhY2UpIHsKICAgIHZhciBvcmlnLCB1c2VyLCBjdXIsIGJnQ2hhbmdlLCB1c2VyQ2hhbmdlLCBhY3R1YWxDb25mbGljdHMsIG91dDsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgIGNhc2UgMDoKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCIiLmNvbmNhdChzdG9yZU5hbWVzcGFjZSwgIi9jbGVhbkZvckRpZmYiKSwgaW5pdGlhbFZhbHVlSlNPTiwgewogICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBvcmlnID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCIiLmNvbmNhdChzdG9yZU5hbWVzcGFjZSwgIi9jbGVhbkZvckRpZmYiKSwgdmFsdWUudG9KU09OKCksIHsKICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgY2FzZSA1OgogICAgICAgICAgdXNlciA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgiIi5jb25jYXQoc3RvcmVOYW1lc3BhY2UsICIvY2xlYW5Gb3JEaWZmIiksIGxpdmVWYWx1ZS50b0pTT04oKSwgewogICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICBjYXNlIDg6CiAgICAgICAgICBjdXIgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgYmdDaGFuZ2UgPSBjaGFuZ2VzZXQob3JpZywgY3VyKTsKICAgICAgICAgIHVzZXJDaGFuZ2UgPSBjaGFuZ2VzZXQob3JpZywgdXNlcik7CiAgICAgICAgICBhY3R1YWxDb25mbGljdHMgPSBjaGFuZ2VzZXRDb25mbGljdHMoYmdDaGFuZ2UsIHVzZXJDaGFuZ2UpOwogICAgICAgICAgY29uc29sZS5sb2coJ0JhY2tncm91bmQgQ2hhbmdlJywgYmdDaGFuZ2UpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIENoYW5nZScsIHVzZXJDaGFuZ2UpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKICAgICAgICAgIGNvbnNvbGUubG9nKCdDb25mbGljdHMnLCBhY3R1YWxDb25mbGljdHMpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKCiAgICAgICAgICB2YWx1ZS5tZXRhZGF0YS5yZXNvdXJjZVZlcnNpb24gPSBsaXZlVmFsdWUubWV0YWRhdGEucmVzb3VyY2VWZXJzaW9uOwogICAgICAgICAgYXBwbHlDaGFuZ2VzZXQodmFsdWUsIGJnQ2hhbmdlKTsKICAgICAgICAgIGlmICghYWN0dWFsQ29uZmxpY3RzLmxlbmd0aCkgewogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjI7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgICAgLy8gU3RvcCB0aGUgc2F2ZSBhbmQgbGV0IHRoZSB1c2VyIGluc3BlY3QgYW5kIGNvbnRpbnVlIGVkaXRpbmcKICAgICAgICAgIG91dCA9IFtyb290R2V0dGVyc1snaTE4bi90J10oJ3ZhbGlkYXRpb24uY29uZmxpY3QnLCB7CiAgICAgICAgICAgIGZpZWxkczogYWN0dWFsQ29uZmxpY3RzLmpvaW4oJywgJyksCiAgICAgICAgICAgIGZpZWxkQ291bnQ6IGFjdHVhbENvbmZsaWN0cy5sZW5ndGgKICAgICAgICAgIH0pXTsKICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIG91dCk7CiAgICAgICAgY2FzZSAyMjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKICAgICAgICBjYXNlIDIzOgogICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CiAgcmV0dXJuIF9oYW5kbGVDb25mbGljdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9"},{"version":3,"names":["SCHEMA","applyChangeset","changeset","changesetConflicts","KEY_FIELD_FOR","_defineProperty","keyFieldFor","type","normalizeType","_type","toLowerCase","handleConflict","_x","_x2","_x3","_x4","_x5","_x6","_handleConflict","apply","arguments","_asyncToGenerator","regeneratorRuntime","mark","_callee","initialValueJSON","value","liveValue","rootGetters","store","storeNamespace","orig","user","cur","bgChange","userChange","actualConflicts","out","wrap","_callee$","_context","prev","next","dispatch","concat","root","sent","toJSON","console","log","metadata","resourceVersion","length","fields","join","fieldCount","abrupt","stop"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/plugins/dashboard-store/normalize.js"],"sourcesContent":["import { SCHEMA } from '@shell/config/types';\n\nimport { applyChangeset, changeset, changesetConflicts } from '@shell/utils/object';\n\nexport const KEY_FIELD_FOR = {\n  [SCHEMA]: '_id',\n  default:  'id',\n};\n\nexport function keyFieldFor(type) {\n  return KEY_FIELD_FOR[type] || KEY_FIELD_FOR['default'];\n}\n\nexport function normalizeType(type) {\n  type = (type?.type || type || '').toLowerCase();\n\n  return type;\n}\n\n// Detect and resolve conflicts from a 409 response.\n// If they are resolved, return a false-y value\n// Else they can't be resolved, return an array of errors to show to the user.\nexport async function handleConflict(initialValueJSON, value, liveValue, rootGetters, store, storeNamespace) {\n  const orig = await store.dispatch(`${ storeNamespace }/cleanForDiff`, initialValueJSON, { root: true });\n  const user = await store.dispatch(`${ storeNamespace }/cleanForDiff`, value.toJSON(), { root: true });\n  const cur = await store.dispatch(`${ storeNamespace }/cleanForDiff`, liveValue.toJSON(), { root: true });\n\n  const bgChange = changeset(orig, cur);\n  const userChange = changeset(orig, user);\n  const actualConflicts = changesetConflicts(bgChange, userChange);\n\n  console.log('Background Change', bgChange); // eslint-disable-line no-console\n  console.log('User Change', userChange); // eslint-disable-line no-console\n  console.log('Conflicts', actualConflicts); // eslint-disable-line no-console\n\n  value.metadata.resourceVersion = liveValue.metadata.resourceVersion;\n  applyChangeset(value, bgChange);\n\n  if ( actualConflicts.length ) {\n    // Stop the save and let the user inspect and continue editing\n    const out = [rootGetters['i18n/t']('validation.conflict', { fields: actualConflicts.join(', '), fieldCount: actualConflicts.length })];\n\n    return out;\n  } else {\n    // The save can continue\n    return false;\n  }\n}\n"],"mappings":"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"}]}