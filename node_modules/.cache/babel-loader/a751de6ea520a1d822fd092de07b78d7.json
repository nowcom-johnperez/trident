{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/HarvesterServiceAddOnConfig.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/HarvesterServiceAddOnConfig.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanMiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwpmdW5jdGlvbiBvd25LZXlzKGUsIHIpIHsgdmFyIHQgPSBPYmplY3Qua2V5cyhlKTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpOyByICYmIChvID0gby5maWx0ZXIoZnVuY3Rpb24gKHIpIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgcikuZW51bWVyYWJsZTsgfSkpLCB0LnB1c2guYXBwbHkodCwgbyk7IH0gcmV0dXJuIHQ7IH0KZnVuY3Rpb24gX29iamVjdFNwcmVhZChlKSB7IGZvciAodmFyIHIgPSAxOyByIDwgYXJndW1lbnRzLmxlbmd0aDsgcisrKSB7IHZhciB0ID0gbnVsbCAhPSBhcmd1bWVudHNbcl0gPyBhcmd1bWVudHNbcl0gOiB7fTsgciAlIDIgPyBvd25LZXlzKE9iamVjdCh0KSwgITApLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpOyB9KTsgfSByZXR1cm4gZTsgfQppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZW5kcy13aXRoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CmltcG9ydCBzZW12ZXIgZnJvbSAnc2VtdmVyJzsKaW1wb3J0IExhYmVsZWRTZWxlY3QgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9MYWJlbGVkU2VsZWN0JzsKaW1wb3J0IHsgX0NSRUFURSB9IGZyb20gJ0BzaGVsbC9jb25maWcvcXVlcnktcGFyYW1zJzsKaW1wb3J0IHsgZ2V0IH0gZnJvbSAnQHNoZWxsL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IEhDSSBhcyBIQ0lfTEFCRUxTX0FOTk9UQVRJT05TIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBTRVJWSUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IGFsbEhhc2ggfSBmcm9tICdAc2hlbGwvdXRpbHMvcHJvbWlzZSc7CnZhciBIQVJWRVNURVJfQUREX09OX0NPTkZJRyA9IFt7CiAgdmFyaWFibGVOYW1lOiAnaXBhbScsCiAga2V5OiBIQ0lfTEFCRUxTX0FOTk9UQVRJT05TLkNMT1VEX1BST1ZJREVSX0lQQU0sCiAgZGVmYXVsdDogJ2RoY3AnCn0sIHsKICB2YXJpYWJsZU5hbWU6ICdzaGFyZWRTZXJ2aWNlJywKICBrZXk6IEhDSV9MQUJFTFNfQU5OT1RBVElPTlMuUFJJTUFSWV9TRVJWSUNFLAogIGRlZmF1bHQ6ICcnCn1dOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgTGFiZWxlZFNlbGVjdDogTGFiZWxlZFNlbGVjdAogIH0sCiAgcHJvcHM6IHsKICAgIG1vZGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiBfQ1JFQVRFCiAgICB9LAogICAgdmFsdWU6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0OiBmdW5jdGlvbiBfZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0sCiAgICByZWdpc3RlckJlZm9yZUhvb2s6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy5yZWdpc3RlckJlZm9yZUhvb2spIHsKICAgICAgdGhpcy5yZWdpc3RlckJlZm9yZUhvb2sodGhpcy53aWxsU2F2ZSwgJ2hhcnZlc3RlcldpbGxTYXZlJyk7CiAgICB9CiAgfSwKICBmZXRjaDogZnVuY3Rpb24gZmV0Y2goKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgdmFyIGluU3RvcmUsIGhhc2gsIHJlczsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgaW5TdG9yZSA9IF90aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50UHJvZHVjdCddLmluU3RvcmU7CiAgICAgICAgICAgIGhhc2ggPSB7CiAgICAgICAgICAgICAgcmtlMlZlcnNpb25zOiBfdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvcmVxdWVzdCcsIHsKICAgICAgICAgICAgICAgIHVybDogJy92MS1ya2UyLXJlbGVhc2UvcmVsZWFzZXMnCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgc2VydmljZXM6IF90aGlzLiRzdG9yZS5kaXNwYXRjaCgiIi5jb25jYXQoaW5TdG9yZSwgIi9maW5kQWxsIiksIHsKICAgICAgICAgICAgICAgIHR5cGU6IFNFUlZJQ0UKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9OwogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgcmV0dXJuIGFsbEhhc2goaGFzaCk7CiAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIF90aGlzLnJrZTJWZXJzaW9ucyA9IHJlcy5ya2UyVmVyc2lvbnM7CiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgIHZhciBoYXJ2ZXN0ZXJBZGRPbkNvbmZpZyA9IHt9OwogICAgSEFSVkVTVEVSX0FERF9PTl9DT05GSUcuZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICBoYXJ2ZXN0ZXJBZGRPbkNvbmZpZ1tjLnZhcmlhYmxlTmFtZV0gPSBfdGhpczIudmFsdWUubWV0YWRhdGEuYW5ub3RhdGlvbnNbYy5rZXldIHx8IGMuZGVmYXVsdDsKICAgIH0pOwogICAgdmFyIHNob3dTaGFyZUlQOwogICAgaWYgKHRoaXMudmFsdWUubWV0YWRhdGEuYW5ub3RhdGlvbnNbSENJX0xBQkVMU19BTk5PVEFUSU9OUy5QUklNQVJZX1NFUlZJQ0VdKSB7CiAgICAgIHNob3dTaGFyZUlQID0gdHJ1ZTsKICAgIH0gZWxzZSB7CiAgICAgIHNob3dTaGFyZUlQID0gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBoYXJ2ZXN0ZXJBZGRPbkNvbmZpZyksIHt9LCB7CiAgICAgIHNob3dTaGFyZUlQOiBzaG93U2hhcmVJUCwKICAgICAgcmtlMlZlcnNpb25zOiB7fQogICAgfSk7CiAgfSwKICBjb21wdXRlZDogX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBtYXBHZXR0ZXJzKFsnYWxsb3dlZE5hbWVzcGFjZXMnLCAnbmFtZXNwYWNlcycsICdjdXJyZW50Q2x1c3RlciddKSksIHt9LCB7CiAgICBpcGFtT3B0aW9uczogZnVuY3Rpb24gaXBhbU9wdGlvbnMoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIGxhYmVsOiAnREhDUCcsCiAgICAgICAgdmFsdWU6ICdkaGNwJwogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICdQb29sJywKICAgICAgICB2YWx1ZTogJ3Bvb2wnCiAgICAgIH1dOwogICAgfSwKICAgIHBvcnRPcHRpb25zOiBmdW5jdGlvbiBwb3J0T3B0aW9ucygpIHsKICAgICAgdmFyIF90aGlzJHZhbHVlOwogICAgICB2YXIgcG9ydHMgPSAoKF90aGlzJHZhbHVlID0gdGhpcy52YWx1ZSkgPT09IG51bGwgfHwgX3RoaXMkdmFsdWUgPT09IHZvaWQgMCB8fCAoX3RoaXMkdmFsdWUgPSBfdGhpcyR2YWx1ZS5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyR2YWx1ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkdmFsdWUucG9ydHMpIHx8IFtdOwogICAgICByZXR1cm4gcG9ydHMuZmlsdGVyKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgcmV0dXJuIHAucG9ydCAmJiBwLnByb3RvY29sID09PSAnVENQJzsKICAgICAgfSkubWFwKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgcmV0dXJuIHAucG9ydDsKICAgICAgfSkgfHwgW107CiAgICB9LAogICAgc2VydmljZU9wdGlvbnM6IGZ1bmN0aW9uIHNlcnZpY2VPcHRpb25zKCkgewogICAgICB2YXIgaW5TdG9yZSA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRQcm9kdWN0J10uaW5TdG9yZTsKICAgICAgdmFyIHNlcnZpY2VzID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1siIi5jb25jYXQoaW5TdG9yZSwgIi9hbGwiKV0oU0VSVklDRSk7CiAgICAgIHZhciBuYW1lc3BhY2VzID0gdGhpcy5uYW1lc3BhY2VzKCk7CiAgICAgIHZhciBvdXQgPSBzZXJ2aWNlcy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsKICAgICAgICB2YXIgX3Mkc3RhdHVzLCBfcyRtZXRhZGF0YSwgX3Mkc3BlYzsKICAgICAgICB2YXIgaW5ncmVzcyA9IChzID09PSBudWxsIHx8IHMgPT09IHZvaWQgMCB8fCAoX3Mkc3RhdHVzID0gcy5zdGF0dXMpID09PSBudWxsIHx8IF9zJHN0YXR1cyA9PT0gdm9pZCAwIHx8IChfcyRzdGF0dXMgPSBfcyRzdGF0dXMubG9hZEJhbGFuY2VyKSA9PT0gbnVsbCB8fCBfcyRzdGF0dXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zJHN0YXR1cy5pbmdyZXNzKSB8fCBbXTsKICAgICAgICByZXR1cm4gaW5ncmVzcy5sZW5ndGggPiAwICYmICEocyAhPT0gbnVsbCAmJiBzICE9PSB2b2lkIDAgJiYgKF9zJG1ldGFkYXRhID0gcy5tZXRhZGF0YSkgIT09IG51bGwgJiYgX3MkbWV0YWRhdGEgIT09IHZvaWQgMCAmJiAoX3MkbWV0YWRhdGEgPSBfcyRtZXRhZGF0YS5hbm5vdGF0aW9ucykgIT09IG51bGwgJiYgX3MkbWV0YWRhdGEgIT09IHZvaWQgMCAmJiBfcyRtZXRhZGF0YVsnY2xvdWRwcm92aWRlci5oYXJ2ZXN0ZXJoY2kuaW8vcHJpbWFyeS1zZXJ2aWNlJ10pICYmICgoX3Mkc3BlYyA9IHMuc3BlYykgPT09IG51bGwgfHwgX3Mkc3BlYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3Mkc3BlYy50eXBlKSA9PT0gJ0xvYWRCYWxhbmNlcicgJiYgbmFtZXNwYWNlc1tzLm1ldGFkYXRhLm5hbWVzcGFjZV07CiAgICAgIH0pOwogICAgICByZXR1cm4gb3V0Lm1hcChmdW5jdGlvbiAocykgewogICAgICAgIHJldHVybiBzLmlkOwogICAgICB9KTsKICAgIH0sCiAgICBzaGFyZUlQRW5hYmxlZDogZnVuY3Rpb24gc2hhcmVJUEVuYWJsZWQoKSB7CiAgICAgIHZhciBrdWJlcm5ldGVzVmVyc2lvbiA9IHRoaXMuY3VycmVudENsdXN0ZXIua3ViZXJuZXRlc1ZlcnNpb24gfHwgJyc7CiAgICAgIHZhciBrdWJlcm5ldGVzVmVyc2lvbkV4dGVuc2lvbiA9IHRoaXMuY3VycmVudENsdXN0ZXIua3ViZXJuZXRlc1ZlcnNpb25FeHRlbnNpb247CiAgICAgIGlmIChrdWJlcm5ldGVzVmVyc2lvbkV4dGVuc2lvbi5zdGFydHNXaXRoKCcrcmtlMicpKSB7CiAgICAgICAgdmFyIF90aGlzJHJrZTJWZXJzaW9ucywgX2NoYXJ0cyRoYXJ2ZXN0ZXJDbG87CiAgICAgICAgdmFyIGNoYXJ0cyA9ICgoKChfdGhpcyRya2UyVmVyc2lvbnMgPSB0aGlzLnJrZTJWZXJzaW9ucykgPT09IG51bGwgfHwgX3RoaXMkcmtlMlZlcnNpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRya2UyVmVyc2lvbnMuZGF0YSkgfHwgW10pLmZpbmQoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgIHJldHVybiB2LmlkID09PSBrdWJlcm5ldGVzVmVyc2lvbjsKICAgICAgICB9KSB8fCB7fSkuY2hhcnRzOwogICAgICAgIHZhciBjY21WZXJzaW9uID0gKGNoYXJ0cyA9PT0gbnVsbCB8fCBjaGFydHMgPT09IHZvaWQgMCB8fCAoX2NoYXJ0cyRoYXJ2ZXN0ZXJDbG8gPSBjaGFydHNbJ2hhcnZlc3Rlci1jbG91ZC1wcm92aWRlciddKSA9PT0gbnVsbCB8fCBfY2hhcnRzJGhhcnZlc3RlckNsbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NoYXJ0cyRoYXJ2ZXN0ZXJDbG8udmVyc2lvbikgfHwgJyc7CiAgICAgICAgaWYgKGNjbVZlcnNpb24uZW5kc1dpdGgoJzAwJykpIHsKICAgICAgICAgIGNjbVZlcnNpb24gPSBjY21WZXJzaW9uLnNsaWNlKDAsIC0yKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbXZlci5zYXRpc2ZpZXMoY2NtVmVyc2lvbiwgJz49MC4yLjAnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogIH0pLAogIG1ldGhvZHM6IHsKICAgIHdpbGxTYXZlOiBmdW5jdGlvbiB3aWxsU2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHZhciBlcnJvcnMgPSBbXTsKICAgICAgaWYgKHRoaXMuc2hvd1NoYXJlSVApIHsKICAgICAgICBpZiAoIXRoaXMuc2hhcmVkU2VydmljZSkgewogICAgICAgICAgZXJyb3JzLnB1c2godGhpcy50KCd2YWxpZGF0aW9uLnJlcXVpcmVkJywgewogICAgICAgICAgICBrZXk6IHRoaXMudCgnc2VydmljZXNQYWdlLmhhcnZlc3Rlci5zaGFyZUlQLmxhYmVsJykKICAgICAgICAgIH0sIHRydWUpKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGVycm9ycy5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9ycyk7CiAgICAgIH0KICAgICAgSEFSVkVTVEVSX0FERF9PTl9DT05GSUcuZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICAgIF90aGlzMy52YWx1ZS5tZXRhZGF0YS5hbm5vdGF0aW9uc1tjLmtleV0gPSBTdHJpbmcoZ2V0KF90aGlzMywgYy52YXJpYWJsZU5hbWUpKTsKICAgICAgfSk7CiAgICAgIGlmICh0aGlzLnNob3dTaGFyZUlQKSB7CiAgICAgICAgZGVsZXRlIHRoaXMudmFsdWUubWV0YWRhdGEuYW5ub3RhdGlvbnNbSENJX0xBQkVMU19BTk5PVEFUSU9OUy5DTE9VRF9QUk9WSURFUl9JUEFNXTsKICAgICAgfSBlbHNlIHsKICAgICAgICBkZWxldGUgdGhpcy52YWx1ZS5tZXRhZGF0YS5hbm5vdGF0aW9uc1tIQ0lfTEFCRUxTX0FOTk9UQVRJT05TLlBSSU1BUllfU0VSVklDRV07CiAgICAgIH0KICAgIH0sCiAgICB0b2dnbGVTaGFyZUlQOiBmdW5jdGlvbiB0b2dnbGVTaGFyZUlQKCkgewogICAgICB0aGlzLnNob3dTaGFyZUlQID0gIXRoaXMuc2hvd1NoYXJlSVA7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["mapGetters","semver","LabeledSelect","_CREATE","get","HCI","HCI_LABELS_ANNOTATIONS","SERVICE","allHash","HARVESTER_ADD_ON_CONFIG","variableName","key","CLOUD_PROVIDER_IPAM","default","PRIMARY_SERVICE","components","props","mode","type","String","value","Object","_default","registerBeforeHook","Function","created","willSave","fetch","_this","_asyncToGenerator","regeneratorRuntime","mark","_callee","inStore","hash","res","wrap","_callee$","_context","prev","next","$store","getters","rke2Versions","dispatch","url","services","concat","sent","stop","data","_this2","harvesterAddOnConfig","forEach","c","metadata","annotations","showShareIP","_objectSpread","computed","ipamOptions","label","portOptions","_this$value","ports","spec","filter","p","port","protocol","map","serviceOptions","namespaces","out","s","_s$status","_s$metadata","_s$spec","ingress","status","loadBalancer","length","namespace","id","shareIPEnabled","kubernetesVersion","currentCluster","kubernetesVersionExtension","startsWith","_this$rke2Versions","_charts$harvesterClo","charts","find","v","ccmVersion","version","endsWith","slice","satisfies","methods","_this3","errors","sharedService","push","t","Promise","reject","toggleShareIP"],"sources":["node_modules/@rancher/shell/components/HarvesterServiceAddOnConfig.vue"],"sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport semver from 'semver';\n\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { _CREATE } from '@shell/config/query-params';\nimport { get } from '@shell/utils/object';\nimport { HCI as HCI_LABELS_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { SERVICE } from '@shell/config/types';\nimport { allHash } from '@shell/utils/promise';\n\nconst HARVESTER_ADD_ON_CONFIG = [{\n  variableName: 'ipam',\n  key:          HCI_LABELS_ANNOTATIONS.CLOUD_PROVIDER_IPAM,\n  default:      'dhcp'\n}, {\n  variableName: 'sharedService',\n  key:          HCI_LABELS_ANNOTATIONS.PRIMARY_SERVICE,\n  default:      ''\n}];\n\nexport default {\n  components: { LabeledSelect },\n\n  props: {\n    mode: {\n      type:    String,\n      default: _CREATE,\n    },\n\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n\n    registerBeforeHook: {\n      type:    Function,\n      default: null\n    },\n  },\n\n  created() {\n    if (this.registerBeforeHook) {\n      this.registerBeforeHook(this.willSave, 'harvesterWillSave');\n    }\n  },\n\n  async fetch() {\n    const inStore = this.$store.getters['currentProduct'].inStore;\n\n    const hash = {\n      rke2Versions: this.$store.dispatch('management/request', { url: '/v1-rke2-release/releases' }),\n      services:     this.$store.dispatch(`${ inStore }/findAll`, { type: SERVICE }),\n    };\n\n    const res = await allHash(hash);\n\n    this.rke2Versions = res.rke2Versions;\n  },\n\n  data() {\n    const harvesterAddOnConfig = {};\n\n    HARVESTER_ADD_ON_CONFIG.forEach((c) => {\n      harvesterAddOnConfig[c.variableName] = this.value.metadata.annotations[c.key] || c.default;\n    });\n\n    let showShareIP;\n\n    if (this.value.metadata.annotations[HCI_LABELS_ANNOTATIONS.PRIMARY_SERVICE]) {\n      showShareIP = true;\n    } else {\n      showShareIP = false;\n    }\n\n    return {\n      ...harvesterAddOnConfig,\n      showShareIP,\n      rke2Versions: {},\n    };\n  },\n\n  computed: {\n    ...mapGetters(['allowedNamespaces', 'namespaces', 'currentCluster']),\n\n    ipamOptions() {\n      return [{\n        label: 'DHCP',\n        value: 'dhcp',\n      }, {\n        label: 'Pool',\n        value: 'pool',\n      }];\n    },\n\n    portOptions() {\n      const ports = this.value?.spec?.ports || [];\n\n      return ports.filter((p) => p.port && p.protocol === 'TCP').map((p) => p.port) || [];\n    },\n\n    serviceOptions() {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const services = this.$store.getters[`${ inStore }/all`](SERVICE);\n\n      const namespaces = this.namespaces();\n\n      const out = services.filter((s) => {\n        const ingress = s?.status?.loadBalancer?.ingress || [];\n\n        return ingress.length > 0 &&\n                !s?.metadata?.annotations?.['cloudprovider.harvesterhci.io/primary-service'] &&\n                s.spec?.type === 'LoadBalancer' &&\n                namespaces[s.metadata.namespace];\n      });\n\n      return out.map((s) => s.id);\n    },\n\n    shareIPEnabled() {\n      const kubernetesVersion = this.currentCluster.kubernetesVersion || '';\n      const kubernetesVersionExtension = this.currentCluster.kubernetesVersionExtension;\n\n      if (kubernetesVersionExtension.startsWith('+rke2')) {\n        const charts = ((this.rke2Versions?.data || []).find((v) => v.id === kubernetesVersion) || {}).charts;\n        let ccmVersion = charts?.['harvester-cloud-provider']?.version || '';\n\n        if (ccmVersion.endsWith('00')) {\n          ccmVersion = ccmVersion.slice(0, -2);\n        }\n\n        return semver.satisfies(ccmVersion, '>=0.2.0');\n      } else {\n        return true;\n      }\n    },\n  },\n\n  methods: {\n    willSave() {\n      const errors = [];\n\n      if (this.showShareIP) {\n        if (!this.sharedService) {\n          errors.push(this.t('validation.required', { key: this.t('servicesPage.harvester.shareIP.label') }, true));\n        }\n      }\n\n      if (errors.length > 0) {\n        return Promise.reject(errors);\n      }\n\n      HARVESTER_ADD_ON_CONFIG.forEach((c) => {\n        this.value.metadata.annotations[c.key] = String(get(this, c.variableName));\n      });\n\n      if (this.showShareIP) {\n        delete this.value.metadata.annotations[HCI_LABELS_ANNOTATIONS.CLOUD_PROVIDER_IPAM];\n      } else {\n        delete this.value.metadata.annotations[HCI_LABELS_ANNOTATIONS.PRIMARY_SERVICE];\n      }\n    },\n\n    toggleShareIP() {\n      this.showShareIP = !this.showShareIP;\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row mt-30\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-if=\"showShareIP\"\n          v-model=\"sharedService\"\n          :mode=\"mode\"\n          :options=\"serviceOptions\"\n          :label=\"t('servicesPage.harvester.shareIP.label')\"\n          :disabled=\"mode === 'edit'\"\n        />\n        <LabeledSelect\n          v-else\n          v-model=\"ipam\"\n          :mode=\"mode\"\n          :options=\"ipamOptions\"\n          :label=\"t('servicesPage.harvester.ipam.label')\"\n          :disabled=\"mode === 'edit'\"\n        />\n        <div\n          v-if=\"mode === 'create'\"\n          class=\"mt-10\"\n        >\n          <a\n            role=\"button\"\n            @click=\"toggleShareIP\"\n          >\n            {{ showShareIP ? t('servicesPage.harvester.useIpam.label') : t('servicesPage.harvester.useShareIP.label') }}\n          </a>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n"],"mappings":"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"}]}