{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/constraints.gatekeeper.sh.constraint.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/constraints.gatekeeper.sh.constraint.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5jb25zdHJ1Y3QuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN5bWJvbC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMuanMiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZ2V0IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldCI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI7CmltcG9ydCBfZ2V0UHJvdG90eXBlT2YgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwpmdW5jdGlvbiBvd25LZXlzKGUsIHIpIHsgdmFyIHQgPSBPYmplY3Qua2V5cyhlKTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpOyByICYmIChvID0gby5maWx0ZXIoZnVuY3Rpb24gKHIpIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgcikuZW51bWVyYWJsZTsgfSkpLCB0LnB1c2guYXBwbHkodCwgbyk7IH0gcmV0dXJuIHQ7IH0KZnVuY3Rpb24gX29iamVjdFNwcmVhZChlKSB7IGZvciAodmFyIHIgPSAxOyByIDwgYXJndW1lbnRzLmxlbmd0aDsgcisrKSB7IHZhciB0ID0gbnVsbCAhPSBhcmd1bWVudHNbcl0gPyBhcmd1bWVudHNbcl0gOiB7fTsgciAlIDIgPyBvd25LZXlzKE9iamVjdCh0KSwgITApLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpOyB9KTsgfSByZXR1cm4gZTsgfQppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuYXNzaWduLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQppbXBvcnQganN5YW1sIGZyb20gJ2pzLXlhbWwnOwppbXBvcnQgU3RldmVNb2RlbCBmcm9tICdAc2hlbGwvcGx1Z2lucy9zdGV2ZS9zdGV2ZS1jbGFzcyc7CmltcG9ydCB7IGRvd25sb2FkRmlsZSB9IGZyb20gJ0BzaGVsbC91dGlscy9kb3dubG9hZCc7CmV4cG9ydCB2YXIgRU5GT1JDRU1FTlRfQUNUSU9OX1ZBTFVFUyA9IHsKICBERU5ZOiAnZGVueScsCiAgRFJZUlVOOiAnZHJ5cnVuJwp9Owp2YXIgR2F0ZUtlZXBlckNvbnN0cmFpbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGV2ZU1vZGVsKSB7CiAgX2luaGVyaXRzKEdhdGVLZWVwZXJDb25zdHJhaW50LCBfU3RldmVNb2RlbCk7CiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihHYXRlS2VlcGVyQ29uc3RyYWludCk7CiAgZnVuY3Rpb24gR2F0ZUtlZXBlckNvbnN0cmFpbnQoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2F0ZUtlZXBlckNvbnN0cmFpbnQpOwogICAgcmV0dXJuIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KICBfY3JlYXRlQ2xhc3MoR2F0ZUtlZXBlckNvbnN0cmFpbnQsIFt7CiAgICBrZXk6ICJfYXZhaWxhYmxlQWN0aW9ucyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG91dCA9IF9nZXQoX2dldFByb3RvdHlwZU9mKEdhdGVLZWVwZXJDb25zdHJhaW50LnByb3RvdHlwZSksICJfYXZhaWxhYmxlQWN0aW9ucyIsIHRoaXMpOwogICAgICB2YXIgdCA9IHRoaXMuJHJvb3RHZXR0ZXJzWydpMThuL3QnXTsKICAgICAgdmFyIGRvd25sb2FkVmlvbGF0aW9ucyA9IHsKICAgICAgICBhY3Rpb246ICdkb3dubG9hZFZpb2xhdGlvbnMnLAogICAgICAgIGljb246ICdpY29uIGljb24tZncgaWNvbi1kb3dubG9hZCcsCiAgICAgICAgbGFiZWw6IHQoJ2dhdGVrZWVwZXJDb25zdHJhaW50LmRvd25sb2FkVmlvbGF0aW9ucycpLAogICAgICAgIHRvdGFsOiAxCiAgICAgIH07CiAgICAgIG91dC51bnNoaWZ0KGRvd25sb2FkVmlvbGF0aW9ucyk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAic2F2ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3NhdmUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGNvbnN0cmFpbnQsIHJlc291cmNlVmVyc2lvbiwgX2NvbnN0cmFpbnQ7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgaWYgKCF0aGlzLmNvbnN0cmFpbnQpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbmRMYXRlc3RDb25zdHJhaW50KCk7CiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICBjb25zdHJhaW50ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICByZXNvdXJjZVZlcnNpb24gPSAoX2NvbnN0cmFpbnQgPSBjb25zdHJhaW50KSA9PT0gbnVsbCB8fCBfY29uc3RyYWludCA9PT0gdm9pZCAwIHx8IChfY29uc3RyYWludCA9IF9jb25zdHJhaW50Lm1ldGFkYXRhKSA9PT0gbnVsbCB8fCBfY29uc3RyYWludCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NvbnN0cmFpbnQucmVzb3VyY2VWZXJzaW9uOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgIHJldHVybiB0aGlzLiRkaXNwYXRjaCgnY2x1c3Rlci9jcmVhdGUnLCB7CiAgICAgICAgICAgICAgICB0eXBlOiAiY29uc3RyYWludHMuZ2F0ZWtlZXBlci5zaC4iLmNvbmNhdCh0aGlzLmtpbmQudG9Mb3dlckNhc2UoKSkKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICBjb25zdHJhaW50ID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjb25zdHJhaW50LnNwZWMgPSB0aGlzLnNwZWM7CiAgICAgICAgICAgICAgY29uc3RyYWludC5tZXRhZGF0YSA9IHRoaXMubWV0YWRhdGE7CiAgICAgICAgICAgICAgaWYgKHJlc291cmNlVmVyc2lvbikgewogICAgICAgICAgICAgICAgY29uc3RyYWludC5tZXRhZGF0YS5yZXNvdXJjZVZlcnNpb24gPSByZXNvdXJjZVZlcnNpb247CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNTsKICAgICAgICAgICAgICByZXR1cm4gY29uc3RyYWludC5zYXZlKCk7CiAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwogICAgICBmdW5jdGlvbiBzYXZlKCkgewogICAgICAgIHJldHVybiBfc2F2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICAgIHJldHVybiBzYXZlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZG93bmxvYWRWaW9sYXRpb25zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZG93bmxvYWRWaW9sYXRpb25zID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgUGFwYSwgdmlvbGF0aW9ucywgY3N2OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIGltcG9ydCggLyogd2VicGFja0NodW5rTmFtZTogImNzdiIgKi8ncGFwYXBhcnNlJyk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICBQYXBhID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHZpb2xhdGlvbnMgPSAodGhpcy52aW9sYXRpb25zIHx8IFtdKS5tYXAoZnVuY3Rpb24gKHZpb2xhdGlvbikgewogICAgICAgICAgICAgICAgICBkZWxldGUgdmlvbGF0aW9uLnJlc291cmNlTGluazsKICAgICAgICAgICAgICAgICAgZGVsZXRlIHZpb2xhdGlvbi5jb25zdHJhaW50TGluazsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHZpb2xhdGlvbjsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY3N2ID0gUGFwYS51bnBhcnNlKHZpb2xhdGlvbnMpOwogICAgICAgICAgICAgICAgZG93bmxvYWRGaWxlKCJ2aW9sYXRpb25zLSIuY29uY2F0KHRoaXMubmFtZSwgIi5jc3YiKSwgY3N2LCAnYXBwbGljYXRpb24vY3N2Jyk7CiAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRkaXNwYXRjaCgnZ3Jvd2wvZnJvbUVycm9yJywgewogICAgICAgICAgICAgICAgICB0aXRsZTogJ0Vycm9yIGRvd25sb2FkaW5nIGZpbGUnLAogICAgICAgICAgICAgICAgICBlcnI6IGVycgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gZG93bmxvYWRWaW9sYXRpb25zKCkgewogICAgICAgIHJldHVybiBfZG93bmxvYWRWaW9sYXRpb25zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGRvd25sb2FkVmlvbGF0aW9uczsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImNsZWFuRm9yTmV3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhbkZvck5ldygpIHsKICAgICAgdGhpcy4kZGlzcGF0Y2goImNsZWFuRm9yTmV3IiwgdGhpcyk7CiAgICAgIGlmICh0aGlzLmNvbnN0cmFpbnQpIHsKICAgICAgICBkZWxldGUgdGhpcy5jb25zdHJhaW50OwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2F2ZVlhbWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVZYW1sKHlhbWwpIHsKICAgICAgdmFyIHBhcnNlZCA9IGpzeWFtbC5sb2FkKHlhbWwpOwogICAgICBPYmplY3QuYXNzaWduKHRoaXMsIHBhcnNlZCk7CiAgICAgIHJldHVybiB0aGlzLnNhdmUoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZW1vdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yZW1vdmUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKCkgewogICAgICAgIHZhciBjb25zdHJhaW50OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZExhdGVzdENvbnN0cmFpbnQoKTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNvbnN0cmFpbnQgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgY29uc3RyYWludC5yZW1vdmUoKSk7CiAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gcmVtb3ZlKCkgewogICAgICAgIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlbW92ZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImZpbmRMYXRlc3RDb25zdHJhaW50IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kTGF0ZXN0Q29uc3RyYWludCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJGRpc3BhdGNoKCdjbHVzdGVyL2ZpbmQnLCB7CiAgICAgICAgdHlwZTogdGhpcy5jb25zdHJhaW50LnR5cGUsCiAgICAgICAgaWQ6IHRoaXMuY29uc3RyYWludC5pZCwKICAgICAgICBvcHQ6IHsKICAgICAgICAgIGZvcmNlOiB0cnVlCiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgcm9vdDogdHJ1ZQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ0b3RhbFZpb2xhdGlvbnMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0dXM7CiAgICAgIHJldHVybiAoKF90aGlzJHN0YXR1cyA9IHRoaXMuc3RhdHVzKSA9PT0gbnVsbCB8fCBfdGhpcyRzdGF0dXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHN0YXR1cy50b3RhbFZpb2xhdGlvbnMpIHx8IHRoaXMudmlvbGF0aW9ucy5sZW5ndGg7CiAgICB9CiAgfSwgewogICAga2V5OiAidmlvbGF0aW9ucyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJHN0YXR1czIsCiAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICB2YXIgdmlvbGF0aW9ucyA9ICgoX3RoaXMkc3RhdHVzMiA9IHRoaXMuc3RhdHVzKSA9PT0gbnVsbCB8fCBfdGhpcyRzdGF0dXMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzdGF0dXMyLnZpb2xhdGlvbnMpIHx8IFtdOwogICAgICByZXR1cm4gdmlvbGF0aW9ucy5tYXAoZnVuY3Rpb24gKHZpb2xhdGlvbikgewogICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHZpb2xhdGlvbiksIHt9LCB7CiAgICAgICAgICByZXNvdXJjZUxpbms6IHsKICAgICAgICAgICAgdGV4dDogdmlvbGF0aW9uLm5hbWUsCiAgICAgICAgICAgIHRvOiB7CiAgICAgICAgICAgICAgbmFtZTogJ2MtY2x1c3Rlci1wcm9kdWN0LXJlc291cmNlLWlkJywKICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgIHJlc291cmNlOiB2aW9sYXRpb24ua2luZC50b0xvd2VyQ2FzZSgpLAogICAgICAgICAgICAgICAgaWQ6IHZpb2xhdGlvbi5uYW1lLAogICAgICAgICAgICAgICAgcHJvZHVjdDogJ2V4cGxvcmVyJwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIGNvbnN0cmFpbnRMaW5rOiB7CiAgICAgICAgICAgIHRleHQ6IF90aGlzLm5hbWVEaXNwbGF5LAogICAgICAgICAgICB0bzogX3RoaXMuZGV0YWlsTG9jYXRpb24KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwogIHJldHVybiBHYXRlS2VlcGVyQ29uc3RyYWludDsKfShTdGV2ZU1vZGVsKTsKZXhwb3J0IHsgR2F0ZUtlZXBlckNvbnN0cmFpbnQgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"names":["jsyaml","SteveModel","downloadFile","ENFORCEMENT_ACTION_VALUES","DENY","DRYRUN","GateKeeperConstraint","_SteveModel","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","get","out","_get","_getPrototypeOf","prototype","t","$rootGetters","downloadViolations","action","icon","label","total","unshift","value","_save","_asyncToGenerator","regeneratorRuntime","mark","_callee","constraint","resourceVersion","_constraint","wrap","_callee$","_context","prev","next","findLatestConstraint","sent","metadata","$dispatch","type","concat","kind","toLowerCase","root","spec","save","stop","_downloadViolations","_callee2","Papa","violations","csv","_callee2$","_context2","map","violation","resourceLink","constraintLink","unparse","name","err","title","cleanForNew","saveYaml","yaml","parsed","load","Object","assign","_remove","_callee3","_callee3$","_context3","abrupt","remove","id","opt","force","_this$status","status","totalViolations","length","_this$status2","_this","_objectSpread","text","to","params","resource","product","nameDisplay","detailLocation","default"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/constraints.gatekeeper.sh.constraint.js"],"sourcesContent":["import jsyaml from 'js-yaml';\r\nimport SteveModel from '@shell/plugins/steve/steve-class';\r\nimport { downloadFile } from '@shell/utils/download';\r\n\r\nexport const ENFORCEMENT_ACTION_VALUES = {\r\n  DENY:   'deny',\r\n  DRYRUN: 'dryrun'\r\n};\r\n\r\nexport default class GateKeeperConstraint extends SteveModel {\r\n  get _availableActions() {\r\n    const out = super._availableActions;\r\n\r\n    const t = this.$rootGetters['i18n/t'];\r\n\r\n    const downloadViolations = {\r\n      action: 'downloadViolations',\r\n      icon:   'icon icon-fw icon-download',\r\n      label:  t('gatekeeperConstraint.downloadViolations'),\r\n      total:  1,\r\n    };\r\n\r\n    out.unshift(downloadViolations);\r\n\r\n    return out;\r\n  }\r\n\r\n  async save() {\r\n    let constraint;\r\n    let resourceVersion;\r\n\r\n    if (this.constraint) {\r\n      constraint = await this.findLatestConstraint();\r\n      resourceVersion = constraint?.metadata?.resourceVersion;\r\n    } else {\r\n      constraint = await this.$dispatch('cluster/create', { type: `constraints.gatekeeper.sh.${ this.kind.toLowerCase() }` }, { root: true });\r\n    }\r\n\r\n    constraint.spec = this.spec;\r\n    constraint.metadata = this.metadata;\r\n    if (resourceVersion) {\r\n      constraint.metadata.resourceVersion = resourceVersion;\r\n    }\r\n\r\n    await constraint.save();\r\n  }\r\n\r\n  async downloadViolations() {\r\n    const Papa = await import(/* webpackChunkName: \"csv\" */'papaparse');\r\n\r\n    try {\r\n      const violations = (this.violations || []).map((violation) => {\r\n        delete violation.resourceLink;\r\n        delete violation.constraintLink;\r\n\r\n        return violation;\r\n      });\r\n\r\n      const csv = Papa.unparse(violations);\r\n\r\n      downloadFile(`violations-${ this.name }.csv`, csv, 'application/csv');\r\n    } catch (err) {\r\n      this.$dispatch('growl/fromError', { title: 'Error downloading file', err }, { root: true });\r\n    }\r\n  }\r\n\r\n  cleanForNew() {\r\n    this.$dispatch(`cleanForNew`, this);\r\n\r\n    if (this.constraint) {\r\n      delete this.constraint;\r\n    }\r\n  }\r\n\r\n  saveYaml(yaml) {\r\n    const parsed = jsyaml.load(yaml);\r\n\r\n    Object.assign(this, parsed);\r\n\r\n    return this.save();\r\n  }\r\n\r\n  async remove() {\r\n    const constraint = await this.findLatestConstraint();\r\n\r\n    return constraint.remove();\r\n  }\r\n\r\n  findLatestConstraint() {\r\n    return this.$dispatch('cluster/find', {\r\n      type: this.constraint.type, id: this.constraint.id, opt: { force: true }\r\n    }, { root: true });\r\n  }\r\n\r\n  get totalViolations() {\r\n    return this.status?.totalViolations || this.violations.length;\r\n  }\r\n\r\n  get violations() {\r\n    const violations = this.status?.violations || [];\r\n\r\n    return violations.map((violation) => {\r\n      return {\r\n        ...violation,\r\n        resourceLink: {\r\n          text: violation.name,\r\n          to:   {\r\n            name:   'c-cluster-product-resource-id',\r\n            params: {\r\n              resource: violation.kind.toLowerCase(), id: violation.name, product: 'explorer'\r\n            }\r\n          }\r\n        },\r\n        constraintLink: {\r\n          text: this.nameDisplay,\r\n          to:   this.detailLocation\r\n        }\r\n      };\r\n    });\r\n  }\r\n}\r\n"],"mappings":"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"}]}