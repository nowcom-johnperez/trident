{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/provisioning.cattle.io.cluster.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/provisioning.cattle.io.cluster.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5jb25zdHJ1Y3QuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zeW1ib2wuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzLmpzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2dldCBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9nZXQiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwpmdW5jdGlvbiBvd25LZXlzKGUsIHIpIHsgdmFyIHQgPSBPYmplY3Qua2V5cyhlKTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIG8gPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpOyByICYmIChvID0gby5maWx0ZXIoZnVuY3Rpb24gKHIpIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSwgcikuZW51bWVyYWJsZTsgfSkpLCB0LnB1c2guYXBwbHkodCwgbyk7IH0gcmV0dXJuIHQ7IH0KZnVuY3Rpb24gX29iamVjdFNwcmVhZChlKSB7IGZvciAodmFyIHIgPSAxOyByIDwgYXJndW1lbnRzLmxlbmd0aDsgcisrKSB7IHZhciB0ID0gbnVsbCAhPSBhcmd1bWVudHNbcl0gPyBhcmd1bWVudHNbcl0gOiB7fTsgciAlIDIgPyBvd25LZXlzKE9iamVjdCh0KSwgITApLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgX2RlZmluZVByb3BlcnR5KGUsIHIsIHRbcl0pOyB9KSA6IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoZSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnModCkpIDogb3duS2V5cyhPYmplY3QodCkpLmZvckVhY2goZnVuY3Rpb24gKHIpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHIsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodCwgcikpOyB9KTsgfSByZXR1cm4gZTsgfQppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdGFydHMtd2l0aC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuZW5kcy13aXRoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuam9pbi5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucHJvbWlzZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5wcm9taXNlLmFsbC1zZXR0bGVkLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvcnQuanMiOwpmdW5jdGlvbiBfY3JlYXRlU3VwZXIoRGVyaXZlZCkgeyB2YXIgaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCA9IF9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QoKTsgcmV0dXJuIGZ1bmN0aW9uIF9jcmVhdGVTdXBlckludGVybmFsKCkgeyB2YXIgU3VwZXIgPSBfZ2V0UHJvdG90eXBlT2YoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9IF9nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3RvcjsgcmVzdWx0ID0gUmVmbGVjdC5jb25zdHJ1Y3QoU3VwZXIsIGFyZ3VtZW50cywgTmV3VGFyZ2V0KTsgfSBlbHNlIHsgcmVzdWx0ID0gU3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgfSByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgcmVzdWx0KTsgfTsgfQpmdW5jdGlvbiBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCkgeyBpZiAodHlwZW9mIFJlZmxlY3QgPT09ICJ1bmRlZmluZWQiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSAiZnVuY3Rpb24iKSByZXR1cm4gdHJ1ZTsgdHJ5IHsgQm9vbGVhbi5wcm90b3R5cGUudmFsdWVPZi5jYWxsKFJlZmxlY3QuY29uc3RydWN0KEJvb2xlYW4sIFtdLCBmdW5jdGlvbiAoKSB7fSkpOyByZXR1cm4gdHJ1ZTsgfSBjYXRjaCAoZSkgeyByZXR1cm4gZmFsc2U7IH0gfQppbXBvcnQgeyBDQVBJLCBNQU5BR0VNRU5ULCBOT1JNQU4sIFNOQVBTSE9ULCBIQ0kgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IFN0ZXZlTW9kZWwgZnJvbSAnQHNoZWxsL3BsdWdpbnMvc3RldmUvc3RldmUtY2xhc3MnOwppbXBvcnQgeyBmaW5kQnkgfSBmcm9tICdAc2hlbGwvdXRpbHMvYXJyYXknOwppbXBvcnQgeyBnZXQsIHNldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdAc2hlbGwvdXRpbHMvc29ydCc7CmltcG9ydCB7IHVjRmlyc3QgfSBmcm9tICdAc2hlbGwvdXRpbHMvc3RyaW5nJzsKaW1wb3J0IHsgY29tcGFyZSB9IGZyb20gJ0BzaGVsbC91dGlscy92ZXJzaW9uJzsKaW1wb3J0IHsgQVMsIE1PREUsIF9WSUVXLCBfWUFNTCB9IGZyb20gJ0BzaGVsbC9jb25maWcvcXVlcnktcGFyYW1zJzsKaW1wb3J0IHsgSEFSVkVTVEVSX05BTUUgYXMgSEFSVkVTVEVSIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9mZWF0dXJlcyc7CmltcG9ydCB7IENBUEkgYXMgQ0FQSV9BTk5PVEFUSU9OUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsKCi8qKgogKiBDbGFzcyByZXByZXNlbnRpbmcgQ2x1c3RlciByZXNvdXJjZS4KICogQGV4dGVuZHMgU3RldmVNb2RlbAogKi8KdmFyIFByb3ZDbHVzdGVyID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfU3RldmVNb2RlbCkgewogIF9pbmhlcml0cyhQcm92Q2x1c3RlciwgX1N0ZXZlTW9kZWwpOwogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUHJvdkNsdXN0ZXIpOwogIGZ1bmN0aW9uIFByb3ZDbHVzdGVyKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFByb3ZDbHVzdGVyKTsKICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKFByb3ZDbHVzdGVyLCBbewogICAga2V5OiAiZGV0YWlscyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG91dCA9IFt7CiAgICAgICAgbGFiZWw6IHRoaXMudCgnY2x1c3Rlci5kZXRhaWwucHJvdmlzaW9uZXInKSwKICAgICAgICBjb250ZW50OiB0aGlzLnByb3Zpc2lvbmVyRGlzcGxheSB8fCB0aGlzLnQoJ2dlbmVyaWMubm9uZScpCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogdGhpcy50KCdjbHVzdGVyLmRldGFpbC5tYWNoaW5lUHJvdmlkZXInKSwKICAgICAgICBjb250ZW50OiB0aGlzLm1hY2hpbmVQcm92aWRlciA/IHRoaXMubWFjaGluZVByb3ZpZGVyRGlzcGxheSA6IG51bGwKICAgICAgfSwgewogICAgICAgIGxhYmVsOiB0aGlzLnQoJ2NsdXN0ZXIuZGV0YWlsLmt1YmVybmV0ZXNWZXJzaW9uJyksCiAgICAgICAgY29udGVudDogdGhpcy5rdWJlcm5ldGVzVmVyc2lvbgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6IHRoaXMudCgnY2x1c3Rlci5kZXRhaWwubWFjaGluZVBvb2xzJyksCiAgICAgICAgY29udGVudDogdGhpcy5wb29scy5sZW5ndGgKICAgICAgfSwgewogICAgICAgIGxhYmVsOiB0aGlzLnQoJ2NsdXN0ZXIuZGV0YWlsLm1hY2hpbmVzJyksCiAgICAgICAgY29udGVudDogdGhpcy5kZXNpcmVkCiAgICAgIH1dLmZpbHRlcihmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiAhIXguY29udGVudDsKICAgICAgfSk7CgogICAgICAvLyBSS0UgVGVtcGxhdGUgZGV0YWlscwogICAgICB2YXIgcmtlVGVtcGxhdGUgPSB0aGlzLnJrZVRlbXBsYXRlOwogICAgICBpZiAocmtlVGVtcGxhdGUpIHsKICAgICAgICBvdXQucHVzaCh7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdjbHVzdGVyLmRldGFpbC5ya2VUZW1wbGF0ZScpLAogICAgICAgICAgZm9ybWF0dGVyOiAnUktFVGVtcGxhdGVOYW1lJywKICAgICAgICAgIGNvbnRlbnQ6IHJrZVRlbXBsYXRlCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLm1hY2hpbmVQcm92aWRlcikgewogICAgICAgIG91dC5zcGxpY2UoMSwgMSk7CiAgICAgICAgcmV0dXJuIG91dDsKICAgICAgfQogICAgICByZXR1cm4gb3V0OwogICAgfQoKICAgIC8vIHVzaW5nIHRoaXMgY29tcHV0ZWQgYmVjYXVzZSBvbiB0aGUgcHJvdmlzaW9uaW5nIGNsdXN0ZXIgd2UgYXJlCiAgICAvLyBkaXNwbGF5aW5nIHRoZSBvbGRlc3QgYWdlIGJldHdlZW4gcHJvdmlzaW9uaW5nLmNsdXN0ZXIgYW5kIG1hbmFnZW1lbnQuY2x1c3RlcgogICAgLy8gc28gdGhhdCBvbiBhIHZlcnNpb24gdXBncmFkZSBvZiBSYW5jaGVyIChleDogMi41LnggdG8gMi42LngpCiAgICAvLyB3ZSBjYW4gaGF2ZSB0aGUgY29ycmVjdCBhZ2Ugb2YgdGhlIGNsdXN0ZXIgZGlzcGxheWVkIG9uIHRoZSBVSSBzaWRlCiAgfSwgewogICAga2V5OiAiY3JlYXRpb25UaW1lc3RhbXAiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZXRhZGF0YSwgX3RoaXMkbWdtdDsKICAgICAgdmFyIHByb3ZDcmVhdGlvblRpbWVzdGFtcCA9IERhdGUucGFyc2UoKF90aGlzJG1ldGFkYXRhID0gdGhpcy5tZXRhZGF0YSkgPT09IG51bGwgfHwgX3RoaXMkbWV0YWRhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1ldGFkYXRhLmNyZWF0aW9uVGltZXN0YW1wKTsKICAgICAgdmFyIG1nbXRDcmVhdGlvblRpbWVzdGFtcCA9IERhdGUucGFyc2UoKF90aGlzJG1nbXQgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQgPT09IHZvaWQgMCB8fCAoX3RoaXMkbWdtdCA9IF90aGlzJG1nbXQubWV0YWRhdGEpID09PSBudWxsIHx8IF90aGlzJG1nbXQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQuY3JlYXRpb25UaW1lc3RhbXApOwogICAgICBpZiAobWdtdENyZWF0aW9uVGltZXN0YW1wICYmIG1nbXRDcmVhdGlvblRpbWVzdGFtcCA8IHByb3ZDcmVhdGlvblRpbWVzdGFtcCkgewogICAgICAgIHZhciBfdGhpcyRtZ210MjsKICAgICAgICByZXR1cm4gKF90aGlzJG1nbXQyID0gdGhpcy5tZ210KSA9PT0gbnVsbCB8fCBfdGhpcyRtZ210MiA9PT0gdm9pZCAwIHx8IChfdGhpcyRtZ210MiA9IF90aGlzJG1nbXQyLm1ldGFkYXRhKSA9PT0gbnVsbCB8fCBfdGhpcyRtZ210MiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDIuY3JlYXRpb25UaW1lc3RhbXA7CiAgICAgIH0KICAgICAgcmV0dXJuIF9nZXQoX2dldFByb3RvdHlwZU9mKFByb3ZDbHVzdGVyLnByb3RvdHlwZSksICJjcmVhdGlvblRpbWVzdGFtcCIsIHRoaXMpOwogICAgfQoKICAgIC8vIE1vZGVscyBjYW4gc3BlY2lmeSBhIHNpbmdsZSBhY3Rpb24gdGhhdCB3aWxsIGJlIHNob3duIGFzIGEgYnV0dG9uIGluIHRoZSBkZXRhaWxzIG1hc3RoZWFkCiAgfSwgewogICAga2V5OiAiZGV0YWlsc0FjdGlvbiIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJG1nbXQzOwogICAgICB2YXIgY2FuRXhwbG9yZSA9ICgoX3RoaXMkbWdtdDMgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210My5pc1JlYWR5KSAmJiAhdGhpcy5oYXNFcnJvcjsKICAgICAgcmV0dXJuIHsKICAgICAgICBhY3Rpb246ICdleHBsb3JlJywKICAgICAgICBsYWJlbDogdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCdjbHVzdGVyLmV4cGxvcmUnKSwKICAgICAgICBlbmFibGVkOiBjYW5FeHBsb3JlCiAgICAgIH07CiAgICB9CiAgfSwgewogICAga2V5OiAiX2F2YWlsYWJsZUFjdGlvbnMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210NCwgX3RoaXMkbWdtdDUsIF90aGlzJG1nbXQ2LCBfY2x1c3RlclRlbXBsYXRlc1NjaGUsIF9jbHVzdGVyVGVtcGxhdGVzU2NoZTIsIF90aGlzJG5vcm1hbkNsdXN0ZXIsIF90aGlzJG1nbXQ3LCBfdGhpcyRtZ210OCwgX3RoaXMkbWdtdDksIF90aGlzJG1nbXQxMCwgX3RoaXMkbWdtdDExLCBfdGhpcyRtZ210MTIsIF90aGlzJG1nbXQxMzsKICAgICAgdmFyIG91dCA9IF9nZXQoX2dldFByb3RvdHlwZU9mKFByb3ZDbHVzdGVyLnByb3RvdHlwZSksICJfYXZhaWxhYmxlQWN0aW9ucyIsIHRoaXMpOwogICAgICB2YXIgaXNMb2NhbCA9IChfdGhpcyRtZ210NCA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQ0LmlzTG9jYWw7CgogICAgICAvLyBEb24ndCBsZXQgdGhlIHVzZXIgZGVsZXRlIHRoZSBsb2NhbCBjbHVzdGVyIGZyb20gdGhlIFVJCiAgICAgIGlmIChpc0xvY2FsKSB7CiAgICAgICAgdmFyIHJlbW92ZSA9IG91dC5maW5kSW5kZXgoZnVuY3Rpb24gKGEpIHsKICAgICAgICAgIHJldHVybiBhLmFjdGlvbiA9PT0gJ3Byb21wdFJlbW92ZSc7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHJlbW92ZSA+IC0xKSB7CiAgICAgICAgICBvdXQuc3BsaWNlKHJlbW92ZSwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHZhciByZWFkeSA9IChfdGhpcyRtZ210NSA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQ1LmlzUmVhZHk7CiAgICAgIHZhciBjYW5FZGl0UktFMmNsdXN0ZXIgPSB0aGlzLmlzUmtlMiAmJiByZWFkeSAmJiB0aGlzLmNhblVwZGF0ZTsKICAgICAgdmFyIGNhblNuYXBzaG90ID0gcmVhZHkgJiYgKHRoaXMuaXNSa2UyICYmIHRoaXMuY2FuVXBkYXRlIHx8IHRoaXMuaXNSa2UxICYmICgoX3RoaXMkbWdtdDYgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQ2ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210Ni5oYXNBY3Rpb24oJ2JhY2t1cEV0Y2QnKSkpOwogICAgICB2YXIgY2x1c3RlclRlbXBsYXRlc1NjaGVtYSA9IHRoaXMuJGdldHRlcnNbJ3NjaGVtYUZvciddKCdtYW5hZ2VtZW50LmNhdHRsZS5pby5jbHVzdGVydGVtcGxhdGUnKTsKICAgICAgdmFyIGNhblVwZGF0ZUNsdXN0ZXJUZW1wbGF0ZSA9IGZhbHNlOwogICAgICBpZiAoY2x1c3RlclRlbXBsYXRlc1NjaGVtYSAmJiAoKF9jbHVzdGVyVGVtcGxhdGVzU2NoZSA9IGNsdXN0ZXJUZW1wbGF0ZXNTY2hlbWEucmVzb3VyY2VNZXRob2RzKSAhPT0gbnVsbCAmJiBfY2x1c3RlclRlbXBsYXRlc1NjaGUgIT09IHZvaWQgMCAmJiBfY2x1c3RlclRlbXBsYXRlc1NjaGUuaW5jbHVkZXMoJ2Jsb2NrZWQtUFVUJykgfHwgKF9jbHVzdGVyVGVtcGxhdGVzU2NoZTIgPSBjbHVzdGVyVGVtcGxhdGVzU2NoZW1hLnJlc291cmNlTWV0aG9kcykgIT09IG51bGwgJiYgX2NsdXN0ZXJUZW1wbGF0ZXNTY2hlMiAhPT0gdm9pZCAwICYmIF9jbHVzdGVyVGVtcGxhdGVzU2NoZTIuaW5jbHVkZXMoJ1BVVCcpKSkgewogICAgICAgIGNhblVwZGF0ZUNsdXN0ZXJUZW1wbGF0ZSA9IHRydWU7CiAgICAgIH0KICAgICAgdmFyIG5vcm1hbkNsdXN0ZXJTYXZlVGVtcGxhdGVBY3Rpb24gPSAhISgoX3RoaXMkbm9ybWFuQ2x1c3RlciA9IHRoaXMubm9ybWFuQ2x1c3RlcikgIT09IG51bGwgJiYgX3RoaXMkbm9ybWFuQ2x1c3RlciAhPT0gdm9pZCAwICYmIChfdGhpcyRub3JtYW5DbHVzdGVyID0gX3RoaXMkbm9ybWFuQ2x1c3Rlci5hY3Rpb25zKSAhPT0gbnVsbCAmJiBfdGhpcyRub3JtYW5DbHVzdGVyICE9PSB2b2lkIDAgJiYgX3RoaXMkbm9ybWFuQ2x1c3Rlci5zYXZlQXNUZW1wbGF0ZSk7CiAgICAgIHZhciBjYW5TYXZlUktFVGVtcGxhdGUgPSB0aGlzLmlzUmtlMSAmJiAoKF90aGlzJG1nbXQ3ID0gdGhpcy5tZ210KSA9PT0gbnVsbCB8fCBfdGhpcyRtZ210NyA9PT0gdm9pZCAwIHx8IChfdGhpcyRtZ210NyA9IF90aGlzJG1nbXQ3LnN0YXR1cykgPT09IG51bGwgfHwgX3RoaXMkbWdtdDcgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQ3LmRyaXZlcikgPT09ICdyYW5jaGVyS3ViZXJuZXRlc0VuZ2luZScgJiYgISgoX3RoaXMkbWdtdDggPSB0aGlzLm1nbXQpICE9PSBudWxsICYmIF90aGlzJG1nbXQ4ICE9PSB2b2lkIDAgJiYgKF90aGlzJG1nbXQ4ID0gX3RoaXMkbWdtdDguc3BlYykgIT09IG51bGwgJiYgX3RoaXMkbWdtdDggIT09IHZvaWQgMCAmJiBfdGhpcyRtZ210OC5jbHVzdGVyVGVtcGxhdGVOYW1lKSAmJiB0aGlzLmhhc0xpbmsoJ3VwZGF0ZScpICYmIGNhblVwZGF0ZUNsdXN0ZXJUZW1wbGF0ZSAmJiBub3JtYW5DbHVzdGVyU2F2ZVRlbXBsYXRlQWN0aW9uOwogICAgICB2YXIgYWN0aW9ucyA9IFsKICAgICAgLy8gTm90ZTogQWN0aW9ucyBhcmUgbm90IHN1cHBvcnRlZCBpbiB0aGUgU3RldmUgQVBJLCBzbyB3ZSBjaGVjawogICAgICAvLyBhdmFpbGFibGUgYWN0aW9ucyBmb3IgUktFMSBjbHVzdGVycywgYnV0IG5vdCBSS0UyIGNsdXN0ZXJzLgogICAgICB7CiAgICAgICAgYWN0aW9uOiAnb3BlblNoZWxsJywKICAgICAgICBsYWJlbDogdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCduYXYuc2hlbGwnKSwKICAgICAgICBpY29uOiAnaWNvbiBpY29uLXRlcm1pbmFsJywKICAgICAgICBlbmFibGVkOiAhISgoX3RoaXMkbWdtdDkgPSB0aGlzLm1nbXQpICE9PSBudWxsICYmIF90aGlzJG1nbXQ5ICE9PSB2b2lkIDAgJiYgX3RoaXMkbWdtdDkubGlua3Muc2hlbGwpICYmIHJlYWR5CiAgICAgIH0sIHsKICAgICAgICBhY3Rpb246ICdkb3dubG9hZEt1YmVDb25maWcnLAogICAgICAgIGJ1bGtBY3Rpb246ICdkb3dubG9hZEt1YmVDb25maWdCdWxrJywKICAgICAgICBsYWJlbDogdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCduYXYua3ViZWNvbmZpZy5kb3dubG9hZCcpLAogICAgICAgIGljb246ICdpY29uIGljb24tZG93bmxvYWQnLAogICAgICAgIGJ1bGthYmxlOiB0cnVlLAogICAgICAgIGVuYWJsZWQ6IChfdGhpcyRtZ210MTAgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQxMCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDEwLmhhc0FjdGlvbignZ2VuZXJhdGVLdWJlY29uZmlnJykKICAgICAgfSwgewogICAgICAgIGFjdGlvbjogJ2NvcHlLdWJlQ29uZmlnJywKICAgICAgICBsYWJlbDogdGhpcy50KCdjbHVzdGVyLmNvcHlDb25maWcnKSwKICAgICAgICBidWxrYWJsZTogZmFsc2UsCiAgICAgICAgZW5hYmxlZDogKF90aGlzJG1nbXQxMSA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDExID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210MTEuaGFzQWN0aW9uKCdnZW5lcmF0ZUt1YmVjb25maWcnKSwKICAgICAgICBpY29uOiAnaWNvbiBpY29uLWNvcHknCiAgICAgIH0sIHsKICAgICAgICBhY3Rpb246ICdzbmFwc2hvdEFjdGlvbicsCiAgICAgICAgbGFiZWw6IHRoaXMuJHJvb3RHZXR0ZXJzWydpMThuL3QnXSgnbmF2LnRha2VTbmFwc2hvdCcpLAogICAgICAgIGljb246ICdpY29uIGljb24tc25hcHNob3QnLAogICAgICAgIGJ1bGtBY3Rpb246ICdzbmFwc2hvdEJ1bGsnLAogICAgICAgIGJ1bGthYmxlOiB0cnVlLAogICAgICAgIGVuYWJsZWQ6IGNhblNuYXBzaG90CiAgICAgIH0sIHsKICAgICAgICBhY3Rpb246ICdyZXN0b3JlU25hcHNob3RBY3Rpb24nLAogICAgICAgIGxhYmVsOiB0aGlzLiRyb290R2V0dGVyc1snaTE4bi90J10oJ25hdi5yZXN0b3JlU25hcHNob3QnKSwKICAgICAgICBpY29uOiAnaWNvbiBpY29uLWZ3IGljb24tYmFja3VwLXJlc3RvcmUnLAogICAgICAgIGVuYWJsZWQ6IGNhblNuYXBzaG90CiAgICAgIH0sIHsKICAgICAgICBhY3Rpb246ICdyb3RhdGVDZXJ0aWZpY2F0ZXMnLAogICAgICAgIGxhYmVsOiB0aGlzLiRyb290R2V0dGVyc1snaTE4bi90J10oJ25hdi5yb3RhdGVDZXJ0aWZpY2F0ZXMnKSwKICAgICAgICBpY29uOiAnaWNvbiBpY29uLWJhY2t1cCcsCiAgICAgICAgZW5hYmxlZDogY2FuRWRpdFJLRTJjbHVzdGVyIHx8ICgoX3RoaXMkbWdtdDEyID0gdGhpcy5tZ210KSA9PT0gbnVsbCB8fCBfdGhpcyRtZ210MTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQxMi5oYXNBY3Rpb24oJ3JvdGF0ZUNlcnRpZmljYXRlcycpKSAmJiByZWFkeQogICAgICB9LCB7CiAgICAgICAgYWN0aW9uOiAncm90YXRlRW5jcnlwdGlvbktleScsCiAgICAgICAgbGFiZWw6IHRoaXMuJHJvb3RHZXR0ZXJzWydpMThuL3QnXSgnbmF2LnJvdGF0ZUVuY3J5cHRpb25LZXlzJyksCiAgICAgICAgaWNvbjogJ2ljb24gaWNvbi1yZWZyZXNoJywKICAgICAgICBlbmFibGVkOiBjYW5FZGl0UktFMmNsdXN0ZXIgfHwgdGhpcy5pc1JrZTEgJiYgKChfdGhpcyRtZ210MTMgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQxMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDEzLmhhc0FjdGlvbigncm90YXRlRW5jcnlwdGlvbktleScpKSAmJiByZWFkeQogICAgICB9LCB7CiAgICAgICAgYWN0aW9uOiAnc2F2ZUFzUktFVGVtcGxhdGUnLAogICAgICAgIGxhYmVsOiB0aGlzLiRyb290R2V0dGVyc1snaTE4bi90J10oJ25hdi5zYXZlQXNSS0VUZW1wbGF0ZScpLAogICAgICAgIGljb246ICdpY29uIGljb24tZm9sZGVyJywKICAgICAgICBlbmFibGVkOiBjYW5TYXZlUktFVGVtcGxhdGUKICAgICAgfSwgewogICAgICAgIGRpdmlkZXI6IHRydWUKICAgICAgfV07CiAgICAgIHJldHVybiBhY3Rpb25zLmNvbmNhdChvdXQpOwogICAgfQogIH0sIHsKICAgIGtleTogIm5vcm1hbkNsdXN0ZXIiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0dXM7CiAgICAgIHZhciBuYW1lID0gKF90aGlzJHN0YXR1cyA9IHRoaXMuc3RhdHVzKSA9PT0gbnVsbCB8fCBfdGhpcyRzdGF0dXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHN0YXR1cy5jbHVzdGVyTmFtZTsKICAgICAgaWYgKCFuYW1lKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgdmFyIG91dCA9IHRoaXMuJHJvb3RHZXR0ZXJzWydyYW5jaGVyL2J5SWQnXShOT1JNQU4uQ0xVU1RFUiwgbmFtZSk7CiAgICAgIHJldHVybiBvdXQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZXhwbG9yZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZXhwbG9yZSgpIHsKICAgICAgdmFyIGxvY2F0aW9uID0gewogICAgICAgIG5hbWU6ICdjLWNsdXN0ZXInLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgY2x1c3RlcjogdGhpcy5tZ210LmlkCiAgICAgICAgfQogICAgICB9OwogICAgICB0aGlzLmN1cnJlbnRSb3V0ZXIoKS5wdXNoKGxvY2F0aW9uKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnb1RvSGFydmVzdGVyQ2x1c3RlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dvVG9IYXJ2ZXN0ZXJDbHVzdGVyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBoYXJ2ZXN0ZXJDbHVzdGVyOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLiRkaXNwYXRjaCgnY3JlYXRlJywgX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzKSwge30sIHsKICAgICAgICAgICAgICAgIHR5cGU6IEhDSS5DTFVTVEVSCiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgaGFydmVzdGVyQ2x1c3RlciA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDM7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgcmV0dXJuIGhhcnZlc3RlckNsdXN0ZXIuZ29Ub0NsdXN0ZXIoKTsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA4OwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMyk7CiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzMsIDhdXSk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gZ29Ub0hhcnZlc3RlckNsdXN0ZXIoKSB7CiAgICAgICAgcmV0dXJuIF9nb1RvSGFydmVzdGVyQ2x1c3Rlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICAgIHJldHVybiBnb1RvSGFydmVzdGVyQ2x1c3RlcjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImdvVG9WaWV3WWFtbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ29Ub1ZpZXdZYW1sKCkgewogICAgICB2YXIgbG9jYXRpb247CiAgICAgIGlmICghdGhpcy5pc1JrZTIpIHsKICAgICAgICB2YXIgX3RoaXMkbWdtdDE0OwogICAgICAgIGxvY2F0aW9uID0gKF90aGlzJG1nbXQxNCA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDE0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210MTQuZGV0YWlsTG9jYXRpb247CiAgICAgIH0KICAgICAgaWYgKCFsb2NhdGlvbikgewogICAgICAgIGxvY2F0aW9uID0gdGhpcy5kZXRhaWxMb2NhdGlvbjsKICAgICAgfQogICAgICBsb2NhdGlvbi5xdWVyeSA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbG9jYXRpb24ucXVlcnkpLCB7fSwgX2RlZmluZVByb3BlcnR5KF9kZWZpbmVQcm9wZXJ0eSh7fSwgTU9ERSwgX1ZJRVcpLCBBUywgX1lBTUwpKTsKICAgICAgdGhpcy5jdXJyZW50Um91dGVyKCkucHVzaChsb2NhdGlvbik7CiAgICB9CiAgfSwgewogICAga2V5OiAiY2FuRGVsZXRlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoUHJvdkNsdXN0ZXIucHJvdG90eXBlKSwgImNhbkRlbGV0ZSIsIHRoaXMpICYmIHRoaXMuc3RhdGVPYmoubmFtZSAhPT0gJ3JlbW92aW5nJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjYW5FZGl0WWFtbCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKCF0aGlzLmlzUmtlMikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gX2dldChfZ2V0UHJvdG90eXBlT2YoUHJvdkNsdXN0ZXIucHJvdG90eXBlKSwgImNhbkVkaXRZYW1sIiwgdGhpcyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNIb3N0ZWRLdWJlcm5ldGVzUHJvdmlkZXIiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBwcm92aWRlcnMgPSBbJ0FLUycsICdFS1MnLCAnR0tFJ107CiAgICAgIHJldHVybiBwcm92aWRlcnMuaW5jbHVkZXModGhpcy5wcm92aXNpb25lcik7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNJbXBvcnRlZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgLy8gQXMgb2YgUmFuY2hlciB2Mi42LjcsIHRoaXMgcmV0dXJucyBmYWxzZSBmb3IgaW1wb3J0ZWQgSzNzIGNsdXN0ZXJzLAogICAgICAvLyBpbiB3aGljaCB0aGlzLnByb3Zpc2lvbmVyIGlzIGBrM3NgLgogICAgICByZXR1cm4gdGhpcy5wcm92aXNpb25lciA9PT0gJ2ltcG9ydGVkJzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0N1c3RvbSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKHRoaXMuaXNSa2UyKSB7CiAgICAgICAgdmFyIF90aGlzJHNwZWM7CiAgICAgICAgcmV0dXJuICEoKF90aGlzJHNwZWMgPSB0aGlzLnNwZWMpICE9PSBudWxsICYmIF90aGlzJHNwZWMgIT09IHZvaWQgMCAmJiAoX3RoaXMkc3BlYyA9IF90aGlzJHNwZWMucmtlQ29uZmlnKSAhPT0gbnVsbCAmJiBfdGhpcyRzcGVjICE9PSB2b2lkIDAgJiYgKF90aGlzJHNwZWMgPSBfdGhpcyRzcGVjLm1hY2hpbmVQb29scykgIT09IG51bGwgJiYgX3RoaXMkc3BlYyAhPT0gdm9pZCAwICYmIF90aGlzJHNwZWMubGVuZ3RoKTsKICAgICAgfQogICAgICBpZiAodGhpcy5pc1JrZTEpIHsKICAgICAgICB2YXIgX3RoaXMkcG9vbHM7CiAgICAgICAgcmV0dXJuICEoKF90aGlzJHBvb2xzID0gdGhpcy5wb29scykgIT09IG51bGwgJiYgX3RoaXMkcG9vbHMgIT09IHZvaWQgMCAmJiBfdGhpcyRwb29scy5sZW5ndGgpOwogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb25maXJtUmVtb3ZlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0ltcG9ydGVkSzNzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAvLyBBcyBvZiBSYW5jaGVyIHYyLjYuNywgdGhpcyByZXR1cm5zIGZhbHNlIGZvciBpbXBvcnRlZCBLM3MgY2x1c3RlcnMsCiAgICAgIC8vIGluIHdoaWNoIHRoaXMucHJvdmlzaW9uZXIgaXMgYGszc2AuCiAgICAgIHJldHVybiB0aGlzLmlzSW1wb3J0ZWQgJiYgdGhpcy5pc0szczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc0ltcG9ydGVkUmtlMiIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJG1nbXQxNTsKICAgICAgcmV0dXJuIHRoaXMuaXNJbXBvcnRlZCAmJiAoKF90aGlzJG1nbXQxNSA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDE1ID09PSB2b2lkIDAgfHwgKF90aGlzJG1nbXQxNSA9IF90aGlzJG1nbXQxNS5zdGF0dXMpID09PSBudWxsIHx8IF90aGlzJG1nbXQxNSA9PT0gdm9pZCAwIHx8IChfdGhpcyRtZ210MTUgPSBfdGhpcyRtZ210MTUucHJvdmlkZXIpID09PSBudWxsIHx8IF90aGlzJG1nbXQxNSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDE1LnN0YXJ0c1dpdGgoJ3JrZTInKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNLM3MiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210MTY7CiAgICAgIHJldHVybiAoKF90aGlzJG1nbXQxNiA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDE2ID09PSB2b2lkIDAgfHwgKF90aGlzJG1nbXQxNiA9IF90aGlzJG1nbXQxNi5zdGF0dXMpID09PSBudWxsIHx8IF90aGlzJG1nbXQxNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDE2LnByb3ZpZGVyKSA9PT0gJ2szcyc7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNSa2UyIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkc3BlYzI7CiAgICAgIHJldHVybiAhISgoX3RoaXMkc3BlYzIgPSB0aGlzLnNwZWMpICE9PSBudWxsICYmIF90aGlzJHNwZWMyICE9PSB2b2lkIDAgJiYgX3RoaXMkc3BlYzIucmtlQ29uZmlnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1JrZTEiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210MTc7CiAgICAgIHJldHVybiAhISgoX3RoaXMkbWdtdDE3ID0gdGhpcy5tZ210KSAhPT0gbnVsbCAmJiBfdGhpcyRtZ210MTcgIT09IHZvaWQgMCAmJiAoX3RoaXMkbWdtdDE3ID0gX3RoaXMkbWdtdDE3LnNwZWMpICE9PSBudWxsICYmIF90aGlzJG1nbXQxNyAhPT0gdm9pZCAwICYmIF90aGlzJG1nbXQxNy5yYW5jaGVyS3ViZXJuZXRlc0VuZ2luZUNvbmZpZyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiaXNIYXJ2ZXN0ZXIiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210MTg7CiAgICAgIHJldHVybiAhISgoX3RoaXMkbWdtdDE4ID0gdGhpcy5tZ210KSAhPT0gbnVsbCAmJiBfdGhpcyRtZ210MTggIT09IHZvaWQgMCAmJiBfdGhpcyRtZ210MTguaXNIYXJ2ZXN0ZXIpOwogICAgfQogIH0sIHsKICAgIGtleTogIm1nbXRDbHVzdGVySWQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210MTksIF90aGlzJGlkOwogICAgICByZXR1cm4gKChfdGhpcyRtZ210MTkgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQxOSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDE5LmlkKSB8fCAoKF90aGlzJGlkID0gdGhpcy5pZCkgPT09IG51bGwgfHwgX3RoaXMkaWQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJGlkLnJlcGxhY2UoIiIuY29uY2F0KHRoaXMubWV0YWRhdGEubmFtZXNwYWNlLCAiLyIpLCAnJykpOwogICAgfQogIH0sIHsKICAgIGtleTogIm1nbXQiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRzdGF0dXMyOwogICAgICB2YXIgbmFtZSA9IChfdGhpcyRzdGF0dXMyID0gdGhpcy5zdGF0dXMpID09PSBudWxsIHx8IF90aGlzJHN0YXR1czIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHN0YXR1czIuY2x1c3Rlck5hbWU7CiAgICAgIGlmICghbmFtZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIHZhciBvdXQgPSB0aGlzLiRyb290R2V0dGVyc1snbWFuYWdlbWVudC9ieUlkJ10oTUFOQUdFTUVOVC5DTFVTVEVSLCBuYW1lKTsKICAgICAgcmV0dXJuIG91dDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJpc1JlYWR5IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkbWdtdDIwOwogICAgICByZXR1cm4gISEoKF90aGlzJG1nbXQyMCA9IHRoaXMubWdtdCkgIT09IG51bGwgJiYgX3RoaXMkbWdtdDIwICE9PSB2b2lkIDAgJiYgX3RoaXMkbWdtdDIwLmlzUmVhZHkpOwogICAgfQoKICAgIC8vIG5vZGVHcm91cHMgY2FuIGJlIHVuZGVmaW5lZCBmb3IgYW4gRUtTIGNsdXN0ZXIgdGhhdCBoYXMganVzdCBiZWVuIGNyZWF0ZWQgYW5kIGhhcyBub3QKICAgIC8vIGhhZCBhbnkgbm9kZSBncm91cHMgYWRkZWQgdG8gaXQKICB9LCB7CiAgICBrZXk6ICJla3NOb2RlR3JvdXBzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkbWdtdDIxOwogICAgICByZXR1cm4gKChfdGhpcyRtZ210MjEgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQyMSA9PT0gdm9pZCAwIHx8IChfdGhpcyRtZ210MjEgPSBfdGhpcyRtZ210MjEuc3BlYykgPT09IG51bGwgfHwgX3RoaXMkbWdtdDIxID09PSB2b2lkIDAgfHwgKF90aGlzJG1nbXQyMSA9IF90aGlzJG1nbXQyMS5la3NDb25maWcpID09PSBudWxsIHx8IF90aGlzJG1nbXQyMSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDIxLm5vZGVHcm91cHMpIHx8IFtdOwogICAgfQogIH0sIHsKICAgIGtleTogIndhaXRGb3JQcm92aXNpb25lciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gd2FpdEZvclByb3Zpc2lvbmVyKHRpbWVvdXQsIGludGVydmFsKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzLndhaXRGb3JUZXN0Rm4oZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiAhIV90aGlzLnByb3Zpc2lvbmVyOwogICAgICB9LCAic2V0IHByb3Zpc2lvbmVyIiwgdGltZW91dCwgaW50ZXJ2YWwpOwogICAgfQogIH0sIHsKICAgIGtleTogIndhaXRGb3JNZ210IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB3YWl0Rm9yTWdtdCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIHZhciB0aW1lb3V0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiA2MDAwMDsKICAgICAgdmFyIGludGVydmFsID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQ7CiAgICAgIHJldHVybiB0aGlzLndhaXRGb3JUZXN0Rm4oZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfdGhpczIkc3RhdHVzLCBfcENsdXN0ZXIkc3RhdHVzOwogICAgICAgIC8vIGB0aGlzYCBpbnN0YW5jZSBpc24ndCBnZXR0aW5nIHVwZGF0ZWQgd2l0aCBgc3RhdHVzLmNsdXN0ZXJOYW1lYAogICAgICAgIC8vIFdvcmthcm91bmQgLSBHZXQgZnJlc2ggY29weSBmcm9tIHRoZSBzdG9yZQogICAgICAgIHZhciBwQ2x1c3RlciA9IF90aGlzMi4kcm9vdEdldHRlcnNbJ21hbmFnZW1lbnQvYnlJZCddKENBUEkuUkFOQ0hFUl9DTFVTVEVSLCBfdGhpczIuaWQpOwogICAgICAgIHZhciBuYW1lID0gKChfdGhpczIkc3RhdHVzID0gX3RoaXMyLnN0YXR1cykgPT09IG51bGwgfHwgX3RoaXMyJHN0YXR1cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMyJHN0YXR1cy5jbHVzdGVyTmFtZSkgfHwgKHBDbHVzdGVyID09PSBudWxsIHx8IHBDbHVzdGVyID09PSB2b2lkIDAgfHwgKF9wQ2x1c3RlciRzdGF0dXMgPSBwQ2x1c3Rlci5zdGF0dXMpID09PSBudWxsIHx8IF9wQ2x1c3RlciRzdGF0dXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wQ2x1c3RlciRzdGF0dXMuY2x1c3Rlck5hbWUpOwogICAgICAgIHJldHVybiBuYW1lICYmICEhX3RoaXMyLiRyb290R2V0dGVyc1snbWFuYWdlbWVudC9ieUlkJ10oTUFOQUdFTUVOVC5DTFVTVEVSLCBuYW1lKTsKICAgICAgfSwgdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCdjbHVzdGVyLm1hbmFnZW1lbnRUaW1lb3V0JyksIHRpbWVvdXQsIGludGVydmFsKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwcm92aXNpb25lciIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKHRoaXMuaXNSa2UyKSB7CiAgICAgICAgdmFyIGFsbEtleXMgPSBPYmplY3Qua2V5cyh0aGlzLnNwZWMpOwogICAgICAgIHZhciBjb25maWdLZXkgPSBhbGxLZXlzLmZpbmQoZnVuY3Rpb24gKGspIHsKICAgICAgICAgIHJldHVybiBrLmVuZHNXaXRoKCdDb25maWcnKTsKICAgICAgICB9KTsKICAgICAgICBpZiAoY29uZmlnS2V5ID09PSAncmtlQ29uZmlnJykgewogICAgICAgICAgcmV0dXJuICdya2UyJzsKICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZ0tleSkgewogICAgICAgICAgcmV0dXJuIGNvbmZpZ0tleS5yZXBsYWNlKC9jb25maWckL2ksICcnKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodGhpcy5tZ210KSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWdtdC5wcm92aXNpb25lcjsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwcm92aXNpb25lckRpc3BsYXkiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRzcGVjMzsKICAgICAgdmFyIHByb3Zpc2lvbmVyID0gKHRoaXMucHJvdmlzaW9uZXIgfHwgJycpLnRvTG93ZXJDYXNlKCk7CgogICAgICAvLyBSS0UgcHJvdmlzaW9uZXIgY2FuIGFjdHVhbGx5IGRvIEszcyB0b28uLi4KICAgICAgaWYgKHByb3Zpc2lvbmVyID09PSAncmtlMicgJiYgKF90aGlzJHNwZWMzID0gdGhpcy5zcGVjKSAhPT0gbnVsbCAmJiBfdGhpcyRzcGVjMyAhPT0gdm9pZCAwICYmIChfdGhpcyRzcGVjMyA9IF90aGlzJHNwZWMzLmt1YmVybmV0ZXNWZXJzaW9uKSAhPT0gbnVsbCAmJiBfdGhpcyRzcGVjMyAhPT0gdm9pZCAwICYmIF90aGlzJHNwZWMzLmluY2x1ZGVzKCdrM3MnKSkgewogICAgICAgIHByb3Zpc2lvbmVyID0gJ2szcyc7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0ltcG9ydGVkSzNzKSB7CiAgICAgICAgcHJvdmlzaW9uZXIgPSAnazNzJzsKICAgICAgfSBlbHNlIGlmICh0aGlzLmlzSW1wb3J0ZWRSa2UyKSB7CiAgICAgICAgcHJvdmlzaW9uZXIgPSAncmtlMic7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXMuJHJvb3RHZXR0ZXJzWydpMThuL3dpdGhGYWxsYmFjayddKCJjbHVzdGVyLnByb3ZpZGVyLlwiIi5jb25jYXQocHJvdmlzaW9uZXIsICJcIiIpLCBudWxsLCB1Y0ZpcnN0KHByb3Zpc2lvbmVyKSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJvdmlkZXJMb2dvIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkbWdtdDIyOwogICAgICByZXR1cm4gKF90aGlzJG1nbXQyMiA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDIyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210MjIucHJvdmlkZXJMb2dvOwogICAgfQogIH0sIHsKICAgIGtleTogImt1YmVybmV0ZXNWZXJzaW9uIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgdW5rbm93biA9IHRoaXMuJHJvb3RHZXR0ZXJzWydpMThuL3QnXSgnZ2VuZXJpYy51bmtub3duJyk7CiAgICAgIGlmICh0aGlzLmlzUmtlMikgewogICAgICAgIHZhciBfdGhpcyRzdGF0dXMzLCBfdGhpcyRzcGVjNDsKICAgICAgICB2YXIgZnJvbVN0YXR1cyA9IChfdGhpcyRzdGF0dXMzID0gdGhpcy5zdGF0dXMpID09PSBudWxsIHx8IF90aGlzJHN0YXR1czMgPT09IHZvaWQgMCB8fCAoX3RoaXMkc3RhdHVzMyA9IF90aGlzJHN0YXR1czMudmVyc2lvbikgPT09IG51bGwgfHwgX3RoaXMkc3RhdHVzMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkc3RhdHVzMy5naXRWZXJzaW9uOwogICAgICAgIHZhciBmcm9tU3BlYyA9IChfdGhpcyRzcGVjNCA9IHRoaXMuc3BlYykgPT09IG51bGwgfHwgX3RoaXMkc3BlYzQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHNwZWM0Lmt1YmVybmV0ZXNWZXJzaW9uOwogICAgICAgIHJldHVybiBmcm9tU3RhdHVzIHx8IGZyb21TcGVjIHx8IHVua25vd247CiAgICAgIH0gZWxzZSBpZiAodGhpcy5tZ210KSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWdtdC5rdWJlcm5ldGVzVmVyc2lvbiB8fCB1bmtub3duOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB1bmtub3duOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAibWFjaGluZVByb3ZpZGVyIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkYW5ub3RhdGlvbnMsIF90aGlzJG1nbXQyMzsKICAgICAgLy8gRmlyc3QgY2hlY2sgYW5ub3RhdGlvbiAtIHVzZWZ1bCBmb3IgY2x1c3RlcnMgY3JlYXRlZCBieSBleHRlbnNpb24gcHJvdmlkZXJzCiAgICAgIHZhciBmcm9tQW5ub3RhdGlvbiA9IChfdGhpcyRhbm5vdGF0aW9ucyA9IHRoaXMuYW5ub3RhdGlvbnMpID09PSBudWxsIHx8IF90aGlzJGFubm90YXRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRhbm5vdGF0aW9uc1tDQVBJX0FOTk9UQVRJT05TLlVJX0NVU1RPTV9QUk9WSURFUl07CiAgICAgIGlmIChmcm9tQW5ub3RhdGlvbikgewogICAgICAgIHJldHVybiBmcm9tQW5ub3RhdGlvbjsKICAgICAgfQogICAgICBpZiAodGhpcy5pc0hhcnZlc3RlcikgewogICAgICAgIHJldHVybiBIQVJWRVNURVI7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0ltcG9ydGVkKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5pc1JrZTIpIHsKICAgICAgICB2YXIgX3RoaXMkc3BlYzU7CiAgICAgICAgdmFyIGtpbmQgPSAoX3RoaXMkc3BlYzUgPSB0aGlzLnNwZWMpID09PSBudWxsIHx8IF90aGlzJHNwZWM1ID09PSB2b2lkIDAgfHwgKF90aGlzJHNwZWM1ID0gX3RoaXMkc3BlYzUucmtlQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjNSA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjNSA9IF90aGlzJHNwZWM1Lm1hY2hpbmVQb29scykgPT09IG51bGwgfHwgX3RoaXMkc3BlYzUgPT09IHZvaWQgMCB8fCAoX3RoaXMkc3BlYzUgPSBfdGhpcyRzcGVjNVswXSkgPT09IG51bGwgfHwgX3RoaXMkc3BlYzUgPT09IHZvaWQgMCB8fCAoX3RoaXMkc3BlYzUgPSBfdGhpcyRzcGVjNS5tYWNoaW5lQ29uZmlnUmVmKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjNSA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjNSA9IF90aGlzJHNwZWM1LmtpbmQpID09PSBudWxsIHx8IF90aGlzJHNwZWM1ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjNS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGlmIChraW5kKSB7CiAgICAgICAgICByZXR1cm4ga2luZC5yZXBsYWNlKC9jb25maWckL2ksICcnKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSBlbHNlIGlmICgoX3RoaXMkbWdtdDIzID0gdGhpcy5tZ210KSAhPT0gbnVsbCAmJiBfdGhpcyRtZ210MjMgIT09IHZvaWQgMCAmJiBfdGhpcyRtZ210MjMubWFjaGluZVByb3ZpZGVyKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWdtdC5tYWNoaW5lUHJvdmlkZXIudG9Mb3dlckNhc2UoKTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWNoaW5lUHJvdmlkZXJEaXNwbGF5IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAodGhpcy5pc0ltcG9ydGVkKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgdmFyIHByb3ZpZGVyID0gKHRoaXMubWFjaGluZVByb3ZpZGVyIHx8ICcnKS50b0xvd2VyQ2FzZSgpOwogICAgICBpZiAocHJvdmlkZXIpIHsKICAgICAgICByZXR1cm4gdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vd2l0aEZhbGxiYWNrJ10oImNsdXN0ZXIucHJvdmlkZXIuXCIiLmNvbmNhdChwcm92aWRlciwgIlwiIiksIG51bGwsIHByb3ZpZGVyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCdnZW5lcmljLnVua25vd24nKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogIm1hY2hpbmVQb29sRGVmYXVsdHMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRzcGVjJHJrZUNvbmZpZzsKICAgICAgcmV0dXJuIChfdGhpcyRzcGVjJHJrZUNvbmZpZyA9IHRoaXMuc3BlYy5ya2VDb25maWcpID09PSBudWxsIHx8IF90aGlzJHNwZWMkcmtlQ29uZmlnID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjJHJrZUNvbmZpZy5tYWNoaW5lUG9vbERlZmF1bHRzOwogICAgfQogIH0sIHsKICAgIGtleTogImRlZmF1bHRIb3N0bmFtZUxlbmd0aExpbWl0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkc3BlYyRya2VDb25maWcyOwogICAgICByZXR1cm4gKF90aGlzJHNwZWMkcmtlQ29uZmlnMiA9IHRoaXMuc3BlYy5ya2VDb25maWcpID09PSBudWxsIHx8IF90aGlzJHNwZWMkcmtlQ29uZmlnMiA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjJHJrZUNvbmZpZzIgPSBfdGhpcyRzcGVjJHJrZUNvbmZpZzIubWFjaGluZVBvb2xEZWZhdWx0cykgPT09IG51bGwgfHwgX3RoaXMkc3BlYyRya2VDb25maWcyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjJHJrZUNvbmZpZzIuaG9zdG5hbWVMZW5ndGhMaW1pdDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkgewogICAgICB0aGlzLnNwZWMucmtlQ29uZmlnID0gdGhpcy5zcGVjLnJrZUNvbmZpZyB8fCB7fTsKICAgICAgdGhpcy5zcGVjLnJrZUNvbmZpZy5tYWNoaW5lUG9vbERlZmF1bHRzID0gdGhpcy5zcGVjLnJrZUNvbmZpZy5tYWNoaW5lUG9vbERlZmF1bHRzIHx8IHt9OwogICAgICB0aGlzLnNwZWMucmtlQ29uZmlnLm1hY2hpbmVQb29sRGVmYXVsdHMuaG9zdG5hbWVMZW5ndGhMaW1pdCA9IHZhbHVlOwogICAgfQogIH0sIHsKICAgIGtleTogInJlbW92ZURlZmF1bHRIb3N0bmFtZUxlbmd0aExpbWl0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVEZWZhdWx0SG9zdG5hbWVMZW5ndGhMaW1pdCgpIHsKICAgICAgdmFyIF90aGlzJG1hY2hpbmVQb29sRGVmYTsKICAgICAgaWYgKChfdGhpcyRtYWNoaW5lUG9vbERlZmEgPSB0aGlzLm1hY2hpbmVQb29sRGVmYXVsdHMpICE9PSBudWxsICYmIF90aGlzJG1hY2hpbmVQb29sRGVmYSAhPT0gdm9pZCAwICYmIF90aGlzJG1hY2hpbmVQb29sRGVmYS5ob3N0bmFtZUxlbmd0aExpbWl0KSB7CiAgICAgICAgdmFyIF90aGlzJHNwZWM2OwogICAgICAgIGRlbGV0ZSB0aGlzLnNwZWMucmtlQ29uZmlnLm1hY2hpbmVQb29sRGVmYXVsdHMuaG9zdG5hbWVMZW5ndGhMaW1pdDsKICAgICAgICBpZiAoT2JqZWN0LmtleXMoKF90aGlzJHNwZWM2ID0gdGhpcy5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjNiA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjNiA9IF90aGlzJHNwZWM2LnJrZUNvbmZpZykgPT09IG51bGwgfHwgX3RoaXMkc3BlYzYgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJHNwZWM2Lm1hY2hpbmVQb29sRGVmYXVsdHMpLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgZGVsZXRlIHRoaXMuc3BlYy5ya2VDb25maWcubWFjaGluZVBvb2xEZWZhdWx0czsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJub2RlcyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzLiRyb290R2V0dGVyc1snbWFuYWdlbWVudC9hbGwnXShNQU5BR0VNRU5ULk5PREUpLmZpbHRlcihmdW5jdGlvbiAobm9kZSkgewogICAgICAgIHJldHVybiBub2RlLmlkLnN0YXJ0c1dpdGgoX3RoaXMzLm1nbXRDbHVzdGVySWQpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtYWNoaW5lcyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CiAgICAgIHJldHVybiB0aGlzLiRyb290R2V0dGVyc1snbWFuYWdlbWVudC9hbGwnXShDQVBJLk1BQ0hJTkUpLmZpbHRlcihmdW5jdGlvbiAobWFjaGluZSkgewogICAgICAgIHZhciBfbWFjaGluZSRtZXRhZGF0YSwgX21hY2hpbmUkc3BlYzsKICAgICAgICBpZiAoKChfbWFjaGluZSRtZXRhZGF0YSA9IG1hY2hpbmUubWV0YWRhdGEpID09PSBudWxsIHx8IF9tYWNoaW5lJG1ldGFkYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbWFjaGluZSRtZXRhZGF0YS5uYW1lc3BhY2UpICE9PSBfdGhpczQubWV0YWRhdGEubmFtZXNwYWNlKSB7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiAoKF9tYWNoaW5lJHNwZWMgPSBtYWNoaW5lLnNwZWMpID09PSBudWxsIHx8IF9tYWNoaW5lJHNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tYWNoaW5lJHNwZWMuY2x1c3Rlck5hbWUpID09PSBfdGhpczQubWV0YWRhdGEubmFtZTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGlzcGxheU5hbWUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICh0aGlzLm1nbXQgJiYgIXRoaXMuaXNSa2UyKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWdtdC5zcGVjLmRpc3BsYXlOYW1lOwogICAgICB9CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogInBvb2xzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdmFyIGRlcGxveW1lbnRzID0gdGhpcy4kcm9vdEdldHRlcnNbJ21hbmFnZW1lbnQvYWxsJ10oQ0FQSS5NQUNISU5FX0RFUExPWU1FTlQpLmZpbHRlcihmdW5jdGlvbiAocG9vbCkgewogICAgICAgIHZhciBfcG9vbCRzcGVjOwogICAgICAgIHJldHVybiAoKF9wb29sJHNwZWMgPSBwb29sLnNwZWMpID09PSBudWxsIHx8IF9wb29sJHNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wb29sJHNwZWMuY2x1c3Rlck5hbWUpID09PSBfdGhpczUubWV0YWRhdGEubmFtZTsKICAgICAgfSk7CiAgICAgIGlmICghIWRlcGxveW1lbnRzLmxlbmd0aCkgewogICAgICAgIHJldHVybiBkZXBsb3ltZW50czsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy4kcm9vdEdldHRlcnNbJ21hbmFnZW1lbnQvYWxsJ10oTUFOQUdFTUVOVC5OT0RFX1BPT0wpLmZpbHRlcihmdW5jdGlvbiAocG9vbCkgewogICAgICAgIHZhciBfdGhpczUkc3RhdHVzOwogICAgICAgIHJldHVybiBwb29sLnNwZWMuY2x1c3Rlck5hbWUgPT09ICgoX3RoaXM1JHN0YXR1cyA9IF90aGlzNS5zdGF0dXMpID09PSBudWxsIHx8IF90aGlzNSRzdGF0dXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzNSRzdGF0dXMuY2x1c3Rlck5hbWUpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJkZXNpcmVkIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5wb29scy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcG9vbCkgewogICAgICAgIHJldHVybiBhY2MgKyAocG9vbC5kZXNpcmVkIHx8IDApOwogICAgICB9LCAwKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJwZW5kaW5nIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5wb29scy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcG9vbCkgewogICAgICAgIHJldHVybiBhY2MgKyAocG9vbC5wZW5kaW5nIHx8IDApOwogICAgICB9LCAwKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJvdXRkYXRlZCIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIHRoaXMucG9vbHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBvb2wpIHsKICAgICAgICByZXR1cm4gYWNjICsgKHBvb2wub3V0ZGF0ZWQgfHwgMCk7CiAgICAgIH0sIDApOwogICAgfQogIH0sIHsKICAgIGtleTogInJlYWR5IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5wb29scy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcG9vbCkgewogICAgICAgIHJldHVybiBhY2MgKyAocG9vbC5yZWFkeSB8fCAwKTsKICAgICAgfSwgMCk7CiAgICB9CiAgfSwgewogICAga2V5OiAidW5hdmFpbGFibGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLnBvb2xzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwb29sKSB7CiAgICAgICAgcmV0dXJuIGFjYyArIChwb29sLnVuYXZhaWxhYmxlIHx8IDApOwogICAgICB9LCAwKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1bmF2YWlsYWJsZU1hY2hpbmVzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKICAgICAgaWYgKHRoaXMuaXNSZWFkeSkgewogICAgICAgIGlmICh0aGlzLmlzUmtlMSkgewogICAgICAgICAgdmFyIG5hbWVzID0gdGhpcy5ub2Rlcy5maWx0ZXIoZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgcmV0dXJuIG5vZGUuc3RhdHVzLmNvbmRpdGlvbnMuZmluZChmdW5jdGlvbiAoYykgewogICAgICAgICAgICAgIHJldHVybiBjLmVycm9yICYmIGMudHlwZSA9PT0gJ1JlYWR5JzsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgICAgICAgdmFyIG5hbWUgPSBub2RlLnN0YXR1cy5ub2RlTmFtZSB8fCBub2RlLm1ldGFkYXRhLm5hbWU7CiAgICAgICAgICAgIHJldHVybiBfdGhpczYudCgnY2x1c3Rlci5hdmFpbGFiaWxpdHlXYXJuaW5ncy5ub2RlJywgewogICAgICAgICAgICAgIG5hbWU6IG5hbWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBuYW1lcy5qb2luKCc8YnI+Jyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciBfbmFtZXMgPSB0aGlzLm1hY2hpbmVzLmZpbHRlcihmdW5jdGlvbiAobWFjaGluZSkgewogICAgICAgICAgICB2YXIgX21hY2hpbmUkc3RhdHVzOwogICAgICAgICAgICByZXR1cm4gKF9tYWNoaW5lJHN0YXR1cyA9IG1hY2hpbmUuc3RhdHVzKSA9PT0gbnVsbCB8fCBfbWFjaGluZSRzdGF0dXMgPT09IHZvaWQgMCB8fCAoX21hY2hpbmUkc3RhdHVzID0gX21hY2hpbmUkc3RhdHVzLmNvbmRpdGlvbnMpID09PSBudWxsIHx8IF9tYWNoaW5lJHN0YXR1cyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21hY2hpbmUkc3RhdHVzLmZpbmQoZnVuY3Rpb24gKGMpIHsKICAgICAgICAgICAgICByZXR1cm4gYy5lcnJvciAmJiBjLnR5cGUgPT09ICdOb2RlSGVhbHRoeSc7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSkubWFwKGZ1bmN0aW9uIChtYWNoaW5lKSB7CiAgICAgICAgICAgIHZhciBfbWFjaGluZSRzdGF0dXMyOwogICAgICAgICAgICBpZiAoKF9tYWNoaW5lJHN0YXR1czIgPSBtYWNoaW5lLnN0YXR1cykgIT09IG51bGwgJiYgX21hY2hpbmUkc3RhdHVzMiAhPT0gdm9pZCAwICYmIChfbWFjaGluZSRzdGF0dXMyID0gX21hY2hpbmUkc3RhdHVzMi5ub2RlUmVmKSAhPT0gbnVsbCAmJiBfbWFjaGluZSRzdGF0dXMyICE9PSB2b2lkIDAgJiYgX21hY2hpbmUkc3RhdHVzMi5uYW1lKSB7CiAgICAgICAgICAgICAgcmV0dXJuIF90aGlzNi50KCdjbHVzdGVyLmF2YWlsYWJpbGl0eVdhcm5pbmdzLm5vZGUnLCB7CiAgICAgICAgICAgICAgICBuYW1lOiBtYWNoaW5lLnN0YXR1cy5ub2RlUmVmLm5hbWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gX3RoaXM2LnQoJ2NsdXN0ZXIuYXZhaWxhYmlsaXR5V2FybmluZ3MubWFjaGluZScsIHsKICAgICAgICAgICAgICBuYW1lOiBtYWNoaW5lLm1ldGFkYXRhLm5hbWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBfbmFtZXMuam9pbignPGJyPicpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gJyc7CiAgICB9CiAgfSwgewogICAga2V5OiAic3RhdGVQYXJ0cyIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIG91dCA9IFt7CiAgICAgICAgbGFiZWw6ICdQZW5kaW5nJywKICAgICAgICBjb2xvcjogJ2JnLWluZm8nLAogICAgICAgIHRleHRDb2xvcjogJ3RleHQtaW5mbycsCiAgICAgICAgdmFsdWU6IHRoaXMucGVuZGluZywKICAgICAgICBzb3J0OiAxCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ091dGRhdGVkJywKICAgICAgICBjb2xvcjogJ2JnLXdhcm5pbmcnLAogICAgICAgIHRleHRDb2xvcjogJ3RleHQtd2FybmluZycsCiAgICAgICAgdmFsdWU6IHRoaXMub3V0ZGF0ZWQsCiAgICAgICAgc29ydDogMgogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICdVbmF2YWlsYWJsZScsCiAgICAgICAgY29sb3I6ICdiZy1lcnJvcicsCiAgICAgICAgdGV4dENvbG9yOiAndGV4dC1lcnJvcicsCiAgICAgICAgdmFsdWU6IHRoaXMudW5hdmFpbGFibGUsCiAgICAgICAgc29ydDogMwogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICdSZWFkeScsCiAgICAgICAgY29sb3I6ICdiZy1zdWNjZXNzJywKICAgICAgICB0ZXh0Q29sb3I6ICd0ZXh0LXN1Y2Nlc3MnLAogICAgICAgIHZhbHVlOiB0aGlzLnJlYWR5LAogICAgICAgIHNvcnQ6IDQKICAgICAgfV0uZmlsdGVyKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHgudmFsdWUgPiAwOwogICAgICB9KTsKICAgICAgcmV0dXJuIHNvcnRCeShvdXQsICdzb3J0OmRlc2MnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRPckNyZWF0ZVRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0T3JDcmVhdGVUb2tlbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoKSB7CiAgICAgICAgdmFyIHRva2VucywgdG9rZW47CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy53YWl0Rm9yTWdtdCgpOwogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgaWYgKHRoaXMubWdtdCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNjsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kZGlzcGF0Y2goJ3JhbmNoZXIvZmluZEFsbCcsIHsKICAgICAgICAgICAgICAgIHR5cGU6IE5PUk1BTi5DTFVTVEVSX1RPS0VOLAogICAgICAgICAgICAgICAgZm9yY2U6IHRydWUKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICB0b2tlbnMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICB0b2tlbiA9IGZpbmRCeSh0b2tlbnMsICdjbHVzdGVySWQnLCB0aGlzLm1nbXQuaWQpOwogICAgICAgICAgICAgIGlmICghdG9rZW4pIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHRva2VuKTsKICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBpZiAodGhpcy5saW5rcy51cGRhdGUpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwogICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGRpc3BhdGNoKCdyYW5jaGVyL2NyZWF0ZScsIHsKICAgICAgICAgICAgICAgIHR5cGU6IE5PUk1BTi5DTFVTVEVSX1RPS0VOLAogICAgICAgICAgICAgICAgY2x1c3RlcklkOiB0aGlzLm1nbXQuaWQKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgdG9rZW4gPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgdG9rZW4uc2F2ZSgpKTsKICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gZ2V0T3JDcmVhdGVUb2tlbigpIHsKICAgICAgICByZXR1cm4gX2dldE9yQ3JlYXRlVG9rZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgICByZXR1cm4gZ2V0T3JDcmVhdGVUb2tlbjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogIm9wZW5TaGVsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3BlblNoZWxsKCkgewogICAgICB2YXIgX3RoaXMkbWdtdDI0OwogICAgICByZXR1cm4gKF90aGlzJG1nbXQyNCA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDI0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210MjQub3BlblNoZWxsKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2VuZXJhdGVLdWJlQ29uZmlnIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUt1YmVDb25maWcoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210MjU7CiAgICAgIHJldHVybiAoX3RoaXMkbWdtdDI1ID0gdGhpcy5tZ210KSA9PT0gbnVsbCB8fCBfdGhpcyRtZ210MjUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQyNS5nZW5lcmF0ZUt1YmVDb25maWcoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb3B5S3ViZUNvbmZpZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2NvcHlLdWJlQ29uZmlnID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMygpIHsKICAgICAgICB2YXIgX3RoaXMkbWdtdDI2OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIChfdGhpcyRtZ210MjYgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQyNiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDI2LmNvcHlLdWJlQ29uZmlnKCk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICB0aGlzLiRkaXNwYXRjaCgnZ3Jvd2wvc3VjY2VzcycsIHsKICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLnQoJ2NsdXN0ZXIuY29waWVkQ29uZmlnJyksCiAgICAgICAgICAgICAgICB0aW1lb3V0OiAzMDAwCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICB9KSk7CiAgICAgIGZ1bmN0aW9uIGNvcHlLdWJlQ29uZmlnKCkgewogICAgICAgIHJldHVybiBfY29weUt1YmVDb25maWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgICByZXR1cm4gY29weUt1YmVDb25maWc7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJkb3dubG9hZEt1YmVDb25maWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvd25sb2FkS3ViZUNvbmZpZygpIHsKICAgICAgdmFyIF90aGlzJG1nbXQyNzsKICAgICAgcmV0dXJuIChfdGhpcyRtZ210MjcgPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQyNyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDI3LmRvd25sb2FkS3ViZUNvbmZpZygpOwogICAgfQogIH0sIHsKICAgIGtleTogImRvd25sb2FkS3ViZUNvbmZpZ0J1bGsiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRvd25sb2FkS3ViZUNvbmZpZ0J1bGsoaXRlbXMpIHsKICAgICAgdmFyIF90aGlzJG1nbXQyODsKICAgICAgcmV0dXJuIChfdGhpcyRtZ210MjggPSB0aGlzLm1nbXQpID09PSBudWxsIHx8IF90aGlzJG1nbXQyOCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkbWdtdDI4LmRvd25sb2FkS3ViZUNvbmZpZ0J1bGsoaXRlbXMpOwogICAgfQogIH0sIHsKICAgIGtleTogInNuYXBzaG90QWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc25hcHNob3RBY3Rpb24gPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU0KCkgewogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDQucHJldiA9IDA7CiAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAzOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLnRha2VTbmFwc2hvdCgpOwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgdGhpcy4kZGlzcGF0Y2goJ2dyb3dsL3N1Y2Nlc3MnLCB7CiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCdjbHVzdGVyLnNuYXBzaG90LnN1Y2Nlc3NUaXRsZScsIHsKICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lRGlzcGxheQogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICBtZXNzYWdlOiB0aGlzLiRyb290R2V0dGVyc1snaTE4bi90J10oJ2NsdXN0ZXIuc25hcHNob3Quc3VjY2Vzc01lc3NhZ2UnLCB7CiAgICAgICAgICAgICAgICAgIG5hbWU6IHRoaXMubmFtZURpc3BsYXkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gOTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF9jb250ZXh0NC5wcmV2ID0gNjsKICAgICAgICAgICAgICBfY29udGV4dDQudDAgPSBfY29udGV4dDRbImNhdGNoIl0oMCk7CiAgICAgICAgICAgICAgdGhpcy4kZGlzcGF0Y2goJ2dyb3dsL2Zyb21FcnJvcicsIHsKICAgICAgICAgICAgICAgIHRpdGxlOiB0aGlzLiRyb290R2V0dGVyc1snaTE4bi90J10oJ2NsdXN0ZXIuc25hcHNob3QuZXJyb3JUaXRsZScsIHsKICAgICAgICAgICAgICAgICAgbmFtZTogdGhpcy5uYW1lRGlzcGxheQogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICBlcnI6IF9jb250ZXh0NC50MAogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzLCBbWzAsIDZdXSk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gc25hcHNob3RBY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIF9zbmFwc2hvdEFjdGlvbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CiAgICAgIHJldHVybiBzbmFwc2hvdEFjdGlvbjsKICAgIH0oKQogIH0sIHsKICAgIGtleTogInNuYXBzaG90QnVsayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3NuYXBzaG90QnVsayA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoaXRlbXMpIHsKICAgICAgICB2YXIgcmVzLCBzdWNjZXNzZnVsLCBpOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDI7CiAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsU2V0dGxlZChpdGVtcy5tYXAoZnVuY3Rpb24gKHJvdykgewogICAgICAgICAgICAgICAgcmV0dXJuIHJvdy50YWtlU25hcHNob3QoKTsKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDUuc2VudDsKICAgICAgICAgICAgICBzdWNjZXNzZnVsID0gcmVzLmZpbHRlcihmdW5jdGlvbiAoeCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHguc3RhdHVzID09PSAnZnVsZmlsbGVkJzsKICAgICAgICAgICAgICB9KS5sZW5ndGg7CiAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3NmdWwpIHsKICAgICAgICAgICAgICAgIHRoaXMuJGRpc3BhdGNoKCdncm93bC9zdWNjZXNzJywgewogICAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCdjbHVzdGVyLnNuYXBzaG90LmJ1bGtTdWNjZXNzVGl0bGUnKSwKICAgICAgICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kcm9vdEdldHRlcnNbJ2kxOG4vdCddKCdjbHVzdGVyLnNuYXBzaG90LmJ1bGtTdWNjZXNzTWVzc2FnZScsIHsKICAgICAgICAgICAgICAgICAgICBjb3VudDogc3VjY2Vzc2Z1bAogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHJlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHJlc1tpXS5zdGF0dXMgIT09ICdmdWxmaWxsZWQnKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJGRpc3BhdGNoKCdncm93bC9mcm9tRXJyb3InLCB7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMuJHJvb3RHZXR0ZXJzWydpMThuL3QnXSgnY2x1c3Rlci5zbmFwc2hvdC5lcnJvclRpdGxlJywgewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogaXRlbXNbaV0ubmFtZURpc3BsYXkKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICBlcnI6IHJlc1tpXS52YWx1ZQogICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcyk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gc25hcHNob3RCdWxrKF94KSB7CiAgICAgICAgcmV0dXJuIF9zbmFwc2hvdEJ1bGsuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgICByZXR1cm4gc25hcHNob3RCdWxrOwogICAgfSgpCiAgfSwgewogICAga2V5OiAidGFrZVNuYXBzaG90IiwKICAgIHZhbHVlOiBmdW5jdGlvbiB0YWtlU25hcHNob3QoKSB7CiAgICAgIGlmICh0aGlzLmlzUmtlMSkgewogICAgICAgIHJldHVybiB0aGlzLiRkaXNwYXRjaCgncmFuY2hlci9yZXF1ZXN0JywgewogICAgICAgICAgdXJsOiAiL3YzL2NsdXN0ZXJzLyIuY29uY2F0KGVzY2FwZSh0aGlzLm1nbXQuaWQpLCAiP2FjdGlvbj1iYWNrdXBFdGNkIiksCiAgICAgICAgICBtZXRob2Q6ICdwb3N0JwogICAgICAgIH0sIHsKICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgX3RoaXMkc3BlYzcsIF90aGlzJHNwZWM4OwogICAgICAgIHZhciBub3cgPSAoKF90aGlzJHNwZWM3ID0gdGhpcy5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjNyA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjNyA9IF90aGlzJHNwZWM3LnJrZUNvbmZpZykgPT09IG51bGwgfHwgX3RoaXMkc3BlYzcgPT09IHZvaWQgMCB8fCAoX3RoaXMkc3BlYzcgPSBfdGhpcyRzcGVjNy5ldGNkU25hcHNob3RDcmVhdGUpID09PSBudWxsIHx8IF90aGlzJHNwZWM3ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjNy5nZW5lcmF0aW9uKSB8fCAwOwogICAgICAgIHZhciBhcmdzID0gewogICAgICAgICAgZ2VuZXJhdGlvbjogbm93ICsgMQogICAgICAgIH07CiAgICAgICAgaWYgKChfdGhpcyRzcGVjOCA9IHRoaXMuc3BlYykgIT09IG51bGwgJiYgX3RoaXMkc3BlYzggIT09IHZvaWQgMCAmJiAoX3RoaXMkc3BlYzggPSBfdGhpcyRzcGVjOC5ya2VDb25maWcpICE9PSBudWxsICYmIF90aGlzJHNwZWM4ICE9PSB2b2lkIDAgJiYgKF90aGlzJHNwZWM4ID0gX3RoaXMkc3BlYzguZXRjZCkgIT09IG51bGwgJiYgX3RoaXMkc3BlYzggIT09IHZvaWQgMCAmJiBfdGhpcyRzcGVjOC5zMykgewogICAgICAgICAgYXJncy5zMyA9IHRoaXMuc3BlYy5ya2VDb25maWcuZXRjZC5zMzsKICAgICAgICB9CiAgICAgICAgc2V0KHRoaXMuc3BlYy5ya2VDb25maWcsICdldGNkU25hcHNob3RDcmVhdGUnLCBhcmdzKTsKICAgICAgICByZXR1cm4gdGhpcy5zYXZlKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJldGNkU25hcHNob3RzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKICAgICAgdmFyIGFsbFNuYXBzaG90cyA9IHRoaXMuJHJvb3RHZXR0ZXJzWydtYW5hZ2VtZW50L2FsbCddKHsKICAgICAgICB0eXBlOiBTTkFQU0hPVAogICAgICB9KTsKICAgICAgcmV0dXJuIGFsbFNuYXBzaG90cy5maWx0ZXIoZnVuY3Rpb24gKHMpIHsKICAgICAgICByZXR1cm4gcy5tZXRhZGF0YS5uYW1lc3BhY2UgPT09IF90aGlzNy5uYW1lc3BhY2UgJiYgcy5jbHVzdGVyTmFtZSA9PT0gX3RoaXM3Lm5hbWU7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInJlc3RvcmVTbmFwc2hvdEFjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdG9yZVNuYXBzaG90QWN0aW9uKCkgewogICAgICB2YXIgcmVzb3VyY2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRoaXM7CiAgICAgIHRoaXMuJGRpc3BhdGNoKCdwcm9tcHRSZXN0b3JlJywgW3Jlc291cmNlXSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2F2ZUFzUktFVGVtcGxhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVBc1JLRVRlbXBsYXRlKCkgewogICAgICB2YXIgY2x1c3RlciA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogdGhpczsKICAgICAgdGhpcy4kZGlzcGF0Y2goJ3Byb21wdE1vZGFsJywgewogICAgICAgIGNvbXBvbmVudFByb3BzOiB7CiAgICAgICAgICBjbHVzdGVyOiBjbHVzdGVyCiAgICAgICAgfSwKICAgICAgICBjb21wb25lbnQ6ICdTYXZlQXNSS0VUZW1wbGF0ZURpYWxvZycKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicm90YXRlQ2VydGlmaWNhdGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByb3RhdGVDZXJ0aWZpY2F0ZXMoKSB7CiAgICAgIHZhciBjbHVzdGVyID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB0aGlzOwogICAgICB0aGlzLiRkaXNwYXRjaCgncHJvbXB0TW9kYWwnLCB7CiAgICAgICAgY29tcG9uZW50UHJvcHM6IHsKICAgICAgICAgIGNsdXN0ZXI6IGNsdXN0ZXIKICAgICAgICB9LAogICAgICAgIGNvbXBvbmVudDogJ1JvdGF0ZUNlcnRpZmljYXRlc0RpYWxvZycKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicm90YXRlRW5jcnlwdGlvbktleSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm90YXRlRW5jcnlwdGlvbktleSgpIHsKICAgICAgdmFyIGNsdXN0ZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHRoaXM7CiAgICAgIHRoaXMuJGRpc3BhdGNoKCdwcm9tcHRNb2RhbCcsIHsKICAgICAgICBjb21wb25lbnRQcm9wczogewogICAgICAgICAgY2x1c3RlcjogY2x1c3RlcgogICAgICAgIH0sCiAgICAgICAgY29tcG9uZW50OiAnUm90YXRlRW5jcnlwdGlvbktleURpYWxvZycKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic3RhdGVPYmoiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB0aGlzLl9zdGF0ZU9iajsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJya2VUZW1wbGF0ZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgdmFyIF90aGlzJG1nbXQkc3BlYywgX3RlbXBsYXRlJHNwZWMsIF9yZXZpc2lvbiRzcGVjOwogICAgICBpZiAoIXRoaXMuaXNSa2UxIHx8ICF0aGlzLm1nbXQpIHsKICAgICAgICAvLyBOb3QgYW4gUktFISBjbHVzdGVyIG9yIG5vIG1hbmFnZW1lbnQgY2x1c3RlciBhdmFpbGFibGUKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYgKCEoKF90aGlzJG1nbXQkc3BlYyA9IHRoaXMubWdtdC5zcGVjKSAhPT0gbnVsbCAmJiBfdGhpcyRtZ210JHNwZWMgIT09IHZvaWQgMCAmJiBfdGhpcyRtZ210JHNwZWMuY2x1c3RlclRlbXBsYXRlUmV2aXNpb25OYW1lKSkgewogICAgICAgIC8vIENsdXN0ZXIgZG9lcyBub3QgdXNlIGFuIFJLRSB0ZW1wbGF0ZQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB2YXIgY2x1c3RlclRlbXBsYXRlTmFtZSA9IHRoaXMubWdtdC5zcGVjLmNsdXN0ZXJUZW1wbGF0ZU5hbWUucmVwbGFjZSgnOicsICcvJyk7CiAgICAgIHZhciBjbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWUgPSB0aGlzLm1nbXQuc3BlYy5jbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWUucmVwbGFjZSgnOicsICcvJyk7CiAgICAgIHZhciB0ZW1wbGF0ZSA9IHRoaXMuJHJvb3RHZXR0ZXJzWydtYW5hZ2VtZW50L2FsbCddKE1BTkFHRU1FTlQuUktFX1RFTVBMQVRFKS5maW5kKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgcmV0dXJuIHQuaWQgPT09IGNsdXN0ZXJUZW1wbGF0ZU5hbWU7CiAgICAgIH0pOwogICAgICB2YXIgcmV2aXNpb24gPSB0aGlzLiRyb290R2V0dGVyc1snbWFuYWdlbWVudC9hbGwnXShNQU5BR0VNRU5ULlJLRV9URU1QTEFURV9SRVZJU0lPTikuZmluZChmdW5jdGlvbiAodCkgewogICAgICAgIHJldHVybiB0LnNwZWMuZW5hYmxlZCAmJiB0LmlkID09PSBjbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWU7CiAgICAgIH0pOwogICAgICBpZiAoIXRlbXBsYXRlIHx8ICFyZXZpc2lvbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gewogICAgICAgIGRpc3BsYXlOYW1lOiAiIi5jb25jYXQoKF90ZW1wbGF0ZSRzcGVjID0gdGVtcGxhdGUuc3BlYykgPT09IG51bGwgfHwgX3RlbXBsYXRlJHNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90ZW1wbGF0ZSRzcGVjLmRpc3BsYXlOYW1lLCAiLyIpLmNvbmNhdCgoX3JldmlzaW9uJHNwZWMgPSByZXZpc2lvbi5zcGVjKSA9PT0gbnVsbCB8fCBfcmV2aXNpb24kc3BlYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3JldmlzaW9uJHNwZWMuZGlzcGxheU5hbWUpLAogICAgICAgIHVwZ3JhZGU6IHRoaXMucmtlVGVtcGxhdGVVcGdyYWRlLAogICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZSwKICAgICAgICByZXZpc2lvbjogcmV2aXNpb24KICAgICAgfTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJya2VUZW1wbGF0ZVVwZ3JhZGUiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHZhciBfdGhpcyRtZ210JHNwZWMyLAogICAgICAgIF90aGlzOCA9IHRoaXMsCiAgICAgICAgX3JldmlzaW9ucyQwJHNwZWM7CiAgICAgIGlmICghdGhpcy5pc1JrZTEgfHwgIXRoaXMubWdtdCkgewogICAgICAgIC8vIE5vdCBhbiBSS0UhIGNsdXN0ZXIgb3Igbm8gbWFuYWdlbWVudCBjbHVzdGVyIGF2YWlsYWJsZQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAoISgoX3RoaXMkbWdtdCRzcGVjMiA9IHRoaXMubWdtdC5zcGVjKSAhPT0gbnVsbCAmJiBfdGhpcyRtZ210JHNwZWMyICE9PSB2b2lkIDAgJiYgX3RoaXMkbWdtdCRzcGVjMi5jbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWUpKSB7CiAgICAgICAgLy8gQ2x1c3RlciBkb2VzIG5vdCB1c2UgYW4gUktFIHRlbXBsYXRlCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBjbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWUgPSB0aGlzLm1nbXQuc3BlYy5jbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWUucmVwbGFjZSgnOicsICcvJyk7CgogICAgICAvLyBHZXQgYWxsIG9mIHRoZSB0ZW1wbGF0ZSByZXZpc2lvbnMgZm9yIHRoaXMgdGVtcGxhdGUKICAgICAgdmFyIHJldmlzaW9ucyA9IHRoaXMuJHJvb3RHZXR0ZXJzWydtYW5hZ2VtZW50L2FsbCddKE1BTkFHRU1FTlQuUktFX1RFTVBMQVRFX1JFVklTSU9OKS5maWx0ZXIoZnVuY3Rpb24gKHQpIHsKICAgICAgICByZXR1cm4gdC5zcGVjLmVuYWJsZWQgJiYgdC5zcGVjLmNsdXN0ZXJUZW1wbGF0ZU5hbWUgPT09IF90aGlzOC5tZ210LnNwZWMuY2x1c3RlclRlbXBsYXRlTmFtZTsKICAgICAgfSk7CiAgICAgIGlmIChyZXZpc2lvbnMubGVuZ3RoIDw9IDEpIHsKICAgICAgICAvLyBPbmx5IG9uZSB0ZW1wbGF0ZSByZXZpc2lvbgogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXZpc2lvbnMuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgIHJldHVybiBwYXJzZUludChhLm1ldGFkYXRhLnJlc291cmNlVmVyc2lvbiwgMTApIC0gcGFyc2VJbnQoYi5tZXRhZGF0YS5yZXNvdXJjZVZlcnNpb24sIDEwKTsKICAgICAgfSkucmV2ZXJzZSgpOwogICAgICByZXR1cm4gcmV2aXNpb25zWzBdLmlkICE9PSBjbHVzdGVyVGVtcGxhdGVSZXZpc2lvbk5hbWUgPyAoX3JldmlzaW9ucyQwJHNwZWMgPSByZXZpc2lvbnNbMF0uc3BlYykgPT09IG51bGwgfHwgX3JldmlzaW9ucyQwJHNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9yZXZpc2lvbnMkMCRzcGVjLmRpc3BsYXlOYW1lIDogZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAiX3N0YXRlT2JqIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkbWV0YWRhdGEzOwogICAgICBpZiAoIXRoaXMuaXNSa2UyKSB7CiAgICAgICAgdmFyIF90aGlzJG1nbXQyOSwgX3RoaXMkbWV0YWRhdGEyOwogICAgICAgIHJldHVybiAoKF90aGlzJG1nbXQyOSA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDI5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZ210Mjkuc3RhdGVPYmopIHx8ICgoX3RoaXMkbWV0YWRhdGEyID0gdGhpcy5tZXRhZGF0YSkgPT09IG51bGwgfHwgX3RoaXMkbWV0YWRhdGEyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZXRhZGF0YTIuc3RhdGUpOwogICAgICB9CiAgICAgIHJldHVybiAoX3RoaXMkbWV0YWRhdGEzID0gdGhpcy5tZXRhZGF0YSkgPT09IG51bGwgfHwgX3RoaXMkbWV0YWRhdGEzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRtZXRhZGF0YTMuc3RhdGU7CiAgICB9CiAgfSwgewogICAga2V5OiAic3VwcG9ydHNXaW5kb3dzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkc3BlYzk7CiAgICAgIGlmICh0aGlzLmlzSzNzIHx8IHRoaXMuaXNJbXBvcnRlZEszcykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAodGhpcy5pc1JrZTEpIHsKICAgICAgICB2YXIgX3RoaXMkbWdtdDMwOwogICAgICAgIHJldHVybiAoKF90aGlzJG1nbXQzMCA9IHRoaXMubWdtdCkgPT09IG51bGwgfHwgX3RoaXMkbWdtdDMwID09PSB2b2lkIDAgfHwgKF90aGlzJG1nbXQzMCA9IF90aGlzJG1nbXQzMC5zcGVjKSA9PT0gbnVsbCB8fCBfdGhpcyRtZ210MzAgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJG1nbXQzMC53aW5kb3dzUHJlZmVyZWRDbHVzdGVyKSB8fCBmYWxzZTsKICAgICAgfQogICAgICBpZiAoIXRoaXMuaXNSa2UyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGlmICghdGhpcy5rdWJlcm5ldGVzVmVyc2lvbiB8fCBjb21wYXJlKHRoaXMua3ViZXJuZXRlc1ZlcnNpb24sICd2MS4yMS4wJykgPCAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciBjbmkgPSAoX3RoaXMkc3BlYzkgPSB0aGlzLnNwZWMpID09PSBudWxsIHx8IF90aGlzJHNwZWM5ID09PSB2b2lkIDAgfHwgKF90aGlzJHNwZWM5ID0gX3RoaXMkc3BlYzkucmtlQ29uZmlnKSA9PT0gbnVsbCB8fCBfdGhpcyRzcGVjOSA9PT0gdm9pZCAwIHx8IChfdGhpcyRzcGVjOSA9IF90aGlzJHNwZWM5Lm1hY2hpbmVHbG9iYWxDb25maWcpID09PSBudWxsIHx8IF90aGlzJHNwZWM5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyRzcGVjOS5jbmk7CiAgICAgIGlmIChjbmkgJiYgY25pICE9PSAnY2FsaWNvJykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjdXN0b21WYWxpZGF0aW9uUnVsZXMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIHBhdGg6ICdtZXRhZGF0YS5uYW1lJywKICAgICAgICB0cmFuc2xhdGlvbktleTogJ2NsdXN0ZXIubmFtZS5sYWJlbCcsCiAgICAgICAgdmFsaWRhdG9yczogWyJjbHVzdGVyTmFtZToiLmNvbmNhdCh0aGlzLmlzUmtlMildLAogICAgICAgIG1heExlbmd0aDogNjMKICAgICAgfV07CiAgICB9CiAgfSwgewogICAga2V5OiAiYWdlbnRDb25maWciLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIC8vIFRoZSBvbmUgd2Ugd2FudCBpcyB0aGUgZmlyc3Qgb25lIHdpdGggbm8gc2VsZWN0b3IuCiAgICAgIC8vIElmIHRoZXJlIGFyZSBtdWx0aXBsZSB3aXRoIG5vIHNlbGVjdG9yLCB0aGF0IHdpbGwgZmFsbCB1bmRlciB0aGUgdW5zdXBwb3J0ZWQgbWVzc2FnZSBiZWxvdy4KICAgICAgcmV0dXJuIHRoaXMuc3BlYy5ya2VDb25maWcubWFjaGluZVNlbGVjdG9yQ29uZmlnLmZpbmQoZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4gIXgubWFjaGluZUxhYmVsU2VsZWN0b3I7CiAgICAgIH0pLmNvbmZpZzsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbG91ZFByb3ZpZGVyIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gdGhpcy5hZ2VudENvbmZpZ1snY2xvdWQtcHJvdmlkZXItbmFtZSddOwogICAgfQogIH0sIHsKICAgIGtleTogImNhbkNsb25lIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVtb3ZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcmVtb3ZlID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICB2YXIgX3RoaXMkc3BlYzEwLCBfcG9vbCRtYWNoaW5lQ29uZmlnUmU7CiAgICAgICAgdmFyIG9wdCwKICAgICAgICAgIHJlcywKICAgICAgICAgIHBvb2wsCiAgICAgICAgICBjbG91ZENyZWRlbnRpYWxTZWNyZXROYW1lLAogICAgICAgICAgY3JlZGVudGlhbCwKICAgICAgICAgIGhhcnZlc3RlckNsdXN0ZXJJZCwKICAgICAgICAgIF9wb29sJG1hY2hpbmVDb25maWdSZTIsCiAgICAgICAgICBfcG9vbCRtYWNoaW5lQ29uZmlnUmUzLAogICAgICAgICAgcG9vbENvbmZpZywKICAgICAgICAgIF9hcmdzNiA9IGFyZ3VtZW50czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgb3B0ID0gX2FyZ3M2Lmxlbmd0aCA+IDAgJiYgX2FyZ3M2WzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczZbMF0gOiB7fTsKICAgICAgICAgICAgICBpZiAoIW9wdC51cmwpIHsKICAgICAgICAgICAgICAgIG9wdC51cmwgPSAodGhpcy5saW5rcyB8fCB7fSlbJ3NlbGYnXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgb3B0Lm1ldGhvZCA9ICdkZWxldGUnOwogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNTsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kZGlzcGF0Y2goJ3JlcXVlc3QnLCBvcHQpOwogICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgcG9vbCA9ICgoKF90aGlzJHNwZWMxMCA9IHRoaXMuc3BlYykgPT09IG51bGwgfHwgX3RoaXMkc3BlYzEwID09PSB2b2lkIDAgfHwgKF90aGlzJHNwZWMxMCA9IF90aGlzJHNwZWMxMC5ya2VDb25maWcpID09PSBudWxsIHx8IF90aGlzJHNwZWMxMCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkc3BlYzEwLm1hY2hpbmVQb29scykgfHwgW10pWzBdOwogICAgICAgICAgICAgIGlmICghKChwb29sID09PSBudWxsIHx8IHBvb2wgPT09IHZvaWQgMCB8fCAoX3Bvb2wkbWFjaGluZUNvbmZpZ1JlID0gcG9vbC5tYWNoaW5lQ29uZmlnUmVmKSA9PT0gbnVsbCB8fCBfcG9vbCRtYWNoaW5lQ29uZmlnUmUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wb29sJG1hY2hpbmVDb25maWdSZS5raW5kKSA9PT0gJ0hhcnZlc3RlckNvbmZpZycpKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNsb3VkQ3JlZGVudGlhbFNlY3JldE5hbWUgPSB0aGlzLnNwZWMuY2xvdWRDcmVkZW50aWFsU2VjcmV0TmFtZTsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDExOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLiRkaXNwYXRjaCgncmFuY2hlci9maW5kQWxsJywgewogICAgICAgICAgICAgICAgdHlwZTogTk9STUFOLkNMT1VEX0NSRURFTlRJQUwKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY3JlZGVudGlhbCA9IHRoaXMuJHJvb3RHZXR0ZXJzWydyYW5jaGVyL2J5SWQnXShOT1JNQU4uQ0xPVURfQ1JFREVOVElBTCwgY2xvdWRDcmVkZW50aWFsU2VjcmV0TmFtZSk7CiAgICAgICAgICAgICAgaWYgKCFjcmVkZW50aWFsKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGhhcnZlc3RlckNsdXN0ZXJJZCA9IGdldChjcmVkZW50aWFsLCAnZGVjb2RlZERhdGEuY2x1c3RlcklkJyk7CiAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAxNDsKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE3OwogICAgICAgICAgICAgIHJldHVybiB0aGlzLiRkaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kJywgewogICAgICAgICAgICAgICAgdHlwZTogIiIuY29uY2F0KENBUEkuTUFDSElORV9DT05GSUdfR1JPVVAsICIuIikuY29uY2F0KCgocG9vbCA9PT0gbnVsbCB8fCBwb29sID09PSB2b2lkIDAgfHwgKF9wb29sJG1hY2hpbmVDb25maWdSZTIgPSBwb29sLm1hY2hpbmVDb25maWdSZWYpID09PSBudWxsIHx8IF9wb29sJG1hY2hpbmVDb25maWdSZTIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wb29sJG1hY2hpbmVDb25maWdSZTIua2luZCkgfHwgJycpLnRvTG93ZXJDYXNlKCkpLAogICAgICAgICAgICAgICAgaWQ6ICIiLmNvbmNhdCh0aGlzLm1ldGFkYXRhLm5hbWVzcGFjZSwgIi8iKS5jb25jYXQocG9vbCA9PT0gbnVsbCB8fCBwb29sID09PSB2b2lkIDAgfHwgKF9wb29sJG1hY2hpbmVDb25maWdSZTMgPSBwb29sLm1hY2hpbmVDb25maWdSZWYpID09PSBudWxsIHx8IF9wb29sJG1hY2hpbmVDb25maWdSZTMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9wb29sJG1hY2hpbmVDb25maWdSZTMubmFtZSkKICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgcG9vbENvbmZpZyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJGRpc3BhdGNoKCdtYW5hZ2VtZW50L3JlcXVlc3QnLCB7CiAgICAgICAgICAgICAgICB1cmw6ICIvazhzL2NsdXN0ZXJzLyIuY29uY2F0KGhhcnZlc3RlckNsdXN0ZXJJZCwgIi92MS9oYXJ2ZXN0ZXIvc2VydmljZWFjY291bnRzLyIpLmNvbmNhdChwb29sQ29uZmlnLnZtTmFtZXNwYWNlLCAiLyIpLmNvbmNhdCh0aGlzLm1ldGFkYXRhLm5hbWUpLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnREVMRVRFJwogICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIHJvb3Q6IHRydWUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI1OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMjI7CiAgICAgICAgICAgICAgX2NvbnRleHQ2LnQwID0gX2NvbnRleHQ2WyJjYXRjaCJdKDE0KTsKICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKF9jb250ZXh0Ni50MCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZQogICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgIGlmICghKChyZXMgPT09IG51bGwgfHwgcmVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiByZXMuX3N0YXR1cykgPT09IDIwNCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjg7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyODsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kZGlzcGF0Y2goJ3dzLnJlc291cmNlLnJlbW92ZScsIHsKICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNiwgdGhpcywgW1sxNCwgMjJdXSk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gcmVtb3ZlKCkgewogICAgICAgIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlbW92ZTsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImhhc0Vycm9yIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgX3RoaXMkc3RhdHVzNDsKICAgICAgcmV0dXJuIChfdGhpcyRzdGF0dXM0ID0gdGhpcy5zdGF0dXMpID09PSBudWxsIHx8IF90aGlzJHN0YXR1czQgPT09IHZvaWQgMCB8fCAoX3RoaXMkc3RhdHVzNCA9IF90aGlzJHN0YXR1czQuY29uZGl0aW9ucykgPT09IG51bGwgfHwgX3RoaXMkc3RhdHVzNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkc3RhdHVzNC5zb21lKGZ1bmN0aW9uIChjb25kaXRpb24pIHsKICAgICAgICByZXR1cm4gY29uZGl0aW9uLmVycm9yID09PSB0cnVlOwogICAgICB9KTsKICAgIH0KICB9XSk7CiAgcmV0dXJuIFByb3ZDbHVzdGVyOwp9KFN0ZXZlTW9kZWwpOwpleHBvcnQgeyBQcm92Q2x1c3RlciBhcyBkZWZhdWx0IH07"},{"version":3,"names":["CAPI","MANAGEMENT","NORMAN","SNAPSHOT","HCI","SteveModel","findBy","get","set","sortBy","ucFirst","compare","AS","MODE","_VIEW","_YAML","HARVESTER_NAME","HARVESTER","CAPI_ANNOTATIONS","ProvCluster","_SteveModel","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","out","label","t","content","provisionerDisplay","machineProvider","machineProviderDisplay","kubernetesVersion","pools","length","desired","filter","x","rkeTemplate","push","formatter","splice","_this$metadata","_this$mgmt","provCreationTimestamp","Date","parse","metadata","creationTimestamp","mgmtCreationTimestamp","mgmt","_this$mgmt2","_get","_getPrototypeOf","prototype","_this$mgmt3","canExplore","isReady","hasError","action","$rootGetters","enabled","_this$mgmt4","_this$mgmt5","_this$mgmt6","_clusterTemplatesSche","_clusterTemplatesSche2","_this$normanCluster","_this$mgmt7","_this$mgmt8","_this$mgmt9","_this$mgmt10","_this$mgmt11","_this$mgmt12","_this$mgmt13","isLocal","remove","findIndex","a","ready","canEditRKE2cluster","isRke2","canUpdate","canSnapshot","isRke1","hasAction","clusterTemplatesSchema","$getters","canUpdateClusterTemplate","resourceMethods","includes","normanClusterSaveTemplateAction","normanCluster","actions","saveAsTemplate","canSaveRKETemplate","status","driver","spec","clusterTemplateName","hasLink","icon","links","shell","bulkAction","bulkable","divider","concat","_this$status","name","clusterName","CLUSTER","value","explore","location","params","cluster","id","currentRouter","_goToHarvesterCluster","_asyncToGenerator","regeneratorRuntime","mark","_callee","harvesterCluster","wrap","_callee$","_context","prev","next","$dispatch","_objectSpread","type","sent","goToCluster","t0","stop","goToHarvesterCluster","goToViewYaml","_this$mgmt14","detailLocation","query","_defineProperty","stateObj","providers","provisioner","_this$spec","rkeConfig","machinePools","_this$pools","isImported","isK3s","_this$mgmt15","provider","startsWith","_this$mgmt16","_this$spec2","_this$mgmt17","rancherKubernetesEngineConfig","_this$mgmt18","isHarvester","_this$mgmt19","_this$id","replace","namespace","_this$status2","_this$mgmt20","_this$mgmt21","eksConfig","nodeGroups","waitForProvisioner","timeout","interval","_this","waitForTestFn","waitForMgmt","_this2","undefined","_this2$status","_pCluster$status","pCluster","RANCHER_CLUSTER","allKeys","Object","keys","configKey","find","k","endsWith","_this$spec3","toLowerCase","isImportedK3s","isImportedRke2","_this$mgmt22","providerLogo","unknown","_this$status3","_this$spec4","fromStatus","version","gitVersion","fromSpec","_this$annotations","_this$mgmt23","fromAnnotation","annotations","UI_CUSTOM_PROVIDER","_this$spec5","kind","machineConfigRef","_this$spec$rkeConfig","machinePoolDefaults","_this$spec$rkeConfig2","hostnameLengthLimit","removeDefaultHostnameLengthLimit","_this$machinePoolDefa","_this$spec6","_this3","NODE","node","mgmtClusterId","_this4","MACHINE","machine","_machine$metadata","_machine$spec","displayName","_this5","deployments","MACHINE_DEPLOYMENT","pool","_pool$spec","NODE_POOL","_this5$status","reduce","acc","pending","outdated","unavailable","_this6","names","nodes","conditions","c","error","map","nodeName","join","machines","_machine$status","_machine$status2","nodeRef","color","textColor","sort","_getOrCreateToken","_callee2","tokens","token","_callee2$","_context2","abrupt","CLUSTER_TOKEN","force","root","update","clusterId","save","getOrCreateToken","openShell","_this$mgmt24","generateKubeConfig","_this$mgmt25","_copyKubeConfig","_callee3","_this$mgmt26","_callee3$","_context3","copyKubeConfig","title","downloadKubeConfig","_this$mgmt27","downloadKubeConfigBulk","items","_this$mgmt28","_snapshotAction","_callee4","_callee4$","_context4","takeSnapshot","nameDisplay","message","err","snapshotAction","_snapshotBulk","_callee5","res","successful","i","_callee5$","_context5","Promise","allSettled","row","count","snapshotBulk","_x","url","escape","method","_this$spec7","_this$spec8","now","etcdSnapshotCreate","generation","args","etcd","s3","_this7","allSnapshots","s","restoreSnapshotAction","resource","saveAsRKETemplate","componentProps","component","rotateCertificates","rotateEncryptionKey","_stateObj","_this$mgmt$spec","_template$spec","_revision$spec","clusterTemplateRevisionName","template","RKE_TEMPLATE","revision","RKE_TEMPLATE_REVISION","upgrade","rkeTemplateUpgrade","_this$mgmt$spec2","_this8","_revisions$0$spec","revisions","b","parseInt","resourceVersion","reverse","_this$metadata3","_this$mgmt29","_this$metadata2","state","_this$spec9","_this$mgmt30","windowsPreferedCluster","cni","machineGlobalConfig","path","translationKey","validators","maxLength","machineSelectorConfig","machineLabelSelector","config","agentConfig","_remove","_callee6","_this$spec10","_pool$machineConfigRe","opt","cloudCredentialSecretName","credential","harvesterClusterId","_pool$machineConfigRe2","_pool$machineConfigRe3","poolConfig","_args6","_callee6$","_context6","CLOUD_CREDENTIAL","MACHINE_CONFIG_GROUP","vmNamespace","console","_status","data","_this$status4","some","condition","default"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/provisioning.cattle.io.cluster.js"],"sourcesContent":["import {\n  CAPI, MANAGEMENT, NORMAN, SNAPSHOT, HCI\n} from '@shell/config/types';\nimport SteveModel from '@shell/plugins/steve/steve-class';\nimport { findBy } from '@shell/utils/array';\nimport { get, set } from '@shell/utils/object';\nimport { sortBy } from '@shell/utils/sort';\nimport { ucFirst } from '@shell/utils/string';\nimport { compare } from '@shell/utils/version';\nimport { AS, MODE, _VIEW, _YAML } from '@shell/config/query-params';\nimport { HARVESTER_NAME as HARVESTER } from '@shell/config/features';\nimport { CAPI as CAPI_ANNOTATIONS } from '@shell/config/labels-annotations';\n\n/**\n * Class representing Cluster resource.\n * @extends SteveModel\n */\nexport default class ProvCluster extends SteveModel {\n  get details() {\n    const out = [\n      {\n        label:   this.t('cluster.detail.provisioner'),\n        content: this.provisionerDisplay || this.t('generic.none'),\n      },\n      {\n        label:   this.t('cluster.detail.machineProvider'),\n        content: this.machineProvider ? this.machineProviderDisplay : null,\n      },\n      {\n        label:   this.t('cluster.detail.kubernetesVersion'),\n        content: this.kubernetesVersion,\n      },\n      {\n        label:   this.t('cluster.detail.machinePools'),\n        content: this.pools.length,\n      },\n      {\n        label:   this.t('cluster.detail.machines'),\n        content: this.desired,\n      },\n    ].filter((x) => !!x.content);\n\n    // RKE Template details\n    const rkeTemplate = this.rkeTemplate;\n\n    if (rkeTemplate) {\n      out.push({\n        label:     this.t('cluster.detail.rkeTemplate'),\n        formatter: 'RKETemplateName',\n        content:   rkeTemplate,\n      });\n    }\n\n    if (!this.machineProvider) {\n      out.splice(1, 1);\n\n      return out;\n    }\n\n    return out;\n  }\n\n  // using this computed because on the provisioning cluster we are\n  // displaying the oldest age between provisioning.cluster and management.cluster\n  // so that on a version upgrade of Rancher (ex: 2.5.x to 2.6.x)\n  // we can have the correct age of the cluster displayed on the UI side\n  get creationTimestamp() {\n    const provCreationTimestamp = Date.parse(this.metadata?.creationTimestamp);\n    const mgmtCreationTimestamp = Date.parse(this.mgmt?.metadata?.creationTimestamp);\n\n    if (mgmtCreationTimestamp && mgmtCreationTimestamp < provCreationTimestamp) {\n      return this.mgmt?.metadata?.creationTimestamp;\n    }\n\n    return super.creationTimestamp;\n  }\n\n  // Models can specify a single action that will be shown as a button in the details masthead\n  get detailsAction() {\n    const canExplore = this.mgmt?.isReady && !this.hasError;\n\n    return {\n      action:  'explore',\n      label:   this.$rootGetters['i18n/t']('cluster.explore'),\n      enabled: canExplore,\n    };\n  }\n\n  get _availableActions() {\n    const out = super._availableActions;\n    const isLocal = this.mgmt?.isLocal;\n\n    // Don't let the user delete the local cluster from the UI\n    if (isLocal) {\n      const remove = out.findIndex((a) => a.action === 'promptRemove');\n\n      if (remove > -1) {\n        out.splice(remove, 1);\n      }\n    }\n    const ready = this.mgmt?.isReady;\n\n    const canEditRKE2cluster = this.isRke2 && ready && this.canUpdate;\n\n    const canSnapshot = ready && ((this.isRke2 && this.canUpdate) || (this.isRke1 && this.mgmt?.hasAction('backupEtcd')));\n\n    const clusterTemplatesSchema = this.$getters['schemaFor']('management.cattle.io.clustertemplate');\n    let canUpdateClusterTemplate = false;\n\n    if (clusterTemplatesSchema && (clusterTemplatesSchema.resourceMethods?.includes('blocked-PUT') || clusterTemplatesSchema.resourceMethods?.includes('PUT'))) {\n      canUpdateClusterTemplate = true;\n    }\n\n    const normanClusterSaveTemplateAction = !!this.normanCluster?.actions?.saveAsTemplate;\n\n    const canSaveRKETemplate = this.isRke1 && this.mgmt?.status?.driver === 'rancherKubernetesEngine' && !this.mgmt?.spec?.clusterTemplateName && this.hasLink('update') && canUpdateClusterTemplate && normanClusterSaveTemplateAction;\n\n    const actions = [\n      // Note: Actions are not supported in the Steve API, so we check\n      // available actions for RKE1 clusters, but not RKE2 clusters.\n      {\n        action:  'openShell',\n        label:   this.$rootGetters['i18n/t']('nav.shell'),\n        icon:    'icon icon-terminal',\n        enabled: !!this.mgmt?.links.shell && ready,\n      }, {\n        action:     'downloadKubeConfig',\n        bulkAction: 'downloadKubeConfigBulk',\n        label:      this.$rootGetters['i18n/t']('nav.kubeconfig.download'),\n        icon:       'icon icon-download',\n        bulkable:   true,\n        enabled:    this.mgmt?.hasAction('generateKubeconfig'),\n      }, {\n        action:   'copyKubeConfig',\n        label:    this.t('cluster.copyConfig'),\n        bulkable: false,\n        enabled:  this.mgmt?.hasAction('generateKubeconfig'),\n        icon:     'icon icon-copy',\n      }, {\n        action:     'snapshotAction',\n        label:      this.$rootGetters['i18n/t']('nav.takeSnapshot'),\n        icon:       'icon icon-snapshot',\n        bulkAction: 'snapshotBulk',\n        bulkable:   true,\n        enabled:    canSnapshot,\n      }, {\n        action:  'restoreSnapshotAction',\n        label:   this.$rootGetters['i18n/t']('nav.restoreSnapshot'),\n        icon:    'icon icon-fw icon-backup-restore',\n        enabled: canSnapshot,\n      }, {\n        action:  'rotateCertificates',\n        label:   this.$rootGetters['i18n/t']('nav.rotateCertificates'),\n        icon:    'icon icon-backup',\n        enabled: canEditRKE2cluster || (this.mgmt?.hasAction('rotateCertificates') && ready),\n      }, {\n        action:  'rotateEncryptionKey',\n        label:   this.$rootGetters['i18n/t']('nav.rotateEncryptionKeys'),\n        icon:    'icon icon-refresh',\n        enabled: canEditRKE2cluster || (this.isRke1 && this.mgmt?.hasAction('rotateEncryptionKey') && ready)\n      }, {\n        action:  'saveAsRKETemplate',\n        label:   this.$rootGetters['i18n/t']('nav.saveAsRKETemplate'),\n        icon:    'icon icon-folder',\n        enabled: canSaveRKETemplate,\n      }, { divider: true }];\n\n    return actions.concat(out);\n  }\n\n  get normanCluster() {\n    const name = this.status?.clusterName;\n\n    if ( !name ) {\n      return null;\n    }\n\n    const out = this.$rootGetters['rancher/byId'](NORMAN.CLUSTER, name);\n\n    return out;\n  }\n\n  explore() {\n    const location = {\n      name:   'c-cluster',\n      params: { cluster: this.mgmt.id }\n    };\n\n    this.currentRouter().push(location);\n  }\n\n  async goToHarvesterCluster() {\n    const harvesterCluster = await this.$dispatch('create', {\n      ...this,\n      type: HCI.CLUSTER\n    });\n\n    try {\n      await harvesterCluster.goToCluster();\n    } catch {\n    }\n  }\n\n  goToViewYaml() {\n    let location;\n\n    if ( !this.isRke2 ) {\n      location = this.mgmt?.detailLocation;\n    }\n\n    if ( !location ) {\n      location = this.detailLocation;\n    }\n\n    location.query = {\n      ...location.query,\n      [MODE]: _VIEW,\n      [AS]:   _YAML\n    };\n\n    this.currentRouter().push(location);\n  }\n\n  get canDelete() {\n    return super.canDelete && this.stateObj.name !== 'removing';\n  }\n\n  get canEditYaml() {\n    if (!this.isRke2) {\n      return false;\n    }\n\n    return super.canEditYaml;\n  }\n\n  get isHostedKubernetesProvider() {\n    const providers = ['AKS', 'EKS', 'GKE'];\n\n    return providers.includes(this.provisioner);\n  }\n\n  get isImported() {\n    // As of Rancher v2.6.7, this returns false for imported K3s clusters,\n    // in which this.provisioner is `k3s`.\n    return this.provisioner === 'imported';\n  }\n\n  get isCustom() {\n    if ( this.isRke2 ) {\n      return !(this.spec?.rkeConfig?.machinePools?.length);\n    }\n\n    if ( this.isRke1 ) {\n      return !this.pools?.length;\n    }\n\n    return false;\n  }\n\n  get confirmRemove() {\n    return true;\n  }\n\n  get isImportedK3s() {\n    // As of Rancher v2.6.7, this returns false for imported K3s clusters,\n    // in which this.provisioner is `k3s`.\n    return this.isImported && this.isK3s;\n  }\n\n  get isImportedRke2() {\n    return this.isImported && this.mgmt?.status?.provider?.startsWith('rke2');\n  }\n\n  get isK3s() {\n    return this.mgmt?.status?.provider === 'k3s';\n  }\n\n  get isRke2() {\n    return !!this.spec?.rkeConfig;\n  }\n\n  get isRke1() {\n    return !!this.mgmt?.spec?.rancherKubernetesEngineConfig;\n  }\n\n  get isHarvester() {\n    return !!this.mgmt?.isHarvester;\n  }\n\n  get mgmtClusterId() {\n    return this.mgmt?.id || this.id?.replace(`${ this.metadata.namespace }/`, '');\n  }\n\n  get mgmt() {\n    const name = this.status?.clusterName;\n\n    if ( !name ) {\n      return null;\n    }\n\n    const out = this.$rootGetters['management/byId'](MANAGEMENT.CLUSTER, name);\n\n    return out;\n  }\n\n  get isReady() {\n    return !!this.mgmt?.isReady;\n  }\n\n  // nodeGroups can be undefined for an EKS cluster that has just been created and has not\n  // had any node groups added to it\n  get eksNodeGroups() {\n    return this.mgmt?.spec?.eksConfig?.nodeGroups || [];\n  }\n\n  waitForProvisioner(timeout, interval) {\n    return this.waitForTestFn(() => {\n      return !!this.provisioner;\n    }, `set provisioner`, timeout, interval);\n  }\n\n  waitForMgmt(timeout = 60000, interval) {\n    return this.waitForTestFn(() => {\n      // `this` instance isn't getting updated with `status.clusterName`\n      // Workaround - Get fresh copy from the store\n      const pCluster = this.$rootGetters['management/byId'](CAPI.RANCHER_CLUSTER, this.id);\n      const name = this.status?.clusterName || pCluster?.status?.clusterName;\n\n      return name && !!this.$rootGetters['management/byId'](MANAGEMENT.CLUSTER, name);\n    }, this.$rootGetters['i18n/t']('cluster.managementTimeout'), timeout, interval);\n  }\n\n  get provisioner() {\n    if ( this.isRke2 ) {\n      const allKeys = Object.keys(this.spec);\n      const configKey = allKeys.find( (k) => k.endsWith('Config'));\n\n      if ( configKey === 'rkeConfig') {\n        return 'rke2';\n      } else if ( configKey ) {\n        return configKey.replace(/config$/i, '');\n      }\n    } else if ( this.mgmt ) {\n      return this.mgmt.provisioner;\n    }\n\n    return null;\n  }\n\n  get provisionerDisplay() {\n    let provisioner = (this.provisioner || '').toLowerCase();\n\n    // RKE provisioner can actually do K3s too...\n    if ( provisioner === 'rke2' && this.spec?.kubernetesVersion?.includes('k3s') ) {\n      provisioner = 'k3s';\n    } else if ( this.isImportedK3s ) {\n      provisioner = 'k3s';\n    } else if ( this.isImportedRke2 ) {\n      provisioner = 'rke2';\n    }\n\n    return this.$rootGetters['i18n/withFallback'](`cluster.provider.\"${ provisioner }\"`, null, ucFirst(provisioner));\n  }\n\n  get providerLogo() {\n    return this.mgmt?.providerLogo;\n  }\n\n  get kubernetesVersion() {\n    const unknown = this.$rootGetters['i18n/t']('generic.unknown');\n\n    if ( this.isRke2 ) {\n      const fromStatus = this.status?.version?.gitVersion;\n      const fromSpec = this.spec?.kubernetesVersion;\n\n      return fromStatus || fromSpec || unknown;\n    } else if ( this.mgmt ) {\n      return this.mgmt.kubernetesVersion || unknown;\n    } else {\n      return unknown;\n    }\n  }\n\n  get machineProvider() {\n    // First check annotation - useful for clusters created by extension providers\n    const fromAnnotation = this.annotations?.[CAPI_ANNOTATIONS.UI_CUSTOM_PROVIDER];\n\n    if (fromAnnotation) {\n      return fromAnnotation;\n    }\n\n    if (this.isHarvester) {\n      return HARVESTER;\n    } else if ( this.isImported ) {\n      return null;\n    } else if ( this.isRke2 ) {\n      const kind = this.spec?.rkeConfig?.machinePools?.[0]?.machineConfigRef?.kind?.toLowerCase();\n\n      if ( kind ) {\n        return kind.replace(/config$/i, '').toLowerCase();\n      }\n\n      return null;\n    } else if ( this.mgmt?.machineProvider ) {\n      return this.mgmt.machineProvider.toLowerCase();\n    }\n\n    return null;\n  }\n\n  get machineProviderDisplay() {\n    if ( this.isImported ) {\n      return null;\n    }\n\n    const provider = (this.machineProvider || '').toLowerCase();\n\n    if ( provider ) {\n      return this.$rootGetters['i18n/withFallback'](`cluster.provider.\"${ provider }\"`, null, provider);\n    } else {\n      return this.$rootGetters['i18n/t']('generic.unknown');\n    }\n  }\n\n  get machinePoolDefaults() {\n    return this.spec.rkeConfig?.machinePoolDefaults;\n  }\n\n  set defaultHostnameLengthLimit(value) {\n    this.spec.rkeConfig = this.spec.rkeConfig || {};\n    this.spec.rkeConfig.machinePoolDefaults = this.spec.rkeConfig.machinePoolDefaults || {};\n    this.spec.rkeConfig.machinePoolDefaults.hostnameLengthLimit = value;\n  }\n\n  get defaultHostnameLengthLimit() {\n    return this.spec.rkeConfig?.machinePoolDefaults?.hostnameLengthLimit;\n  }\n\n  removeDefaultHostnameLengthLimit() {\n    if (this.machinePoolDefaults?.hostnameLengthLimit) {\n      delete this.spec.rkeConfig.machinePoolDefaults.hostnameLengthLimit;\n\n      if (Object.keys(this.spec?.rkeConfig?.machinePoolDefaults).length === 0) {\n        delete this.spec.rkeConfig.machinePoolDefaults;\n      }\n    }\n  }\n\n  get nodes() {\n    return this.$rootGetters['management/all'](MANAGEMENT.NODE).filter((node) => node.id.startsWith(this.mgmtClusterId));\n  }\n\n  get machines() {\n    return this.$rootGetters['management/all'](CAPI.MACHINE).filter((machine) => {\n      if ( machine.metadata?.namespace !== this.metadata.namespace ) {\n        return false;\n      }\n\n      return machine.spec?.clusterName === this.metadata.name;\n    });\n  }\n\n  get displayName() {\n    if ( this.mgmt && !this.isRke2 ) {\n      return this.mgmt.spec.displayName;\n    }\n\n    return null;\n  }\n\n  get pools() {\n    const deployments = this.$rootGetters['management/all'](CAPI.MACHINE_DEPLOYMENT).filter((pool) => pool.spec?.clusterName === this.metadata.name);\n\n    if (!!deployments.length) {\n      return deployments;\n    }\n\n    return this.$rootGetters['management/all'](MANAGEMENT.NODE_POOL).filter((pool) => pool.spec.clusterName === this.status?.clusterName);\n  }\n\n  get desired() {\n    return this.pools.reduce((acc, pool) => acc + (pool.desired || 0), 0);\n  }\n\n  get pending() {\n    return this.pools.reduce((acc, pool) => acc + (pool.pending || 0), 0);\n  }\n\n  get outdated() {\n    return this.pools.reduce((acc, pool) => acc + (pool.outdated || 0), 0);\n  }\n\n  get ready() {\n    return this.pools.reduce((acc, pool) => acc + (pool.ready || 0), 0);\n  }\n\n  get unavailable() {\n    return this.pools.reduce((acc, pool) => acc + (pool.unavailable || 0), 0);\n  }\n\n  get unavailableMachines() {\n    if (this.isReady) {\n      if (this.isRke1) {\n        const names = this.nodes.filter((node) => {\n          return node.status.conditions.find((c) => c.error && c.type === 'Ready');\n        }).map((node) => {\n          const name = node.status.nodeName || node.metadata.name;\n\n          return this.t('cluster.availabilityWarnings.node', { name });\n        });\n\n        return names.join('<br>');\n      } else {\n        const names = this.machines.filter((machine) => {\n          return machine.status?.conditions?.find((c) => c.error && c.type === 'NodeHealthy');\n        }).map((machine) => {\n          if (machine.status?.nodeRef?.name) {\n            return this.t('cluster.availabilityWarnings.node', { name: machine.status.nodeRef.name });\n          }\n\n          return this.t('cluster.availabilityWarnings.machine', { name: machine.metadata.name });\n        });\n\n        return names.join('<br>');\n      }\n    }\n\n    return '';\n  }\n\n  get stateParts() {\n    const out = [\n      {\n        label:     'Pending',\n        color:     'bg-info',\n        textColor: 'text-info',\n        value:     this.pending,\n        sort:      1,\n      },\n      {\n        label:     'Outdated',\n        color:     'bg-warning',\n        textColor: 'text-warning',\n        value:     this.outdated,\n        sort:      2,\n      },\n      {\n        label:     'Unavailable',\n        color:     'bg-error',\n        textColor: 'text-error',\n        value:     this.unavailable,\n        sort:      3,\n      },\n      {\n        label:     'Ready',\n        color:     'bg-success',\n        textColor: 'text-success',\n        value:     this.ready,\n        sort:      4,\n      },\n    ].filter((x) => x.value > 0);\n\n    return sortBy(out, 'sort:desc');\n  }\n\n  async getOrCreateToken() {\n    await this.waitForMgmt();\n\n    if ( !this.mgmt ) {\n      return;\n    }\n\n    const tokens = await this.$dispatch('rancher/findAll', { type: NORMAN.CLUSTER_TOKEN, force: true }, { root: true });\n\n    let token = findBy(tokens, 'clusterId', this.mgmt.id);\n\n    if ( token ) {\n      return token;\n    }\n\n    if ( !this.links.update ) {\n      return;\n    }\n\n    token = await this.$dispatch('rancher/create', {\n      type:      NORMAN.CLUSTER_TOKEN,\n      clusterId: this.mgmt.id\n    }, { root: true });\n\n    return token.save();\n  }\n\n  openShell() {\n    return this.mgmt?.openShell();\n  }\n\n  generateKubeConfig() {\n    return this.mgmt?.generateKubeConfig();\n  }\n\n  async copyKubeConfig() {\n    await this.mgmt?.copyKubeConfig();\n\n    this.$dispatch('growl/success', {\n      title:   this.t('cluster.copiedConfig'),\n      timeout: 3000,\n    }, { root: true });\n  }\n\n  downloadKubeConfig() {\n    return this.mgmt?.downloadKubeConfig();\n  }\n\n  downloadKubeConfigBulk(items) {\n    return this.mgmt?.downloadKubeConfigBulk(items);\n  }\n\n  async snapshotAction() {\n    try {\n      await this.takeSnapshot();\n      this.$dispatch('growl/success', {\n        title:   this.$rootGetters['i18n/t']('cluster.snapshot.successTitle', { name: this.nameDisplay }),\n        message: this.$rootGetters['i18n/t']('cluster.snapshot.successMessage', { name: this.nameDisplay })\n      }, { root: true });\n    } catch (err) {\n      this.$dispatch('growl/fromError', {\n        title: this.$rootGetters['i18n/t']('cluster.snapshot.errorTitle', { name: this.nameDisplay }),\n        err,\n      }, { root: true });\n    }\n  }\n\n  async snapshotBulk(items) {\n    const res = await Promise.allSettled(items.map((row) => {\n      return row.takeSnapshot();\n    }));\n\n    const successful = res.filter( (x) => x.status === 'fulfilled').length;\n\n    if ( successful ) {\n      this.$dispatch('growl/success', {\n        title:   this.$rootGetters['i18n/t']('cluster.snapshot.bulkSuccessTitle'),\n        message: this.$rootGetters['i18n/t']('cluster.snapshot.bulkSuccessMessage', { count: successful })\n      }, { root: true });\n    }\n\n    for ( let i = 0 ; i < res.length ; i++ ) {\n      if ( res[i].status !== 'fulfilled' ) {\n        this.$dispatch('growl/fromError', {\n          title: this.$rootGetters['i18n/t']('cluster.snapshot.errorTitle', { name: items[i].nameDisplay }),\n          err:   res[i].value,\n        }, { root: true });\n      }\n    }\n  }\n\n  takeSnapshot() {\n    if ( this.isRke1 ) {\n      return this.$dispatch('rancher/request', {\n        url:    `/v3/clusters/${ escape(this.mgmt.id) }?action=backupEtcd`,\n        method: 'post',\n      }, { root: true });\n    } else {\n      const now = this.spec?.rkeConfig?.etcdSnapshotCreate?.generation || 0;\n      const args = { generation: now + 1 };\n\n      if ( this.spec?.rkeConfig?.etcd?.s3 ) {\n        args.s3 = this.spec.rkeConfig.etcd.s3;\n      }\n\n      set(this.spec.rkeConfig, 'etcdSnapshotCreate', args);\n\n      return this.save();\n    }\n  }\n\n  get etcdSnapshots() {\n    const allSnapshots = this.$rootGetters['management/all']({ type: SNAPSHOT });\n\n    return allSnapshots\n      .filter((s) => s.metadata.namespace === this.namespace && s.clusterName === this.name );\n  }\n\n  restoreSnapshotAction(resource = this) {\n    this.$dispatch('promptRestore', [resource]);\n  }\n\n  saveAsRKETemplate(cluster = this) {\n    this.$dispatch('promptModal', {\n      componentProps: { cluster },\n      component:      'SaveAsRKETemplateDialog'\n    });\n  }\n\n  rotateCertificates(cluster = this) {\n    this.$dispatch('promptModal', {\n      componentProps: { cluster },\n\n      component: 'RotateCertificatesDialog'\n    });\n  }\n\n  rotateEncryptionKey(cluster = this) {\n    this.$dispatch('promptModal', {\n      componentProps: { cluster },\n      component:      'RotateEncryptionKeyDialog'\n    });\n  }\n\n  get stateObj() {\n    return this._stateObj;\n  }\n\n  get rkeTemplate() {\n    if (!this.isRke1 || !this.mgmt) {\n      // Not an RKE! cluster or no management cluster available\n      return false;\n    }\n\n    if (!this.mgmt.spec?.clusterTemplateRevisionName) {\n      // Cluster does not use an RKE template\n      return false;\n    }\n\n    const clusterTemplateName = this.mgmt.spec.clusterTemplateName.replace(':', '/');\n    const clusterTemplateRevisionName = this.mgmt.spec.clusterTemplateRevisionName.replace(':', '/');\n    const template = this.$rootGetters['management/all'](MANAGEMENT.RKE_TEMPLATE).find((t) => t.id === clusterTemplateName);\n    const revision = this.$rootGetters['management/all'](MANAGEMENT.RKE_TEMPLATE_REVISION).find((t) => t.spec.enabled && t.id === clusterTemplateRevisionName);\n\n    if (!template || !revision) {\n      return false;\n    }\n\n    return {\n      displayName: `${ template.spec?.displayName }/${ revision.spec?.displayName }`,\n      upgrade:     this.rkeTemplateUpgrade,\n      template,\n      revision,\n    };\n  }\n\n  get rkeTemplateUpgrade() {\n    if (!this.isRke1 || !this.mgmt) {\n      // Not an RKE! cluster or no management cluster available\n      return false;\n    }\n\n    if (!this.mgmt.spec?.clusterTemplateRevisionName) {\n      // Cluster does not use an RKE template\n      return false;\n    }\n\n    const clusterTemplateRevisionName = this.mgmt.spec.clusterTemplateRevisionName.replace(':', '/');\n\n    // Get all of the template revisions for this template\n    const revisions = this.$rootGetters['management/all'](MANAGEMENT.RKE_TEMPLATE_REVISION).filter((t) => t.spec.enabled && t.spec.clusterTemplateName === this.mgmt.spec.clusterTemplateName);\n\n    if (revisions.length <= 1) {\n      // Only one template revision\n      return false;\n    }\n\n    revisions.sort((a, b) => {\n      return parseInt(a.metadata.resourceVersion, 10) - parseInt(b.metadata.resourceVersion, 10);\n    }).reverse();\n\n    return revisions[0].id !== clusterTemplateRevisionName ? revisions[0].spec?.displayName : false;\n  }\n\n  get _stateObj() {\n    if (!this.isRke2) {\n      return this.mgmt?.stateObj || this.metadata?.state;\n    }\n\n    return this.metadata?.state;\n  }\n\n  get supportsWindows() {\n    if (this.isK3s || this.isImportedK3s) {\n      return false;\n    }\n\n    if ( this.isRke1 ) {\n      return this.mgmt?.spec?.windowsPreferedCluster || false;\n    }\n\n    if ( !this.isRke2 ) {\n      return false;\n    }\n\n    if ( !this.kubernetesVersion || compare(this.kubernetesVersion, 'v1.21.0') < 0 ) {\n      return false;\n    }\n\n    const cni = this.spec?.rkeConfig?.machineGlobalConfig?.cni;\n\n    if ( cni && cni !== 'calico' ) {\n      return false;\n    }\n\n    return true;\n  }\n\n  get customValidationRules() {\n    return [\n      {\n        path:           'metadata.name',\n        translationKey: 'cluster.name.label',\n        validators:     [`clusterName:${ this.isRke2 }`],\n        maxLength:      63,\n      },\n    ];\n  }\n\n  get agentConfig() {\n    // The one we want is the first one with no selector.\n    // If there are multiple with no selector, that will fall under the unsupported message below.\n    return this.spec.rkeConfig.machineSelectorConfig.find((x) => !x.machineLabelSelector).config;\n  }\n\n  get cloudProvider() {\n    return this.agentConfig['cloud-provider-name'];\n  }\n\n  get canClone() {\n    return false;\n  }\n\n  async remove(opt = {}) {\n    if ( !opt.url ) {\n      opt.url = (this.links || {})['self'];\n    }\n\n    opt.method = 'delete';\n\n    const res = await this.$dispatch('request', opt);\n\n    const pool = (this.spec?.rkeConfig?.machinePools || [])[0];\n\n    if (pool?.machineConfigRef?.kind === 'HarvesterConfig') {\n      const cloudCredentialSecretName = this.spec.cloudCredentialSecretName;\n\n      await this.$dispatch('rancher/findAll', { type: NORMAN.CLOUD_CREDENTIAL }, { root: true });\n\n      const credential = this.$rootGetters['rancher/byId'](NORMAN.CLOUD_CREDENTIAL, cloudCredentialSecretName);\n\n      if (credential) {\n        const harvesterClusterId = get(credential, 'decodedData.clusterId');\n\n        try {\n          const poolConfig = await this.$dispatch('management/find', {\n            type: `${ CAPI.MACHINE_CONFIG_GROUP }.${ (pool?.machineConfigRef?.kind || '').toLowerCase() }`,\n            id:   `${ this.metadata.namespace }/${ pool?.machineConfigRef?.name }`,\n          }, { root: true });\n\n          await this.$dispatch('management/request', {\n            url:    `/k8s/clusters/${ harvesterClusterId }/v1/harvester/serviceaccounts/${ poolConfig.vmNamespace }/${ this.metadata.name }`,\n            method: 'DELETE',\n          }, { root: true });\n        } catch (e) {\n          console.error(e); // eslint-disable-line no-console\n        }\n      }\n    }\n\n    if ( res?._status === 204 ) {\n      await this.$dispatch('ws.resource.remove', { data: this });\n    }\n  }\n\n  get hasError() {\n    return this.status?.conditions?.some((condition) => condition.error === true);\n  }\n}\n"],"mappings":"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"}]}