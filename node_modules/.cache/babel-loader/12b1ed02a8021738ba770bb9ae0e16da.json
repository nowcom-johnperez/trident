{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/install-redirect.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/install-redirect.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfdHlwZW9mIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgeyBSRVBPX1RZUEUsIFJFUE8sIENIQVJULCBWRVJTSU9OIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwpleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAocHJvZHVjdCwgY2hhcnROYW1lLCBkZWZhdWx0UmVzb3VyY2VPclJvdXRlKSB7CiAgdmFyIGluc3RhbGwgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IHRydWU7CiAgcmV0dXJuIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX21pZGRsZXdhcmUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoX3JlZikgewogICAgICB2YXIgX3N0b3JlJGdldHRlcnMkY3VycmVuOwogICAgICB2YXIgcmVkaXJlY3QsIHN0b3JlLCBjbHVzdGVyLCBjaGFydDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgcmVkaXJlY3QgPSBfcmVmLnJlZGlyZWN0LCBzdG9yZSA9IF9yZWYuc3RvcmU7CiAgICAgICAgICAgIGNsdXN0ZXIgPSAoKF9zdG9yZSRnZXR0ZXJzJGN1cnJlbiA9IHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRDbHVzdGVyJ10pID09PSBudWxsIHx8IF9zdG9yZSRnZXR0ZXJzJGN1cnJlbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3N0b3JlJGdldHRlcnMkY3VycmVuLmlkKSB8fCAnbG9jYWwnOwogICAgICAgICAgICBpZiAoIXN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2lzUHJvZHVjdEFjdGl2ZSddKHByb2R1Y3QpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFkZWZhdWx0UmVzb3VyY2VPclJvdXRlKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCEoX3R5cGVvZihkZWZhdWx0UmVzb3VyY2VPclJvdXRlKSA9PT0gJ29iamVjdCcpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVkaXJlY3QoZGVmYXVsdFJlc291cmNlT3JSb3V0ZSkpOwogICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZWRpcmVjdCh7CiAgICAgICAgICAgICAgbmFtZTogJ2MtY2x1c3Rlci1wcm9kdWN0LXJlc291cmNlJywKICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgIGNsdXN0ZXI6IGNsdXN0ZXIsCiAgICAgICAgICAgICAgICBwcm9kdWN0OiBwcm9kdWN0LAogICAgICAgICAgICAgICAgcmVzb3VyY2U6IGRlZmF1bHRSZXNvdXJjZU9yUm91dGUKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgaWYgKCFpbnN0YWxsKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdjYXRhbG9nL2xvYWQnLCB7CiAgICAgICAgICAgICAgZm9yY2U6IHRydWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICBjaGFydCA9IHN0b3JlLmdldHRlcnNbJ2NhdGFsb2cvY2hhcnQnXSh7CiAgICAgICAgICAgICAgY2hhcnROYW1lOiBjaGFydE5hbWUKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGlmICghY2hhcnQpIHsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgcmVkaXJlY3QoewogICAgICAgICAgICAgIG5hbWU6ICdjLWNsdXN0ZXItYXBwcy1jaGFydHMtY2hhcnQnLAogICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgY2x1c3RlcjogY2x1c3RlcgogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgcXVlcnk6IF9kZWZpbmVQcm9wZXJ0eShfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KF9kZWZpbmVQcm9wZXJ0eSh7fSwgUkVQT19UWVBFLCBjaGFydC5yZXBvVHlwZSksIFJFUE8sIGNoYXJ0LnJlcG9OYW1lKSwgQ0hBUlQsIGNoYXJ0LmNoYXJ0TmFtZSksIFZFUlNJT04sIGNoYXJ0LnZlcnNpb25zWzBdLnZlcnNpb24pCiAgICAgICAgICAgIH0pKTsKICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgIC8vIFRoZSBjaGFydCdzIG5vdCBhdmFpbGFibGUKICAgICAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ2xvYWRpbmdFcnJvcicsICJDaGFydCBub3QgZm91bmQgZm9yICIuY29uY2F0KHByb2R1Y3QpKTsKICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCByZWRpcmVjdCh7CiAgICAgICAgICAgICAgbmFtZTogJ2MtY2x1c3Rlci1leHBsb3JlcicsCiAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICBjbHVzdGVyOiBjbHVzdGVyCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSk7CiAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpOwogICAgZnVuY3Rpb24gbWlkZGxld2FyZShfeCkgewogICAgICByZXR1cm4gX21pZGRsZXdhcmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0KICAgIHJldHVybiBtaWRkbGV3YXJlOwogIH0oKTsKfQ=="},{"version":3,"names":["REPO_TYPE","REPO","CHART","VERSION","product","chartName","defaultResourceOrRoute","install","arguments","length","undefined","_middleware","_asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","_store$getters$curren","redirect","store","cluster","chart","wrap","_callee$","_context","prev","next","getters","id","_typeof","abrupt","name","params","resource","dispatch","force","query","_defineProperty","repoType","repoName","versions","version","concat","stop","middleware","_x","apply"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/install-redirect.js"],"sourcesContent":["import { REPO_TYPE, REPO, CHART, VERSION } from '@shell/config/query-params';\n\nexport default function(product, chartName, defaultResourceOrRoute, install = true) {\n  return async function middleware({ redirect, store } ) {\n    const cluster = store.getters['currentCluster']?.id || 'local';\n\n    if ( store.getters['type-map/isProductActive'](product) ) {\n      // If the product is installed and there's a default resource, redirect there\n\n      if ( defaultResourceOrRoute ) {\n        if ( typeof defaultResourceOrRoute === 'object' ) {\n          return redirect(defaultResourceOrRoute);\n        }\n\n        return redirect({\n          name:   'c-cluster-product-resource',\n          params: {\n            cluster,\n            product,\n            resource: defaultResourceOrRoute\n          },\n        });\n      }\n\n      // Otherwise just let the middleware pass through\n    } else if (install) {\n      // The product is not installed, redirect to the details chart\n\n      await store.dispatch('catalog/load', { force: true });\n\n      const chart = store.getters['catalog/chart']({ chartName });\n\n      if ( chart ) {\n        return redirect({\n          name:   'c-cluster-apps-charts-chart',\n          params: { cluster },\n          query:  {\n            [REPO_TYPE]: chart.repoType,\n            [REPO]:      chart.repoName,\n            [CHART]:     chart.chartName,\n            [VERSION]:   chart.versions[0].version\n          },\n        });\n      } else {\n        // The chart's not available\n        store.dispatch('loadingError', `Chart not found for ${ product }`);\n      }\n    } else {\n      return redirect({\n        name:   'c-cluster-explorer',\n        params: { cluster },\n      });\n    }\n  };\n}\n"],"mappings":"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"}]}