{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/workload.service.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/workload.service.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVmbGVjdC5jb25zdHJ1Y3QuanMiOwppbXBvcnQgX2RlZmluZVByb3BlcnR5IGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2dldFByb3RvdHlwZU9mIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gX2dldFByb3RvdHlwZU9mKERlcml2ZWQpLCByZXN1bHQ7IGlmIChoYXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KSB7IHZhciBOZXdUYXJnZXQgPSBfZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7IHJlc3VsdCA9IFJlZmxlY3QuY29uc3RydWN0KFN1cGVyLCBhcmd1bWVudHMsIE5ld1RhcmdldCk7IH0gZWxzZSB7IHJlc3VsdCA9IFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IH0gcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIHJlc3VsdCk7IH07IH0KZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSAidW5kZWZpbmVkIiB8fCAhUmVmbGVjdC5jb25zdHJ1Y3QpIHJldHVybiBmYWxzZTsgaWYgKFJlZmxlY3QuY29uc3RydWN0LnNoYW0pIHJldHVybiBmYWxzZTsgaWYgKHR5cGVvZiBQcm94eSA9PT0gImZ1bmN0aW9uIikgcmV0dXJuIHRydWU7IHRyeSB7IEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLCBbXSwgZnVuY3Rpb24gKCkge30pKTsgcmV0dXJuIHRydWU7IH0gY2F0Y2ggKGUpIHsgcmV0dXJuIGZhbHNlOyB9IH0KaW1wb3J0IHsgZmluZEJ5IH0gZnJvbSAnQHNoZWxsL3V0aWxzL2FycmF5JzsKaW1wb3J0IHsgVEFSR0VUX1dPUktMT0FEUywgVUlfTUFOQUdFRCwgSENJIGFzIEhDSV9MQUJFTFNfQU5OT1RBVElPTlMgfSBmcm9tICdAc2hlbGwvY29uZmlnL2xhYmVscy1hbm5vdGF0aW9ucyc7CmltcG9ydCB7IFdPUktMT0FEX1RZUEVTLCBTRVJWSUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IGNsb25lLCBnZXQgYXMgX2dldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgU3RldmVNb2RlbCBmcm9tICdAc2hlbGwvcGx1Z2lucy9zdGV2ZS9zdGV2ZS1jbGFzcyc7CmltcG9ydCB7IHNob3J0ZW5lZEltYWdlIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CnZhciBXb3JrbG9hZFNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9TdGV2ZU1vZGVsKSB7CiAgX2luaGVyaXRzKFdvcmtsb2FkU2VydmljZSwgX1N0ZXZlTW9kZWwpOwogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoV29ya2xvYWRTZXJ2aWNlKTsKICBmdW5jdGlvbiBXb3JrbG9hZFNlcnZpY2UoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV29ya2xvYWRTZXJ2aWNlKTsKICAgIHJldHVybiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgX2NyZWF0ZUNsYXNzKFdvcmtsb2FkU2VydmljZSwgW3sKICAgIGtleTogImdldFBvcnRzV2l0aFNlcnZpY2VUeXBlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0UG9ydHNXaXRoU2VydmljZVR5cGUgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHBvcnRzLCBjYW5BY2Nlc3NTZXJ2aWNlcywgc2VydmljZXMsIGNsdXN0ZXJJUFNlcnZpY2VQb3J0cywgbG9hZEJhbGFuY2VyU2VydmljZVBvcnRzLCBub2RlUG9ydFNlcnZpY2VQb3J0czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBwb3J0cyA9IFtdOwogICAgICAgICAgICAgIHRoaXMuY29udGFpbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChjb250YWluZXIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBwb3J0cy5wdXNoLmFwcGx5KHBvcnRzLCBfdG9Db25zdW1hYmxlQXJyYXkoY29udGFpbmVyLnBvcnRzIHx8IFtdKSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgKHRoaXMuaW5pdENvbnRhaW5lcnMgfHwgW10pLmZvckVhY2goZnVuY3Rpb24gKGNvbnRhaW5lcikgewogICAgICAgICAgICAgICAgcmV0dXJuIHBvcnRzLnB1c2guYXBwbHkocG9ydHMsIF90b0NvbnN1bWFibGVBcnJheShjb250YWluZXIucG9ydHMgfHwgW10pKTsKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgLy8gT25seSBnZXQgc2VydmljZXMgb3duZWQgaWYgd2UgY2FuIGFjY2VzcyB0aGUgc2VydmljZSByZXNvdXJjZQogICAgICAgICAgICAgIGNhbkFjY2Vzc1NlcnZpY2VzID0gdGhpcy4kZ2V0dGVyc1snc2NoZW1hRm9yJ10oU0VSVklDRSk7CiAgICAgICAgICAgICAgaWYgKCFjYW5BY2Nlc3NTZXJ2aWNlcykgewogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFNlcnZpY2VzT3duZWQoKTsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBbXTsKICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBzZXJ2aWNlcyA9IF9jb250ZXh0LnQwOwogICAgICAgICAgICAgIGNsdXN0ZXJJUFNlcnZpY2VQb3J0cyA9IFtdOwogICAgICAgICAgICAgIGxvYWRCYWxhbmNlclNlcnZpY2VQb3J0cyA9IFtdOwogICAgICAgICAgICAgIG5vZGVQb3J0U2VydmljZVBvcnRzID0gW107CiAgICAgICAgICAgICAgaWYgKHNlcnZpY2VzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgc2VydmljZXMuZm9yRWFjaChmdW5jdGlvbiAoc3ZjKSB7CiAgICAgICAgICAgICAgICAgIHZhciBfc3ZjJHNwZWMsIF9zdmMkc3BlYzIsIF9zdmMkc3BlYzM7CiAgICAgICAgICAgICAgICAgIHN3aXRjaCAoc3ZjLnNwZWMudHlwZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ0NsdXN0ZXJJUCc6CiAgICAgICAgICAgICAgICAgICAgICBjbHVzdGVySVBTZXJ2aWNlUG9ydHMucHVzaC5hcHBseShjbHVzdGVySVBTZXJ2aWNlUG9ydHMsIF90b0NvbnN1bWFibGVBcnJheSgoc3ZjID09PSBudWxsIHx8IHN2YyA9PT0gdm9pZCAwIHx8IChfc3ZjJHNwZWMgPSBzdmMuc3BlYykgPT09IG51bGwgfHwgX3N2YyRzcGVjID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc3ZjJHNwZWMucG9ydHMpIHx8IFtdKSk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdMb2FkQmFsYW5jZXInOgogICAgICAgICAgICAgICAgICAgICAgbG9hZEJhbGFuY2VyU2VydmljZVBvcnRzLnB1c2guYXBwbHkobG9hZEJhbGFuY2VyU2VydmljZVBvcnRzLCBfdG9Db25zdW1hYmxlQXJyYXkoKHN2YyA9PT0gbnVsbCB8fCBzdmMgPT09IHZvaWQgMCB8fCAoX3N2YyRzcGVjMiA9IHN2Yy5zcGVjKSA9PT0gbnVsbCB8fCBfc3ZjJHNwZWMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc3ZjJHNwZWMyLnBvcnRzKSB8fCBbXSkpOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTm9kZVBvcnQnOgogICAgICAgICAgICAgICAgICAgICAgbm9kZVBvcnRTZXJ2aWNlUG9ydHMucHVzaC5hcHBseShub2RlUG9ydFNlcnZpY2VQb3J0cywgX3RvQ29uc3VtYWJsZUFycmF5KChzdmMgPT09IG51bGwgfHwgc3ZjID09PSB2b2lkIDAgfHwgKF9zdmMkc3BlYzMgPSBzdmMuc3BlYykgPT09IG51bGwgfHwgX3N2YyRzcGVjMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3N2YyRzcGVjMy5wb3J0cykgfHwgW10pKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHBvcnRzLmZvckVhY2goZnVuY3Rpb24gKHBvcnQpIHsKICAgICAgICAgICAgICAgIHZhciBuYW1lID0gcG9ydC5uYW1lID8gcG9ydC5uYW1lIDogIiIuY29uY2F0KHBvcnQuY29udGFpbmVyUG9ydCkuY29uY2F0KHBvcnQucHJvdG9jb2wudG9Mb3dlckNhc2UoKSkuY29uY2F0KHBvcnQuaG9zdFBvcnQgfHwgcG9ydC5fbGlzdGVuaW5nUG9ydCB8fCAnJyk7CiAgICAgICAgICAgICAgICBwb3J0Lm5hbWUgPSBuYW1lOwogICAgICAgICAgICAgICAgaWYgKHBvcnQuX3NlcnZpY2VUeXBlICYmIHBvcnQuX3NlcnZpY2VUeXBlICE9PSAnJykgewogICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobG9hZEJhbGFuY2VyU2VydmljZVBvcnRzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICB2YXIgcG9ydFNwZWMgPSBmaW5kQnkobG9hZEJhbGFuY2VyU2VydmljZVBvcnRzLCAnbmFtZScsIG5hbWUpOwogICAgICAgICAgICAgICAgICBpZiAocG9ydFNwZWMpIHsKICAgICAgICAgICAgICAgICAgICBwb3J0Ll9saXN0ZW5pbmdQb3J0ID0gcG9ydFNwZWMucG9ydDsKICAgICAgICAgICAgICAgICAgICBwb3J0Ll9zZXJ2aWNlVHlwZSA9ICdMb2FkQmFsYW5jZXInOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG5vZGVQb3J0U2VydmljZVBvcnRzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICB2YXIgX3BvcnRTcGVjID0gZmluZEJ5KG5vZGVQb3J0U2VydmljZVBvcnRzLCAnbmFtZScsIG5hbWUpOwogICAgICAgICAgICAgICAgICBpZiAoX3BvcnRTcGVjKSB7CiAgICAgICAgICAgICAgICAgICAgcG9ydC5fbGlzdGVuaW5nUG9ydCA9IF9wb3J0U3BlYy5ub2RlUG9ydDsKICAgICAgICAgICAgICAgICAgICBwb3J0Ll9zZXJ2aWNlVHlwZSA9ICdOb2RlUG9ydCc7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoY2x1c3RlcklQU2VydmljZVBvcnRzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBpZiAoZmluZEJ5KGNsdXN0ZXJJUFNlcnZpY2VQb3J0cywgJ25hbWUnLCBuYW1lKSkgewogICAgICAgICAgICAgICAgICAgIHBvcnQuX3NlcnZpY2VUeXBlID0gJ0NsdXN0ZXJJUCc7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBwb3J0cyk7CiAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwogICAgICBmdW5jdGlvbiBnZXRQb3J0c1dpdGhTZXJ2aWNlVHlwZSgpIHsKICAgICAgICByZXR1cm4gX2dldFBvcnRzV2l0aFNlcnZpY2VUeXBlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGdldFBvcnRzV2l0aFNlcnZpY2VUeXBlOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiZ2V0U2VydmljZXNPd25lZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2dldFNlcnZpY2VzT3duZWQgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciBmb3JjZSwKICAgICAgICAgIG5vcm1hblR5cGVzLAogICAgICAgICAgc2VsZWN0b3JLZXksCiAgICAgICAgICBub3JtYW5TZWxlY3RvclZhbHVlLAogICAgICAgICAgc3RldmVTZWxlY3RvclZhbHVlLAogICAgICAgICAgYWxsU3ZjLAogICAgICAgICAgX2FyZ3MyID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICBmb3JjZSA9IF9hcmdzMi5sZW5ndGggPiAwICYmIF9hcmdzMlswXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MyWzBdIDogZmFsc2U7CiAgICAgICAgICAgICAgbm9ybWFuVHlwZXMgPSBfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KF9kZWZpbmVQcm9wZXJ0eShfZGVmaW5lUHJvcGVydHkoe30sIFdPUktMT0FEX1RZUEVTLlJFUExJQ0FfU0VULCAncmVwbGljYVNldCcpLCBXT1JLTE9BRF9UWVBFUy5ERVBMT1lNRU5ULCAnZGVwbG95bWVudCcpLCBXT1JLTE9BRF9UWVBFUy5TVEFURUZVTF9TRVQsICdzdGF0ZWZ1bFNldCcpLCBXT1JLTE9BRF9UWVBFUy5EQUVNT05fU0VULCAnZGFlbW9uU2V0Jyk7CiAgICAgICAgICAgICAgc2VsZWN0b3JLZXkgPSBPYmplY3Qua2V5cyh0aGlzLndvcmtsb2FkU2VsZWN0b3IpWzBdOwogICAgICAgICAgICAgIG5vcm1hblNlbGVjdG9yVmFsdWUgPSAiIi5jb25jYXQobm9ybWFuVHlwZXNbdGhpcy5fdHlwZSA/IHRoaXMuX3R5cGUgOiB0aGlzLnR5cGVdLCAiLSIpLmNvbmNhdCh0aGlzLm1ldGFkYXRhLm5hbWVzcGFjZSwgIi0iKS5jb25jYXQodGhpcy5tZXRhZGF0YS5uYW1lKTsKICAgICAgICAgICAgICBzdGV2ZVNlbGVjdG9yVmFsdWUgPSB0aGlzLndvcmtsb2FkU2VsZWN0b3Jbc2VsZWN0b3JLZXldOwogICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsKICAgICAgICAgICAgICAgIHR5cGU6IFNFUlZJQ0UsCiAgICAgICAgICAgICAgICBvcHQ6IHsKICAgICAgICAgICAgICAgICAgZm9yY2U6IGZvcmNlCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgYWxsU3ZjID0gX2NvbnRleHQyLnNlbnQ7CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIChhbGxTdmMgfHwgW10pLmZpbHRlcihmdW5jdGlvbiAoc3ZjKSB7CiAgICAgICAgICAgICAgICB2YXIgX3N2YyRzcGVjNCwgX3N2YyRzcGVjNTsKICAgICAgICAgICAgICAgIHJldHVybiAoKChfc3ZjJHNwZWM0ID0gc3ZjLnNwZWMpID09PSBudWxsIHx8IF9zdmMkc3BlYzQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdmMkc3BlYzQuc2VsZWN0b3IpIHx8IHt9KVtzZWxlY3RvcktleV0gPT09IHN0ZXZlU2VsZWN0b3JWYWx1ZSB8fCAoKChfc3ZjJHNwZWM1ID0gc3ZjLnNwZWMpID09PSBudWxsIHx8IF9zdmMkc3BlYzUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zdmMkc3BlYzUuc2VsZWN0b3IpIHx8IHt9KVtzZWxlY3RvcktleV0gPT09IG5vcm1hblNlbGVjdG9yVmFsdWU7CiAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CiAgICAgIGZ1bmN0aW9uIGdldFNlcnZpY2VzT3duZWQoKSB7CiAgICAgICAgcmV0dXJuIF9nZXRTZXJ2aWNlc093bmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KICAgICAgcmV0dXJuIGdldFNlcnZpY2VzT3duZWQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJpbWFnZU5hbWVzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICB2YXIgY29udGFpbmVyczsKICAgICAgdmFyIGltYWdlcyA9IFtdOwogICAgICBpZiAodGhpcy50eXBlID09PSBXT1JLTE9BRF9UWVBFUy5DUk9OX0pPQikgewogICAgICAgIGNvbnRhaW5lcnMgPSBfZ2V0KHRoaXMsICdzcGVjLmpvYlRlbXBsYXRlLnNwZWMudGVtcGxhdGUuc3BlYy5jb250YWluZXJzJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVycyA9IF9nZXQodGhpcywgJ3NwZWMudGVtcGxhdGUuc3BlYy5jb250YWluZXJzJyk7CiAgICAgIH0KICAgICAgaWYgKGNvbnRhaW5lcnMpIHsKICAgICAgICBjb250YWluZXJzLmZvckVhY2goZnVuY3Rpb24gKGNvbnRhaW5lcikgewogICAgICAgICAgaWYgKCFpbWFnZXMuaW5jbHVkZXMoY29udGFpbmVyLmltYWdlKSkgewogICAgICAgICAgICBpbWFnZXMucHVzaChjb250YWluZXIuaW1hZ2UpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybiBpbWFnZXMubWFwKHNob3J0ZW5lZEltYWdlKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjb250YWluZXJzIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICBpZiAodGhpcy50eXBlID09PSBXT1JLTE9BRF9UWVBFUy5DUk9OX0pPQikgewogICAgICAgIC8vIGNyb25qb2IgcG9kIHRlbXBsYXRlIGlzIG5lc3RlZCBzbGlnaHRseSBkaWZmZXJlbnQgdGhhbiBvdGhlciB0eXBlcwogICAgICAgIHZhciBfY29udGFpbmVycyA9IHRoaXMuc3BlYy5qb2JUZW1wbGF0ZS5zcGVjLnRlbXBsYXRlLnNwZWMuY29udGFpbmVyczsKICAgICAgICByZXR1cm4gX2NvbnRhaW5lcnM7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc3BlYy5jb250YWluZXJzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy5jb250YWluZXJzOwogICAgICB9CiAgICAgIHZhciBjb250YWluZXJzID0gdGhpcy5zcGVjLnRlbXBsYXRlLnNwZWMuY29udGFpbmVyczsKICAgICAgcmV0dXJuIGNvbnRhaW5lcnM7CiAgICB9CiAgfSwgewogICAga2V5OiAiaW5pdENvbnRhaW5lcnMiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIGlmICh0aGlzLnR5cGUgPT09IFdPUktMT0FEX1RZUEVTLkNST05fSk9CKSB7CiAgICAgICAgLy8gY3JvbmpvYiBwb2QgdGVtcGxhdGUgaXMgbmVzdGVkIHNsaWdodGx5IGRpZmZlcmVudCB0aGFuIG90aGVyIHR5cGVzCiAgICAgICAgdmFyIF9pbml0Q29udGFpbmVycyA9IHRoaXMuc3BlYy5qb2JUZW1wbGF0ZS5zcGVjLnRlbXBsYXRlLnNwZWMuaW5pdENvbnRhaW5lcnM7CiAgICAgICAgcmV0dXJuIF9pbml0Q29udGFpbmVyczsKICAgICAgfQogICAgICBpZiAodGhpcy5zcGVjLmluaXRDb250YWluZXJzKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc3BlYy5pbml0Q29udGFpbmVyczsKICAgICAgfQogICAgICB2YXIgaW5pdENvbnRhaW5lcnMgPSB0aGlzLnNwZWMudGVtcGxhdGUuc3BlYy5pbml0Q29udGFpbmVyczsKICAgICAgcmV0dXJuIGluaXRDb250YWluZXJzOwogICAgfQogIH0sIHsKICAgIGtleTogIndvcmtsb2FkU2VsZWN0b3IiLAogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgJ3dvcmtsb2FkLnVzZXIuY2F0dGxlLmlvL3dvcmtsb2Fkc2VsZWN0b3InOiAiIi5jb25jYXQodGhpcy5fdHlwZSA/IHRoaXMuX3R5cGUgOiB0aGlzLnR5cGUsICItIikuY29uY2F0KHRoaXMubWV0YWRhdGEubmFtZXNwYWNlLCAiLSIpLmNvbmNhdCh0aGlzLm1ldGFkYXRhLm5hbWUpCiAgICAgIH07CiAgICB9CgogICAgLy8gY3JlYXRlIGNsdXN0ZXJpcCwgbm9kZXBvcnQsIGxvYWRiYWxhbmNlciBzZXJ2aWNlcyBmcm9tIGNvbnRhaW5lciBwb3J0IHNwZWMKICB9LCB7CiAgICBrZXk6ICJzZXJ2aWNlc0Zyb21Db250YWluZXJQb3J0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3NlcnZpY2VzRnJvbUNvbnRhaW5lclBvcnRzID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhtb2RlLCBwb3J0cykgewogICAgICAgIHZhciBvd25lclJlZiwgYW5ub3RhdGlvbnMsIGNsdXN0ZXJJUCwgbm9kZVBvcnQsIGxvYWRCYWxhbmNlciwgZXhpc3RpbmcsIHRvU2F2ZSwgdG9SZW1vdmUsIGNsdXN0ZXJJUFByb3h5LCBub2RlUG9ydFByb3h5LCBsb2FkQmFsYW5jZXJQcm94eSwgcG9ydHNXaXRoSXBhbTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgb3duZXJSZWYgPSB7CiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiB0aGlzLmFwaVZlcnNpb24sCiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiB0cnVlLAogICAgICAgICAgICAgICAga2luZDogdGhpcy5raW5kLAogICAgICAgICAgICAgICAgbmFtZTogdGhpcy5tZXRhZGF0YS5uYW1lLAogICAgICAgICAgICAgICAgdWlkOiB0aGlzLm1ldGFkYXRhLnVpZAogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgYW5ub3RhdGlvbnMgPSBfZGVmaW5lUHJvcGVydHkoX2RlZmluZVByb3BlcnR5KHt9LCBUQVJHRVRfV09SS0xPQURTLCBKU09OLnN0cmluZ2lmeShbIiIuY29uY2F0KHRoaXMubWV0YWRhdGEubmFtZXNwYWNlLCAiLyIpLmNvbmNhdCh0aGlzLm1ldGFkYXRhLm5hbWUpXSkpLCBVSV9NQU5BR0VELCAndHJ1ZScpOwogICAgICAgICAgICAgIGNsdXN0ZXJJUCA9IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNFUlZJQ0UsCiAgICAgICAgICAgICAgICBzcGVjOiB7CiAgICAgICAgICAgICAgICAgIHBvcnRzOiBbXSwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHRoaXMud29ya2xvYWRTZWxlY3RvciwKICAgICAgICAgICAgICAgICAgdHlwZTogJ0NsdXN0ZXJJUCcKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBtZXRhZGF0YTogewogICAgICAgICAgICAgICAgICBuYW1lOiB0aGlzLm1ldGFkYXRhLm5hbWUsCiAgICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogdGhpcy5tZXRhZGF0YS5uYW1lc3BhY2UsCiAgICAgICAgICAgICAgICAgIGFubm90YXRpb25zOiBhbm5vdGF0aW9ucywKICAgICAgICAgICAgICAgICAgb3duZXJSZWZlcmVuY2VzOiBbb3duZXJSZWZdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBub2RlUG9ydCA9IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNFUlZJQ0UsCiAgICAgICAgICAgICAgICBzcGVjOiB7CiAgICAgICAgICAgICAgICAgIHBvcnRzOiBbXSwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHRoaXMud29ya2xvYWRTZWxlY3RvciwKICAgICAgICAgICAgICAgICAgdHlwZTogJ05vZGVQb3J0JwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICIiLmNvbmNhdCh0aGlzLm1ldGFkYXRhLm5hbWUsICItbm9kZXBvcnQiKSwKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiB0aGlzLm1ldGFkYXRhLm5hbWVzcGFjZSwKICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbnM6IGFubm90YXRpb25zLAogICAgICAgICAgICAgICAgICBvd25lclJlZmVyZW5jZXM6IFtvd25lclJlZl0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIGxvYWRCYWxhbmNlciA9IHsKICAgICAgICAgICAgICAgIHR5cGU6IFNFUlZJQ0UsCiAgICAgICAgICAgICAgICBzcGVjOiB7CiAgICAgICAgICAgICAgICAgIHBvcnRzOiBbXSwKICAgICAgICAgICAgICAgICAgc2VsZWN0b3I6IHRoaXMud29ya2xvYWRTZWxlY3RvciwKICAgICAgICAgICAgICAgICAgdHlwZTogJ0xvYWRCYWxhbmNlcicsCiAgICAgICAgICAgICAgICAgIGV4dGVybmFsVHJhZmZpY1BvbGljeTogJ0NsdXN0ZXInCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbWV0YWRhdGE6IHsKICAgICAgICAgICAgICAgICAgbmFtZTogIiIuY29uY2F0KHRoaXMubWV0YWRhdGEubmFtZSwgIi1sb2FkYmFsYW5jZXIiKSwKICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiB0aGlzLm1ldGFkYXRhLm5hbWVzcGFjZSwKICAgICAgICAgICAgICAgICAgYW5ub3RhdGlvbnM6IGFubm90YXRpb25zLAogICAgICAgICAgICAgICAgICBvd25lclJlZmVyZW5jZXM6IFtvd25lclJlZl0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNzsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRTZXJ2aWNlc093bmVkKHRoaXMuaXNGcm9tTm9ybWFuKTsKICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgIGV4aXN0aW5nID0gX2NvbnRleHQzLnNlbnQ7CiAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nICYmIGV4aXN0aW5nLmxlbmd0aCkgewogICAgICAgICAgICAgICAgZXhpc3RpbmcuZm9yRWFjaChmdW5jdGlvbiAoc2VydmljZSkgewogICAgICAgICAgICAgICAgICBzd2l0Y2ggKHNlcnZpY2Uuc3BlYy50eXBlKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnQ2x1c3RlcklQJzoKICAgICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJJUCA9IHNlcnZpY2U7CiAgICAgICAgICAgICAgICAgICAgICBjbHVzdGVySVAuc3BlYy5wb3J0cyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTm9kZVBvcnQnOgogICAgICAgICAgICAgICAgICAgICAgbm9kZVBvcnQgPSBzZXJ2aWNlOwogICAgICAgICAgICAgICAgICAgICAgbm9kZVBvcnQuc3BlYy5wb3J0cyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTG9hZEJhbGFuY2VyJzoKICAgICAgICAgICAgICAgICAgICAgIGxvYWRCYWxhbmNlciA9IHNlcnZpY2U7CiAgICAgICAgICAgICAgICAgICAgICBsb2FkQmFsYW5jZXIuc3BlYy5wb3J0cyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcG9ydHMuZm9yRWFjaChmdW5jdGlvbiAocG9ydCkgewogICAgICAgICAgICAgICAgdmFyIHBvcnRTcGVjID0gewogICAgICAgICAgICAgICAgICBuYW1lOiBwb3J0Lm5hbWUsCiAgICAgICAgICAgICAgICAgIHByb3RvY29sOiBwb3J0LnByb3RvY29sLAogICAgICAgICAgICAgICAgICBwb3J0OiBwb3J0LmNvbnRhaW5lclBvcnQsCiAgICAgICAgICAgICAgICAgIHRhcmdldFBvcnQ6IHBvcnQuY29udGFpbmVyUG9ydAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGlmIChwb3J0Ll9zZXJ2aWNlVHlwZSAhPT0gJycpIHsKICAgICAgICAgICAgICAgICAgY2x1c3RlcklQLnNwZWMucG9ydHMucHVzaChwb3J0U3BlYyk7CiAgICAgICAgICAgICAgICAgIHN3aXRjaCAocG9ydC5fc2VydmljZVR5cGUpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICdOb2RlUG9ydCc6CiAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBucFBvcnQgPSBjbG9uZShwb3J0U3BlYyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwb3J0Ll9saXN0ZW5pbmdQb3J0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgbnBQb3J0Lm5vZGVQb3J0ID0gcG9ydC5fbGlzdGVuaW5nUG9ydDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBub2RlUG9ydC5zcGVjLnBvcnRzLnB1c2gobnBQb3J0KTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnTG9hZEJhbGFuY2VyJzoKICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxiUG9ydCA9IGNsb25lKHBvcnRTcGVjKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcnQuX2xpc3RlbmluZ1BvcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBsYlBvcnQucG9ydCA9IHBvcnQuX2xpc3RlbmluZ1BvcnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgbG9hZEJhbGFuY2VyLnNwZWMucG9ydHMucHVzaChsYlBvcnQpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB0b1NhdmUgPSBbXTsKICAgICAgICAgICAgICB0b1JlbW92ZSA9IFtdOwogICAgICAgICAgICAgIGlmICghKGNsdXN0ZXJJUC5zcGVjLnBvcnRzLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDIzOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghY2x1c3RlcklQLmlkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNsdXN0ZXJJUFByb3h5ID0gY2x1c3RlcklQOwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMjA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAxOTsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kZGlzcGF0Y2goImNsdXN0ZXIvY3JlYXRlIiwgY2x1c3RlcklQLCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgY2x1c3RlcklQUHJveHkgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgY2FzZSAyMDoKICAgICAgICAgICAgICB0b1NhdmUucHVzaChjbHVzdGVySVBQcm94eSk7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyNDsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyMzoKICAgICAgICAgICAgICBpZiAoY2x1c3RlcklQLmlkKSB7CiAgICAgICAgICAgICAgICB0b1JlbW92ZS5wdXNoKGNsdXN0ZXJJUCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGlmICghKG5vZGVQb3J0LnNwZWMucG9ydHMubGVuZ3RoID4gMCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gMzU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKCFub2RlUG9ydC5pZCkgewogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAyOTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBub2RlUG9ydFByb3h5ID0gbm9kZVBvcnQ7CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzMjsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDMxOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLiRkaXNwYXRjaCgiY2x1c3Rlci9jcmVhdGUiLCBub2RlUG9ydCwgewogICAgICAgICAgICAgICAgcm9vdDogdHJ1ZQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYXNlIDMxOgogICAgICAgICAgICAgIG5vZGVQb3J0UHJveHkgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgY2FzZSAzMjoKICAgICAgICAgICAgICB0b1NhdmUucHVzaChub2RlUG9ydFByb3h5KTsKICAgICAgICAgICAgICAvLyBpZiBpZCBkZWZpbmVkIGJ1dCBubyBwb3J0cywgdGhlIHNlcnZpY2UgYWxyZWFkeSBleGlzdHMgYnV0IHNob3VsZCBiZSByZW1vdmVkICh1c2VyIGhhcyByZW1vdmVkIGFsbCBjb250YWluZXIgcG9ydHMgbWFwcGluZyB0byBpdCkKICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDM1OgogICAgICAgICAgICAgIGlmIChub2RlUG9ydC5pZCkgewogICAgICAgICAgICAgICAgdG9SZW1vdmUucHVzaChub2RlUG9ydCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlIDM2OgogICAgICAgICAgICAgIGlmICghKGxvYWRCYWxhbmNlci5zcGVjLnBvcnRzLmxlbmd0aCA+IDApKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQ5OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmICghbG9hZEJhbGFuY2VyLmlkKSB7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDQxOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGxvYWRCYWxhbmNlclByb3h5ID0gbG9hZEJhbGFuY2VyOwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNDQ7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNDE6CiAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA0MzsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kZGlzcGF0Y2goImNsdXN0ZXIvY3JlYXRlIiwgbG9hZEJhbGFuY2VyLCB7CiAgICAgICAgICAgICAgICByb290OiB0cnVlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNhc2UgNDM6CiAgICAgICAgICAgICAgbG9hZEJhbGFuY2VyUHJveHkgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgY2FzZSA0NDoKICAgICAgICAgICAgICBwb3J0c1dpdGhJcGFtID0gcG9ydHMuZmlsdGVyKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcC5faXBhbTsKICAgICAgICAgICAgICB9KSB8fCBbXTsKICAgICAgICAgICAgICBpZiAocG9ydHNXaXRoSXBhbS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBsb2FkQmFsYW5jZXJQcm94eS5tZXRhZGF0YS5hbm5vdGF0aW9uc1tIQ0lfTEFCRUxTX0FOTk9UQVRJT05TLkNMT1VEX1BST1ZJREVSX0lQQU1dID0gcG9ydHNXaXRoSXBhbVswXS5faXBhbTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgdG9TYXZlLnB1c2gobG9hZEJhbGFuY2VyUHJveHkpOwogICAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTA7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgNDk6CiAgICAgICAgICAgICAgaWYgKGxvYWRCYWxhbmNlci5pZCkgewogICAgICAgICAgICAgICAgdG9SZW1vdmUucHVzaChsb2FkQmFsYW5jZXIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSA1MDoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgewogICAgICAgICAgICAgICAgdG9TYXZlOiB0b1NhdmUsCiAgICAgICAgICAgICAgICB0b1JlbW92ZTogdG9SZW1vdmUKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgY2FzZSA1MToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMywgdGhpcyk7CiAgICAgIH0pKTsKICAgICAgZnVuY3Rpb24gc2VydmljZXNGcm9tQ29udGFpbmVyUG9ydHMoX3gsIF94MikgewogICAgICAgIHJldHVybiBfc2VydmljZXNGcm9tQ29udGFpbmVyUG9ydHMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQogICAgICByZXR1cm4gc2VydmljZXNGcm9tQ29udGFpbmVyUG9ydHM7CiAgICB9KCkKICB9XSk7CiAgcmV0dXJuIFdvcmtsb2FkU2VydmljZTsKfShTdGV2ZU1vZGVsKTsKZXhwb3J0IHsgV29ya2xvYWRTZXJ2aWNlIGFzIGRlZmF1bHQgfTs="},{"version":3,"names":["findBy","TARGET_WORKLOADS","UI_MANAGED","HCI","HCI_LABELS_ANNOTATIONS","WORKLOAD_TYPES","SERVICE","clone","get","SteveModel","shortenedImage","WorkloadService","_SteveModel","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","_getPortsWithServiceType","_asyncToGenerator","regeneratorRuntime","mark","_callee","ports","canAccessServices","services","clusterIPServicePorts","loadBalancerServicePorts","nodePortServicePorts","wrap","_callee$","_context","prev","next","containers","forEach","container","push","_toConsumableArray","initContainers","$getters","getServicesOwned","t0","sent","length","svc","_svc$spec","_svc$spec2","_svc$spec3","spec","type","port","name","concat","containerPort","protocol","toLowerCase","hostPort","_listeningPort","_serviceType","portSpec","nodePort","abrupt","stop","getPortsWithServiceType","_getServicesOwned","_callee2","force","normanTypes","selectorKey","normanSelectorValue","steveSelectorValue","allSvc","_args2","_callee2$","_context2","undefined","_defineProperty","REPLICA_SET","DEPLOYMENT","STATEFUL_SET","DAEMON_SET","Object","keys","workloadSelector","_type","metadata","namespace","$dispatch","opt","root","filter","_svc$spec4","_svc$spec5","selector","images","CRON_JOB","includes","image","map","jobTemplate","template","_servicesFromContainerPorts","_callee3","mode","ownerRef","annotations","clusterIP","loadBalancer","existing","toSave","toRemove","clusterIPProxy","nodePortProxy","loadBalancerProxy","portsWithIpam","_callee3$","_context3","apiVersion","controller","kind","uid","JSON","stringify","ownerReferences","externalTrafficPolicy","isFromNorman","service","targetPort","npPort","lbPort","id","p","_ipam","CLOUD_PROVIDER_IPAM","servicesFromContainerPorts","_x","_x2","default"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/workload.service.js"],"sourcesContent":["\nimport { findBy } from '@shell/utils/array';\nimport { TARGET_WORKLOADS, UI_MANAGED, HCI as HCI_LABELS_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { WORKLOAD_TYPES, SERVICE } from '@shell/config/types';\nimport { clone, get } from '@shell/utils/object';\nimport SteveModel from '@shell/plugins/steve/steve-class';\nimport { shortenedImage } from '@shell/utils/string';\n\nexport default class WorkloadService extends SteveModel {\n  async getPortsWithServiceType() {\n    const ports = [];\n\n    this.containers.forEach((container) => ports.push(...(container.ports || [])));\n    (this.initContainers || []).forEach((container) => ports.push(...(container.ports || [])));\n\n    // Only get services owned if we can access the service resource\n    const canAccessServices = this.$getters['schemaFor'](SERVICE);\n    const services = canAccessServices ? await this.getServicesOwned() : [];\n    const clusterIPServicePorts = [];\n    const loadBalancerServicePorts = [];\n    const nodePortServicePorts = [];\n\n    if (services.length) {\n      services.forEach((svc) => {\n        switch (svc.spec.type) {\n        case 'ClusterIP':\n          clusterIPServicePorts.push(...(svc?.spec?.ports || []));\n          break;\n        case 'LoadBalancer':\n          loadBalancerServicePorts.push(...(svc?.spec?.ports || []));\n          break;\n        case 'NodePort':\n          nodePortServicePorts.push(...(svc?.spec?.ports || []));\n          break;\n        default:\n          break;\n        }\n      });\n    }\n    ports.forEach((port) => {\n      const name = port.name ? port.name : `${ port.containerPort }${ port.protocol.toLowerCase() }${ port.hostPort || port._listeningPort || '' }`;\n\n      port.name = name;\n\n      if (port._serviceType && port._serviceType !== '') {\n        return;\n      }\n\n      if (loadBalancerServicePorts.length) {\n        const portSpec = findBy(loadBalancerServicePorts, 'name', name);\n\n        if (portSpec) {\n          port._listeningPort = portSpec.port;\n\n          port._serviceType = 'LoadBalancer';\n\n          return;\n        }\n      } if (nodePortServicePorts.length) {\n        const portSpec = findBy(nodePortServicePorts, 'name', name);\n\n        if (portSpec) {\n          port._listeningPort = portSpec.nodePort;\n\n          port._serviceType = 'NodePort';\n\n          return;\n        }\n      } if (clusterIPServicePorts.length) {\n        if (findBy(clusterIPServicePorts, 'name', name)) {\n          port._serviceType = 'ClusterIP';\n        }\n      }\n    });\n\n    return ports;\n  }\n\n  async getServicesOwned(force = false) {\n    const normanTypes = {\n      [WORKLOAD_TYPES.REPLICA_SET]:  'replicaSet',\n      [WORKLOAD_TYPES.DEPLOYMENT]:   'deployment',\n      [WORKLOAD_TYPES.STATEFUL_SET]: 'statefulSet',\n      [WORKLOAD_TYPES.DAEMON_SET]:   'daemonSet',\n    };\n    const selectorKey = Object.keys(this.workloadSelector)[0];\n\n    const normanSelectorValue =\n      `${ normanTypes[this._type ? this._type : this.type] }-${\n        this.metadata.namespace\n      }-${ this.metadata.name }`;\n\n    const steveSelectorValue = this.workloadSelector[selectorKey];\n    const allSvc = await this.$dispatch('cluster/findAll', { type: SERVICE, opt: { force } }, { root: true });\n\n    return (allSvc || []).filter((svc) => (svc.spec?.selector || {})[selectorKey] === steveSelectorValue || (svc.spec?.selector || {})[selectorKey] === normanSelectorValue );\n  }\n\n  get imageNames() {\n    let containers;\n    const images = [];\n\n    if (this.type === WORKLOAD_TYPES.CRON_JOB) {\n      containers = get(this, 'spec.jobTemplate.spec.template.spec.containers');\n    } else {\n      containers = get(this, 'spec.template.spec.containers');\n    }\n    if (containers) {\n      containers.forEach((container) => {\n        if (!images.includes(container.image)) {\n          images.push(container.image);\n        }\n      });\n    }\n\n    return images.map(shortenedImage);\n  }\n\n  get containers() {\n    if (this.type === WORKLOAD_TYPES.CRON_JOB) {\n      // cronjob pod template is nested slightly different than other types\n      const { spec: { jobTemplate: { spec: { template: { spec: { containers } } } } } } = this;\n\n      return containers;\n    }\n\n    if ( this.spec.containers ) {\n      return this.spec.containers;\n    }\n\n    const { spec:{ template:{ spec:{ containers } } } } = this;\n\n    return containers;\n  }\n\n  get initContainers() {\n    if (this.type === WORKLOAD_TYPES.CRON_JOB) {\n      // cronjob pod template is nested slightly different than other types\n      const { spec: { jobTemplate: { spec: { template: { spec: { initContainers } } } } } } = this;\n\n      return initContainers;\n    }\n\n    if (this.spec.initContainers) {\n      return this.spec.initContainers;\n    }\n\n    const { spec:{ template:{ spec:{ initContainers } } } } = this;\n\n    return initContainers;\n  }\n\n  get workloadSelector() {\n    return {\n      'workload.user.cattle.io/workloadselector': `${ this._type ? this._type : this.type }-${\n        this.metadata.namespace\n      }-${ this.metadata.name }`\n    };\n  }\n\n  // create clusterip, nodeport, loadbalancer services from container port spec\n  async servicesFromContainerPorts(mode, ports) {\n    const ownerRef = {\n      apiVersion: this.apiVersion,\n      controller: true,\n      kind:       this.kind,\n      name:       this.metadata.name,\n      uid:        this.metadata.uid\n    };\n\n    const annotations = { [TARGET_WORKLOADS]: JSON.stringify([`${ this.metadata.namespace }/${ this.metadata.name }`]), [UI_MANAGED]: 'true' };\n\n    let clusterIP = {\n      type: SERVICE,\n      spec: {\n        ports:    [],\n        selector: this.workloadSelector,\n        type:     'ClusterIP'\n      },\n      metadata: {\n        name:            this.metadata.name,\n        namespace:       this.metadata.namespace,\n        annotations,\n        ownerReferences: [ownerRef]\n      },\n    };\n\n    let nodePort = {\n      type: SERVICE,\n      spec: {\n        ports:    [],\n        selector: this.workloadSelector,\n        type:     'NodePort'\n      },\n      metadata: {\n        name:            `${ this.metadata.name }-nodeport`,\n        namespace:       this.metadata.namespace,\n        annotations,\n        ownerReferences: [ownerRef]\n      },\n    };\n\n    let loadBalancer = {\n      type: SERVICE,\n      spec: {\n        ports:                 [],\n        selector:              this.workloadSelector,\n        type:                  'LoadBalancer',\n        externalTrafficPolicy: 'Cluster'\n      },\n      metadata: {\n        name:            `${ this.metadata.name }-loadbalancer`,\n        namespace:       this.metadata.namespace,\n        annotations,\n        ownerReferences: [ownerRef]\n      },\n    };\n\n    const existing = await this.getServicesOwned(this.isFromNorman);\n\n    if (existing && existing.length) {\n      existing.forEach((service) => {\n        switch (service.spec.type) {\n        case 'ClusterIP':\n          clusterIP = service;\n          clusterIP.spec.ports = [];\n          break;\n        case 'NodePort':\n          nodePort = service;\n          nodePort.spec.ports = [];\n          break;\n        case 'LoadBalancer':\n          loadBalancer = service;\n          loadBalancer.spec.ports = [];\n          break;\n        default:\n          break;\n        }\n      });\n    }\n    ports.forEach((port) => {\n      const portSpec = {\n        name: port.name, protocol: port.protocol, port: port.containerPort, targetPort: port.containerPort\n      };\n\n      if (port._serviceType !== '') {\n        clusterIP.spec.ports.push(portSpec);\n        switch (port._serviceType) {\n        case 'NodePort': {\n          const npPort = clone(portSpec);\n\n          if (port._listeningPort) {\n            npPort.nodePort = port._listeningPort;\n          }\n          nodePort.spec.ports.push(npPort);\n          break; }\n        case 'LoadBalancer': {\n          const lbPort = clone(portSpec);\n\n          if (port._listeningPort) {\n            lbPort.port = port._listeningPort;\n          }\n          loadBalancer.spec.ports.push(lbPort);\n          break; }\n        default:\n          break;\n        }\n      }\n    });\n\n    const toSave = [];\n    const toRemove = [];\n    let clusterIPProxy;\n\n    if (clusterIP.spec.ports.length > 0) {\n      if (clusterIP.id) {\n        clusterIPProxy = clusterIP;\n      } else {\n        clusterIPProxy = await this.$dispatch(`cluster/create`, clusterIP, { root: true });\n      }\n      toSave.push(clusterIPProxy);\n    } else if (clusterIP.id) {\n      toRemove.push(clusterIP);\n    }\n\n    if (nodePort.spec.ports.length > 0) {\n      let nodePortProxy;\n\n      // if id is defined it's a preexisting service\n      if (nodePort.id) {\n        nodePortProxy = nodePort;\n      } else {\n        nodePortProxy = await this.$dispatch(`cluster/create`, nodePort, { root: true });\n      }\n      toSave.push(nodePortProxy);\n      // if id defined but no ports, the service already exists but should be removed (user has removed all container ports mapping to it)\n    } else if (nodePort.id) {\n      toRemove.push(nodePort);\n    }\n\n    if (loadBalancer.spec.ports.length > 0) {\n      let loadBalancerProxy;\n\n      if (loadBalancer.id) {\n        loadBalancerProxy = loadBalancer;\n      } else {\n        loadBalancerProxy = await this.$dispatch(`cluster/create`, loadBalancer, { root: true });\n      }\n\n      const portsWithIpam = ports.filter((p) => p._ipam) || [];\n\n      if (portsWithIpam.length > 0) {\n        loadBalancerProxy.metadata.annotations[HCI_LABELS_ANNOTATIONS.CLOUD_PROVIDER_IPAM] = portsWithIpam[0]._ipam;\n      }\n\n      toSave.push(loadBalancerProxy);\n    } else if (loadBalancer.id) {\n      toRemove.push(loadBalancer);\n    }\n\n    return { toSave, toRemove };\n  }\n}\n"],"mappings":"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"}]}