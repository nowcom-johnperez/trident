{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/validators/prometheusrule.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/validators/prometheusrule.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0IGhhcyBmcm9tICdsb2Rhc2gvaGFzJzsKaW1wb3J0IGlzRW1wdHkgZnJvbSAnbG9kYXNoL2lzRW1wdHknOwpleHBvcnQgZnVuY3Rpb24gcnVsZUdyb3VwcyhzcGVjLCBnZXR0ZXJzLCBlcnJvcnMsIHZhbGlkYXRvckFyZ3MpIHsKICBpZiAoaXNFbXB0eShzcGVjID09PSBudWxsIHx8IHNwZWMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHNwZWMuZ3JvdXBzKSkgewogICAgZXJyb3JzLnB1c2goZ2V0dGVyc1snaTE4bi90J10oJ3ZhbGlkYXRpb24ucHJvbWV0aGV1c1J1bGUuZ3JvdXBzLnJlcXVpcmVkJykpOwogIH0KICByZXR1cm4gZXJyb3JzOwp9CmV4cG9ydCBmdW5jdGlvbiBncm91cHNBcmVWYWxpZCgpIHsKICB2YXIgZ3JvdXBzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTsKICB2YXIgZ2V0dGVycyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogIHZhciBlcnJvcnMgPSBhcmd1bWVudHMubGVuZ3RoID4gMiA/IGFyZ3VtZW50c1syXSA6IHVuZGVmaW5lZDsKICB2YXIgdmFsaWRhdG9yQXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwogIGdyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uIChncm91cCwgZ3JvdXBJbmRleCkgewogICAgdmFyIHJlYWRhYmxlR3JvdXBJbmRleCA9IGdyb3VwSW5kZXggKyAxOyAvLyBvaCB0aGF0IG9sIHplcm8gYmFzZWQgYXJyYXkgaW5kZXguLi4uCgogICAgaWYgKGlzRW1wdHkoZ3JvdXAgPT09IG51bGwgfHwgZ3JvdXAgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdyb3VwLm5hbWUpKSB7CiAgICAgIGVycm9ycy5wdXNoKGdldHRlcnNbJ2kxOG4vdCddKCd2YWxpZGF0aW9uLnByb21ldGhldXNSdWxlLmdyb3Vwcy52YWxpZC5uYW1lJywgewogICAgICAgIGluZGV4OiByZWFkYWJsZUdyb3VwSW5kZXgKICAgICAgfSkpOwogICAgfQogICAgaWYgKGlzRW1wdHkoZ3JvdXAgPT09IG51bGwgfHwgZ3JvdXAgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGdyb3VwLnJ1bGVzKSkgewogICAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5wcm9tZXRoZXVzUnVsZS5ncm91cHMudmFsaWQuc2luZ2xlRW50cnknLCB7CiAgICAgICAgaW5kZXg6IHJlYWRhYmxlR3JvdXBJbmRleAogICAgICB9KSk7CiAgICB9IGVsc2UgewogICAgICBncm91cC5ydWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChydWxlLCBydWxlSW5kZXgpIHsKICAgICAgICB2YXIgcmVhZGFibGVSdWxlSW5kZXggPSBydWxlSW5kZXggKyAxOyAvLyBvaCB0aGF0IG9sIHplcm8gYmFzZWQgYXJyYXkgaW5kZXguLi4uCgogICAgICAgIGlmIChoYXMocnVsZSwgJ2FsZXJ0JykgJiYgaXNFbXB0eShydWxlID09PSBudWxsIHx8IHJ1bGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHJ1bGUuYWxlcnQpKSB7CiAgICAgICAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5wcm9tZXRoZXVzUnVsZS5ncm91cHMudmFsaWQucnVsZS5hbGVydE5hbWUnLCB7CiAgICAgICAgICAgIGdyb3VwSW5kZXg6IHJlYWRhYmxlR3JvdXBJbmRleCwKICAgICAgICAgICAgcnVsZUluZGV4OiByZWFkYWJsZVJ1bGVJbmRleAogICAgICAgICAgfSkpOwogICAgICAgIH0gZWxzZSBpZiAoaGFzKHJ1bGUsICdyZWNvcmQnKSAmJiBpc0VtcHR5KHJ1bGUgPT09IG51bGwgfHwgcnVsZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogcnVsZS5yZWNvcmQpKSB7CiAgICAgICAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5wcm9tZXRoZXVzUnVsZS5ncm91cHMudmFsaWQucnVsZS5yZWNvcmROYW1lJywgewogICAgICAgICAgICBncm91cEluZGV4OiByZWFkYWJsZUdyb3VwSW5kZXgsCiAgICAgICAgICAgIHJ1bGVJbmRleDogcmVhZGFibGVSdWxlSW5kZXgKICAgICAgICAgIH0pKTsKICAgICAgICB9CiAgICAgICAgaWYgKGhhcyhydWxlLCAnZXhwcicpICYmIGlzRW1wdHkocnVsZS5leHByKSB8fCAhaGFzKHJ1bGUsICdleHByJykpIHsKICAgICAgICAgIGVycm9ycy5wdXNoKGdldHRlcnNbJ2kxOG4vdCddKCd2YWxpZGF0aW9uLnByb21ldGhldXNSdWxlLmdyb3Vwcy52YWxpZC5ydWxlLmV4cHInLCB7CiAgICAgICAgICAgIGdyb3VwSW5kZXg6IHJlYWRhYmxlR3JvdXBJbmRleCwKICAgICAgICAgICAgcnVsZUluZGV4OiByZWFkYWJsZVJ1bGVJbmRleAogICAgICAgICAgfSkpOwogICAgICAgIH0KICAgICAgICBpZiAoaGFzKHJ1bGUsICdhbGVydCcpKSB7CiAgICAgICAgICBpZiAoaGFzKHJ1bGUsICdsYWJlbHMnKSAmJiBpc0VtcHR5KHJ1bGUubGFiZWxzKSB8fCAhaGFzKHJ1bGUsICdsYWJlbHMnKSkgewogICAgICAgICAgICBlcnJvcnMucHVzaChnZXR0ZXJzWydpMThuL3QnXSgndmFsaWRhdGlvbi5wcm9tZXRoZXVzUnVsZS5ncm91cHMudmFsaWQucnVsZS5sYWJlbHMnLCB7CiAgICAgICAgICAgICAgZ3JvdXBJbmRleDogcmVhZGFibGVHcm91cEluZGV4LAogICAgICAgICAgICAgIHJ1bGVJbmRleDogcmVhZGFibGVSdWxlSW5kZXgKICAgICAgICAgICAgfSkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIGVycm9yczsKfQ=="},{"version":3,"names":["has","isEmpty","ruleGroups","spec","getters","errors","validatorArgs","groups","push","groupsAreValid","arguments","length","undefined","forEach","group","groupIndex","readableGroupIndex","name","index","rules","rule","ruleIndex","readableRuleIndex","alert","record","expr","labels"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/validators/prometheusrule.js"],"sourcesContent":["import has from 'lodash/has';\nimport isEmpty from 'lodash/isEmpty';\n\nexport function ruleGroups(spec, getters, errors, validatorArgs) {\n  if (isEmpty(spec?.groups)) {\n    errors.push(getters['i18n/t']('validation.prometheusRule.groups.required'));\n  }\n\n  return errors;\n}\n\nexport function groupsAreValid(groups = [], getters, errors, validatorArgs) {\n  groups.forEach((group, groupIndex) => {\n    const readableGroupIndex = groupIndex + 1; // oh that ol zero based array index....\n\n    if (isEmpty(group?.name)) {\n      errors.push(\n        getters['i18n/t']('validation.prometheusRule.groups.valid.name', { index: readableGroupIndex })\n      );\n    }\n\n    if (isEmpty(group?.rules)) {\n      errors.push(\n        getters['i18n/t'](\n          'validation.prometheusRule.groups.valid.singleEntry',\n          { index: readableGroupIndex }\n        )\n      );\n    } else {\n      group.rules.forEach((rule, ruleIndex) => {\n        const readableRuleIndex = ruleIndex + 1; // oh that ol zero based array index....\n\n        if (has(rule, 'alert') && isEmpty(rule?.alert)) {\n          errors.push(\n            getters['i18n/t'](\n              'validation.prometheusRule.groups.valid.rule.alertName',\n              { groupIndex: readableGroupIndex, ruleIndex: readableRuleIndex }\n            )\n          );\n        } else if (has(rule, 'record') && isEmpty(rule?.record)) {\n          errors.push(\n            getters['i18n/t'](\n              'validation.prometheusRule.groups.valid.rule.recordName',\n              { groupIndex: readableGroupIndex, ruleIndex: readableRuleIndex }\n            )\n          );\n        }\n\n        if ((has(rule, 'expr') && isEmpty(rule.expr)) || !has(rule, 'expr')) {\n          errors.push(\n            getters['i18n/t'](\n              'validation.prometheusRule.groups.valid.rule.expr',\n              { groupIndex: readableGroupIndex, ruleIndex: readableRuleIndex }\n            )\n          );\n        }\n\n        if (has(rule, 'alert')) {\n          if (\n            (has(rule, 'labels') && isEmpty(rule.labels)) ||\n            !has(rule, 'labels')\n          ) {\n            errors.push(\n              getters['i18n/t'](\n                'validation.prometheusRule.groups.valid.rule.labels',\n                { groupIndex: readableGroupIndex, ruleIndex: readableRuleIndex }\n              )\n            );\n          }\n        }\n      });\n    }\n  });\n\n  return errors;\n}\n"],"mappings":"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"}]}