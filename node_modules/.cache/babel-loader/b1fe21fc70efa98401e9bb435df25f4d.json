{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--17-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js??ref--17-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/gc/gc-route-changed.ts","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/gc/gc-route-changed.ts","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js","mtime":1716430466133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoLmpzIjsKaW1wb3J0IGdjIGZyb20gJy4vZ2MnOwpmdW5jdGlvbiBnZXRSZXNvdXJjZUZyb21Sb3V0ZSh0bykgewogIHZhciBfYSwgX2I7CiAgdmFyIHJlc291cmNlID0gKF9hID0gdG8ucGFyYW1zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVzb3VyY2U7CiAgaWYgKCFyZXNvdXJjZSkgewogICAgdmFyIG1hdGNoID0gKF9iID0gdG8ubmFtZSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm1hdGNoKC9eYy1jbHVzdGVyLShbXi1dKykvKTsKICAgIGlmIChtYXRjaCkgewogICAgICByZXNvdXJjZSA9IG1hdGNoWzJdOwogICAgfQogIH0KICByZXR1cm4gcmVzb3VyY2U7Cn0KLyoqCiAqIEhhbmRsZSBHQyBvbiByb3V0ZSBjaGFuZ2UgKGdpdmVuIHNldHRpbmdzIHRoaXMgbWlnaHQgYmUgYSBuby1vcCkKICovCnZhciBHYXJiYWdlQ29sbGVjdFJvdXRlQ2hhbmdlZCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQpOwogIH0KICBfY3JlYXRlQ2xhc3MoR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQsIFt7CiAgICBrZXk6ICJnY1JvdXRlQ2hhbmdlZCIsCiAgICB2YWx1ZToKICAgIC8qKgogICAgICogQSBsb2dnZWQgaW4gcm91dGUgaGFzIGNoYW5nZWQKICAgICAqIDEpIFRyYWNrIHRoZSB0aW1lIHRoaXMgb2NjdXJyZWQgdG8gZW5zdXJlIGFueSByZXNvdXJjZXMgZmV0Y2hlZCBhZnRlcndhcmRzIGFyZSBub3QgR0NkCiAgICAgKiAyKSBLaWNrIG9mZiBhIEdDCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdjUm91dGVDaGFuZ2VkKGN0eCwgdG8pIHsKICAgICAgZ2MuZ2NVcGRhdGVSb3V0ZUNoYW5nZWQoKTsKICAgICAgLy8gY29tbWl0KGBnY1JvdXRlQ2hhbmdlZGApOwogICAgICBpZiAoIWdjLmdjRW5hYmxlZFNldHRpbmcoY3R4KSB8fCAhZ2MuZ2NFbmFibGVkUm91dGUoY3R4KSB8fCB0by5uYW1lID09PSAnYXV0aC1sb2dvdXQnKSB7CiAgICAgICAgLy8gKGF1dGgtbG9nb3V0IGNvbnZlbmllbmNlLCBubyBwb2ludCBHQydpbmcgaWYgd2UndmUganVzdCBsb3N0IGFsbCB0eXBlcykKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHJlc291cmNlID0gZ2V0UmVzb3VyY2VGcm9tUm91dGUodG8pOwogICAgICB2YXIgaWdub3JlVFlwZXMgPSAhIXJlc291cmNlID8gX2RlZmluZVByb3BlcnR5KHt9LCByZXNvdXJjZSwgdHJ1ZSkgOiB7fTsKICAgICAgY3R4LmRpc3BhdGNoKCdnYXJiYWdlQ29sbGVjdCcsIGlnbm9yZVRZcGVzKTsgLy8gZ2MuZ2FyYmFnZUNvbGxlY3QgaXMgcGVyIHN0b3JlLCBzbyBkaXNwYXRjaCB2aWEgY2VudHJhbCBwb2ludAogICAgfQogIH1dKTsKICByZXR1cm4gR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQ7Cn0oKTsKdmFyIGdjcmMgPSBuZXcgR2FyYmFnZUNvbGxlY3RSb3V0ZUNoYW5nZWQoKTsKZXhwb3J0IGRlZmF1bHQgZ2NyYzs="},{"version":3,"names":["gc","getResourceFromRoute","to","resource","_a","params","match","_b","name","GarbageCollectRouteChanged","_classCallCheck","_createClass","key","value","gcRouteChanged","ctx","gcUpdateRouteChanged","gcEnabledSetting","gcEnabledRoute","ignoreTYpes","_defineProperty","dispatch","gcrc"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/gc/gc-route-changed.ts"],"sourcesContent":["import gc from './gc';\n\nfunction getResourceFromRoute(to: any) {\n  let resource = to.params?.resource;\n\n  if ( !resource ) {\n    const match = to.name?.match(/^c-cluster-([^-]+)/);\n\n    if ( match ) {\n      resource = match[2];\n    }\n  }\n\n  return resource;\n}\n\n/**\n * Handle GC on route change (given settings this might be a no-op)\n */\nclass GarbageCollectRouteChanged {\n  /**\n   * A logged in route has changed\n   * 1) Track the time this occurred to ensure any resources fetched afterwards are not GCd\n   * 2) Kick off a GC\n   */\n  gcRouteChanged(ctx: any, to: any) {\n    gc.gcUpdateRouteChanged();\n    // commit(`gcRouteChanged`);\n\n    if (!gc.gcEnabledSetting(ctx) || !gc.gcEnabledRoute(ctx) || to.name === 'auth-logout') {\n      // (auth-logout convenience, no point GC'ing if we've just lost all types)\n      return;\n    }\n\n    const resource = getResourceFromRoute(to);\n    const ignoreTYpes = !!resource ? { [resource]: true } : {};\n\n    ctx.dispatch('garbageCollect', ignoreTYpes); // gc.garbageCollect is per store, so dispatch via central point\n  }\n}\n\nconst gcrc = new GarbageCollectRouteChanged();\n\nexport default gcrc;\n"],"mappings":";;;;;;AAAA,OAAOA,EAAE,MAAM,MAAM;AAErB,SAASC,oBAAoBA,CAACC,EAAO;;EACnC,IAAIC,QAAQ,IAAAC,EAAA,GAAGF,EAAE,CAACG,MAAM,cAAAD,EAAA,uBAAAA,EAAA,CAAED,QAAQ;EAElC,IAAK,CAACA,QAAQ,EAAG;IACf,IAAMG,KAAK,IAAAC,EAAA,GAAGL,EAAE,CAACM,IAAI,cAAAD,EAAA,uBAAAA,EAAA,CAAED,KAAK,CAAC,oBAAoB,CAAC;IAElD,IAAKA,KAAK,EAAG;MACXH,QAAQ,GAAGG,KAAK,CAAC,CAAC,CAAC;;;EAIvB,OAAOH,QAAQ;AACjB;AAEA;;;AAAA,IAGMM,0BAA0B;EAAA,SAAAA,2BAAA;IAAAC,eAAA,OAAAD,0BAAA;EAAA;EAAAE,YAAA,CAAAF,0BAAA;IAAAG,GAAA;IAAAC,KAAA;IAC9B;;;;;IAKA,SAAAC,eAAeC,GAAQ,EAAEb,EAAO;MAC9BF,EAAE,CAACgB,oBAAoB,EAAE;MACzB;MAEA,IAAI,CAAChB,EAAE,CAACiB,gBAAgB,CAACF,GAAG,CAAC,IAAI,CAACf,EAAE,CAACkB,cAAc,CAACH,GAAG,CAAC,IAAIb,EAAE,CAACM,IAAI,KAAK,aAAa,EAAE;QACrF;QACA;;MAGF,IAAML,QAAQ,GAAGF,oBAAoB,CAACC,EAAE,CAAC;MACzC,IAAMiB,WAAW,GAAG,CAAC,CAAChB,QAAQ,GAAAiB,eAAA,KAAMjB,QAAQ,EAAG,IAAI,IAAK,EAAE;MAE1DY,GAAG,CAACM,QAAQ,CAAC,gBAAgB,EAAEF,WAAW,CAAC,CAAC,CAAC;IAC/C;EAAC;EAAA,OAAAV,0BAAA;AAAA;AAGH,IAAMa,IAAI,GAAG,IAAIb,0BAA0B,EAAE;AAE7C,eAAea,IAAI"}]}