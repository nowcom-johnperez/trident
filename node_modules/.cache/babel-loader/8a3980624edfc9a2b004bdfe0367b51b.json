{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/monitoring/steps/uninstall-v1.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/monitoring/steps/uninstall-v1.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wcm9taXNlLmpzIjsKaW1wb3J0IHsgaGF2ZVYxTW9uaXRvcmluZywgaGF2ZVYxTW9uaXRvcmluZ1dvcmtsb2FkcyB9IGZyb20gJ0BzaGVsbC91dGlscy9tb25pdG9yaW5nJzsKaW1wb3J0IEFzeW5jQnV0dG9uIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0FzeW5jQnV0dG9uJzsKaW1wb3J0IEljb25NZXNzYWdlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0ljb25NZXNzYWdlJzsKZnVuY3Rpb24gZGVsYXkodCwgdikgewogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgc2V0VGltZW91dChyZXNvbHZlLmJpbmQobnVsbCwgdiksIHQpOwogIH0pOwp9CmV4cG9ydCBkZWZhdWx0IHsKICBsYWJlbDogJ21vbml0b3JpbmcuaW5zdGFsbFN0ZXBzLnVuaW5zdGFsbFYxLnN0ZXBUaXRsZScsCiAgc3VidGV4dDogJ21vbml0b3JpbmcuaW5zdGFsbFN0ZXBzLnVuaW5zdGFsbFYxLnN0ZXBTdWJ0ZXh0JywKICB3ZWlnaHQ6IDEwMCwKICBjb21wb25lbnRzOiB7CiAgICBBc3luY0J1dHRvbjogQXN5bmNCdXR0b24sCiAgICBJY29uTWVzc2FnZTogSWNvbk1lc3NhZ2UKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBoYXZlVjFNb25pdG9yaW5nOiBmYWxzZSwKICAgICAgZXJyb3I6IG51bGwKICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5oYXZlVjFNb25pdG9yaW5nID0gaGF2ZVYxTW9uaXRvcmluZyh0aGlzLiRzdG9yZS5nZXR0ZXJzKTsKICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZScsIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIHJlYWR5OiBmYWxzZSwKICAgICAgaGlkZGVuOiAhdGhpcy5oYXZlVjFNb25pdG9yaW5nCiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHVuaW5zdGFsbDogZnVuY3Rpb24gdW5pbnN0YWxsKGJ1dHRvbkNiKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL3Byb21wdE1vZGFsJywgewogICAgICAgIGNvbXBvbmVudDogJ0dlbmVyaWNQcm9tcHQnLAogICAgICAgIGNvbXBvbmVudFByb3BzOiB7CiAgICAgICAgICBhcHBseU1vZGU6ICd1bmluc3RhbGwnLAogICAgICAgICAgYXBwbHlBY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIF9hcHBseUFjdGlvbiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShidXR0b25Eb25lKSB7CiAgICAgICAgICAgICAgdmFyIGluZGV4LCBoYXNWMU1vbml0b3JpbmcsIGhhc1YxTW9uaXRvcmluZ1dvcmtsb2FkczsKICAgICAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgICAgIHdoaWxlICgxKSBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuJHN0b3JlLmdldHRlcnNbJ2N1cnJlbnRDbHVzdGVyJ10uZG9BY3Rpb24oJ2Rpc2FibGVNb25pdG9yaW5nJyk7CiAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7CiAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICBpZiAoIShpbmRleCA8IDMwKSkgewogICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8vIFdhaXQgMzAgc2Vjb25kcyBmb3IgdGhlIGNvbnRhaW5lcnMgdG8gZ28KICAgICAgICAgICAgICAgICAgICBoYXNWMU1vbml0b3JpbmcgPSBoYXZlVjFNb25pdG9yaW5nKF90aGlzLiRzdG9yZS5nZXR0ZXJzKTsKICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaGF2ZVYxTW9uaXRvcmluZ1dvcmtsb2FkcyhfdGhpcy4kc3RvcmUpOwogICAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgICAgaGFzVjFNb25pdG9yaW5nV29ya2xvYWRzID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgICAgICBpZiAoISghaGFzVjFNb25pdG9yaW5nICYmICFoYXNWMU1vbml0b3JpbmdXb3JrbG9hZHMpKSB7CiAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuJGVtaXQoJ3VwZGF0ZScsIHsKICAgICAgICAgICAgICAgICAgICAgIHJlYWR5OiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgaGlkZGVuOiB0cnVlCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuaGF2ZVYxTW9uaXRvcmluZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGJ1dHRvbkRvbmUodHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CiAgICAgICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWxheSgxMDAwKTsKICAgICAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICAgICAgICBpbmRleCsrOwogICAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRmFpbGVkIHRvIHVuaW5zdGFsbDogdGltZWQgb3V0Iik7CiAgICAgICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LCBfY2FsbGVlKTsKICAgICAgICAgICAgfSkpOwogICAgICAgICAgICBmdW5jdGlvbiBhcHBseUFjdGlvbihfeCkgewogICAgICAgICAgICAgIHJldHVybiBfYXBwbHlBY3Rpb24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gYXBwbHlBY3Rpb247CiAgICAgICAgICB9KCksCiAgICAgICAgICB0aXRsZTogdGhpcy50KCdwcm9tcHRSZW1vdmUudGl0bGUnLCB7fSwgdHJ1ZSksCiAgICAgICAgICBib2R5OiB0aGlzLnQoJ21vbml0b3JpbmcuaW5zdGFsbFN0ZXBzLnVuaW5zdGFsbFYxLnByb21wdERlc2NyaXB0aW9uJywge30sIHRydWUpCiAgICAgICAgfQogICAgICB9KTsKICAgICAgYnV0dG9uQ2IodHJ1ZSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["haveV1Monitoring","haveV1MonitoringWorkloads","AsyncButton","IconMessage","delay","t","v","Promise","resolve","setTimeout","bind","label","subtext","weight","components","data","error","mounted","$store","getters","$emit","loading","ready","hidden","methods","uninstall","buttonCb","_this","dispatch","component","componentProps","applyMode","applyAction","_applyAction","_asyncToGenerator","regeneratorRuntime","mark","_callee","buttonDone","index","hasV1Monitoring","hasV1MonitoringWorkloads","wrap","_callee$","_context","prev","next","doAction","sent","abrupt","Error","stop","_x","apply","arguments","title","body"],"sources":["node_modules/@rancher/shell/chart/monitoring/steps/uninstall-v1.vue"],"sourcesContent":["\n<script>\nimport { haveV1Monitoring, haveV1MonitoringWorkloads } from '@shell/utils/monitoring';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport IconMessage from '@shell/components/IconMessage';\n\nfunction delay(t, v) {\n  return new Promise((resolve) => {\n    setTimeout(resolve.bind(null, v), t);\n  });\n}\n\nexport default {\n\n  label:   'monitoring.installSteps.uninstallV1.stepTitle',\n  subtext: 'monitoring.installSteps.uninstallV1.stepSubtext',\n  weight:  100,\n\n  components: {\n    AsyncButton,\n    IconMessage\n  },\n\n  data() {\n    return {\n      haveV1Monitoring: false,\n      error:            null,\n    };\n  },\n\n  mounted() {\n    this.haveV1Monitoring = haveV1Monitoring(this.$store.getters);\n    this.$emit('update', {\n      loading: false,\n      ready:   false,\n      hidden:  !this.haveV1Monitoring,\n    });\n  },\n\n  methods: {\n    uninstall(buttonCb) {\n      this.$store.dispatch('cluster/promptModal', {\n        component:      'GenericPrompt',\n        componentProps: {\n          applyMode:   'uninstall',\n          applyAction: async(buttonDone) => {\n            await this.$store.getters['currentCluster'].doAction('disableMonitoring');\n\n            for (let index = 0; index < 30; index++) {\n            // Wait 30 seconds for the containers to go\n              const hasV1Monitoring = haveV1Monitoring(this.$store.getters);\n              const hasV1MonitoringWorkloads = await haveV1MonitoringWorkloads(this.$store);\n\n              if ((!hasV1Monitoring && !hasV1MonitoringWorkloads)) {\n                this.$emit('update', { ready: true, hidden: true });\n                this.haveV1Monitoring = false;\n\n                buttonDone(true);\n\n                return;\n              }\n              await delay(1000);\n            }\n\n            throw new Error(`Failed to uninstall: timed out`);\n          },\n          title: this.t('promptRemove.title', {}, true),\n          body:  this.t('monitoring.installSteps.uninstallV1.promptDescription', {}, true),\n        },\n      });\n      buttonCb(true);\n    },\n  }\n};\n\n</script>\n<template>\n  <div class=\"v1-monitoring\">\n    <template v-if=\"haveV1Monitoring\">\n      <IconMessage\n        class=\"mt-40 mb-20\"\n        icon=\"icon-warning\"\n        :vertical=\"true\"\n        icon-state=\"warning\"\n      >\n        <template #message>\n          <p>\n            {{ t('monitoring.installSteps.uninstallV1.warning1') }}\n          </p>\n          <p\n            v-clean-html=\"t('monitoring.installSteps.uninstallV1.warning2', {}, true)\"\n            class=\"mt-10\"\n          />\n        </template>\n      </IconMessage>\n      <AsyncButton\n        mode=\"uninstall\"\n        :delay=\"0\"\n        @click=\"uninstall\"\n      />\n    </template>\n    <IconMessage\n      v-else\n      class=\"mt-40\"\n      icon=\"icon-checkmark\"\n      :vertical=\"true\"\n      icon-state=\"success\"\n    >\n      <template #message>\n        <p class=\"\">\n          {{ t('monitoring.installSteps.uninstallV1.success1') }}\n        </p>\n        <p\n          v-clean-html=\"t('monitoring.installSteps.uninstallV1.success2')\"\n          class=\"mt-10\"\n        />\n      </template>\n    </IconMessage>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n.v1-monitoring {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  p {\n    max-width: 900px;\n  }\n  .btn {\n    min-width: 200px;\n  }\n}\n</style>\n"],"mappings":";;;;AAEA,SAAAA,gBAAA,EAAAC,yBAAA;AACA,OAAAC,WAAA;AACA,OAAAC,WAAA;AAEA,SAAAC,MAAAC,CAAA,EAAAC,CAAA;EACA,WAAAC,OAAA,WAAAC,OAAA;IACAC,UAAA,CAAAD,OAAA,CAAAE,IAAA,OAAAJ,CAAA,GAAAD,CAAA;EACA;AACA;AAEA;EAEAM,KAAA;EACAC,OAAA;EACAC,MAAA;EAEAC,UAAA;IACAZ,WAAA,EAAAA,WAAA;IACAC,WAAA,EAAAA;EACA;EAEAY,IAAA,WAAAA,KAAA;IACA;MACAf,gBAAA;MACAgB,KAAA;IACA;EACA;EAEAC,OAAA,WAAAA,QAAA;IACA,KAAAjB,gBAAA,GAAAA,gBAAA,MAAAkB,MAAA,CAAAC,OAAA;IACA,KAAAC,KAAA;MACAC,OAAA;MACAC,KAAA;MACAC,MAAA,QAAAvB;IACA;EACA;EAEAwB,OAAA;IACAC,SAAA,WAAAA,UAAAC,QAAA;MAAA,IAAAC,KAAA;MACA,KAAAT,MAAA,CAAAU,QAAA;QACAC,SAAA;QACAC,cAAA;UACAC,SAAA;UACAC,WAAA;YAAA,IAAAC,YAAA,GAAAC,iBAAA,eAAAC,kBAAA,CAAAC,IAAA,UAAAC,QAAAC,UAAA;cAAA,IAAAC,KAAA,EAAAC,eAAA,EAAAC,wBAAA;cAAA,OAAAN,kBAAA,CAAAO,IAAA,UAAAC,SAAAC,QAAA;gBAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;kBAAA;oBAAAF,QAAA,CAAAE,IAAA;oBAAA,OACAnB,KAAA,CAAAT,MAAA,CAAAC,OAAA,mBAAA4B,QAAA;kBAAA;oBAEAR,KAAA;kBAAA;oBAAA,MAAAA,KAAA;sBAAAK,QAAA,CAAAE,IAAA;sBAAA;oBAAA;oBACA;oBACAN,eAAA,GAAAxC,gBAAA,CAAA2B,KAAA,CAAAT,MAAA,CAAAC,OAAA;oBAAAyB,QAAA,CAAAE,IAAA;oBAAA,OACA7C,yBAAA,CAAA0B,KAAA,CAAAT,MAAA;kBAAA;oBAAAuB,wBAAA,GAAAG,QAAA,CAAAI,IAAA;oBAAA,MAEA,CAAAR,eAAA,KAAAC,wBAAA;sBAAAG,QAAA,CAAAE,IAAA;sBAAA;oBAAA;oBACAnB,KAAA,CAAAP,KAAA;sBAAAE,KAAA;sBAAAC,MAAA;oBAAA;oBACAI,KAAA,CAAA3B,gBAAA;oBAEAsC,UAAA;oBAAA,OAAAM,QAAA,CAAAK,MAAA;kBAAA;oBAAAL,QAAA,CAAAE,IAAA;oBAAA,OAIA1C,KAAA;kBAAA;oBAbAmC,KAAA;oBAAAK,QAAA,CAAAE,IAAA;oBAAA;kBAAA;oBAAA,MAgBA,IAAAI,KAAA;kBAAA;kBAAA;oBAAA,OAAAN,QAAA,CAAAO,IAAA;gBAAA;cAAA,GAAAd,OAAA;YAAA,CACA;YAAA,SAAAL,YAAAoB,EAAA;cAAA,OAAAnB,YAAA,CAAAoB,KAAA,OAAAC,SAAA;YAAA;YAAA,OAAAtB,WAAA;UAAA;UACAuB,KAAA,OAAAlD,CAAA;UACAmD,IAAA,OAAAnD,CAAA;QACA;MACA;MACAqB,QAAA;IACA;EACA;AACA"}]}