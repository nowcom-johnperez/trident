{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js??ref--16-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/gatekeeper/util.js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/gatekeeper/util.js","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/babel.config.js","mtime":1716430386710},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmxhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnVuc2NvcGFibGVzLmZsYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnByb21pc2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0IHsgR0FURUtFRVBFUiwgU0NIRU1BIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmV4cG9ydCBmdW5jdGlvbiBmaW5kQWxsQ29uc3RyYWludHMoX3gpIHsKICByZXR1cm4gX2ZpbmRBbGxDb25zdHJhaW50cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CmZ1bmN0aW9uIF9maW5kQWxsQ29uc3RyYWludHMoKSB7CiAgX2ZpbmRBbGxDb25zdHJhaW50cyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShzdG9yZSkgewogICAgdmFyIGNvbnN0cmFpbnRUeXBlcywgbmVzdGVkQ29uc3RyYWludHM7CiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgIHJldHVybiBmaW5kQWxsQ29uc3RyYWludFR5cGVzKHN0b3JlKTsKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBjb25zdHJhaW50VHlwZXMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgbmVzdGVkQ29uc3RyYWludHMgPSBjb25zdHJhaW50VHlwZXMubWFwKGZ1bmN0aW9uIChjdCkgewogICAgICAgICAgICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsKICAgICAgICAgICAgICB0eXBlOiBjdCwKICAgICAgICAgICAgICBvcHQ6IHsKICAgICAgICAgICAgICAgIGZvcmNlOiB0cnVlCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgICAgX2NvbnRleHQubmV4dCA9IDY7CiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwobmVzdGVkQ29uc3RyYWludHMpOwogICAgICAgIGNhc2UgNjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIF9jb250ZXh0LnNlbnQuZmxhdCgpKTsKICAgICAgICBjYXNlIDc6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKICByZXR1cm4gX2ZpbmRBbGxDb25zdHJhaW50cy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CmV4cG9ydCBmdW5jdGlvbiBmaW5kQWxsQ29uc3RyYWludFR5cGVzKHN0b3JlKSB7CiAgdmFyIHNjaGVtYXMgPSBzdG9yZS5nZXR0ZXJzWydjbHVzdGVyL2FsbCddKFNDSEVNQSk7CiAgcmV0dXJuIGZpbmRDb25zdHJhaW50VHlwZXMoc2NoZW1hcyk7Cn0KZXhwb3J0IGZ1bmN0aW9uIGZpbmRBbGxUZW1wbGF0ZXMoc3RvcmUpIHsKICByZXR1cm4gc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsKICAgIHR5cGU6IEdBVEVLRUVQRVIuQ09OU1RSQUlOVF9URU1QTEFURQogIH0pOwp9CmV4cG9ydCBmdW5jdGlvbiBmaW5kVGVtcGxhdGVUeXBlKHNjaGVtYXMpIHsKICAvLyBAVE9ETyB0aGlzIHdpbGwganVzdCBiZSBhIHJlZ3VsYXIgc2luZ2xlIHR5cGUgbm93IHRoYXQgdGhlIHNlcnZlciBmaWx0ZXJzIHRvIHByZWZlcnJlZCB2ZXJzaW9uCiAgLy8gc28geW91IGNhbiBqdXN0IGFkZCB0ZW1wbGF0ZXMuZ2F0ZWtlZXBlci5zaC5jb25zdHJhaW50dGVtcGxhdGUgYXMgYSBjb25zdGFudCBpbiB0eXBlcy5qcwogIHZhciB0ZW1wbGF0ZSA9IHNjaGVtYXMuZmluZChmdW5jdGlvbiAoc2NoZW1hKSB7CiAgICB2YXIgX3NjaGVtYSRhdHRyaWJ1dGVzLCBfc2NoZW1hJGF0dHJpYnV0ZXMyOwogICAgcmV0dXJuIChzY2hlbWEgPT09IG51bGwgfHwgc2NoZW1hID09PSB2b2lkIDAgfHwgKF9zY2hlbWEkYXR0cmlidXRlcyA9IHNjaGVtYS5hdHRyaWJ1dGVzKSA9PT0gbnVsbCB8fCBfc2NoZW1hJGF0dHJpYnV0ZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zY2hlbWEkYXR0cmlidXRlcy5ncm91cCkgPT09ICd0ZW1wbGF0ZXMuZ2F0ZWtlZXBlci5zaCcgJiYgKHNjaGVtYSA9PT0gbnVsbCB8fCBzY2hlbWEgPT09IHZvaWQgMCB8fCAoX3NjaGVtYSRhdHRyaWJ1dGVzMiA9IHNjaGVtYS5hdHRyaWJ1dGVzKSA9PT0gbnVsbCB8fCBfc2NoZW1hJGF0dHJpYnV0ZXMyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfc2NoZW1hJGF0dHJpYnV0ZXMyLmtpbmQpID09PSAnQ29uc3RyYWludFRlbXBsYXRlJzsKICB9KTsKICByZXR1cm4gdGVtcGxhdGUgPT09IG51bGwgfHwgdGVtcGxhdGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbXBsYXRlLmlkOwp9CmZ1bmN0aW9uIGZpbmRDb25zdHJhaW50VHlwZXMoc2NoZW1hcykgewogIHJldHVybiBzY2hlbWFzLmZpbHRlcihmdW5jdGlvbiAoc2NoZW1hKSB7CiAgICB2YXIgX3NjaGVtYSRhdHRyaWJ1dGVzMzsKICAgIHJldHVybiAoc2NoZW1hID09PSBudWxsIHx8IHNjaGVtYSA9PT0gdm9pZCAwIHx8IChfc2NoZW1hJGF0dHJpYnV0ZXMzID0gc2NoZW1hLmF0dHJpYnV0ZXMpID09PSBudWxsIHx8IF9zY2hlbWEkYXR0cmlidXRlczMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9zY2hlbWEkYXR0cmlidXRlczMuZ3JvdXApID09PSAnY29uc3RyYWludHMuZ2F0ZWtlZXBlci5zaCc7CiAgfSkubWFwKGZ1bmN0aW9uIChzY2hlbWEpIHsKICAgIHJldHVybiBzY2hlbWEuaWQ7CiAgfSk7Cn0="},{"version":3,"names":["GATEKEEPER","SCHEMA","findAllConstraints","_x","_findAllConstraints","apply","arguments","_asyncToGenerator","regeneratorRuntime","mark","_callee","store","constraintTypes","nestedConstraints","wrap","_callee$","_context","prev","next","findAllConstraintTypes","sent","map","ct","dispatch","type","opt","force","Promise","all","abrupt","flat","stop","schemas","getters","findConstraintTypes","findAllTemplates","CONSTRAINT_TEMPLATE","findTemplateType","template","find","schema","_schema$attributes","_schema$attributes2","attributes","group","kind","id","filter","_schema$attributes3"],"sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/utils/gatekeeper/util.js"],"sourcesContent":["import { GATEKEEPER, SCHEMA } from '@shell/config/types';\n\nexport async function findAllConstraints(store) {\n  const constraintTypes = await findAllConstraintTypes(store);\n  const nestedConstraints = constraintTypes.map((ct) => store.dispatch('cluster/findAll', { type: ct, opt: { force: true } }));\n\n  return (await Promise.all(nestedConstraints)).flat();\n}\n\nexport function findAllConstraintTypes(store) {\n  const schemas = store.getters['cluster/all'](SCHEMA);\n\n  return findConstraintTypes(schemas);\n}\n\nexport function findAllTemplates(store) {\n  return store.dispatch('cluster/findAll', { type: GATEKEEPER.CONSTRAINT_TEMPLATE });\n}\n\nexport function findTemplateType(schemas) {\n  // @TODO this will just be a regular single type now that the server filters to preferred version\n  // so you can just add templates.gatekeeper.sh.constrainttemplate as a constant in types.js\n  const template = schemas.find((schema) => {\n    return schema?.attributes?.group === 'templates.gatekeeper.sh' &&\n        schema?.attributes?.kind === 'ConstraintTemplate';\n  });\n\n  return template?.id;\n}\n\nfunction findConstraintTypes(schemas) {\n  return schemas\n    .filter((schema) => schema?.attributes?.group === 'constraints.gatekeeper.sh')\n    .map((schema) => schema.id);\n}\n"],"mappings":";;;;;;;;;;;;AAAA,SAASA,UAAU,EAAEC,MAAM,QAAQ,qBAAqB;AAExD,gBAAsBC,kBAAkBA,CAAAC,EAAA;EAAA,OAAAC,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAKvC,SAAAF,oBAAA;EAAAA,mBAAA,GAAAG,iBAAA,eAAAC,kBAAA,CAAAC,IAAA,CALM,SAAAC,QAAkCC,KAAK;IAAA,IAAAC,eAAA,EAAAC,iBAAA;IAAA,OAAAL,kBAAA,CAAAM,IAAA,UAAAC,SAAAC,QAAA;MAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;QAAA;UAAAF,QAAA,CAAAE,IAAA;UAAA,OACdC,sBAAsB,CAACR,KAAK,CAAC;QAAA;UAArDC,eAAe,GAAAI,QAAA,CAAAI,IAAA;UACfP,iBAAiB,GAAGD,eAAe,CAACS,GAAG,CAAC,UAACC,EAAE;YAAA,OAAKX,KAAK,CAACY,QAAQ,CAAC,iBAAiB,EAAE;cAAEC,IAAI,EAAEF,EAAE;cAAEG,GAAG,EAAE;gBAAEC,KAAK,EAAE;cAAK;YAAE,CAAC,CAAC;UAAA,EAAC;UAAAV,QAAA,CAAAE,IAAA;UAAA,OAE9GS,OAAO,CAACC,GAAG,CAACf,iBAAiB,CAAC;QAAA;UAAA,OAAAG,QAAA,CAAAa,MAAA,WAAAb,QAAA,CAAAI,IAAA,CAAEU,IAAI;QAAA;QAAA;UAAA,OAAAd,QAAA,CAAAe,IAAA;MAAA;IAAA,GAAArB,OAAA;EAAA,CACnD;EAAA,OAAAN,mBAAA,CAAAC,KAAA,OAAAC,SAAA;AAAA;AAED,OAAO,SAASa,sBAAsBA,CAACR,KAAK,EAAE;EAC5C,IAAMqB,OAAO,GAAGrB,KAAK,CAACsB,OAAO,CAAC,aAAa,CAAC,CAAChC,MAAM,CAAC;EAEpD,OAAOiC,mBAAmB,CAACF,OAAO,CAAC;AACrC;AAEA,OAAO,SAASG,gBAAgBA,CAACxB,KAAK,EAAE;EACtC,OAAOA,KAAK,CAACY,QAAQ,CAAC,iBAAiB,EAAE;IAAEC,IAAI,EAAExB,UAAU,CAACoC;EAAoB,CAAC,CAAC;AACpF;AAEA,OAAO,SAASC,gBAAgBA,CAACL,OAAO,EAAE;EACxC;EACA;EACA,IAAMM,QAAQ,GAAGN,OAAO,CAACO,IAAI,CAAC,UAACC,MAAM,EAAK;IAAA,IAAAC,kBAAA,EAAAC,mBAAA;IACxC,OAAO,CAAAF,MAAM,aAANA,MAAM,gBAAAC,kBAAA,GAAND,MAAM,CAAEG,UAAU,cAAAF,kBAAA,uBAAlBA,kBAAA,CAAoBG,KAAK,MAAK,yBAAyB,IAC1D,CAAAJ,MAAM,aAANA,MAAM,gBAAAE,mBAAA,GAANF,MAAM,CAAEG,UAAU,cAAAD,mBAAA,uBAAlBA,mBAAA,CAAoBG,IAAI,MAAK,oBAAoB;EACvD,CAAC,CAAC;EAEF,OAAOP,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEQ,EAAE;AACrB;AAEA,SAASZ,mBAAmBA,CAACF,OAAO,EAAE;EACpC,OAAOA,OAAO,CACXe,MAAM,CAAC,UAACP,MAAM;IAAA,IAAAQ,mBAAA;IAAA,OAAK,CAAAR,MAAM,aAANA,MAAM,gBAAAQ,mBAAA,GAANR,MAAM,CAAEG,UAAU,cAAAK,mBAAA,uBAAlBA,mBAAA,CAAoBJ,KAAK,MAAK,2BAA2B;EAAA,EAAC,CAC7EvB,GAAG,CAAC,UAACmB,MAAM;IAAA,OAAKA,MAAM,CAACM,EAAE;EAAA,EAAC;AAC/B"}]}