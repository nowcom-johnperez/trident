{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js??ref--17-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/workload/storage/__tests__/Storage.test.ts","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/workload/storage/__tests__/Storage.test.ts","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js","mtime":1716430466133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbW91bnQgfSBmcm9tICdAdnVlL3Rlc3QtdXRpbHMnOwppbXBvcnQgU3RvcmFnZSBmcm9tICdAc2hlbGwvZWRpdC8vd29ya2xvYWQvc3RvcmFnZS9pbmRleC52dWUnOwpkZXNjcmliZSgnY29tcG9uZW50OiBTdG9yYWdlJywgKCkgPT4gewogICAgZGVzY3JpYmUuZWFjaChbCiAgICAgICAgJ2F3c0VsYXN0aWNCbG9ja1N0b3JlJywKICAgICAgICAnYXp1cmVEaXNrJywKICAgICAgICAnYXp1cmVGaWxlJywKICAgICAgICAnY29uZmlnTWFwJywKICAgICAgICAvLyAnY3JlYXRlUFZDJywKICAgICAgICAnY3NpJywKICAgICAgICAnZW1wdHlEaXInLAogICAgICAgICdnY2VQZXJzaXN0ZW50RGlzaycsCiAgICAgICAgJ2djZVBlcnNpc3RlbnREaXNrJywKICAgICAgICAnaG9zdFBhdGgnLAogICAgICAgICdzZWNyZXQnLAogICAgICAgICd2c3BoZXJlVm9sdW1lJwogICAgXSkoJ2dpdmVuIHZvbHVtZSB0eXBlICVwJywgKHZvbHVtZVR5cGUpID0+IHsKICAgICAgICBpdCgnc2hvdWxkIGRpc3BsYXkgdGhlIHZvbHVtZSBuYW1lIGFzIGZpcnN0IGlucHV0IG9mIHRoZSBmb3JtIGFycmF5JywgKCkgPT4gewogICAgICAgICAgICBjb25zdCBuYW1lID0gJ3doYXRldmVyJzsKICAgICAgICAgICAgY29uc3Qgd3JhcHBlciA9IG1vdW50KFN0b3JhZ2UsIHsKICAgICAgICAgICAgICAgIHByb3BzRGF0YTogewogICAgICAgICAgICAgICAgICAgIHNhdmVQdmNIb29rTmFtZTogJycsCiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgdm9sdW1lczogW3sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdHlwZTogdm9sdW1lVHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbdm9sdW1lVHlwZV06IHt9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBtb2NrczogewogICAgICAgICAgICAgICAgICAgIHQ6ICh0ZXh0KSA9PiB0ZXh0LAogICAgICAgICAgICAgICAgICAgICRzdG9yZTogewogICAgICAgICAgICAgICAgICAgICAgICBnZXR0ZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaTE4bi90JzogamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoa2V5KSA9PiBrZXkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2kxOG4vZXhpc3RzJzogamVzdC5mbigpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB3cmFwcGVyLmZpbmQoJ2lucHV0JykuZWxlbWVudDsKICAgICAgICAgICAgZXhwZWN0KGlucHV0LnZhbHVlKS50b1N0cmljdEVxdWFsKG5hbWUpOwogICAgICAgIH0pOwogICAgICAgIGl0KCdzaG91bGQgZWRpdCB0aGUgdm9sdW1lIG5hbWUnLCAoKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSAnd2hhdGV2ZXInOwogICAgICAgICAgICBjb25zdCBuZXdOYW1lID0gJ25ldyB3aGF0ZXZlcic7CiAgICAgICAgICAgIGNvbnN0IHdyYXBwZXIgPSBtb3VudChTdG9yYWdlLCB7CiAgICAgICAgICAgICAgICBwcm9wc0RhdGE6IHsKICAgICAgICAgICAgICAgICAgICBzYXZlUHZjSG9va05hbWU6ICcnLAogICAgICAgICAgICAgICAgICAgIHZhbHVlOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZvbHVtZXM6IFt7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3R5cGU6IHZvbHVtZVR5cGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3ZvbHVtZVR5cGVdOiB7fSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbW9ja3M6IHsKICAgICAgICAgICAgICAgICAgICB0OiAodGV4dCkgPT4gdGV4dCwKICAgICAgICAgICAgICAgICAgICAkc3RvcmU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0dGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2kxOG4vdCc6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKGtleSkgPT4ga2V5KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdpMThuL2V4aXN0cyc6IGplc3QuZm4oKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHdyYXBwZXIuZmluZCgnaW5wdXQnKS5zZXRWYWx1ZShuZXdOYW1lKTsKICAgICAgICAgICAgZXhwZWN0KHdyYXBwZXIudm0udmFsdWUudm9sdW1lc1swXS5uYW1lKS50b1N0cmljdEVxdWFsKG5ld05hbWUpOwogICAgICAgIH0pOwogICAgfSk7CiAgICAvLyBUT0RPOiBmaW5kIGhvdyB0byBpbnRlcmFjdCB3aXRoIHRoZSB0b29sdGlwIHNlbGVjdGlvbiBvdXRzaWRlIG9mIHRoZSBjb21wb25lbnQKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBqZXN0L25vLWRpc2FibGVkLXRlc3RzCiAgICBpdC5za2lwKCdzaG91bGQgYWxsb3cgdG8gYWRkIGEgbmV3IHZvbHVtZScsIGFzeW5jICgpID0+IHsKICAgICAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoU3RvcmFnZSwgewogICAgICAgICAgICBwcm9wc0RhdGE6IHsgc2F2ZVB2Y0hvb2tOYW1lOiAnJyB9LAogICAgICAgICAgICBtb2NrczogewogICAgICAgICAgICAgICAgdDogKHRleHQpID0+IHRleHQsCiAgICAgICAgICAgICAgICAkc3RvcmU6IHsgZ2V0dGVyczogeyAnaTE4bi90JzogamVzdC5mbigpIH0gfQogICAgICAgICAgICB9LAogICAgICAgIH0pOwogICAgICAgIGF3YWl0IHdyYXBwZXIuZmluZCgnI3NlbGVjdC12b2x1bWUnKS50cmlnZ2VyKCdjbGljaycpOwogICAgICAgIGF3YWl0IHdyYXBwZXIudHJpZ2dlcigna2V5ZG93bi5kb3duJyk7CiAgICAgICAgYXdhaXQgd3JhcHBlci50cmlnZ2VyKCdrZXlkb3duLmVudGVyJyk7CiAgICAgICAgZXhwZWN0KHdyYXBwZXIudm0udmFsdWUudm9sdW1lc1swXSkudG9TdHJpY3RFcXVhbCh7CiAgICAgICAgICAgIF90eXBlOiAnYXdzRWxhc3RpY0Jsb2NrU3RvcmUnLAogICAgICAgICAgICBhd3NFbGFzdGljQmxvY2tTdG9yZToge30sCiAgICAgICAgICAgIG5hbWU6ICcnCiAgICAgICAgfSk7CiAgICB9KTsKfSk7Cg=="},{"version":3,"file":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/workload/storage/__tests__/Storage.test.ts","sourceRoot":"","sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/workload/storage/__tests__/Storage.test.ts"],"names":[],"mappings":"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","sourcesContent":["import { mount } from '@vue/test-utils';\nimport Storage from '@shell/edit//workload/storage/index.vue';\n\ndescribe('component: Storage', () => {\n  describe.each([\n    'awsElasticBlockStore',\n    'azureDisk',\n    'azureFile',\n    'configMap',\n    // 'createPVC',\n    'csi',\n    'emptyDir',\n    'gcePersistentDisk',\n    'gcePersistentDisk',\n    'hostPath',\n    'secret',\n    'vsphereVolume'\n  ])('given volume type %p', (volumeType) => {\n    it('should display the volume name as first input of the form array', () => {\n      const name = 'whatever';\n      const wrapper = mount(Storage, {\n        propsData: {\n          savePvcHookName: '',\n          value:           {\n            volumes: [{\n              _type:        volumeType,\n              [volumeType]: {},\n              name\n            }]\n          },\n        },\n        mocks: {\n          t:      (text: string) => text, // Mock i18n global function used as alternative to the getter\n          $store: {\n            getters: {\n              'i18n/t':      jest.fn().mockImplementation((key: string) => key),\n              'i18n/exists': jest.fn()\n            }\n          }\n        },\n      });\n\n      const input = wrapper.find('input').element as HTMLInputElement;\n\n      expect(input.value).toStrictEqual(name);\n    });\n\n    it('should edit the volume name', () => {\n      const name = 'whatever';\n      const newName = 'new whatever';\n      const wrapper = mount(Storage, {\n        propsData: {\n          savePvcHookName: '',\n          value:           {\n            volumes: [{\n              _type:        volumeType,\n              [volumeType]: {},\n              name\n            }]\n          },\n        },\n        mocks: {\n          t:      (text: string) => text, // Mock i18n global function used as alternative to the getter\n          $store: {\n            getters: {\n              'i18n/t':      jest.fn().mockImplementation((key: string) => key),\n              'i18n/exists': jest.fn()\n            }\n          }\n        },\n      });\n\n      wrapper.find('input').setValue(newName);\n\n      expect(wrapper.vm.value.volumes[0].name).toStrictEqual(newName);\n    });\n  });\n\n  // TODO: find how to interact with the tooltip selection outside of the component\n  // eslint-disable-next-line jest/no-disabled-tests\n  it.skip('should allow to add a new volume', async() => {\n    const wrapper = mount(Storage, {\n      propsData: { savePvcHookName: '' },\n      mocks:     {\n        t:      (text: string) => text, // Mock i18n global function used as alternative to the getter\n        $store: { getters: { 'i18n/t': jest.fn() } }\n      },\n    });\n\n    await wrapper.find('#select-volume').trigger('click');\n    await wrapper.trigger('keydown.down');\n    await wrapper.trigger('keydown.enter');\n\n    expect(wrapper.vm.value.volumes[0]).toStrictEqual({\n      _type:                'awsElasticBlockStore',\n      awsElasticBlockStore: {},\n      name:                 ''\n    });\n  });\n});\n"]}]}