{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js??ref--17-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js","mtime":1716430466133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgbW91bnQgfSBmcm9tICdAdnVlL3Rlc3QtdXRpbHMnOwppbXBvcnQgRm9ybVZhbGlkYXRpb24gZnJvbSAnQHNoZWxsL21peGlucy9mb3JtLXZhbGlkYXRpb24nOwppbXBvcnQgTW9uaXRvcmluZyBmcm9tICdAc2hlbGwvZWRpdC9tb25pdG9yaW5nLmNvcmVvcy5jb20ucHJvbWV0aGV1c3J1bGUvaW5kZXgudnVlJzsKaW1wb3J0IHsgX0VESVQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmltcG9ydCB7IGNsZWFuSHRtbERpcmVjdGl2ZSB9IGZyb20gJ0BzaGVsbC9wbHVnaW5zL2NsZWFuLWh0bWwtZGlyZWN0aXZlJzsKZGVzY3JpYmUoJ2VkaXQ6IG1hbmFnZW1lbnQuY2F0dGxlLmlvLnNldHRpbmcgc2hvdWxkJywgKCkgPT4gewogICAgY29uc3QgTU9DS0VEX0VSUk9SUyA9IFsnZXJyb3IxJywgJ2Vycm9yMicsICdlcnJvcjMnLCAnZXJyb3I0JywgJ2Vycm9yNSddOwogICAgY29uc3QgRVJST1JfQkFOTkVSX1NFTEVDVE9SID0gJ1tkYXRhLXRlc3RpZD0iYmFubmVyLWNsb3NlIl0nOwogICAgY29uc3QgcmVxdWlyZWRTZXR1cCA9ICgpID0+ICh7CiAgICAgICAgLy8gUmVtb3ZlIGFsbCB0aGVzZSBtb2NrcyBhZnRlciBtaWdyYXRpb24gdG8gVnVlIDIuNy8zIGR1ZSBtaXhpbiBsb2dpYwogICAgICAgIG1vY2tzOiB7CiAgICAgICAgICAgICRzdG9yZTogewogICAgICAgICAgICAgICAgZ2V0dGVyczogewogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdG9yZTogKCkgPT4gJ2N1cnJlbnRfc3RvcmUnLAogICAgICAgICAgICAgICAgICAgICdjdXJyZW50X3N0b3JlL3NjaGVtYUZvcic6IGplc3QuZm4oKSwKICAgICAgICAgICAgICAgICAgICAnY3VycmVudF9zdG9yZS9hbGwnOiBqZXN0LmZuKCksCiAgICAgICAgICAgICAgICAgICAgJ2kxOG4vdCc6IGplc3QuZm4oKSwKICAgICAgICAgICAgICAgICAgICAnaTE4bi9leGlzdHMnOiBqZXN0LmZuKCksCiAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlczogKCkgPT4gKHt9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICAkcm91dGU6IHsgcXVlcnk6IHsgQVM6ICcnIH0sIG5hbWU6ICcnIH0sCiAgICAgICAgICAgICRyb3V0ZXI6IHsgYXBwbHlRdWVyeTogamVzdC5mbigpIH0KICAgICAgICB9CiAgICB9KTsKICAgIGl0KCdzaG91bGQgY2xvc2UgZXJyb3IgYmFubmVycycsIGFzeW5jICgpID0+IHsKICAgICAgICBqZXN0LnNweU9uKEZvcm1WYWxpZGF0aW9uLmNvbXB1dGVkLCAnZnZVbnJlcG9ydGVkVmFsaWRhdGlvbkVycm9ycycpLm1vY2tSZXR1cm5WYWx1ZShNT0NLRURfRVJST1JTKTsKICAgICAgICBjb25zdCB3cmFwcGVyID0gbW91bnQoTW9uaXRvcmluZywgewogICAgICAgICAgICBwcm9wc0RhdGE6IHsKICAgICAgICAgICAgICAgIGNhbllhbWw6IGZhbHNlLAogICAgICAgICAgICAgICAgbW9kZTogX0VESVQsCiAgICAgICAgICAgICAgICByZXNvdXJjZToge30sCiAgICAgICAgICAgICAgICB2YWx1ZTogeyB2YWx1ZTogJ2FueXRoaW5nJyB9LAogICAgICAgICAgICAgICAgbmFtZTogJycKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZGlyZWN0aXZlczogeyBjbGVhbkh0bWxEaXJlY3RpdmUgfSwKICAgICAgICAgICAgLi4ucmVxdWlyZWRTZXR1cCgpCiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgZXJyb3JCYW5uZXJzID0gd3JhcHBlci5maW5kQWxsKEVSUk9SX0JBTk5FUl9TRUxFQ1RPUik7CiAgICAgICAgLy8gQXNzZXJ0IHRoYXQgYWxsIHRoZSBlcnJvciBiYW5uZXJzIGFyZSByZW5kZXJlZAogICAgICAgIGV4cGVjdChlcnJvckJhbm5lcnMpLnRvSGF2ZUxlbmd0aChNT0NLRURfRVJST1JTLmxlbmd0aCk7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNT0NLRURfRVJST1JTLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGF3YWl0IGVycm9yQmFubmVycy5hdCgwKS50cmlnZ2VyKCdjbGljaycpOwogICAgICAgICAgICBjb25zdCByZXN1bHRFcnJvckJhbm5lcnMgPSB3cmFwcGVyLmZpbmRBbGwoRVJST1JfQkFOTkVSX1NFTEVDVE9SKTsKICAgICAgICAgICAgLy8gQXNzZXJ0IHRoYXQgYW4gZXJyb3IgYmFubmVyIGlzIGNsb3NlZCB1bnRpbCB0aGUgbGFzdCBvbmUKICAgICAgICAgICAgZXhwZWN0KHJlc3VsdEVycm9yQmFubmVycykudG9IYXZlTGVuZ3RoKE1PQ0tFRF9FUlJPUlMubGVuZ3RoIC0gMSAtIGkpOwogICAgICAgIH0KICAgIH0pOwp9KTsK"},{"version":3,"file":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts","sourceRoot":"","sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/__tests__/monitoring.coreos.com.prometheusrule.test.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,KAAK,EAAE,MAAM,iBAAiB,CAAC;AACxC,OAAO,cAAc,MAAM,+BAA+B,CAAC;AAC3D,OAAO,UAAU,MAAM,4DAA4D,CAAC;AACpF,OAAO,EAAE,KAAK,EAAE,MAAM,4BAA4B,CAAC;AACnD,OAAO,EAAE,kBAAkB,EAAE,MAAM,qCAAqC,CAAC;AAEzE,QAAQ,CAAC,2CAA2C,EAAE,GAAG,EAAE;IACzD,MAAM,aAAa,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;IACzE,MAAM,qBAAqB,GAAG,8BAA8B,CAAC;IAC7D,MAAM,aAAa,GAAG,GAAG,EAAE,CAAC,CAAC;QAC3B,sEAAsE;QACtE,KAAK,EAAE;YACL,MAAM,EAAE;gBACN,OAAO,EAAE;oBACP,YAAY,EAAe,GAAG,EAAE,CAAC,eAAe;oBAChD,yBAAyB,EAAE,IAAI,CAAC,EAAE,EAAE;oBACpC,mBAAmB,EAAQ,IAAI,CAAC,EAAE,EAAE;oBACpC,QAAQ,EAAmB,IAAI,CAAC,EAAE,EAAE;oBACpC,aAAa,EAAc,IAAI,CAAC,EAAE,EAAE;oBACpC,UAAU,EAAiB,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC;iBACtC;aACF;YACD,MAAM,EAAG,EAAE,KAAK,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,EAAE;YACxC,OAAO,EAAE,EAAE,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE,EAAE;SACnC;KACF,CAAC,CAAC;IAEH,EAAE,CAAC,4BAA4B,EAAE,KAAK,IAAG,EAAE;QACzC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,QAAQ,EAAE,8BAA8B,CAAC,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;QAEnG,MAAM,OAAO,GAAG,KAAK,CAAC,UAAU,EAAE;YAChC,SAAS,EAAE;gBACT,OAAO,EAAG,KAAK;gBACf,IAAI,EAAM,KAAK;gBACf,QAAQ,EAAE,EAAE;gBACZ,KAAK,EAAK,EAAE,KAAK,EAAE,UAAU,EAAE;gBAC/B,IAAI,EAAM,EAAE;aACb;YACD,UAAU,EAAE,EAAE,kBAAkB,EAAE;YAClC,GAAG,aAAa,EAAE;SACnB,CAAC,CAAC;QAEH,MAAM,YAAY,GAAG,OAAO,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;QAE5D,iDAAiD;QACjD,MAAM,CAAC,YAAY,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;QAExD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,aAAa,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC7C,MAAM,YAAY,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;YAC1C,MAAM,kBAAkB,GAAG,OAAO,CAAC,OAAO,CAAC,qBAAqB,CAAC,CAAC;YAElE,2DAA2D;YAC3D,MAAM,CAAC,kBAAkB,CAAC,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;SACvE;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["import { mount } from '@vue/test-utils';\nimport FormValidation from '@shell/mixins/form-validation';\nimport Monitoring from '@shell/edit/monitoring.coreos.com.prometheusrule/index.vue';\nimport { _EDIT } from '@shell/config/query-params';\nimport { cleanHtmlDirective } from '@shell/plugins/clean-html-directive';\n\ndescribe('edit: management.cattle.io.setting should', () => {\n  const MOCKED_ERRORS = ['error1', 'error2', 'error3', 'error4', 'error5'];\n  const ERROR_BANNER_SELECTOR = '[data-testid=\"banner-close\"]';\n  const requiredSetup = () => ({\n    // Remove all these mocks after migration to Vue 2.7/3 due mixin logic\n    mocks: {\n      $store: {\n        getters: {\n          currentStore:              () => 'current_store',\n          'current_store/schemaFor': jest.fn(),\n          'current_store/all':       jest.fn(),\n          'i18n/t':                  jest.fn(),\n          'i18n/exists':             jest.fn(),\n          namespaces:                () => ({})\n        }\n      },\n      $route:  { query: { AS: '' }, name: '' },\n      $router: { applyQuery: jest.fn() }\n    }\n  });\n\n  it('should close error banners', async() => {\n    jest.spyOn(FormValidation.computed, 'fvUnreportedValidationErrors').mockReturnValue(MOCKED_ERRORS);\n\n    const wrapper = mount(Monitoring, {\n      propsData: {\n        canYaml:  false,\n        mode:     _EDIT,\n        resource: {},\n        value:    { value: 'anything' },\n        name:     ''\n      },\n      directives: { cleanHtmlDirective },\n      ...requiredSetup()\n    });\n\n    const errorBanners = wrapper.findAll(ERROR_BANNER_SELECTOR);\n\n    // Assert that all the error banners are rendered\n    expect(errorBanners).toHaveLength(MOCKED_ERRORS.length);\n\n    for (let i = 0; i < MOCKED_ERRORS.length; i++) {\n      await errorBanners.at(0).trigger('click');\n      const resultErrorBanners = wrapper.findAll(ERROR_BANNER_SELECTOR);\n\n      // Assert that an error banner is closed until the last one\n      expect(resultErrorBanners).toHaveLength(MOCKED_ERRORS.length - 1 - i);\n    }\n  });\n});\n"]}]}