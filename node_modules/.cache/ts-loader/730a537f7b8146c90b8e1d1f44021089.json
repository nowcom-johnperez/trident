{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js??ref--17-1!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/__tests__/batch.cronjob.test.ts","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/__tests__/batch.cronjob.test.ts","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/ts-loader/index.js","mtime":1716430466133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IENyb25qb2IgZnJvbSAnQHNoZWxsL21vZGVscy9iYXRjaC5jcm9uam9iJzsKZGVzY3JpYmUoJ2NsYXNzIENyb25qb2InLCAoKSA9PiB7CiAgICBpdCgnc2hvdWxkIGhhdmUgbm8gb3duZXJSZWZlcmVuY2VzIGJ5IGRlZmF1bHQnLCAoKSA9PiB7CiAgICAgICAgY29uc3QgY3JvbkpvYkRhdGEgPSB7CiAgICAgICAgICAgIGlkOiAnYW55LWlkJywKICAgICAgICAgICAgdHlwZTogJ2JhdGNoLmpvYicsCiAgICAgICAgICAgIGFwaVZlcnNpb246ICdiYXRjaC92MScsCiAgICAgICAgICAgIGtpbmQ6ICdKb2InLAogICAgICAgICAgICBtZXRhZGF0YTogewogICAgICAgICAgICAgICAgbmFtZTogJ2FueS1uYW1lJywKICAgICAgICAgICAgICAgIG5hbWVzcGFjZTogJ2FueS1uYW1lc3BhY2UnLAogICAgICAgICAgICAgICAgdWlkOiAnYW55LXVpZCcKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc3BlYzogeyBqb2JUZW1wbGF0ZToge30gfQogICAgICAgIH07CiAgICAgICAgY29uc3QgZXhwZWN0YXRpb24gPSB7CiAgICAgICAgICAgIG5hbWU6ICdhbnktbmFtZScsIG5hbWVzcGFjZTogJ2FueS1uYW1lc3BhY2UnLCB1aWQ6ICdhbnktdWlkJwogICAgICAgIH07CiAgICAgICAgY29uc3QgY3JvbmpvYiA9IG5ldyBDcm9uam9iKGNyb25Kb2JEYXRhKTsKICAgICAgICBleHBlY3QoY3JvbmpvYi5tZXRhZGF0YSkudG9TdHJpY3RFcXVhbChleHBlY3RhdGlvbik7CiAgICB9KTsKICAgIGRlc2NyaWJlKCdtZXRob2QgcnVuTm93JywgKCkgPT4gewogICAgICAgIGl0KCdzaG91bGQgcG9wdWxhdGUgam9iIG1ldGFkYXRhJywgYXN5bmMgKCkgPT4gewogICAgICAgICAgICBjb25zdCBqb2JEYXRhID0gewogICAgICAgICAgICAgICAgaWQ6ICdhbnktaWQnLAogICAgICAgICAgICAgICAgdHlwZTogJ2JhdGNoLmpvYicsCiAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiAnYmF0Y2gvdjEnLAogICAgICAgICAgICAgICAga2luZDogJ0pvYicsCiAgICAgICAgICAgICAgICBtZXRhZGF0YTogewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICdhbnktbmFtZScsCiAgICAgICAgICAgICAgICAgICAgbmFtZXNwYWNlOiAnYW55LW5hbWVzcGFjZScsCiAgICAgICAgICAgICAgICAgICAgdWlkOiAnYW55LXVpZCcKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzcGVjOiB7IGpvYlRlbXBsYXRlOiB7fSB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBEYXRlLm5vdygpOwogICAgICAgICAgICBjb25zdCBleHBlY3RlZCA9IHsKICAgICAgICAgICAgICAgIG5hbWU6IGAke2pvYkRhdGEubWV0YWRhdGEubmFtZX0tJHtkYXRlfWAsCiAgICAgICAgICAgICAgICBuYW1lc3BhY2U6IGpvYkRhdGEubWV0YWRhdGEubmFtZXNwYWNlLAogICAgICAgICAgICAgICAgb3duZXJSZWZlcmVuY2VzOiBbewogICAgICAgICAgICAgICAgICAgICAgICBhcGlWZXJzaW9uOiAnYmF0Y2gvdjEnLAogICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICBraW5kOiAnSm9iJywKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogam9iRGF0YS5tZXRhZGF0YS5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICB1aWQ6IGpvYkRhdGEubWV0YWRhdGEudWlkCiAgICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgICB1aWQ6IGpvYkRhdGEubWV0YWRhdGEudWlkCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNvbnN0IGRpc3BhdGNoZXIgPSAoKSA9PiAoewogICAgICAgICAgICAgICAgLi4uam9iRGF0YSwKICAgICAgICAgICAgICAgIHNhdmU6IGplc3QuZm4oKSwKICAgICAgICAgICAgICAgIGdvVG9EZXRhaWw6IGplc3QuZm4oKQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29uc3QgY3JvbmpvYiA9IG5ldyBDcm9uam9iKGpvYkRhdGEsIHsgZGlzcGF0Y2g6IGRpc3BhdGNoZXIgfSk7CiAgICAgICAgICAgIGplc3QKICAgICAgICAgICAgICAgIC51c2VGYWtlVGltZXJzKCkKICAgICAgICAgICAgICAgIC5zZXRTeXN0ZW1UaW1lKGRhdGUpOwogICAgICAgICAgICBqZXN0LnNweU9uKGNyb25qb2IsICckZGlzcGF0Y2gnKS5tb2NrSW1wbGVtZW50YXRpb24oZGlzcGF0Y2hlcik7CiAgICAgICAgICAgIGF3YWl0IGNyb25qb2IucnVuTm93KCk7CiAgICAgICAgICAgIGV4cGVjdChjcm9uam9iLm1ldGFkYXRhKS50b1N0cmljdEVxdWFsKGV4cGVjdGVkKTsKICAgICAgICB9KTsKICAgICAgICBpdCgnc2hvdWxkIHJlZGlyZWN0IHRvIGFub3RoZXIgcGFnZScsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3Qgam9iRGF0YSA9IHsKICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB7IG5hbWU6ICdhbnktbmFtZScgfSwKICAgICAgICAgICAgICAgIHNwZWM6IHsgam9iVGVtcGxhdGU6IHt9IH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgY29uc3QgY2FsbGJhY2sgPSBqZXN0LmZuKCk7CiAgICAgICAgICAgIGNvbnN0IGRpc3BhdGNoZXIgPSAoKSA9PiAoewogICAgICAgICAgICAgICAgLi4uam9iRGF0YSwKICAgICAgICAgICAgICAgIHNhdmU6IGplc3QuZm4oKSwKICAgICAgICAgICAgICAgIGdvVG9EZXRhaWw6IGNhbGxiYWNrCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb25zdCBjcm9uam9iID0gbmV3IENyb25qb2Ioam9iRGF0YSwgeyBkaXNwYXRjaDogZGlzcGF0Y2hlciB9KTsKICAgICAgICAgICAgamVzdC5zcHlPbihjcm9uam9iLCAnJGRpc3BhdGNoJykubW9ja0ltcGxlbWVudGF0aW9uKGRpc3BhdGNoZXIpOwogICAgICAgICAgICBhd2FpdCBjcm9uam9iLnJ1bk5vdygpOwogICAgICAgICAgICBleHBlY3QoY2FsbGJhY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCk7CiAgICAgICAgfSk7CiAgICB9KTsKfSk7Cg=="},{"version":3,"file":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/__tests__/batch.cronjob.test.ts","sourceRoot":"","sources":["/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/models/__tests__/batch.cronjob.test.ts"],"names":[],"mappings":"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","sourcesContent":["import Cronjob from '@shell/models/batch.cronjob';\ndescribe('class Cronjob', () => {\n  it('should have no ownerReferences by default', () => {\n    const cronJobData = {\n      id:         'any-id',\n      type:       'batch.job',\n      apiVersion: 'batch/v1',\n      kind:       'Job',\n      metadata:   {\n        name:      'any-name',\n        namespace: 'any-namespace',\n        uid:       'any-uid'\n      },\n      spec: { jobTemplate: {} }\n    };\n    const expectation = {\n      name: 'any-name', namespace: 'any-namespace', uid: 'any-uid'\n    };\n    const cronjob = new Cronjob(cronJobData);\n\n    expect(cronjob.metadata).toStrictEqual(expectation);\n  });\n\n  describe('method runNow', () => {\n    it('should populate job metadata', async() => {\n      const jobData = {\n        id:         'any-id',\n        type:       'batch.job',\n        apiVersion: 'batch/v1',\n        kind:       'Job',\n        metadata:   {\n          name:      'any-name',\n          namespace: 'any-namespace',\n          uid:       'any-uid'\n        },\n        spec: { jobTemplate: {} }\n      };\n      const date = Date.now();\n      const expected = {\n        name:            `${ jobData.metadata.name }-${ date }`,\n        namespace:       jobData.metadata.namespace,\n        ownerReferences: [{\n          apiVersion: 'batch/v1',\n          controller: true,\n          kind:       'Job',\n          name:       jobData.metadata.name,\n          uid:        jobData.metadata.uid\n        }],\n        uid: jobData.metadata.uid\n      };\n      const dispatcher = () => ({\n        ...jobData,\n        save:       jest.fn(),\n        goToDetail: jest.fn()\n      });\n      const cronjob = new Cronjob(jobData, { dispatch: dispatcher });\n\n      jest\n        .useFakeTimers()\n        .setSystemTime(date);\n      jest.spyOn(cronjob, '$dispatch').mockImplementation(dispatcher);\n\n      await cronjob.runNow();\n\n      expect(cronjob.metadata).toStrictEqual(expected);\n    });\n\n    it('should redirect to another page', async() => {\n      const jobData = {\n        metadata: { name: 'any-name' },\n        spec:     { jobTemplate: {} }\n      };\n      const callback = jest.fn();\n      const dispatcher = () => ({\n        ...jobData,\n        save:       jest.fn(),\n        goToDetail: callback\n      });\n      const cronjob = new Cronjob(jobData, { dispatch: dispatcher });\n\n      jest.spyOn(cronjob, '$dispatch').mockImplementation(dispatcher);\n\n      await cronjob.runNow();\n\n      expect(callback).toHaveBeenCalledWith();\n    });\n  });\n});\n"]}]}