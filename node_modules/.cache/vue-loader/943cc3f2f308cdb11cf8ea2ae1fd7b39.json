{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/machine-config/digitalocean.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/machine-config/digitalocean.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsKaW1wb3J0IExhYmVsZWRTZWxlY3QgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9MYWJlbGVkU2VsZWN0JzsKaW1wb3J0IEFycmF5TGlzdCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0FycmF5TGlzdCc7CmltcG9ydCB7IENoZWNrYm94IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9DaGVja2JveCc7CmltcG9ydCB7IE5PUk1BTiB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBzdHJpbmdpZnksIGV4Y2VwdGlvblRvRXJyb3JzQXJyYXkgfSBmcm9tICdAc2hlbGwvdXRpbHMvZXJyb3InOwppbXBvcnQgeyBfQ1JFQVRFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyBCYW5uZXIgfSBmcm9tICdAY29tcG9uZW50cy9CYW5uZXInOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmcsIExhYmVsZWRTZWxlY3QsIEFycmF5TGlzdCwgQ2hlY2tib3gsIEJhbm5lcgogIH0sCgogIG1peGluczogW0NyZWF0ZUVkaXRWaWV3XSwKCiAgcHJvcHM6IHsKICAgIGNyZWRlbnRpYWxJZDogewogICAgICB0eXBlOiAgICAgU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCgogICAgZGlzYWJsZWQ6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgfSwKCiAgYXN5bmMgZmV0Y2goKSB7CiAgICB0aGlzLmVycm9ycyA9IFtdOwoKICAgIHRyeSB7CiAgICAgIGlmICggdGhpcy5jcmVkZW50aWFsSWQgKSB7CiAgICAgICAgdGhpcy5jcmVkZW50aWFsID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3JhbmNoZXIvZmluZCcsIHsgdHlwZTogTk9STUFOLkNMT1VEX0NSRURFTlRJQUwsIGlkOiB0aGlzLmNyZWRlbnRpYWxJZCB9KTsKICAgICAgfQogICAgfSBjYXRjaCAoZSkgewogICAgICB0aGlzLmNyZWRlbnRpYWwgPSBudWxsOwogICAgfQoKICAgIHRyeSB7CiAgICAgIHRoaXMucmVnaW9uT3B0aW9ucyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdkaWdpdGFsb2NlYW4vcmVnaW9uT3B0aW9ucycsIHsgY3JlZGVudGlhbElkOiB0aGlzLmNyZWRlbnRpYWxJZCB9KTsKCiAgICAgIGxldCBkZWZhdWx0UmVnaW9uID0gJ3NmbzMnOwoKICAgICAgaWYgKCAhdGhpcy5yZWdpb25PcHRpb25zLmZpbmQoKHgpID0+IHgudmFsdWUgPT09IGRlZmF1bHRSZWdpb24pICkgewogICAgICAgIGRlZmF1bHRSZWdpb24gPSB0aGlzLnJlZ2lvbk9wdGlvbnNbMF0/LnZhbHVlOwogICAgICB9CgogICAgICBjb25zdCByZWdpb24gPSB0aGlzLnZhbHVlLnJlZ2lvbiB8fCB0aGlzLmNyZWRlbnRpYWw/LmRlZmF1bHRSZWdpb24gfHwgZGVmYXVsdFJlZ2lvbjsKCiAgICAgIGlmICggIXRoaXMudmFsdWUucmVnaW9uICkgewogICAgICAgIHRoaXMudmFsdWUucmVnaW9uID0gcmVnaW9uOwogICAgICB9CgogICAgICB0aGlzLmluc3RhbmNlT3B0aW9ucyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdkaWdpdGFsb2NlYW4vaW5zdGFuY2VPcHRpb25zJywgeyBjcmVkZW50aWFsSWQ6IHRoaXMuY3JlZGVudGlhbElkLCByZWdpb24gfSk7CgogICAgICBsZXQgZGVmYXVsdFNpemUgPSAncy0ydmNwdS00Z2InOwoKICAgICAgaWYgKCAhdGhpcy5pbnN0YW5jZU9wdGlvbnMuZmluZCgoeCkgPT4geC52YWx1ZSA9PT0gZGVmYXVsdFNpemUpICkgewogICAgICAgIGRlZmF1bHRTaXplID0gdGhpcy5pbnN0YW5jZU9wdGlvbnMuZmluZCgoeCkgPT4geC5tZW1vcnlHYiA+PSA0KT8udmFsdWU7CgogICAgICAgIGlmICggIWRlZmF1bHRTaXplICkgewogICAgICAgICAgZGVmYXVsdFNpemUgPSB0aGlzLmluc3RhbmNlT3B0aW9uc1swXS52YWx1ZTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGlmICggIXRoaXMudmFsdWUuc2l6ZSApIHsKICAgICAgICB0aGlzLnZhbHVlLnNpemUgPSBkZWZhdWx0U2l6ZTsKICAgICAgfQoKICAgICAgdGhpcy5pbWFnZU9wdGlvbnMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZGlnaXRhbG9jZWFuL2ltYWdlT3B0aW9ucycsIHsgY3JlZGVudGlhbElkOiB0aGlzLmNyZWRlbnRpYWxJZCwgcmVnaW9uIH0pOwoKICAgICAgbGV0IGRlZmF1bHRJbWFnZSA9ICd1YnVudHUtMjAtMDQteDY0JzsKCiAgICAgIGlmICggIXRoaXMuaW1hZ2VPcHRpb25zLmZpbmQoKHgpID0+IHgudmFsdWUgPT09IGRlZmF1bHRJbWFnZSkgKSB7CiAgICAgICAgZGVmYXVsdEltYWdlID0gdGhpcy5pbWFnZU9wdGlvbnNbMF0udmFsdWU7CiAgICAgIH0KCiAgICAgIGlmICggIXRoaXMudmFsdWUuaW1hZ2UgKSB7CiAgICAgICAgdGhpcy52YWx1ZS5pbWFnZSA9IGRlZmF1bHRJbWFnZTsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVVc2VybmFtZSgpOwogICAgfSBjYXRjaCAoZSkgewogICAgICB0aGlzLmVycm9ycyA9IGV4Y2VwdGlvblRvRXJyb3JzQXJyYXkoZSk7CiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIGxldCB0YWdzID0gbnVsbDsKCiAgICBpZiAodGhpcy52YWx1ZS50YWdzKSB7CiAgICAgIHRhZ3MgPSB0aGlzLnZhbHVlLnRhZ3Muc3BsaXQoJywnKTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBjcmVkZW50aWFsOiAgICAgIG51bGwsCiAgICAgIHJlZ2lvbk9wdGlvbnM6ICAgbnVsbCwKICAgICAgaW1hZ2VPcHRpb25zOiAgICBudWxsLAogICAgICBpbnN0YW5jZU9wdGlvbnM6IG51bGwsCiAgICAgIHRhZ3MKICAgIH07CiAgfSwKCiAgd2F0Y2g6IHsKICAgICdjcmVkZW50aWFsSWQnKCkgewogICAgICB0aGlzLiRmZXRjaCgpOwogICAgfSwKCiAgICAndmFsdWUuaW1hZ2UnOiAndXBkYXRlVXNlcm5hbWUnLAogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBpc0NyZWF0ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMubW9kZSA9PT0gX0NSRUFURTsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICBzdHJpbmdpZnksCgogICAgdXBkYXRlVXNlcm5hbWUoKSB7CiAgICAgIGlmICggdGhpcy52YWx1ZS5pbWFnZS5tYXRjaCgvcmFuY2hlcm9zL2kpICkgewogICAgICAgIHRoaXMudmFsdWUuc3NoVXNlciA9ICdyYW5jaGVyJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnZhbHVlLnNzaFVzZXIgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgIH0sCgogICAgdXBkYXRlVGFncygpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUsICd0YWdzJywgdGhpcy50YWdzLmpvaW4oKSk7CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["digitalocean.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"digitalocean.vue","sourceRoot":"node_modules/@rancher/shell/machine-config","sourcesContent":["<script>\nimport Loading from '@shell/components/Loading';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport ArrayList from '@shell/components/form/ArrayList';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { NORMAN } from '@shell/config/types';\nimport { stringify, exceptionToErrorsArray } from '@shell/utils/error';\nimport { _CREATE } from '@shell/config/query-params';\nimport { Banner } from '@components/Banner';\n\nexport default {\n  components: {\n    Loading, LabeledSelect, ArrayList, Checkbox, Banner\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    credentialId: {\n      type:     String,\n      required: true,\n    },\n\n    disabled: {\n      type:    Boolean,\n      default: false\n    },\n  },\n\n  async fetch() {\n    this.errors = [];\n\n    try {\n      if ( this.credentialId ) {\n        this.credential = await this.$store.dispatch('rancher/find', { type: NORMAN.CLOUD_CREDENTIAL, id: this.credentialId });\n      }\n    } catch (e) {\n      this.credential = null;\n    }\n\n    try {\n      this.regionOptions = await this.$store.dispatch('digitalocean/regionOptions', { credentialId: this.credentialId });\n\n      let defaultRegion = 'sfo3';\n\n      if ( !this.regionOptions.find((x) => x.value === defaultRegion) ) {\n        defaultRegion = this.regionOptions[0]?.value;\n      }\n\n      const region = this.value.region || this.credential?.defaultRegion || defaultRegion;\n\n      if ( !this.value.region ) {\n        this.value.region = region;\n      }\n\n      this.instanceOptions = await this.$store.dispatch('digitalocean/instanceOptions', { credentialId: this.credentialId, region });\n\n      let defaultSize = 's-2vcpu-4gb';\n\n      if ( !this.instanceOptions.find((x) => x.value === defaultSize) ) {\n        defaultSize = this.instanceOptions.find((x) => x.memoryGb >= 4)?.value;\n\n        if ( !defaultSize ) {\n          defaultSize = this.instanceOptions[0].value;\n        }\n      }\n\n      if ( !this.value.size ) {\n        this.value.size = defaultSize;\n      }\n\n      this.imageOptions = await this.$store.dispatch('digitalocean/imageOptions', { credentialId: this.credentialId, region });\n\n      let defaultImage = 'ubuntu-20-04-x64';\n\n      if ( !this.imageOptions.find((x) => x.value === defaultImage) ) {\n        defaultImage = this.imageOptions[0].value;\n      }\n\n      if ( !this.value.image ) {\n        this.value.image = defaultImage;\n      }\n\n      this.updateUsername();\n    } catch (e) {\n      this.errors = exceptionToErrorsArray(e);\n    }\n  },\n\n  data() {\n    let tags = null;\n\n    if (this.value.tags) {\n      tags = this.value.tags.split(',');\n    }\n\n    return {\n      credential:      null,\n      regionOptions:   null,\n      imageOptions:    null,\n      instanceOptions: null,\n      tags\n    };\n  },\n\n  watch: {\n    'credentialId'() {\n      this.$fetch();\n    },\n\n    'value.image': 'updateUsername',\n  },\n\n  computed: {\n    isCreate() {\n      return this.mode === _CREATE;\n    }\n  },\n\n  methods: {\n    stringify,\n\n    updateUsername() {\n      if ( this.value.image.match(/rancheros/i) ) {\n        this.value.sshUser = 'rancher';\n      } else {\n        this.value.sshUser = undefined;\n      }\n    },\n\n    updateTags() {\n      this.$set(this.value, 'tags', this.tags.join());\n    }\n  },\n};\n</script>\n\n<template>\n  <Loading\n    v-if=\"$fetchState.pending\"\n    :delayed=\"true\"\n  />\n  <div v-else-if=\"errors.length\">\n    <div\n      v-for=\"(err, idx) in errors\"\n      :key=\"idx\"\n    >\n      <Banner\n        color=\"error\"\n        :label=\"stringify(err)\"\n      />\n    </div>\n  </div>\n  <div v-else>\n    <div class=\"row mt-20\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.region\"\n          :mode=\"mode\"\n          :options=\"regionOptions\"\n          :searchable=\"true\"\n          :required=\"true\"\n          :disabled=\"disabled\"\n          label=\"Region\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.size\"\n          :mode=\"mode\"\n          :options=\"instanceOptions\"\n          :searchable=\"true\"\n          :required=\"true\"\n          :disabled=\"disabled\"\n          label=\"Size\"\n        />\n      </div>\n    </div>\n\n    <div class=\"row mt-20\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.image\"\n          :mode=\"mode\"\n          :options=\"imageOptions\"\n          :searchable=\"true\"\n          :required=\"true\"\n          :disabled=\"disabled\"\n          label=\"OS Image\"\n        />\n      </div>\n      <div class=\"col span-6 pt-5\">\n        <h3>Additional DigitalOcean Options</h3>\n        <Checkbox\n          v-model=\"value.monitoring\"\n          :mode=\"mode\"\n          :disabled=\"disabled\"\n          label=\"Monitoring\"\n        />\n        <Checkbox\n          v-model=\"value.ipv6\"\n          :mode=\"mode\"\n          :disabled=\"disabled\"\n          label=\"IPv6\"\n        />\n        <Checkbox\n          v-model=\"value.privateNetworking\"\n          :mode=\"mode\"\n          :disabled=\"disabled\"\n          label=\"Private Networking\"\n        />\n      </div>\n    </div>\n    <div class=\"row mt-20\">\n      <div class=\"col span-6\">\n        <ArrayList\n          v-model=\"tags\"\n          :mode=\"mode\"\n          :protip=\"false\"\n          :title=\"t('cluster.machineConfig.digitalocean.tags.label')\"\n          :value-placeholder=\"t('cluster.machineConfig.digitalocean.tags.placeholder')\"\n          :disabled=\"!isCreate\"\n          :add-allowed=\"isCreate\"\n          :remove-allowed=\"isCreate\"\n          @input=\"updateTags\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n"]}]}