{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/ContainerResourceLimit.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/ContainerResourceLimit.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBpc0VtcHR5IGZyb20gJ2xvZGFzaC9pc0VtcHR5JzsKaW1wb3J0IFVuaXRJbnB1dCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL1VuaXRJbnB1dCc7CmltcG9ydCB7IENPTlRBSU5FUl9ERUZBVUxUX1JFU09VUkNFX0xJTUlUIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBjbGVhblVwIH0gZnJvbSAnQHNoZWxsL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IF9WSUVXIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgVW5pdElucHV0IH0sCgogIHByb3BzOiB7CiAgICBtb2RlOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ2NyZWF0ZScKICAgIH0sCgogICAgbmFtZXNwYWNlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogbnVsbAogICAgfSwKCiAgICB2YWx1ZTogewogICAgICB0eXBlOiAgICBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+IHsKICAgICAgICByZXR1cm4ge307CiAgICAgIH0KICAgIH0sCgogICAgaGFuZGxlR3B1TGltaXQ6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogdHJ1ZQogICAgfSwKCiAgICByZWdpc3RlckJlZm9yZUhvb2s6IHsKICAgICAgdHlwZTogICAgRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6IG51bGwKICAgIH0sCgogICAgc2hvd1RpcDogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IHsKICAgICAgbGltaXRzQ3B1LCBsaW1pdHNNZW1vcnksIHJlcXVlc3RzQ3B1LCByZXF1ZXN0c01lbW9yeSwgbGltaXRzR3B1CiAgICB9ID0gdGhpcy52YWx1ZTsKCiAgICByZXR1cm4gewogICAgICBsaW1pdHNDcHUsIGxpbWl0c01lbW9yeSwgcmVxdWVzdHNDcHUsIHJlcXVlc3RzTWVtb3J5LCBsaW1pdHNHcHUsIHZpZXdNb2RlOiBfVklFVwogICAgfTsKICB9LAoKICB3YXRjaDogewogICAgdmFsdWUoKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBsaW1pdHNDcHUsIGxpbWl0c01lbW9yeSwgcmVxdWVzdHNDcHUsIHJlcXVlc3RzTWVtb3J5LCBsaW1pdHNHcHUKICAgICAgfSA9IHRoaXMudmFsdWU7CgogICAgICB0aGlzLmxpbWl0c0NwdSA9IGxpbWl0c0NwdTsKICAgICAgdGhpcy5saW1pdHNNZW1vcnkgPSBsaW1pdHNNZW1vcnk7CiAgICAgIHRoaXMucmVxdWVzdHNDcHUgPSByZXF1ZXN0c0NwdTsKICAgICAgdGhpcy5yZXF1ZXN0c01lbW9yeSA9IHJlcXVlc3RzTWVtb3J5OwogICAgICB0aGlzLmxpbWl0c0dwdSA9IGxpbWl0c0dwdTsKICAgIH0KICB9LAoKICBjb21wdXRlZDogewogICAgZGV0YWlsVG9wQ29sdW1ucygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICB0aXRsZTogdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi90J10oJ2dlbmVyaWMuY3JlYXRlZCcpLAogICAgICAgICAgbmFtZTogICdjcmVhdGVkJwogICAgICAgIH0sCiAgICAgIF07CiAgICB9LAogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcz8ubmFtZXNwYWNlPy5pZCkgewogICAgICB0aGlzLmluaXRMaW1pdHMoKTsKICAgIH0KCiAgICBpZiAodGhpcy5yZWdpc3RlckJlZm9yZUhvb2spIHsKICAgICAgdGhpcy5yZWdpc3RlckJlZm9yZUhvb2sodGhpcy51cGRhdGVCZWZvcmVTYXZlKTsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICB1cGRhdGVMaW1pdHMoKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBsaW1pdHNDcHUsCiAgICAgICAgbGltaXRzTWVtb3J5LAogICAgICAgIHJlcXVlc3RzQ3B1LAogICAgICAgIHJlcXVlc3RzTWVtb3J5LAogICAgICAgIGxpbWl0c0dwdQogICAgICB9ID0gdGhpczsKCiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgY2xlYW5VcCh7CiAgICAgICAgbGltaXRzQ3B1LAogICAgICAgIGxpbWl0c01lbW9yeSwKICAgICAgICByZXF1ZXN0c0NwdSwKICAgICAgICBsaW1pdHNHcHUsCiAgICAgICAgcmVxdWVzdHNNZW1vcnkKICAgICAgfSkpOwogICAgfSwKCiAgICB1cGRhdGVCZWZvcmVTYXZlKHZhbHVlKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBsaW1pdHNDcHUsCiAgICAgICAgbGltaXRzTWVtb3J5LAogICAgICAgIHJlcXVlc3RzQ3B1LAogICAgICAgIHJlcXVlc3RzTWVtb3J5LAogICAgICAgIGxpbWl0c0dwdQogICAgICB9ID0gdGhpczsKICAgICAgY29uc3QgbmFtZXNwYWNlID0gdGhpcy5uYW1lc3BhY2U7IC8vIG5vIGRlZXAgY29weSBpbiBkZXN0cnVjdHVyZSBwcm94eSB5ZXQKCiAgICAgIGNvbnN0IG91dCA9IGNsZWFuVXAoewogICAgICAgIGxpbWl0c0NwdSwKICAgICAgICBsaW1pdHNNZW1vcnksCiAgICAgICAgcmVxdWVzdHNDcHUsCiAgICAgICAgbGltaXRzR3B1LAogICAgICAgIHJlcXVlc3RzTWVtb3J5CiAgICAgIH0pOwoKICAgICAgaWYgKG5hbWVzcGFjZSkgewogICAgICAgIG5hbWVzcGFjZS5zZXRBbm5vdGF0aW9uKENPTlRBSU5FUl9ERUZBVUxUX1JFU09VUkNFX0xJTUlULCBKU09OLnN0cmluZ2lmeShvdXQpKTsKICAgICAgfQogICAgfSwKCiAgICBpbml0TGltaXRzKCkgewogICAgICBjb25zdCBuYW1lc3BhY2UgPSB0aGlzLm5hbWVzcGFjZTsKICAgICAgY29uc3QgZGVmYXVsdHMgPSBuYW1lc3BhY2U/Lm1ldGFkYXRhPy5hbm5vdGF0aW9uc1tDT05UQUlORVJfREVGQVVMVF9SRVNPVVJDRV9MSU1JVF07CgogICAgICAvLyBFbWJlciBVSSBjYW4gc2V0IHRoZSBkZWZhdWx0cyB0byB0aGUgc3RyaW5nIGxpdGVyYWwgJ251bGwnCiAgICAgIGlmICghaXNFbXB0eShkZWZhdWx0cykgJiYgZGVmYXVsdHMgIT09ICdudWxsJykgewogICAgICAgIGNvbnN0IHsKICAgICAgICAgIGxpbWl0c0NwdSwKICAgICAgICAgIGxpbWl0c01lbW9yeSwKICAgICAgICAgIHJlcXVlc3RzQ3B1LAogICAgICAgICAgcmVxdWVzdHNNZW1vcnksCiAgICAgICAgICBsaW1pdHNHcHUKICAgICAgICB9ID0gSlNPTi5wYXJzZShkZWZhdWx0cyk7CgogICAgICAgIHRoaXMubGltaXRzQ3B1ID0gbGltaXRzQ3B1OwogICAgICAgIHRoaXMubGltaXRzTWVtb3J5ID0gbGltaXRzTWVtb3J5OwogICAgICAgIHRoaXMucmVxdWVzdHNDcHUgPSByZXF1ZXN0c0NwdTsKICAgICAgICB0aGlzLnJlcXVlc3RzTWVtb3J5ID0gcmVxdWVzdHNNZW1vcnk7CiAgICAgICAgdGhpcy5saW1pdHNHcHUgPSBsaW1pdHNHcHU7CiAgICAgIH0KICAgIH0sCiAgfQoKfTsK"},{"version":3,"sources":["ContainerResourceLimit.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"ContainerResourceLimit.vue","sourceRoot":"node_modules/@rancher/shell/components","sourcesContent":["<script>\nimport isEmpty from 'lodash/isEmpty';\nimport UnitInput from '@shell/components/form/UnitInput';\nimport { CONTAINER_DEFAULT_RESOURCE_LIMIT } from '@shell/config/labels-annotations';\nimport { cleanUp } from '@shell/utils/object';\nimport { _VIEW } from '@shell/config/query-params';\n\nexport default {\n  components: { UnitInput },\n\n  props: {\n    mode: {\n      type:    String,\n      default: 'create'\n    },\n\n    namespace: {\n      type:    Object,\n      default: null\n    },\n\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n\n    handleGpuLimit: {\n      type:    Boolean,\n      default: true\n    },\n\n    registerBeforeHook: {\n      type:    Function,\n      default: null\n    },\n\n    showTip: {\n      type:    Boolean,\n      default: true\n    }\n  },\n\n  data() {\n    const {\n      limitsCpu, limitsMemory, requestsCpu, requestsMemory, limitsGpu\n    } = this.value;\n\n    return {\n      limitsCpu, limitsMemory, requestsCpu, requestsMemory, limitsGpu, viewMode: _VIEW\n    };\n  },\n\n  watch: {\n    value() {\n      const {\n        limitsCpu, limitsMemory, requestsCpu, requestsMemory, limitsGpu\n      } = this.value;\n\n      this.limitsCpu = limitsCpu;\n      this.limitsMemory = limitsMemory;\n      this.requestsCpu = requestsCpu;\n      this.requestsMemory = requestsMemory;\n      this.limitsGpu = limitsGpu;\n    }\n  },\n\n  computed: {\n    detailTopColumns() {\n      return [\n        {\n          title: this.$store.getters['i18n/t']('generic.created'),\n          name:  'created'\n        },\n      ];\n    },\n  },\n\n  created() {\n    if (this?.namespace?.id) {\n      this.initLimits();\n    }\n\n    if (this.registerBeforeHook) {\n      this.registerBeforeHook(this.updateBeforeSave);\n    }\n  },\n\n  methods: {\n    updateLimits() {\n      const {\n        limitsCpu,\n        limitsMemory,\n        requestsCpu,\n        requestsMemory,\n        limitsGpu\n      } = this;\n\n      this.$emit('input', cleanUp({\n        limitsCpu,\n        limitsMemory,\n        requestsCpu,\n        limitsGpu,\n        requestsMemory\n      }));\n    },\n\n    updateBeforeSave(value) {\n      const {\n        limitsCpu,\n        limitsMemory,\n        requestsCpu,\n        requestsMemory,\n        limitsGpu\n      } = this;\n      const namespace = this.namespace; // no deep copy in destructure proxy yet\n\n      const out = cleanUp({\n        limitsCpu,\n        limitsMemory,\n        requestsCpu,\n        limitsGpu,\n        requestsMemory\n      });\n\n      if (namespace) {\n        namespace.setAnnotation(CONTAINER_DEFAULT_RESOURCE_LIMIT, JSON.stringify(out));\n      }\n    },\n\n    initLimits() {\n      const namespace = this.namespace;\n      const defaults = namespace?.metadata?.annotations[CONTAINER_DEFAULT_RESOURCE_LIMIT];\n\n      // Ember UI can set the defaults to the string literal 'null'\n      if (!isEmpty(defaults) && defaults !== 'null') {\n        const {\n          limitsCpu,\n          limitsMemory,\n          requestsCpu,\n          requestsMemory,\n          limitsGpu\n        } = JSON.parse(defaults);\n\n        this.limitsCpu = limitsCpu;\n        this.limitsMemory = limitsMemory;\n        this.requestsCpu = requestsCpu;\n        this.requestsMemory = requestsMemory;\n        this.limitsGpu = limitsGpu;\n      }\n    },\n  }\n\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row\">\n      <div\n        v-if=\"showTip\"\n        class=\"col span-12\"\n      >\n        <p class=\"helper-text mb-10\">\n          <t\n            v-if=\"mode === viewMode\"\n            k=\"containerResourceLimit.helpTextDetail\"\n          />\n          <t\n            v-else\n            k=\"containerResourceLimit.helpText\"\n          />\n        </p>\n      </div>\n    </div>\n\n    <div class=\"row mb-20\">\n      <span class=\"col span-6\">\n        <UnitInput\n          v-model=\"requestsCpu\"\n          :placeholder=\"t('containerResourceLimit.cpuPlaceholder')\"\n          :label=\"t('containerResourceLimit.requestsCpu')\"\n          :mode=\"mode\"\n          :input-exponent=\"-1\"\n          :output-modifier=\"true\"\n          :base-unit=\"t('suffix.cpus')\"\n          data-testid=\"cpu-reservation\"\n          @input=\"updateLimits\"\n        />\n      </span>\n      <span class=\"col span-6\">\n        <UnitInput\n          v-model=\"requestsMemory\"\n          :placeholder=\"t('containerResourceLimit.memPlaceholder')\"\n          :label=\"t('containerResourceLimit.requestsMemory')\"\n          :mode=\"mode\"\n          :input-exponent=\"2\"\n          :increment=\"1024\"\n          :output-modifier=\"true\"\n          data-testid=\"memory-reservation\"\n          @input=\"updateLimits\"\n        />\n      </span>\n    </div>\n\n    <div class=\"row mb-20\">\n      <span class=\"col span-6\">\n        <UnitInput\n          v-model=\"limitsCpu\"\n          :placeholder=\"t('containerResourceLimit.cpuPlaceholder')\"\n          :label=\"t('containerResourceLimit.limitsCpu')\"\n          :mode=\"mode\"\n          :input-exponent=\"-1\"\n          :output-modifier=\"true\"\n          :base-unit=\"t('suffix.cpus')\"\n          data-testid=\"cpu-limit\"\n          @input=\"updateLimits\"\n        />\n      </span>\n      <span class=\"col span-6\">\n        <UnitInput\n          v-model=\"limitsMemory\"\n          :placeholder=\"t('containerResourceLimit.memPlaceholder')\"\n          :label=\"t('containerResourceLimit.limitsMemory')\"\n          :mode=\"mode\"\n          :input-exponent=\"2\"\n          :increment=\"1024\"\n          :output-modifier=\"true\"\n          data-testid=\"memory-limit\"\n          @input=\"updateLimits\"\n        />\n      </span>\n    </div>\n    <div\n      v-if=\"handleGpuLimit\"\n      class=\"row\"\n    >\n      <span class=\"col span-6\">\n        <UnitInput\n          v-model=\"limitsGpu\"\n          :placeholder=\"t('containerResourceLimit.gpuPlaceholder')\"\n          :label=\"t('containerResourceLimit.limitsGpu')\"\n          :mode=\"mode\"\n          :base-unit=\"t('suffix.gpus')\"\n          data-testid=\"gpu-limit\"\n          @input=\"updateLimits\"\n        />\n      </span>\n    </div>\n  </div>\n</template>\n"]}]}