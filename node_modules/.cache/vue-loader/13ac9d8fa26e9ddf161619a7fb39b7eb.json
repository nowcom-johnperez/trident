{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/provisioning.cattle.io.cluster.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/provisioning.cattle.io.cluster.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgeyBCYW5uZXIgfSBmcm9tICdAY29tcG9uZW50cy9CYW5uZXInOwppbXBvcnQgUmVzb3VyY2VUYWJsZSwgeyBkZWZhdWx0VGFibGVTb3J0R2VuZXJhdGlvbkZuIH0gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvUmVzb3VyY2VUYWJsZSc7CmltcG9ydCBSZXNvdXJjZVRhYnMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9SZXNvdXJjZVRhYnMnOwppbXBvcnQgU29ydGFibGVUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Tb3J0YWJsZVRhYmxlJzsKaW1wb3J0IENvcHlDb2RlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NvcHlDb2RlJzsKaW1wb3J0IFRhYiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvVGFiJzsKaW1wb3J0IHsgYWxsSGFzaCB9IGZyb20gJ0BzaGVsbC91dGlscy9wcm9taXNlJzsKaW1wb3J0IHsgQ0FQSSwgTUFOQUdFTUVOVCwgTk9STUFOLCBTTkFQU0hPVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgewogIFNUQVRFLCBOQU1FIGFzIE5BTUVfQ09MLCBBR0UsIEFHRV9OT1JNQU4sIElOVEVSTkFMX0VYVEVSTkFMX0lQLCBTVEFURV9OT1JNQU4sIFJPTEVTLCBNQUNISU5FX05PREVfT1MsIE1BTkFHRU1FTlRfTk9ERV9PUywgTkFNRSwKfSBmcm9tICdAc2hlbGwvY29uZmlnL3RhYmxlLWhlYWRlcnMnOwppbXBvcnQgeyBTVEFURVNfRU5VTSB9IGZyb20gJ0BzaGVsbC9wbHVnaW5zL2Rhc2hib2FyZC1zdG9yZS9yZXNvdXJjZS1jbGFzcyc7CmltcG9ydCBDdXN0b21Db21tYW5kIGZyb20gJ0BzaGVsbC9lZGl0L3Byb3Zpc2lvbmluZy5jYXR0bGUuaW8uY2x1c3Rlci9DdXN0b21Db21tYW5kJzsKaW1wb3J0IEFzeW5jQnV0dG9uIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0FzeW5jQnV0dG9uLnZ1ZSc7CmltcG9ydCBBbnNpVXAgZnJvbSAnYW5zaV91cCc7CmltcG9ydCBkYXkgZnJvbSAnZGF5anMnOwppbXBvcnQgeyBhZGRQYXJhbXMgfSBmcm9tICdAc2hlbGwvdXRpbHMvdXJsJzsKaW1wb3J0IHsgYmFzZTY0RGVjb2RlIH0gZnJvbSAnQHNoZWxsL3V0aWxzL2NyeXB0byc7CmltcG9ydCB7IERBVEVfRk9STUFULCBUSU1FX0ZPUk1BVCwgU0NBTEVfUE9PTF9QUk9NUFQgfSBmcm9tICdAc2hlbGwvc3RvcmUvcHJlZnMnOwppbXBvcnQgeyBlc2NhcGVIdG1sIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCBNYWNoaW5lU3VtbWFyeUdyYXBoIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm1hdHRlci9NYWNoaW5lU3VtbWFyeUdyYXBoJzsKaW1wb3J0IFNvY2tldCwgewogIEVWRU5UX0NPTk5FQ1RFRCwKICBFVkVOVF9ESVNDT05ORUNURUQsCiAgRVZFTlRfTUVTU0FHRSwKICAvLyAgRVZFTlRfRlJBTUVfVElNRU9VVCwKICBFVkVOVF9DT05ORUNUX0VSUk9SCn0gZnJvbSAnQHNoZWxsL3V0aWxzL3NvY2tldCc7CmltcG9ydCB7IGdldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgQ2FwaU1hY2hpbmVEZXBsb3ltZW50IGZyb20gJ0BzaGVsbC9tb2RlbHMvY2x1c3Rlci54LWs4cy5pby5tYWNoaW5lZGVwbG95bWVudCc7CmltcG9ydCB7IGlzQWx0ZXJuYXRlIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3BsYXRmb3JtJzsKCmxldCBsYXN0SWQgPSAxOwpjb25zdCBhbnNpdXAgPSBuZXcgQW5zaVVwKCk7CgovKioKICogTWFjaGluZSBEZXBsb3ltZW50IGhhcyBhIHJlZmVyZW5jZSB0byB0aGUgJ3RlbXBsYXRlJyB1c2VkIHRvIGNyZWF0ZSB0aGF0IGRlcGxveW1lbnQKICogRm9yIGFuIGVtcHR5IG1hY2hpbmUgcG9vbCwgd2UgKG9idmlvdXNseSkgZG9uJ3QgZ2V0IGFueSBtYWNoaW5lIGRlcGxveW1lbnRzIGZvciB0aGF0IHBvb2wuCiAqCiAqIFRoaXMgY2xhc3MgYWxsb3dzIHVzIHRvIGZha2UgYSBtYWNoaW5lIGRlcGxveW1lbnQgLSB3aGVuIGNyZWF0ZWQsIHdlIHNldCBhZGRpdGlvbmFsIHByb3BlcnRpZXMgKF9jbHVzdGVyIGV0YykKICogYW5kIHVzZSB0aGVzZSBpbiB0aGUgZ2V0dGVycy4KICoqLwpjbGFzcyBFbXB0eUNhcGlNYWNoaW5lRGVwbG95bWVudCBleHRlbmRzIENhcGlNYWNoaW5lRGVwbG95bWVudCB7CiAgZ2V0IGluQ2x1c3RlclNwZWMoKSB7CiAgICByZXR1cm4gdGhpcy5fY2x1c3RlclNwZWM7CiAgfQoKICBnZXQgY2x1c3RlcigpIHsKICAgIHJldHVybiB0aGlzLl9jbHVzdGVyOwogIH0KCiAgZ2V0IHRlbXBsYXRlKCkgewogICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlOwogIH0KfQoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmcsCiAgICBCYW5uZXIsCiAgICBSZXNvdXJjZVRhYmxlLAogICAgUmVzb3VyY2VUYWJzLAogICAgU29ydGFibGVUYWJsZSwKICAgIFRhYiwKICAgIENvcHlDb2RlLAogICAgQ3VzdG9tQ29tbWFuZCwKICAgIEFzeW5jQnV0dG9uLAogICAgTWFjaGluZVN1bW1hcnlHcmFwaCwKICB9LAoKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgT2JqZWN0LAogICAgICBkZWZhdWx0OiAoKSA9PiB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9CiAgfSwKCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBhd2FpdCB0aGlzLnZhbHVlLndhaXRGb3JQcm92aXNpb25lcigpOwoKICAgIGNvbnN0IGV4dENsYXNzID0gdGhpcy4kcGx1Z2luLmdldER5bmFtaWMoJ3Byb3Zpc2lvbmVyJywgdGhpcy52YWx1ZS5tYWNoaW5lUHJvdmlkZXIpOwoKICAgIGlmIChleHRDbGFzcykgewogICAgICB0aGlzLmV4dFByb3ZpZGVyID0gbmV3IGV4dENsYXNzKHsKICAgICAgICBkaXNwYXRjaDogdGhpcy4kc3RvcmUuZGlzcGF0Y2gsCiAgICAgICAgZ2V0dGVyczogIHRoaXMuJHN0b3JlLmdldHRlcnMsCiAgICAgICAgYXhpb3M6ICAgIHRoaXMuJHN0b3JlLiRheGlvcywKICAgICAgICAkcGx1Z2luOiAgdGhpcy4kc3RvcmUuYXBwLiRwbHVnaW4sCiAgICAgICAgJHQ6ICAgICAgIHRoaXMudAogICAgICB9KTsKICAgICAgdGhpcy5leHREZXRhaWxUYWJzID0gewogICAgICAgIC4uLnRoaXMuZXh0RGV0YWlsVGFicywKICAgICAgICAuLi50aGlzLmV4dFByb3ZpZGVyLmRldGFpbFRhYnMKICAgICAgfTsKICAgICAgdGhpcy5leHRDdXN0b21QYXJhbXMgPSB7IHByb3ZpZGVyOiB0aGlzLnZhbHVlLm1hY2hpbmVQcm92aWRlciB9OwogICAgfQoKICAgIGNvbnN0IGZldGNoT25lID0ge307CgogICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2Nhbkxpc3QnXShDQVBJLk1BQ0hJTkVfREVQTE9ZTUVOVCkgKSB7CiAgICAgIGZldGNoT25lLm1hY2hpbmVEZXBsb3ltZW50cyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IENBUEkuTUFDSElORV9ERVBMT1lNRU5UIH0pOwogICAgfQoKICAgIGlmICggdGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9jYW5MaXN0J10oQ0FQSS5NQUNISU5FKSApIHsKICAgICAgZmV0Y2hPbmUubWFjaGluZXMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBDQVBJLk1BQ0hJTkUgfSk7CiAgICB9CgogICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2Nhbkxpc3QnXShTTkFQU0hPVCkgKSB7CiAgICAgIGZldGNoT25lLnNuYXBzaG90cyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IFNOQVBTSE9UIH0pOwogICAgfQoKICAgIGlmICggdGhpcy52YWx1ZS5pc0ltcG9ydGVkIHx8IHRoaXMudmFsdWUuaXNDdXN0b20gfHwgdGhpcy52YWx1ZS5pc0hvc3RlZEt1YmVybmV0ZXNQcm92aWRlciApIHsKICAgICAgZmV0Y2hPbmUuY2x1c3RlclRva2VuID0gdGhpcy52YWx1ZS5nZXRPckNyZWF0ZVRva2VuKCk7CiAgICB9CgogICAgLy8gTmVlZCB0byBnZXQgTm9ybWFuIGNsdXN0ZXJzIHNvIHRoYXQgd2UgY2FuIGNoZWNrIGlmIHVzZXIgaGFzIHBlcm1pc3Npb25zIHRvIGFjY2VzcyB0aGUgbG9jYWwgY2x1c3RlcgogICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydyYW5jaGVyL2Nhbkxpc3QnXShOT1JNQU4uQ0xVU1RFUikgKSB7CiAgICAgIGZldGNoT25lLm5vcm1hbkNsdXN0ZXJzID0gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3JhbmNoZXIvZmluZEFsbCcsIHsgdHlwZTogTk9STUFOLkNMVVNURVIgfSk7CiAgICB9CgogICAgaWYgKCB0aGlzLnZhbHVlLmlzUmtlMSAmJiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydpc1JhbmNoZXInXSApIHsKICAgICAgZmV0Y2hPbmUuZXRjZEJhY2t1cHMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9maW5kQWxsJywgeyB0eXBlOiBOT1JNQU4uRVRDRF9CQUNLVVAgfSk7CgogICAgICBmZXRjaE9uZS5ub3JtYW5Ob2RlUG9vbHMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9maW5kQWxsJywgeyB0eXBlOiBOT1JNQU4uTk9ERV9QT09MIH0pOwogICAgfQoKICAgIGNvbnN0IGZldGNoT25lUmVzID0gYXdhaXQgYWxsSGFzaChmZXRjaE9uZSk7CgogICAgdGhpcy5hbGxNYWNoaW5lcyA9IGZldGNoT25lUmVzLm1hY2hpbmVzIHx8IFtdOwogICAgdGhpcy5hbGxNYWNoaW5lRGVwbG95bWVudHMgPSBmZXRjaE9uZVJlcy5tYWNoaW5lRGVwbG95bWVudHMgfHwgW107CiAgICB0aGlzLmhhdmVNYWNoaW5lcyA9ICEhZmV0Y2hPbmVSZXMubWFjaGluZXM7CiAgICB0aGlzLmhhdmVEZXBsb3ltZW50cyA9ICEhZmV0Y2hPbmVSZXMubWFjaGluZURlcGxveW1lbnRzOwogICAgdGhpcy5jbHVzdGVyVG9rZW4gPSBmZXRjaE9uZVJlcy5jbHVzdGVyVG9rZW47CiAgICB0aGlzLmV0Y2RCYWNrdXBzID0gZmV0Y2hPbmVSZXMuZXRjZEJhY2t1cHM7CgogICAgaWYgKGZldGNoT25lUmVzLm5vcm1hbkNsdXN0ZXJzKSB7CiAgICAgIC8vIERvZXMgdGhlIHVzZXIgaGF2ZSBhY2Nlc3MgdG8gdGhlIGxvY2FsIGNsdXN0ZXI/IE5lZWQgdG8gaW4gb3JkZXIgdG8gYmUgYWJsZSB0byBzaG93IHRoZSAnUmVsYXRlZCBSZXNvdXJjZXMnIHRhYgogICAgICB0aGlzLmhhc0xvY2FsQWNjZXNzID0gISFmZXRjaE9uZVJlcy5ub3JtYW5DbHVzdGVycy5maW5kKChjKSA9PiBjLmludGVybmFsKTsKICAgIH0KCiAgICBjb25zdCBmZXRjaFR3byA9IHt9OwoKICAgIGNvbnN0IHRoaXNDbHVzdGVyTWFjaGluZXMgPSB0aGlzLmFsbE1hY2hpbmVEZXBsb3ltZW50cy5maWx0ZXIoKGRlcGxveW1lbnQpID0+IHsKICAgICAgcmV0dXJuIGRlcGxveW1lbnQ/LnNwZWM/LmNsdXN0ZXJOYW1lID09PSB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWU7CiAgICB9KTsKCiAgICBjb25zdCBtYWNoaW5lRGVwbG95bWVudFRlbXBsYXRlVHlwZSA9IHRoaXNDbHVzdGVyTWFjaGluZXM/LlswXT8udGVtcGxhdGVUeXBlOwoKICAgIGlmIChtYWNoaW5lRGVwbG95bWVudFRlbXBsYXRlVHlwZSAmJiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L3NjaGVtYUZvciddKG1hY2hpbmVEZXBsb3ltZW50VGVtcGxhdGVUeXBlKSApIHsKICAgICAgZmV0Y2hUd28ubWR0dCA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IG1hY2hpbmVEZXBsb3ltZW50VGVtcGxhdGVUeXBlIH0pOwogICAgfQoKICAgIGlmICghdGhpcy5zaG93TWFjaGluZXMpIHsKICAgICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2Nhbkxpc3QnXShNQU5BR0VNRU5ULk5PREUpICkgewogICAgICAgIGZldGNoVHdvLmFsbE5vZGVzID0gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsgdHlwZTogTUFOQUdFTUVOVC5OT0RFIH0pOwogICAgICB9CgogICAgICBpZiAoIHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvY2FuTGlzdCddKE1BTkFHRU1FTlQuTk9ERV9QT09MKSApIHsKICAgICAgICBmZXRjaFR3by5hbGxOb2RlUG9vbHMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULk5PREVfUE9PTCB9KTsKICAgICAgfQoKICAgICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2Nhbkxpc3QnXShNQU5BR0VNRU5ULk5PREVfVEVNUExBVEUpICkgewogICAgICAgIGZldGNoVHdvLm5vZGVUZW1wbGF0ZXMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULk5PREVfVEVNUExBVEUgfSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBmZXRjaFR3b1JlcyA9IGF3YWl0IGFsbEhhc2goZmV0Y2hUd28pOwoKICAgIHRoaXMuYWxsTm9kZXMgPSBmZXRjaFR3b1Jlcy5hbGxOb2RlcyB8fCBbXTsKICAgIHRoaXMuaGF2ZU5vZGVzID0gISFmZXRjaFR3b1Jlcy5hbGxOb2RlczsKICAgIHRoaXMuYWxsTm9kZVBvb2xzID0gZmV0Y2hUd29SZXMuYWxsTm9kZVBvb2xzIHx8IFtdOwogICAgdGhpcy5oYXZlTm9kZVBvb2xzID0gISFmZXRjaFR3b1Jlcy5hbGxOb2RlUG9vbHM7CiAgICB0aGlzLm1hY2hpbmVUZW1wbGF0ZXMgPSBmZXRjaFR3b1Jlcy5tZHR0IHx8IFtdOwoKICAgIC8vIEZldGNoIFJLRSB0ZW1wbGF0ZSByZXZpc2lvbnMgc28gd2UgY2FuIHNob3cgd2hlbiBhbiB1cGRhdGVkIHRlbXBsYXRlIGlzIGF2YWlsYWJsZQogICAgLy8gVGhpcyByZXF1ZXN0IGRvZXMgbm90IG5lZWQgdG8gYmUgYmxvY2tpbmcKICAgIGlmICggdGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9jYW5MaXN0J10oTUFOQUdFTUVOVC5SS0VfVEVNUExBVEUpICkgewogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULlJLRV9URU1QTEFURSB9KTsKICAgIH0KCiAgICBpZiAoIHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvY2FuTGlzdCddKE1BTkFHRU1FTlQuUktFX1RFTVBMQVRFX1JFVklTSU9OKSApIHsKICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsgdHlwZTogTUFOQUdFTUVOVC5SS0VfVEVNUExBVEVfUkVWSVNJT04gfSk7CiAgICB9CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIGlmICggdGhpcy5zaG93TG9nICkgewogICAgICB0aGlzLmNvbm5lY3RMb2coKTsKICAgIH0KICB9LAoKICBiZWZvcmVEZXN0cm95KCkgewogICAgaWYgKCB0aGlzLmxvZ1NvY2tldCApIHsKICAgICAgdGhpcy5sb2dTb2NrZXQuZGlzY29ubmVjdCgpOwogICAgICB0aGlzLmxvZ1NvY2tldCA9IG51bGw7CiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CgogICAgICBhbGxNYWNoaW5lczogICAgICAgICAgIFtdLAogICAgICBhbGxNYWNoaW5lRGVwbG95bWVudHM6IFtdLAogICAgICBhbGxOb2RlczogICAgICAgICAgICAgIFtdLAogICAgICBhbGxOb2RlUG9vbHM6ICAgICAgICAgIFtdLAoKICAgICAgaGF2ZU1hY2hpbmVzOiAgICBmYWxzZSwKICAgICAgaGF2ZURlcGxveW1lbnRzOiBmYWxzZSwKICAgICAgaGF2ZU5vZGVzOiAgICAgICBmYWxzZSwKICAgICAgaGF2ZU5vZGVQb29sczogICBmYWxzZSwKICAgICAgaGFzTG9jYWxBY2Nlc3M6ICBmYWxzZSwKCiAgICAgIG1nbXROb2RlU2NoZW1hOiB0aGlzLiRzdG9yZS5nZXR0ZXJzW2BtYW5hZ2VtZW50L3NjaGVtYUZvcmBdKE1BTkFHRU1FTlQuTk9ERSksCiAgICAgIG1hY2hpbmVTY2hlbWE6ICB0aGlzLiRzdG9yZS5nZXR0ZXJzW2BtYW5hZ2VtZW50L3NjaGVtYUZvcmBdKENBUEkuTUFDSElORSksCgogICAgICBjbHVzdGVyVG9rZW46IG51bGwsCiAgICAgIGV0Y2RCYWNrdXBzOiAgbnVsbCwKCiAgICAgIGxvZ09wZW46ICAgZmFsc2UsCiAgICAgIGxvZ1NvY2tldDogbnVsbCwKICAgICAgbG9nczogICAgICBbXSwKCiAgICAgIGV4dFByb3ZpZGVyOiAgICAgbnVsbCwKICAgICAgZXh0Q3VzdG9tUGFyYW1zOiBudWxsLAogICAgICBleHREZXRhaWxUYWJzOiAgIHsKICAgICAgICBtYWNoaW5lczogICAgIHRydWUsIC8vIGluIHRoaXMgY29tcG9uZW50CiAgICAgICAgbG9nczogICAgICAgICB0cnVlLCAvLyBpbiB0aGlzIGNvbXBvbmVudAogICAgICAgIHJlZ2lzdHJhdGlvbjogdHJ1ZSwgLy8gaW4gdGhpcyBjb21wb25lbnQKICAgICAgICBzbmFwc2hvdHM6ICAgIHRydWUsIC8vIGluIHRoaXMgY29tcG9uZW50CiAgICAgICAgcmVsYXRlZDogICAgICB0cnVlLCAvLyBpbiBSZXNvdXJjZVRhYnMKICAgICAgICBldmVudHM6ICAgICAgIHRydWUsIC8vIGluIFJlc291cmNlVGFicwogICAgICAgIGNvbmRpdGlvbnM6ICAgdHJ1ZSwgLy8gaW4gUmVzb3VyY2VUYWJzCiAgICAgIH0sCgogICAgICBzaG93V2luZG93c1dhcm5pbmc6IGZhbHNlCiAgICB9OwogIH0sCgogIHdhdGNoOiB7CiAgICBzaG93Tm9kZXMobmV1KSB7CiAgICAgIGlmIChuZXUpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9maW5kQWxsJywgeyB0eXBlOiBOT1JNQU4uTk9ERSB9KTsKICAgICAgfQogICAgfSwKICB9LAoKICBjb21wdXRlZDogewogICAgZGVmYXVsdFRhYigpIHsKICAgICAgaWYgKHRoaXMuc2hvd1JlZ2lzdHJhdGlvbikgewogICAgICAgIGlmICh0aGlzLnZhbHVlLmlzUmtlMiA/ICF0aGlzLm1hY2hpbmVzPy5sZW5ndGggOiAhdGhpcy5ub2Rlcz8ubGVuZ3RoKSB7CiAgICAgICAgICByZXR1cm4gJ3JlZ2lzdHJhdGlvbic7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAodGhpcy5zaG93TWFjaGluZXMpIHsKICAgICAgICByZXR1cm4gJ21hY2hpbmUtcG9vbHMnOwogICAgICB9CgogICAgICBpZiAodGhpcy5zaG93Tm9kZXMpIHsKICAgICAgICByZXR1cm4gJ25vZGUtcG9vbHMnOwogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9LAoKICAgIC8vIFVzZWQgdG8gc2hvdyBzdW1tYXJ5IGdyYXBoIGZvciBlYWNoIG5vZGUgcG9vbCBncm91cCBpbiB0aGUgbWFjaGluZSBwb29sIHRhYmxlCiAgICBwb29sU3VtbWFyeUluZm8oKSB7CiAgICAgIGNvbnN0IGluZm8gPSB7fTsKCiAgICAgIHRoaXMudmFsdWU/LnBvb2xzLmZvckVhY2goKHApID0+IHsKICAgICAgICBjb25zdCBncm91cCA9IGBbJHsgcC50eXBlIH06ICR7IHAuaWQgfV1gOwoKICAgICAgICBpbmZvW2dyb3VwXSA9IHA7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIGluZm87CiAgICB9LAoKICAgIGZha2VNYWNoaW5lcygpIHsKICAgICAgY29uc3QgbWFjaGluZU5hbWVGbiA9IChjbHVzdGVyTmFtZSwgbWFjaGluZVBvb2xOYW1lKSA9PiBgJHsgY2x1c3Rlck5hbWUgfS0keyBtYWNoaW5lUG9vbE5hbWUgfWA7CgogICAgICAvLyBXaGVuIHdlIHNjYWxlIHVwLCB0aGUgcXVhbnRpdHkgd2lsbCBjaGFuZ2UgdG8gTisxIC0gc28gZnJvbSAwIHRvIDEsIHRoZSBxdWFudGl0eSBjaGFuZ2VzLAogICAgICAvLyBidXQgaXQgdGFrZXMgdGllbSBmb3IgdGhlIG1hY2hpbmUgdG8gYXBwZWFyLCBzbyB0aGUgcG9vbCBpcyBlbXB0eSwgYnV0IGlmIHdlIGp1c3QgZ28gb2ZmIG9uIGEgbm9uLXplcm8gcXVxbnRpdHkKICAgICAgLy8gdGhlbiB0aGUgcG9vbCB3b3VsZCBiZSBoaWRkZW4gLSBzbyB3ZSBmaW5kIGVtcHR5IHBvb2wgYnkgY2hlY2tpbmcgdGhlIG1hY2hpbmVzCiAgICAgIGNvbnN0IGVtcHR5UG9vbHMgPSAodGhpcy52YWx1ZS5zcGVjLnJrZUNvbmZpZz8ubWFjaGluZVBvb2xzIHx8IFtdKS5maWx0ZXIoKG1wKSA9PiB7CiAgICAgICAgY29uc3QgbWFjaGluZUZ1bGxOYW1lID0gbWFjaGluZU5hbWVGbih0aGlzLnZhbHVlLm5hbWUsIG1wLm5hbWUpOwoKICAgICAgICBjb25zdCBtYWNoaW5lcyA9IHRoaXMudmFsdWUubWFjaGluZXMuZmlsdGVyKChtYWNoaW5lKSA9PiB7CiAgICAgICAgICBjb25zdCBpc0VsZW1lbnRhbENsdXN0ZXIgPSBtYWNoaW5lLnNwZWM/LmluZnJhc3RydWN0dXJlUmVmPy5hcGlWZXJzaW9uLnN0YXJ0c1dpdGgoJ2VsZW1lbnRhbC5jYXR0bGUuaW8nKTsKICAgICAgICAgIGNvbnN0IG1hY2hpbmVQb29sSW5mTmFtZSA9IG1hY2hpbmUuc3BlYz8uaW5mcmFzdHJ1Y3R1cmVSZWY/Lm5hbWU7CgogICAgICAgICAgaWYgKGlzRWxlbWVudGFsQ2x1c3RlcikgewogICAgICAgICAgICByZXR1cm4gbWFjaGluZVBvb2xJbmZOYW1lLmluY2x1ZGVzKG1hY2hpbmVGdWxsTmFtZSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gaWYgbGFiZWxzIGV4aXN0LCB0aGVuIHRoZSBtYWNoaW5lRnVsbE5hbWUgbXVzdCB1bmVxdWl2b2NhbGx5IGJlIGVxdWFsIHRvIG1hbmNoaW5lTGFiZWxGdWxsTmFtZSAoYmFzZWQgb24gbGFiZWxzKQogICAgICAgICAgY29uc3QgbWFjaGluZUxhYmVsQ2x1c3Rlck5hbWUgPSBtYWNoaW5lLm1ldGFkYXRhPy5sYWJlbHM/LlsnY2x1c3Rlci54LWs4cy5pby9jbHVzdGVyLW5hbWUnXTsKICAgICAgICAgIGNvbnN0IG1hY2hpbmVMYWJlbFBvb2xOYW1lID0gbWFjaGluZS5tZXRhZGF0YT8ubGFiZWxzPy5bJ3JrZS5jYXR0bGUuaW8vcmtlLW1hY2hpbmUtcG9vbC1uYW1lJ107CgogICAgICAgICAgaWYgKG1hY2hpbmVMYWJlbENsdXN0ZXJOYW1lICYmIG1hY2hpbmVMYWJlbFBvb2xOYW1lKSB7CiAgICAgICAgICAgIGNvbnN0IG1hbmNoaW5lTGFiZWxGdWxsTmFtZSA9IG1hY2hpbmVOYW1lRm4obWFjaGluZUxhYmVsQ2x1c3Rlck5hbWUsIG1hY2hpbmVMYWJlbFBvb2xOYW1lKTsKCiAgICAgICAgICAgIHJldHVybiBtYWNoaW5lRnVsbE5hbWUgPT09IG1hbmNoaW5lTGFiZWxGdWxsTmFtZTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbWFjaGluZVBvb2xJbmZOYW1lLnN0YXJ0c1dpdGgobWFjaGluZUZ1bGxOYW1lKTsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIG1hY2hpbmVzLmxlbmd0aCA9PT0gMDsKICAgICAgfSk7CgogICAgICAvLyBXaGVuIGEgZGVwbG95bWVudCBoYXMgbm8gbWFjaGluZXMgaXQncyBub3Qgc2hvd24uLi4uIHNvIGFkZCBhIGZha2UgbWFjaGluZSB0byBpdAogICAgICAvLyBUaGlzIGlzIGEgY2F0Y2ggYWxsIHNjZW5hcmlvIHNlZW4gaW4gb2xkZXIgbm9kZSBwb29sIHdvcmxkIGJ1dCBub3QgZGVwbG95bWVudHMKICAgICAgcmV0dXJuIGVtcHR5UG9vbHMubWFwKChtcCwgaSkgPT4gewogICAgICAgIGNvbnN0IHBvb2wgPSBuZXcgRW1wdHlDYXBpTWFjaGluZURlcGxveW1lbnQoCiAgICAgICAgICB7CiAgICAgICAgICAgIGlkOiAgICAgICBpLAogICAgICAgICAgICBtZXRhZGF0YTogewogICAgICAgICAgICAgIG5hbWU6ICAgICAgYCR7IHRoaXMudmFsdWUubmFtZURpc3BsYXkgfS0keyBtcC5uYW1lIH1gLAogICAgICAgICAgICAgIG5hbWVzcGFjZTogdGhpcy52YWx1ZS5uYW1lc3BhY2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNwZWM6IHt9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBnZXR0ZXJzOiAgICAgdGhpcy4kc3RvcmUuZ2V0dGVycywKICAgICAgICAgICAgcm9vdEdldHRlcnM6IHRoaXMuJHJvb3QuJHN0b3JlLmdldHRlcnMsCiAgICAgICAgICB9CiAgICAgICAgKTsKCiAgICAgICAgY29uc3QgdGVtcGxhdGVOYW1lUHJlZml4ID0gYCR7IHBvb2wubWV0YWRhdGEubmFtZSB9LWA7CgogICAgICAgIC8vIEFsbCBvZiB0aGVzZSBwcm9wZXJ0aWVzIGFyZSBuZWVkZWQgdG8gZW5zdXJlIHRoZSBwb29sIGRpc3BsYXlzIGNvcnJlY3RseSBhbmQgdGhhdCB3ZSBjYW4gc2NhbGUgdXAgYW5kIGRvd24KICAgICAgICBwb29sLl90ZW1wbGF0ZSA9IHRoaXMubWFjaGluZVRlbXBsYXRlcy5maW5kKCh0KSA9PiB0Lm1ldGFkYXRhLm5hbWUuc3RhcnRzV2l0aCh0ZW1wbGF0ZU5hbWVQcmVmaXgpKTsKICAgICAgICBwb29sLl9jbHVzdGVyID0gdGhpcy52YWx1ZTsKICAgICAgICBwb29sLl9jbHVzdGVyU3BlYyA9IG1wOwoKICAgICAgICByZXR1cm4gewogICAgICAgICAgcG9vbElkOiAgICAgICAgICAgcG9vbC5pZCwKICAgICAgICAgIG1haW5Sb3dLZXk6ICAgICAgICdpc0Zha2UnLAogICAgICAgICAgcG9vbCwKICAgICAgICAgIGF2YWlsYWJsZUFjdGlvbnM6IFtdCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LAoKICAgIG1hY2hpbmVzKCkgewogICAgICByZXR1cm4gWy4uLnRoaXMudmFsdWUubWFjaGluZXMsIC4uLnRoaXMuZmFrZU1hY2hpbmVzXTsKICAgIH0sCgogICAgbm9kZXMoKSB7CiAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5hbGxOb2Rlcy5maWx0ZXIoKHgpID0+IHgubWdtdENsdXN0ZXJJZCA9PT0gdGhpcy52YWx1ZS5tZ210Q2x1c3RlcklkKTsKCiAgICAgIHJldHVybiBbLi4ubm9kZXMsIC4uLnRoaXMuZmFrZU5vZGVzXTsKICAgIH0sCgogICAgZmFrZU5vZGVzKCkgewogICAgICAvLyBXaGVuIGEgcG9vbCBoYXMgbm8gbm9kZXMgaXQncyBub3Qgc2hvd24uLi4uIHNvIGFkZCBhIGZha2Ugbm9kZSB0byBpdAogICAgICBjb25zdCBlbXB0eU5vZGVQb29scyA9IHRoaXMuYWxsTm9kZVBvb2xzLmZpbHRlcigoeCkgPT4geC5zcGVjLmNsdXN0ZXJOYW1lID09PSB0aGlzLnZhbHVlLm1nbXRDbHVzdGVySWQgJiYgeC5zcGVjLnF1YW50aXR5ID09PSAwKTsKCiAgICAgIHJldHVybiBlbXB0eU5vZGVQb29scy5tYXAoKG5wKSA9PiAoewogICAgICAgIHNwZWM6ICAgICAgICAgICAgIHsgbm9kZVBvb2xOYW1lOiBucC5pZC5yZXBsYWNlKCcvJywgJzonKSB9LAogICAgICAgIG1haW5Sb3dLZXk6ICAgICAgICdpc0Zha2UnLAogICAgICAgIHBvb2w6ICAgICAgICAgICAgIG5wLAogICAgICAgIGF2YWlsYWJsZUFjdGlvbnM6IFtdCiAgICAgIH0pKTsKICAgIH0sCgogICAgc2hvd01hY2hpbmVzKCkgewogICAgICBjb25zdCBzaG93TWFjaGluZXMgPSB0aGlzLmhhdmVNYWNoaW5lcyAmJiAodGhpcy52YWx1ZS5pc1JrZTIgfHwgISF0aGlzLm1hY2hpbmVzLmxlbmd0aCk7CgogICAgICByZXR1cm4gc2hvd01hY2hpbmVzICYmIHRoaXMuZXh0RGV0YWlsVGFicy5tYWNoaW5lczsKICAgIH0sCgogICAgc2hvd05vZGVzKCkgewogICAgICByZXR1cm4gIXRoaXMuc2hvd01hY2hpbmVzICYmIHRoaXMuaGF2ZU5vZGVzICYmICEhdGhpcy5ub2Rlcy5sZW5ndGg7CiAgICB9LAoKICAgIHNob3dTbmFwc2hvdHMoKSB7CiAgICAgIGlmICh0aGlzLnZhbHVlLmlzUmtlMSkgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydyYW5jaGVyL2Nhbkxpc3QnXShOT1JNQU4uRVRDRF9CQUNLVVApICYmIHRoaXMuZXh0RGV0YWlsVGFicy5zbmFwc2hvdHM7CiAgICAgIH0gZWxzZSBpZiAodGhpcy52YWx1ZS5pc1JrZTIpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9jYW5MaXN0J10oU05BUFNIT1QpICYmIHRoaXMuZXh0RGV0YWlsVGFicy5zbmFwc2hvdHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCgogICAgc2hvd0Vrc05vZGVHcm91cFdhcm5pbmcoKSB7CiAgICAgIGlmICggdGhpcy52YWx1ZS5wcm92aXNpb25lciA9PT0gJ0VLUycgJiYgdGhpcy52YWx1ZS5zdGF0ZSAhPT0gU1RBVEVTX0VOVU0uQUNUSVZFKSB7CiAgICAgICAgY29uc3QgZGVzaXJlZFRvdGFsID0gdGhpcy52YWx1ZS5la3NOb2RlR3JvdXBzLmZpbHRlcigoZykgPT4gZy5kZXNpcmVkU2l6ZSA9PT0gMCk7CgogICAgICAgIGlmICggZGVzaXJlZFRvdGFsLmxlbmd0aCA9PT0gdGhpcy52YWx1ZS5la3NOb2RlR3JvdXBzLmxlbmd0aCApIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKCiAgICBtYWNoaW5lSGVhZGVycygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICBTVEFURSwKICAgICAgICBOQU1FX0NPTCwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAgICAgICAgICAnbm9kZS1uYW1lJywKICAgICAgICAgIGxhYmVsS2V5OiAgICAgICd0YWJsZUhlYWRlcnMubWFjaGluZU5vZGVOYW1lJywKICAgICAgICAgIHNvcnQ6ICAgICAgICAgICdzdGF0dXMubm9kZVJlZi5uYW1lJywKICAgICAgICAgIHZhbHVlOiAgICAgICAgICdzdGF0dXMubm9kZVJlZi5uYW1lJywKICAgICAgICAgIGZvcm1hdHRlcjogICAgICdMaW5rRGV0YWlsJywKICAgICAgICAgIGZvcm1hdHRlck9wdHM6IHsgcmVmZXJlbmNlOiAna3ViZU5vZGVEZXRhaWxMb2NhdGlvbicgfSwKICAgICAgICAgIGRhc2hJZkVtcHR5OiAgIHRydWUsCiAgICAgICAgfSwKICAgICAgICBJTlRFUk5BTF9FWFRFUk5BTF9JUCwKICAgICAgICBNQUNISU5FX05PREVfT1MsCiAgICAgICAgUk9MRVMsCiAgICAgICAgQUdFLAogICAgICBdOwogICAgfSwKCiAgICBtZ210Tm9kZVNjaGVtYUhlYWRlcnMoKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgU1RBVEUsIE5BTUVfQ09MLAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAgICAgICAgICdub2RlLW5hbWUnLAogICAgICAgICAgbGFiZWxLZXk6ICAgICAgJ3RhYmxlSGVhZGVycy5tYWNoaW5lTm9kZU5hbWUnLAogICAgICAgICAgc29ydDogICAgICAgICAgJ2t1YmVOb2RlTmFtZScsCiAgICAgICAgICB2YWx1ZTogICAgICAgICAna3ViZU5vZGVOYW1lJywKICAgICAgICAgIGZvcm1hdHRlcjogICAgICdMaW5rRGV0YWlsJywKICAgICAgICAgIGZvcm1hdHRlck9wdHM6IHsgcmVmZXJlbmNlOiAna3ViZU5vZGVEZXRhaWxMb2NhdGlvbicgfSwKICAgICAgICAgIGRhc2hJZkVtcHR5OiAgIHRydWUsCiAgICAgICAgfSwKICAgICAgICBJTlRFUk5BTF9FWFRFUk5BTF9JUCwKICAgICAgICBNQU5BR0VNRU5UX05PREVfT1MsCiAgICAgICAgUk9MRVMsCiAgICAgICAgQUdFCiAgICAgIF07CiAgICB9LAoKICAgIHJrZTFTbmFwc2hvdHMoKSB7CiAgICAgIGNvbnN0IG1nbXRJZCA9IHRoaXMudmFsdWUubWdtdD8uaWQ7CgogICAgICBpZiAoICFtZ210SWQgKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CgogICAgICByZXR1cm4gKHRoaXMuZXRjZEJhY2t1cHMgfHwgW10pLmZpbHRlcigoeCkgPT4geC5jbHVzdGVySWQgPT09IG1nbXRJZCk7CiAgICB9LAoKICAgIHJrZTJTbmFwc2hvdHMoKSB7CiAgICAgIHJldHVybiB0aGlzLnZhbHVlLmV0Y2RTbmFwc2hvdHM7CiAgICB9LAoKICAgIHJrZTFTbmFwc2hvdEhlYWRlcnMoKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgU1RBVEVfTk9STUFOLAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAgICAgICAgICduYW1lJywKICAgICAgICAgIGxhYmVsS2V5OiAgICAgICd0YWJsZUhlYWRlcnMubmFtZScsCiAgICAgICAgICB2YWx1ZTogICAgICAgICAnbmFtZURpc3BsYXknLAogICAgICAgICAgc29ydDogICAgICAgICAgWyduYW1lU29ydCddLAogICAgICAgICAgY2FuQmVWYXJpYWJsZTogdHJ1ZSwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAgICAndmVyc2lvbicsCiAgICAgICAgICBsYWJlbEtleTogJ3RhYmxlSGVhZGVycy52ZXJzaW9uJywKICAgICAgICAgIHZhbHVlOiAgICAnc3RhdHVzLmt1YmVybmV0ZXNWZXJzaW9uJywKICAgICAgICAgIHNvcnQ6ICAgICAnc3RhdHVzLmt1YmVybmV0ZXNWZXJzaW9uJywKICAgICAgICAgIHdpZHRoOiAgICAxNTAsCiAgICAgICAgfSwKICAgICAgICB7IC4uLkFHRV9OT1JNQU4sIGNhbkJlVmFyaWFibGU6IHRydWUgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAgICAgICdtYW51YWwnLAogICAgICAgICAgbGFiZWxLZXk6ICAndGFibGVIZWFkZXJzLm1hbnVhbCcsCiAgICAgICAgICB2YWx1ZTogICAgICdtYW51YWwnLAogICAgICAgICAgZm9ybWF0dGVyOiAnQ2hlY2tlZCcsCiAgICAgICAgICBzb3J0OiAgICAgIFsnbWFudWFsJ10sCiAgICAgICAgICBhbGlnbjogICAgICdjZW50ZXInLAogICAgICAgICAgd2lkdGg6ICAgICA1MCwKICAgICAgICB9LAogICAgICBdOwogICAgfSwKCiAgICBya2UyU25hcHNob3RIZWFkZXJzKCkgewogICAgICByZXR1cm4gWwogICAgICAgIHsKICAgICAgICAgIC4uLlNUQVRFX05PUk1BTiwgdmFsdWU6ICdzbmFwc2hvdEZpbGUuc3RhdHVzJywgZm9ybWF0dGVyT3B0czogeyBhcmJpdHJhcnk6IHRydWUgfQogICAgICAgIH0sCiAgICAgICAgTkFNRSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAgICAgICdzaXplJywKICAgICAgICAgIGxhYmVsS2V5OiAgJ3RhYmxlSGVhZGVycy5zaXplJywKICAgICAgICAgIHZhbHVlOiAgICAgJ3NuYXBzaG90RmlsZS5zaXplJywKICAgICAgICAgIHNvcnQ6ICAgICAgJ3NuYXBzaG90RmlsZS5zaXplJywKICAgICAgICAgIGZvcm1hdHRlcjogJ1NpJywKICAgICAgICAgIHdpZHRoOiAgICAgMTUwLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgLi4uQUdFLAogICAgICAgICAgc29ydDogICAgICAgICAgJ3NuYXBzaG90RmlsZS5jcmVhdGVkQXQ6ZGVzYycsCiAgICAgICAgICBjYW5CZVZhcmlhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgXTsKICAgIH0sCgogICAgc2hvd1JlZ2lzdHJhdGlvbigpIHsKICAgICAgaWYgKCAhdGhpcy5jbHVzdGVyVG9rZW4gKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpZiAoIHRoaXMudmFsdWUuaXNJbXBvcnRlZCApIHsKICAgICAgICByZXR1cm4gIXRoaXMudmFsdWUubWdtdD8uaXNSZWFkeSAmJiB0aGlzLmV4dERldGFpbFRhYnMucmVnaXN0cmF0aW9uOwogICAgICB9CgogICAgICBpZiAoIHRoaXMudmFsdWUuaXNDdXN0b20gKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZXh0RGV0YWlsVGFicy5yZWdpc3RyYXRpb247CiAgICAgIH0KCiAgICAgIGlmICggdGhpcy52YWx1ZS5pc0hvc3RlZEt1YmVybmV0ZXNQcm92aWRlciAmJiAhdGhpcy5pc0NsdXN0ZXJSZWFkeSApIHsKICAgICAgICByZXR1cm4gdGhpcy5leHREZXRhaWxUYWJzLnJlZ2lzdHJhdGlvbjsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKCiAgICBpc0NsdXN0ZXJSZWFkeSgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWUubWdtdD8uaXNSZWFkeTsKICAgIH0sCgogICAgc2hvd0xvZygpIHsKICAgICAgY29uc3Qgc2hvd0xvZyA9IHRoaXMudmFsdWUubWdtdD8uaGFzTGluaygnbG9nJyk7CgogICAgICByZXR1cm4gc2hvd0xvZyAmJiB0aGlzLmV4dERldGFpbFRhYnMubG9nczsKICAgIH0sCgogICAgZGF0ZVRpbWVGb3JtYXRTdHIoKSB7CiAgICAgIGNvbnN0IGRhdGVGb3JtYXQgPSBlc2NhcGVIdG1sKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwcmVmcy9nZXQnXShEQVRFX0ZPUk1BVCkpOwoKICAgICAgcmV0dXJuIGAkeyBkYXRlRm9ybWF0IH0gJHsgdGhpcy50aW1lRm9ybWF0U3RyIH1gOwogICAgfSwKCiAgICB0aW1lRm9ybWF0U3RyKCkgewogICAgICByZXR1cm4gZXNjYXBlSHRtbCggdGhpcy4kc3RvcmUuZ2V0dGVyc1sncHJlZnMvZ2V0J10oVElNRV9GT1JNQVQpKTsKICAgIH0sCgogICAgaGFzV2luZG93c01hY2hpbmUoKSB7CiAgICAgIHJldHVybiB0aGlzLm1hY2hpbmVzLnNvbWUoKG1hY2hpbmUpID0+IGdldChtYWNoaW5lLCAnc3RhdHVzLm5vZGVJbmZvLm9wZXJhdGluZ1N5c3RlbScpID09PSAnd2luZG93cycpOwogICAgfSwKCiAgICBzbmFwc2hvdHNHcm91cEJ5KCkgewogICAgICByZXR1cm4gJ2JhY2t1cExvY2F0aW9uJzsKICAgIH0KICB9LAoKICBtb3VudGVkKCkgewogICAgd2luZG93LmMgPSB0aGlzOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIHRvZ2dsZVNjYWxlRG93bk1vZGFsKCBldmVudCwgcmVzb3VyY2VzICkgewogICAgICAvLyBDaGVjayBpZiB0aGUgdXNlciBoZWxkIGFsdCBrZXkgd2hlbiBhbiBhY3Rpb24gaXMgY2xpY2tlZC4KICAgICAgY29uc3QgYWx0ID0gaXNBbHRlcm5hdGUoZXZlbnQpOwogICAgICBjb25zdCBzaG93U2NhbGVQb29sUHJvbXB0ID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1sncHJlZnMvZ2V0J10oU0NBTEVfUE9PTF9QUk9NUFQpOwoKICAgICAgLy8gUHJvbXB0IGlmIHNob3dTY2FsZVBvb2xQcm9tcHQgcHJlZiBub3Qgc3RvcmUgYW5kIHVzZXIgZGlkIG5vdCBoZWxkIGFsdCBrZXkKICAgICAgaWYgKCFhbHQgJiYgIXNob3dTY2FsZVBvb2xQcm9tcHQpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9wcm9tcHRNb2RhbCcsIHsKICAgICAgICAgIGNvbXBvbmVudDogICdTY2FsZVBvb2xEb3duRGlhbG9nJywKICAgICAgICAgIHJlc291cmNlcywKICAgICAgICAgIG1vZGFsV2lkdGg6ICc0NTBweCcKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBVc2VyIGhlbGQgYWx0IGtleSwgc28gZG9uJ3QgcHJvbXB0CiAgICAgICAgcmVzb3VyY2VzLnNjYWxlUG9vbCgtMSk7CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgdGFrZVNuYXBzaG90KGJ0bkNiKSB7CiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgdGhpcy52YWx1ZS50YWtlU25hcHNob3QoKTsKCiAgICAgICAgLy8gR2l2ZSB0aGUgY2hhbmdlIGV2ZW50IHNvbWUgdGltZSB0byBzaG93IHVwCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBidG5DYih0cnVlKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyb3dsL2Zyb21FcnJvcicsIHsgdGl0bGU6ICdFcnJvciBjcmVhdGluZyBzbmFwc2hvdCcsIGVyciB9KTsKICAgICAgICBidG5DYihmYWxzZSk7CiAgICAgIH0KICAgIH0sCgogICAgc2hvd1Bvb2xBY3Rpb24oZXZlbnQsIHBvb2wpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGBhY3Rpb24tbWVudS9zaG93YCwgewogICAgICAgIHJlc291cmNlczogW3Bvb2xdLAogICAgICAgIGVsZW06ICAgICAgZXZlbnQudGFyZ2V0CiAgICAgIH0pOwogICAgfSwKCiAgICBzaG93UG9vbEFjdGlvbkJ1dHRvbihwb29sKSB7CiAgICAgIHJldHVybiAhIXBvb2wuYXZhaWxhYmxlQWN0aW9ucz8ubGVuZ3RoOwogICAgfSwKCiAgICBhc3luYyBjb25uZWN0TG9nKCkgewogICAgICBpZiAoIHRoaXMubG9nU29ja2V0ICkgewogICAgICAgIGF3YWl0IHRoaXMubG9nU29ja2V0LmRpc2Nvbm5lY3QoKTsKICAgICAgICB0aGlzLmxvZ1NvY2tldCA9IG51bGw7CiAgICAgIH0KCiAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICBmb2xsb3c6ICAgICB0cnVlLAogICAgICAgIHRpbWVzdGFtcHM6IHRydWUsCiAgICAgICAgcHJldHR5OiAgICAgdHJ1ZSwKICAgICAgfTsKCiAgICAgIGxldCB1cmwgPSB0aGlzLnZhbHVlLm1nbXQ/LmxpbmtGb3IoJ2xvZycpOwoKICAgICAgdXJsID0gYWRkUGFyYW1zKHVybC5yZXBsYWNlKC9eaHR0cC8sICd3cycpLCBwYXJhbXMpOwoKICAgICAgdGhpcy5sb2dTb2NrZXQgPSBuZXcgU29ja2V0KHVybCwgdHJ1ZSwgMCk7CiAgICAgIHRoaXMubG9nU29ja2V0LmFkZEV2ZW50TGlzdGVuZXIoRVZFTlRfQ09OTkVDVEVELCAoZSkgPT4gewogICAgICAgIHRoaXMubG9ncyA9IFtdOwogICAgICAgIHRoaXMubG9nT3BlbiA9IHRydWU7CiAgICAgIH0pOwoKICAgICAgdGhpcy5sb2dTb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihFVkVOVF9ESVNDT05ORUNURUQsIChlKSA9PiB7CiAgICAgICAgdGhpcy5sb2dPcGVuID0gZmFsc2U7CiAgICAgIH0pOwoKICAgICAgdGhpcy5sb2dTb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihFVkVOVF9DT05ORUNUX0VSUk9SLCAoZSkgPT4gewogICAgICAgIHRoaXMubG9nT3BlbiA9IGZhbHNlOwogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nvbm5lY3QgRXJyb3InLCBlKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCiAgICAgIH0pOwoKICAgICAgdGhpcy5sb2dTb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihFVkVOVF9NRVNTQUdFLCAoZSkgPT4gewogICAgICAgIGNvbnN0IGxpbmUgPSBiYXNlNjREZWNvZGUoZS5kZXRhaWwuZGF0YSk7CgogICAgICAgIGxldCBtc2cgPSBsaW5lOwogICAgICAgIGxldCB0aW1lID0gbnVsbDsKCiAgICAgICAgY29uc3QgaWR4ID0gbGluZS5pbmRleE9mKCcgJyk7CgogICAgICAgIGlmICggaWR4ID4gMCApIHsKICAgICAgICAgIGNvbnN0IHRpbWVTdHIgPSBsaW5lLnN1YnN0cigwLCBpZHgpOwogICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHRpbWVTdHIpOwoKICAgICAgICAgIGlmICggIWlzTmFOKGRhdGUuZ2V0U2Vjb25kcygpKSApIHsKICAgICAgICAgICAgdGltZSA9IGRhdGUudG9JU09TdHJpbmcoKTsKICAgICAgICAgICAgbXNnID0gbGluZS5zdWJzdHIoaWR4ICsgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLmxvZ3MucHVzaCh7CiAgICAgICAgICBpZDogICAgIGxhc3RJZCsrLAogICAgICAgICAgbXNnOiAgICBhbnNpdXAuYW5zaV90b19odG1sKG1zZyksCiAgICAgICAgICByYXdNc2c6IG1zZywKICAgICAgICAgIHRpbWUsCiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgdGhpcy5sb2dTb2NrZXQuY29ubmVjdCgpOwogICAgfSwKCiAgICBmb3JtYXQodGltZSkgewogICAgICBpZiAoICF0aW1lICkgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQoKICAgICAgY29uc3QgdmFsID0gZGF5KHRpbWUpOwogICAgICBjb25zdCB0b2RheSA9IGRheSgpLmZvcm1hdCgnWVlZWS1NTS1ERCcpOwoKICAgICAgaWYgKCB2YWwuZm9ybWF0KCdZWVlZLU1NLUREJykgPT09IHRvZGF5ICkgewogICAgICAgIHJldHVybiBkYXkodGltZSkuZm9ybWF0KHRoaXMudGltZUZvcm1hdFN0cik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGRheSh0aW1lKS5mb3JtYXQodGhpcy5kYXRlVGltZUZvcm1hdFN0cik7CiAgICAgIH0KICAgIH0sCgogICAgbWFjaGluZVNvcnRHZW5lcmF0aW9uRm4oKSB7CiAgICAgIC8vIFRoZSBzb3J0IGdlbmVyYXRpb24gZnVuY3Rpb24gY3JlYXRlcyBhIHVuaXF1ZSB2YWx1ZSBhbmQgaXMgdXNlZCB0byBjcmVhdGUgYSBrZXkgaW5jbHVkaW5nIHNvcnQgZGV0YWlscy4KICAgICAgLy8gVGhlIHVuaXF1ZSBrZXkgZGV0ZXJtaW5lcyBpZiB0aGUgbGlzdCBpcyByZWRyYXduIG9yIGEgY2FjaGVkIHZlcnNpb24gaXMgc2hvd24uCiAgICAgIC8vIEJlY2F1c2Ugd2UgZW5zdXJlIHRoZSAnbm90IGluIGEgcG9vbCcgZ3JvdXAgaXMgdGhlcmUgdmlhIGEgcm93LCBhbmQgdGltaW5nIGlzc3VlcywgdGhlIHVucWl1ZSBrZXkgZG9lc24ndCBjaGFuZ2UKICAgICAgLy8gYWZ0ZXIgYSBtYWNoaW5lIGlzIGFkZGVkL3JlbW92ZWQuLi4gc28gdGhlIGxpc3Qgd29uJ3QgdXBkYXRlLi4uIHNvIHdlIG5lZWQgdG8gaW5qZWN0IGEgc3RyaW5nIHRvIGVuc3VyZSB0aGUga2V5IGlzIGZyZXNoCiAgICAgIGNvbnN0IGJhc2UgPSBkZWZhdWx0VGFibGVTb3J0R2VuZXJhdGlvbkZuKHRoaXMubWFjaGluZVNjaGVtYSwgdGhpcy4kc3RvcmUpOwoKICAgICAgcmV0dXJuIGJhc2UgKyAoISF0aGlzLmZha2VNYWNoaW5lcy5sZW5ndGggPyAnLWZha2UnIDogJycpOwogICAgfSwKCiAgICBub2RlU29ydEdlbmVyYXRpb25GbigpIHsKICAgICAgLy8gVGhlIHNvcnQgZ2VuZXJhdGlvbiBmdW5jdGlvbiBjcmVhdGVzIGEgdW5pcXVlIHZhbHVlIGFuZCBpcyB1c2VkIHRvIGNyZWF0ZSBhIGtleSBpbmNsdWRpbmcgc29ydCBkZXRhaWxzLgogICAgICAvLyBUaGUgdW5pcXVlIGtleSBkZXRlcm1pbmVzIGlmIHRoZSBsaXN0IGlzIHJlZHJhd24gb3IgYSBjYWNoZWQgdmVyc2lvbiBpcyBzaG93bi4KICAgICAgLy8gQmVjYXVzZSB3ZSBlbnN1cmUgdGhlICdub3QgaW4gYSBwb29sJyBncm91cCBpcyB0aGVyZSB2aWEgYSByb3csIGFuZCB0aW1pbmcgaXNzdWVzLCB0aGUgdW5xaXVlIGtleSBkb2Vzbid0IGNoYW5nZQogICAgICAvLyBhZnRlciBhIG1hY2hpbmUgaXMgYWRkZWQvcmVtb3ZlZC4uLiBzbyB0aGUgbGlzdCB3b24ndCB1cGRhdGUuLi4gc28gd2UgbmVlZCB0byBpbmplY3QgYSBzdHJpbmcgdG8gZW5zdXJlIHRoZSBrZXkgaXMgZnJlc2gKICAgICAgY29uc3QgYmFzZSA9IGRlZmF1bHRUYWJsZVNvcnRHZW5lcmF0aW9uRm4odGhpcy5tZ210Tm9kZVNjaGVtYSwgdGhpcy4kc3RvcmUpOwoKICAgICAgcmV0dXJuIGJhc2UgKyAoISF0aGlzLmZha2VOb2Rlcy5sZW5ndGggPyAnLWZha2UnIDogJycpOwogICAgfSwKICB9Cn07Cg=="},{"version":3,"sources":["provisioning.cattle.io.cluster.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"provisioning.cattle.io.cluster.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport Loading from '@shell/components/Loading';\nimport { Banner } from '@components/Banner';\nimport ResourceTable, { defaultTableSortGenerationFn } from '@shell/components/ResourceTable';\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport SortableTable from '@shell/components/SortableTable';\nimport CopyCode from '@shell/components/CopyCode';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport { allHash } from '@shell/utils/promise';\nimport { CAPI, MANAGEMENT, NORMAN, SNAPSHOT } from '@shell/config/types';\nimport {\n  STATE, NAME as NAME_COL, AGE, AGE_NORMAN, INTERNAL_EXTERNAL_IP, STATE_NORMAN, ROLES, MACHINE_NODE_OS, MANAGEMENT_NODE_OS, NAME,\n} from '@shell/config/table-headers';\nimport { STATES_ENUM } from '@shell/plugins/dashboard-store/resource-class';\nimport CustomCommand from '@shell/edit/provisioning.cattle.io.cluster/CustomCommand';\nimport AsyncButton from '@shell/components/AsyncButton.vue';\nimport AnsiUp from 'ansi_up';\nimport day from 'dayjs';\nimport { addParams } from '@shell/utils/url';\nimport { base64Decode } from '@shell/utils/crypto';\nimport { DATE_FORMAT, TIME_FORMAT, SCALE_POOL_PROMPT } from '@shell/store/prefs';\nimport { escapeHtml } from '@shell/utils/string';\nimport MachineSummaryGraph from '@shell/components/formatter/MachineSummaryGraph';\nimport Socket, {\n  EVENT_CONNECTED,\n  EVENT_DISCONNECTED,\n  EVENT_MESSAGE,\n  //  EVENT_FRAME_TIMEOUT,\n  EVENT_CONNECT_ERROR\n} from '@shell/utils/socket';\nimport { get } from '@shell/utils/object';\nimport CapiMachineDeployment from '@shell/models/cluster.x-k8s.io.machinedeployment';\nimport { isAlternate } from '@shell/utils/platform';\n\nlet lastId = 1;\nconst ansiup = new AnsiUp();\n\n/**\n * Machine Deployment has a reference to the 'template' used to create that deployment\n * For an empty machine pool, we (obviously) don't get any machine deployments for that pool.\n *\n * This class allows us to fake a machine deployment - when created, we set additional properties (_cluster etc)\n * and use these in the getters.\n **/\nclass EmptyCapiMachineDeployment extends CapiMachineDeployment {\n  get inClusterSpec() {\n    return this._clusterSpec;\n  }\n\n  get cluster() {\n    return this._cluster;\n  }\n\n  get template() {\n    return this._template;\n  }\n}\n\nexport default {\n  components: {\n    Loading,\n    Banner,\n    ResourceTable,\n    ResourceTabs,\n    SortableTable,\n    Tab,\n    CopyCode,\n    CustomCommand,\n    AsyncButton,\n    MachineSummaryGraph,\n  },\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  async fetch() {\n    await this.value.waitForProvisioner();\n\n    const extClass = this.$plugin.getDynamic('provisioner', this.value.machineProvider);\n\n    if (extClass) {\n      this.extProvider = new extClass({\n        dispatch: this.$store.dispatch,\n        getters:  this.$store.getters,\n        axios:    this.$store.$axios,\n        $plugin:  this.$store.app.$plugin,\n        $t:       this.t\n      });\n      this.extDetailTabs = {\n        ...this.extDetailTabs,\n        ...this.extProvider.detailTabs\n      };\n      this.extCustomParams = { provider: this.value.machineProvider };\n    }\n\n    const fetchOne = {};\n\n    if ( this.$store.getters['management/canList'](CAPI.MACHINE_DEPLOYMENT) ) {\n      fetchOne.machineDeployments = this.$store.dispatch('management/findAll', { type: CAPI.MACHINE_DEPLOYMENT });\n    }\n\n    if ( this.$store.getters['management/canList'](CAPI.MACHINE) ) {\n      fetchOne.machines = this.$store.dispatch('management/findAll', { type: CAPI.MACHINE });\n    }\n\n    if ( this.$store.getters['management/canList'](SNAPSHOT) ) {\n      fetchOne.snapshots = this.$store.dispatch('management/findAll', { type: SNAPSHOT });\n    }\n\n    if ( this.value.isImported || this.value.isCustom || this.value.isHostedKubernetesProvider ) {\n      fetchOne.clusterToken = this.value.getOrCreateToken();\n    }\n\n    // Need to get Norman clusters so that we can check if user has permissions to access the local cluster\n    if ( this.$store.getters['rancher/canList'](NORMAN.CLUSTER) ) {\n      fetchOne.normanClusters = this.$store.dispatch('rancher/findAll', { type: NORMAN.CLUSTER });\n    }\n\n    if ( this.value.isRke1 && this.$store.getters['isRancher'] ) {\n      fetchOne.etcdBackups = this.$store.dispatch('rancher/findAll', { type: NORMAN.ETCD_BACKUP });\n\n      fetchOne.normanNodePools = this.$store.dispatch('rancher/findAll', { type: NORMAN.NODE_POOL });\n    }\n\n    const fetchOneRes = await allHash(fetchOne);\n\n    this.allMachines = fetchOneRes.machines || [];\n    this.allMachineDeployments = fetchOneRes.machineDeployments || [];\n    this.haveMachines = !!fetchOneRes.machines;\n    this.haveDeployments = !!fetchOneRes.machineDeployments;\n    this.clusterToken = fetchOneRes.clusterToken;\n    this.etcdBackups = fetchOneRes.etcdBackups;\n\n    if (fetchOneRes.normanClusters) {\n      // Does the user have access to the local cluster? Need to in order to be able to show the 'Related Resources' tab\n      this.hasLocalAccess = !!fetchOneRes.normanClusters.find((c) => c.internal);\n    }\n\n    const fetchTwo = {};\n\n    const thisClusterMachines = this.allMachineDeployments.filter((deployment) => {\n      return deployment?.spec?.clusterName === this.value.metadata.name;\n    });\n\n    const machineDeploymentTemplateType = thisClusterMachines?.[0]?.templateType;\n\n    if (machineDeploymentTemplateType && this.$store.getters['management/schemaFor'](machineDeploymentTemplateType) ) {\n      fetchTwo.mdtt = this.$store.dispatch('management/findAll', { type: machineDeploymentTemplateType });\n    }\n\n    if (!this.showMachines) {\n      if ( this.$store.getters['management/canList'](MANAGEMENT.NODE) ) {\n        fetchTwo.allNodes = this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE });\n      }\n\n      if ( this.$store.getters['management/canList'](MANAGEMENT.NODE_POOL) ) {\n        fetchTwo.allNodePools = this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_POOL });\n      }\n\n      if ( this.$store.getters['management/canList'](MANAGEMENT.NODE_TEMPLATE) ) {\n        fetchTwo.nodeTemplates = this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_TEMPLATE });\n      }\n    }\n\n    const fetchTwoRes = await allHash(fetchTwo);\n\n    this.allNodes = fetchTwoRes.allNodes || [];\n    this.haveNodes = !!fetchTwoRes.allNodes;\n    this.allNodePools = fetchTwoRes.allNodePools || [];\n    this.haveNodePools = !!fetchTwoRes.allNodePools;\n    this.machineTemplates = fetchTwoRes.mdtt || [];\n\n    // Fetch RKE template revisions so we can show when an updated template is available\n    // This request does not need to be blocking\n    if ( this.$store.getters['management/canList'](MANAGEMENT.RKE_TEMPLATE) ) {\n      this.$store.dispatch('management/findAll', { type: MANAGEMENT.RKE_TEMPLATE });\n    }\n\n    if ( this.$store.getters['management/canList'](MANAGEMENT.RKE_TEMPLATE_REVISION) ) {\n      this.$store.dispatch('management/findAll', { type: MANAGEMENT.RKE_TEMPLATE_REVISION });\n    }\n  },\n\n  created() {\n    if ( this.showLog ) {\n      this.connectLog();\n    }\n  },\n\n  beforeDestroy() {\n    if ( this.logSocket ) {\n      this.logSocket.disconnect();\n      this.logSocket = null;\n    }\n  },\n\n  data() {\n    return {\n\n      allMachines:           [],\n      allMachineDeployments: [],\n      allNodes:              [],\n      allNodePools:          [],\n\n      haveMachines:    false,\n      haveDeployments: false,\n      haveNodes:       false,\n      haveNodePools:   false,\n      hasLocalAccess:  false,\n\n      mgmtNodeSchema: this.$store.getters[`management/schemaFor`](MANAGEMENT.NODE),\n      machineSchema:  this.$store.getters[`management/schemaFor`](CAPI.MACHINE),\n\n      clusterToken: null,\n      etcdBackups:  null,\n\n      logOpen:   false,\n      logSocket: null,\n      logs:      [],\n\n      extProvider:     null,\n      extCustomParams: null,\n      extDetailTabs:   {\n        machines:     true, // in this component\n        logs:         true, // in this component\n        registration: true, // in this component\n        snapshots:    true, // in this component\n        related:      true, // in ResourceTabs\n        events:       true, // in ResourceTabs\n        conditions:   true, // in ResourceTabs\n      },\n\n      showWindowsWarning: false\n    };\n  },\n\n  watch: {\n    showNodes(neu) {\n      if (neu) {\n        this.$store.dispatch('rancher/findAll', { type: NORMAN.NODE });\n      }\n    },\n  },\n\n  computed: {\n    defaultTab() {\n      if (this.showRegistration) {\n        if (this.value.isRke2 ? !this.machines?.length : !this.nodes?.length) {\n          return 'registration';\n        }\n      }\n\n      if (this.showMachines) {\n        return 'machine-pools';\n      }\n\n      if (this.showNodes) {\n        return 'node-pools';\n      }\n\n      return '';\n    },\n\n    // Used to show summary graph for each node pool group in the machine pool table\n    poolSummaryInfo() {\n      const info = {};\n\n      this.value?.pools.forEach((p) => {\n        const group = `[${ p.type }: ${ p.id }]`;\n\n        info[group] = p;\n      });\n\n      return info;\n    },\n\n    fakeMachines() {\n      const machineNameFn = (clusterName, machinePoolName) => `${ clusterName }-${ machinePoolName }`;\n\n      // When we scale up, the quantity will change to N+1 - so from 0 to 1, the quantity changes,\n      // but it takes tiem for the machine to appear, so the pool is empty, but if we just go off on a non-zero quqntity\n      // then the pool would be hidden - so we find empty pool by checking the machines\n      const emptyPools = (this.value.spec.rkeConfig?.machinePools || []).filter((mp) => {\n        const machineFullName = machineNameFn(this.value.name, mp.name);\n\n        const machines = this.value.machines.filter((machine) => {\n          const isElementalCluster = machine.spec?.infrastructureRef?.apiVersion.startsWith('elemental.cattle.io');\n          const machinePoolInfName = machine.spec?.infrastructureRef?.name;\n\n          if (isElementalCluster) {\n            return machinePoolInfName.includes(machineFullName);\n          }\n\n          // if labels exist, then the machineFullName must unequivocally be equal to manchineLabelFullName (based on labels)\n          const machineLabelClusterName = machine.metadata?.labels?.['cluster.x-k8s.io/cluster-name'];\n          const machineLabelPoolName = machine.metadata?.labels?.['rke.cattle.io/rke-machine-pool-name'];\n\n          if (machineLabelClusterName && machineLabelPoolName) {\n            const manchineLabelFullName = machineNameFn(machineLabelClusterName, machineLabelPoolName);\n\n            return machineFullName === manchineLabelFullName;\n          }\n\n          return machinePoolInfName.startsWith(machineFullName);\n        });\n\n        return machines.length === 0;\n      });\n\n      // When a deployment has no machines it's not shown.... so add a fake machine to it\n      // This is a catch all scenario seen in older node pool world but not deployments\n      return emptyPools.map((mp, i) => {\n        const pool = new EmptyCapiMachineDeployment(\n          {\n            id:       i,\n            metadata: {\n              name:      `${ this.value.nameDisplay }-${ mp.name }`,\n              namespace: this.value.namespace,\n            },\n            spec: {}\n          },\n          {\n            getters:     this.$store.getters,\n            rootGetters: this.$root.$store.getters,\n          }\n        );\n\n        const templateNamePrefix = `${ pool.metadata.name }-`;\n\n        // All of these properties are needed to ensure the pool displays correctly and that we can scale up and down\n        pool._template = this.machineTemplates.find((t) => t.metadata.name.startsWith(templateNamePrefix));\n        pool._cluster = this.value;\n        pool._clusterSpec = mp;\n\n        return {\n          poolId:           pool.id,\n          mainRowKey:       'isFake',\n          pool,\n          availableActions: []\n        };\n      });\n    },\n\n    machines() {\n      return [...this.value.machines, ...this.fakeMachines];\n    },\n\n    nodes() {\n      const nodes = this.allNodes.filter((x) => x.mgmtClusterId === this.value.mgmtClusterId);\n\n      return [...nodes, ...this.fakeNodes];\n    },\n\n    fakeNodes() {\n      // When a pool has no nodes it's not shown.... so add a fake node to it\n      const emptyNodePools = this.allNodePools.filter((x) => x.spec.clusterName === this.value.mgmtClusterId && x.spec.quantity === 0);\n\n      return emptyNodePools.map((np) => ({\n        spec:             { nodePoolName: np.id.replace('/', ':') },\n        mainRowKey:       'isFake',\n        pool:             np,\n        availableActions: []\n      }));\n    },\n\n    showMachines() {\n      const showMachines = this.haveMachines && (this.value.isRke2 || !!this.machines.length);\n\n      return showMachines && this.extDetailTabs.machines;\n    },\n\n    showNodes() {\n      return !this.showMachines && this.haveNodes && !!this.nodes.length;\n    },\n\n    showSnapshots() {\n      if (this.value.isRke1) {\n        return this.$store.getters['rancher/canList'](NORMAN.ETCD_BACKUP) && this.extDetailTabs.snapshots;\n      } else if (this.value.isRke2) {\n        return this.$store.getters['management/canList'](SNAPSHOT) && this.extDetailTabs.snapshots;\n      }\n\n      return false;\n    },\n\n    showEksNodeGroupWarning() {\n      if ( this.value.provisioner === 'EKS' && this.value.state !== STATES_ENUM.ACTIVE) {\n        const desiredTotal = this.value.eksNodeGroups.filter((g) => g.desiredSize === 0);\n\n        if ( desiredTotal.length === this.value.eksNodeGroups.length ) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    machineHeaders() {\n      return [\n        STATE,\n        NAME_COL,\n        {\n          name:          'node-name',\n          labelKey:      'tableHeaders.machineNodeName',\n          sort:          'status.nodeRef.name',\n          value:         'status.nodeRef.name',\n          formatter:     'LinkDetail',\n          formatterOpts: { reference: 'kubeNodeDetailLocation' },\n          dashIfEmpty:   true,\n        },\n        INTERNAL_EXTERNAL_IP,\n        MACHINE_NODE_OS,\n        ROLES,\n        AGE,\n      ];\n    },\n\n    mgmtNodeSchemaHeaders() {\n      return [\n        STATE, NAME_COL,\n        {\n          name:          'node-name',\n          labelKey:      'tableHeaders.machineNodeName',\n          sort:          'kubeNodeName',\n          value:         'kubeNodeName',\n          formatter:     'LinkDetail',\n          formatterOpts: { reference: 'kubeNodeDetailLocation' },\n          dashIfEmpty:   true,\n        },\n        INTERNAL_EXTERNAL_IP,\n        MANAGEMENT_NODE_OS,\n        ROLES,\n        AGE\n      ];\n    },\n\n    rke1Snapshots() {\n      const mgmtId = this.value.mgmt?.id;\n\n      if ( !mgmtId ) {\n        return [];\n      }\n\n      return (this.etcdBackups || []).filter((x) => x.clusterId === mgmtId);\n    },\n\n    rke2Snapshots() {\n      return this.value.etcdSnapshots;\n    },\n\n    rke1SnapshotHeaders() {\n      return [\n        STATE_NORMAN,\n        {\n          name:          'name',\n          labelKey:      'tableHeaders.name',\n          value:         'nameDisplay',\n          sort:          ['nameSort'],\n          canBeVariable: true,\n        },\n        {\n          name:     'version',\n          labelKey: 'tableHeaders.version',\n          value:    'status.kubernetesVersion',\n          sort:     'status.kubernetesVersion',\n          width:    150,\n        },\n        { ...AGE_NORMAN, canBeVariable: true },\n        {\n          name:      'manual',\n          labelKey:  'tableHeaders.manual',\n          value:     'manual',\n          formatter: 'Checked',\n          sort:      ['manual'],\n          align:     'center',\n          width:     50,\n        },\n      ];\n    },\n\n    rke2SnapshotHeaders() {\n      return [\n        {\n          ...STATE_NORMAN, value: 'snapshotFile.status', formatterOpts: { arbitrary: true }\n        },\n        NAME,\n        {\n          name:      'size',\n          labelKey:  'tableHeaders.size',\n          value:     'snapshotFile.size',\n          sort:      'snapshotFile.size',\n          formatter: 'Si',\n          width:     150,\n        },\n        {\n          ...AGE,\n          sort:          'snapshotFile.createdAt:desc',\n          canBeVariable: true\n        },\n      ];\n    },\n\n    showRegistration() {\n      if ( !this.clusterToken ) {\n        return false;\n      }\n\n      if ( this.value.isImported ) {\n        return !this.value.mgmt?.isReady && this.extDetailTabs.registration;\n      }\n\n      if ( this.value.isCustom ) {\n        return this.extDetailTabs.registration;\n      }\n\n      if ( this.value.isHostedKubernetesProvider && !this.isClusterReady ) {\n        return this.extDetailTabs.registration;\n      }\n\n      return false;\n    },\n\n    isClusterReady() {\n      return this.value.mgmt?.isReady;\n    },\n\n    showLog() {\n      const showLog = this.value.mgmt?.hasLink('log');\n\n      return showLog && this.extDetailTabs.logs;\n    },\n\n    dateTimeFormatStr() {\n      const dateFormat = escapeHtml( this.$store.getters['prefs/get'](DATE_FORMAT));\n\n      return `${ dateFormat } ${ this.timeFormatStr }`;\n    },\n\n    timeFormatStr() {\n      return escapeHtml( this.$store.getters['prefs/get'](TIME_FORMAT));\n    },\n\n    hasWindowsMachine() {\n      return this.machines.some((machine) => get(machine, 'status.nodeInfo.operatingSystem') === 'windows');\n    },\n\n    snapshotsGroupBy() {\n      return 'backupLocation';\n    }\n  },\n\n  mounted() {\n    window.c = this;\n  },\n\n  methods: {\n    toggleScaleDownModal( event, resources ) {\n      // Check if the user held alt key when an action is clicked.\n      const alt = isAlternate(event);\n      const showScalePoolPrompt = this.$store.getters['prefs/get'](SCALE_POOL_PROMPT);\n\n      // Prompt if showScalePoolPrompt pref not store and user did not held alt key\n      if (!alt && !showScalePoolPrompt) {\n        this.$store.dispatch('management/promptModal', {\n          component:  'ScalePoolDownDialog',\n          resources,\n          modalWidth: '450px'\n        });\n      } else {\n        // User held alt key, so don't prompt\n        resources.scalePool(-1);\n      }\n    },\n\n    async takeSnapshot(btnCb) {\n      try {\n        await this.value.takeSnapshot();\n\n        // Give the change event some time to show up\n        setTimeout(() => {\n          btnCb(true);\n        }, 1000);\n      } catch (err) {\n        this.$store.dispatch('growl/fromError', { title: 'Error creating snapshot', err });\n        btnCb(false);\n      }\n    },\n\n    showPoolAction(event, pool) {\n      this.$store.commit(`action-menu/show`, {\n        resources: [pool],\n        elem:      event.target\n      });\n    },\n\n    showPoolActionButton(pool) {\n      return !!pool.availableActions?.length;\n    },\n\n    async connectLog() {\n      if ( this.logSocket ) {\n        await this.logSocket.disconnect();\n        this.logSocket = null;\n      }\n\n      const params = {\n        follow:     true,\n        timestamps: true,\n        pretty:     true,\n      };\n\n      let url = this.value.mgmt?.linkFor('log');\n\n      url = addParams(url.replace(/^http/, 'ws'), params);\n\n      this.logSocket = new Socket(url, true, 0);\n      this.logSocket.addEventListener(EVENT_CONNECTED, (e) => {\n        this.logs = [];\n        this.logOpen = true;\n      });\n\n      this.logSocket.addEventListener(EVENT_DISCONNECTED, (e) => {\n        this.logOpen = false;\n      });\n\n      this.logSocket.addEventListener(EVENT_CONNECT_ERROR, (e) => {\n        this.logOpen = false;\n        console.error('Connect Error', e); // eslint-disable-line no-console\n      });\n\n      this.logSocket.addEventListener(EVENT_MESSAGE, (e) => {\n        const line = base64Decode(e.detail.data);\n\n        let msg = line;\n        let time = null;\n\n        const idx = line.indexOf(' ');\n\n        if ( idx > 0 ) {\n          const timeStr = line.substr(0, idx);\n          const date = new Date(timeStr);\n\n          if ( !isNaN(date.getSeconds()) ) {\n            time = date.toISOString();\n            msg = line.substr(idx + 1);\n          }\n        }\n\n        this.logs.push({\n          id:     lastId++,\n          msg:    ansiup.ansi_to_html(msg),\n          rawMsg: msg,\n          time,\n        });\n      });\n\n      this.logSocket.connect();\n    },\n\n    format(time) {\n      if ( !time ) {\n        return '';\n      }\n\n      const val = day(time);\n      const today = day().format('YYYY-MM-DD');\n\n      if ( val.format('YYYY-MM-DD') === today ) {\n        return day(time).format(this.timeFormatStr);\n      } else {\n        return day(time).format(this.dateTimeFormatStr);\n      }\n    },\n\n    machineSortGenerationFn() {\n      // The sort generation function creates a unique value and is used to create a key including sort details.\n      // The unique key determines if the list is redrawn or a cached version is shown.\n      // Because we ensure the 'not in a pool' group is there via a row, and timing issues, the unqiue key doesn't change\n      // after a machine is added/removed... so the list won't update... so we need to inject a string to ensure the key is fresh\n      const base = defaultTableSortGenerationFn(this.machineSchema, this.$store);\n\n      return base + (!!this.fakeMachines.length ? '-fake' : '');\n    },\n\n    nodeSortGenerationFn() {\n      // The sort generation function creates a unique value and is used to create a key including sort details.\n      // The unique key determines if the list is redrawn or a cached version is shown.\n      // Because we ensure the 'not in a pool' group is there via a row, and timing issues, the unqiue key doesn't change\n      // after a machine is added/removed... so the list won't update... so we need to inject a string to ensure the key is fresh\n      const base = defaultTableSortGenerationFn(this.mgmtNodeSchema, this.$store);\n\n      return base + (!!this.fakeNodes.length ? '-fake' : '');\n    },\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <Banner\n      v-if=\"showWindowsWarning\"\n      color=\"error\"\n      :label=\"t('cluster.banner.os', { newOS: 'Windows', existingOS: 'Linux' })\"\n    />\n    <Banner\n      v-if=\"showEksNodeGroupWarning\"\n      color=\"error\"\n      :label=\"t('cluster.banner.desiredNodeGroupWarning')\"\n    />\n\n    <Banner\n      v-if=\"$fetchState.error\"\n      color=\"error\"\n      :label=\"$fetchState.error\"\n    />\n    <ResourceTabs\n      v-model=\"value\"\n      :default-tab=\"defaultTab\"\n      :need-related=\"hasLocalAccess\"\n      :extension-params=\"extCustomParams\"\n      :needRelated=\"extDetailTabs.related\"\n      :needEvents=\"extDetailTabs.events\"\n      :needConditions=\"extDetailTabs.conditions\"\n    >\n      <Tab\n        v-if=\"showMachines\"\n        name=\"machine-pools\"\n        :label-key=\"value.isCustom ? 'cluster.tabs.machines' : 'cluster.tabs.machinePools'\"\n        :weight=\"4\"\n      >\n        <ResourceTable\n          :rows=\"machines\"\n          :schema=\"machineSchema\"\n          :headers=\"machineHeaders\"\n          default-sort-by=\"name\"\n          :groupable=\"false\"\n          :group-by=\"value.isCustom ? null : 'poolId'\"\n          group-ref=\"pool\"\n          :group-sort=\"['pool.nameDisplay']\"\n          :sort-generation-fn=\"machineSortGenerationFn\"\n        >\n          <template #main-row:isFake=\"{fullColspan}\">\n            <tr class=\"main-row\">\n              <td\n                :colspan=\"fullColspan\"\n                class=\"no-entries\"\n              >\n                {{ t('node.list.noNodes') }}\n              </td>\n            </tr>\n          </template>\n\n          <template #group-by=\"{group}\">\n            <div\n              class=\"pool-row\"\n              :class=\"{'has-description':group.ref && group.ref.template}\"\n            >\n              <div\n                v-trim-whitespace\n                class=\"group-tab\"\n              >\n                <div\n                  v-if=\"group && group.ref\"\n                  v-clean-html=\"group.ref.groupByPoolShortLabel\"\n                />\n                <div\n                  v-else\n                  v-clean-html=\"t('resourceTable.groupLabel.notInANodePool')\"\n                />\n                <div\n                  v-if=\"group.ref && group.ref.template\"\n                  class=\"description text-muted text-small\"\n                >\n                  {{ group.ref.providerDisplay }} &ndash;  {{ group.ref.providerLocation }} / {{ group.ref.providerSize }} ({{ group.ref.providerName }})\n                </div>\n              </div>\n              <div\n                v-if=\"group.ref && poolSummaryInfo[group.ref]\"\n                class=\"right group-header-buttons mr-20\"\n              >\n                <MachineSummaryGraph\n                  :row=\"poolSummaryInfo[group.ref]\"\n                  :horizontal=\"true\"\n                  class=\"mr-20\"\n                />\n                <template v-if=\"value.hasLink('update') && group.ref.showScalePool\">\n                  <button\n                    v-clean-tooltip=\"t('node.list.scaleDown')\"\n                    :disabled=\"!group.ref.canScaleDownPool()\"\n                    type=\"button\"\n                    class=\"btn btn-sm role-secondary\"\n                    @click=\"toggleScaleDownModal($event, group.ref)\"\n                  >\n                    <i class=\"icon icon-sm icon-minus\" />\n                  </button>\n                  <button\n                    v-clean-tooltip=\"t('node.list.scaleUp')\"\n                    :disabled=\"!group.ref.canScaleUpPool()\"\n                    type=\"button\"\n                    class=\"btn btn-sm role-secondary ml-10\"\n                    @click=\"group.ref.scalePool(1)\"\n                  >\n                    <i class=\"icon icon-sm icon-plus\" />\n                  </button>\n                </template>\n              </div>\n            </div>\n          </template>\n        </ResourceTable>\n      </Tab>\n\n      <Tab\n        v-else-if=\"showNodes\"\n        name=\"node-pools\"\n        :label-key=\"value.isCustom ? 'cluster.tabs.machines' : 'cluster.tabs.machinePools'\"\n        :weight=\"4\"\n      >\n        <ResourceTable\n          :schema=\"mgmtNodeSchema\"\n          :headers=\"mgmtNodeSchemaHeaders\"\n          :rows=\"nodes\"\n          :groupable=\"false\"\n          :group-by=\"value.isCustom ? null : 'spec.nodePoolName'\"\n          group-ref=\"pool\"\n          :group-sort=\"['pool.nameDisplay']\"\n          :sort-generation-fn=\"nodeSortGenerationFn\"\n        >\n          <template #main-row:isFake=\"{fullColspan}\">\n            <tr class=\"main-row\">\n              <td\n                :colspan=\"fullColspan\"\n                class=\"no-entries\"\n              >\n                {{ t('node.list.noNodes') }}\n              </td>\n            </tr>\n          </template>\n\n          <template #group-by=\"{group}\">\n            <div\n              class=\"pool-row\"\n              :class=\"{'has-description':group.ref && group.ref.nodeTemplate}\"\n            >\n              <div\n                v-trim-whitespace\n                class=\"group-tab\"\n              >\n                <div\n                  v-if=\"group.ref\"\n                  v-clean-html=\"t('resourceTable.groupLabel.nodePool', { name: group.ref.spec.hostnamePrefix}, true)\"\n                />\n                <div\n                  v-else\n                  v-clean-html=\"t('resourceTable.groupLabel.notInANodePool')\"\n                />\n                <div\n                  v-if=\"group.ref && group.ref.nodeTemplate\"\n                  class=\"description text-muted text-small\"\n                >\n                  {{ group.ref.providerDisplay }} &ndash;  {{ group.ref.providerLocation }} / {{ group.ref.providerSize }} ({{ group.ref.providerName }})\n                </div>\n              </div>\n              <div\n                v-if=\"group.ref\"\n                class=\"right group-header-buttons\"\n              >\n                <MachineSummaryGraph\n                  :row=\"poolSummaryInfo[group.ref]\"\n                  :horizontal=\"true\"\n                  class=\"mr-20\"\n                />\n                <template v-if=\"group.ref.hasLink('update')\">\n                  <button\n                    v-clean-tooltip=\"t('node.list.scaleDown')\"\n                    :disabled=\"group.ref.spec.quantity < 2\"\n                    type=\"button\"\n                    class=\"btn btn-sm role-secondary\"\n                    @click=\"toggleScaleDownModal($event, group.ref)\"\n                  >\n                    <i class=\"icon icon-sm icon-minus\" />\n                  </button>\n                  <button\n                    v-clean-tooltip=\"t('node.list.scaleUp')\"\n                    type=\"button\"\n                    class=\"btn btn-sm role-secondary ml-10\"\n                    @click=\"group.ref.scalePool(1)\"\n                  >\n                    <i class=\"icon icon-sm icon-plus\" />\n                  </button>\n                </template>\n\n                <button\n                  type=\"button\"\n                  class=\"project-action btn btn-sm role-multi-action actions mr-5 ml-15\"\n                  :class=\"{invisible: !showPoolActionButton(group.ref)}\"\n                  @click=\"showPoolAction($event, group.ref)\"\n                >\n                  <i class=\"icon icon-actions\" />\n                </button>\n              </div>\n            </div>\n          </template>\n        </ResourceTable>\n      </Tab>\n\n      <Tab\n        v-if=\"showLog\"\n        name=\"log\"\n        :label=\"t('cluster.tabs.log')\"\n        :weight=\"3\"\n        class=\"logs-container\"\n      >\n        <table\n          class=\"fixed\"\n          cellpadding=\"0\"\n          cellspacing=\"0\"\n        >\n          <tbody class=\"logs-body\">\n            <template v-if=\"logs.length\">\n              <tr\n                v-for=\"line in logs\"\n                :key=\"line.id\"\n              >\n                <td\n                  :key=\"line.id + '-time'\"\n                  v-clean-html=\"format(line.time)\"\n                  class=\"time\"\n                />\n                <td\n                  :key=\"line.id + '-msg'\"\n                  v-clean-html=\"line.msg\"\n                  class=\"msg\"\n                />\n              </tr>\n            </template>\n            <tr\n              v-else-if=\"!logOpen\"\n              v-t=\"'cluster.log.connecting'\"\n              colspan=\"2\"\n              class=\"msg text-muted\"\n            />\n            <tr\n              v-else\n              v-t=\"'cluster.log.noData'\"\n              colspan=\"2\"\n              class=\"msg text-muted\"\n            />\n          </tbody>\n        </table>\n      </Tab>\n\n      <Tab\n        v-if=\"showRegistration\"\n        name=\"registration\"\n        :label=\"t('cluster.tabs.registration')\"\n        :weight=\"2\"\n      >\n        <Banner\n          v-if=\"!value.isCustom\"\n          color=\"warning\"\n          :label=\"t('cluster.import.warningBanner')\"\n        />\n        <CustomCommand\n          v-if=\"value.isCustom\"\n          :cluster-token=\"clusterToken\"\n          :cluster=\"value\"\n          @copied-windows=\"hasWindowsMachine ? null : showWindowsWarning = true\"\n        />\n        <template v-else>\n          <h4 v-clean-html=\"t('cluster.import.commandInstructions', null, true)\" />\n          <CopyCode class=\"m-10 p-10\">\n            {{ clusterToken.command }}\n          </CopyCode>\n\n          <h4\n            v-clean-html=\"t('cluster.import.commandInstructionsInsecure', null, true)\"\n            class=\"mt-10\"\n          />\n          <CopyCode class=\"m-10 p-10\">\n            {{ clusterToken.insecureCommand }}\n          </CopyCode>\n\n          <h4\n            v-clean-html=\"t('cluster.import.clusterRoleBindingInstructions', null, true)\"\n            class=\"mt-10\"\n          />\n          <CopyCode class=\"m-10 p-10\">\n            {{ t('cluster.import.clusterRoleBindingCommand', null, true) }}\n          </CopyCode>\n        </template>\n      </Tab>\n\n      <Tab\n        v-if=\"showSnapshots\"\n        name=\"snapshots\"\n        label=\"Snapshots\"\n        :weight=\"1\"\n      >\n        <SortableTable\n          class=\"snapshots\"\n          :headers=\"value.isRke1 ? rke1SnapshotHeaders : rke2SnapshotHeaders\"\n          default-sort-by=\"age\"\n          :table-actions=\"value.isRke1\"\n          :rows=\"value.isRke1 ? rke1Snapshots : rke2Snapshots\"\n          :search=\"false\"\n          :groupable=\"true\"\n          :group-by=\"snapshotsGroupBy\"\n        >\n          <template #header-right>\n            <AsyncButton\n              mode=\"snapshot\"\n              class=\"btn role-primary\"\n              :disabled=\"!isClusterReady\"\n              @click=\"takeSnapshot\"\n            />\n          </template>\n          <template #group-by=\"{group}\">\n            <div class=\"group-bar\">\n              <div class=\"group-tab\">\n                {{ t('cluster.snapshot.groupLabel') }}: {{ group.key }}\n              </div>\n            </div>\n          </template>\n        </SortableTable>\n      </Tab>\n    </ResourceTabs>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n.main-row .no-entries {\n  text-align: center;\n}\n\n.pool-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n\n  &.has-description {\n    .group-tab {\n      &, &::after {\n          height: 50px;\n      }\n\n      &::after {\n          right: -20px;\n      }\n\n      .description {\n          margin-top: -20px;\n      }\n    }\n  }\n  .group-header-buttons {\n    align-items: center;\n    display: flex;\n  }\n}\n\n.logs-container {\n  height: 100%;\n  overflow: auto;\n  padding: 5px;\n  background-color: var(--logs-bg);\n  font-family: Menlo,Consolas,monospace;\n  color: var(--logs-text);\n\n  .closed {\n    opacity: 0.25;\n  }\n\n  .time {\n    white-space: nowrap;\n    width: auto;\n    padding-right: 15px;\n    user-select: none;\n  }\n\n  .msg {\n    white-space: normal;\n\n    .highlight {\n      color: var(--logs-highlight);\n      background-color: var(--logs-highlight-bg);\n    }\n  }\n}\n\n.snapshots ::v-deep .state-description{\n  font-size: .8em;\n  color: var(--error);\n}\n\n</style>\n"]}]}