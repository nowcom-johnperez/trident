{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/helm.cattle.io.projecthelmchart.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/helm.cattle.io.projecthelmchart.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBUYWJiZWQgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVGFiYmVkJzsKaW1wb3J0IGNyZWF0ZUVkaXRWaWV3IGZyb20gJ0BzaGVsbC9taXhpbnMvY3JlYXRlLWVkaXQtdmlldyc7CmltcG9ydCBDcnVSZXNvdXJjZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9DcnVSZXNvdXJjZSc7CmltcG9ydCBRdWVzdGlvbnMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvUXVlc3Rpb25zJzsKaW1wb3J0IHsgQ09ORklHX01BUCwgTkFNRVNQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCBqc3lhbWwgZnJvbSAnanMteWFtbCc7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ3J1UmVzb3VyY2UsCiAgICBMYWJlbGVkU2VsZWN0LAogICAgTGFiZWxlZElucHV0LAogICAgVGFiYmVkLAogICAgUXVlc3Rpb25zLAogICAgTG9hZGluZwogIH0sCgogIG1peGluczogW2NyZWF0ZUVkaXRWaWV3XSwKCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgICBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgfSwKICB9LAoKICBhc3luYyBmZXRjaCgpIHsKICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjYXRhbG9nL2xvYWQnKTsKICAgIGNvbnN0IGluU3RvcmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50U3RvcmUnXShOQU1FU1BBQ0UpOwoKICAgIC8vIHRoaXMgc2VlbXMgZXhjZXNzaXZlIGJ1dCBpZiB3ZSdyZSBnb25uYSBwdWxsIHVwIHNwZWNpZmljIGNvbmZpZ01hcHMgd2UgbmVlZCB0aGVuIHdlIG5lZWQgdGhlIGNvbmZpZ21hcHMgdG8gYmUgaW4gdGhlIHN0b3JlLgogICAgLy8gVG9EbzogdHJ5IHRvIGZpbmQgYSBiZXR0ZXIgd2F5IG9mIGxvYWRpbmcgdGhlc2Ugb3IganVzdCBsb2FkIHRoZSBvbmVzIHdlIG5lZWQKICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGAkeyBpblN0b3JlIH0vZmluZEFsbGAsIHsgdHlwZTogQ09ORklHX01BUCB9KTsKCiAgICBjb25zdCBmZWRlcmF0b3JTeXN0ZW1OYW1lc3BhY2VzQ29uZmlnTWFwID0gYXdhaXQgdGhpcy5nZXRDb25maWdNYXAoJ2NhdHRsZS1tb25pdG9yaW5nLXN5c3RlbS9wcm9tZXRoZXVzLWZlZGVyYXRvci1zeXN0ZW0tbmFtZXNwYWNlcycpOwoKICAgIHRoaXMuc3lzdGVtTmFtZXNwYWNlcyA9IEpTT04ucGFyc2UoZmVkZXJhdG9yU3lzdGVtTmFtZXNwYWNlc0NvbmZpZ01hcD8uZGF0YT8uWydzeXN0ZW0tbmFtZXNwYWNlcy5qc29uJ10pOwoKICAgIHRoaXMubmFtZXNwYWNlcyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbYCR7IGluU3RvcmUgfS9hbGxgXShOQU1FU1BBQ0UpCiAgICAgIC5maWx0ZXIodGhpcy5uYW1lc3BhY2VGaWx0ZXIpCiAgICAgIC5tYXAodGhpcy5uYW1lc3BhY2VNYXBwZXIpOwoKICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogIH0sCgogIGRhdGEoKSB7CiAgICBpZiAoIXRoaXMudmFsdWUuc3BlYy52YWx1ZXMpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUuc3BlYywgJ3ZhbHVlcycsIHt9KTsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBzeXN0ZW1OYW1lc3BhY2VzOiBudWxsLAogICAgICBuYW1lc3BhY2VzOiAgICAgICBbXSwKICAgICAgbG9hZGluZzogICAgICAgICAgdHJ1ZQogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgc2VsZWN0ZWROYW1lc3BhY2VRdWVzdGlvbnMoKSB7CiAgICAgIGNvbnN0IGluU3RvcmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50U3RvcmUnXSgpOwoKICAgICAgY29uc3QgY29uZmlnTWFwUmVsYXRpb25zaGlwID0gdGhpcy5jdXJyZW50TmFtZXNwYWNlPy5tZXRhZGF0YT8ucmVsYXRpb25zaGlwcy5maW5kKChyZWxhdGlvbnNoaXApID0+IHJlbGF0aW9uc2hpcD8udG9UeXBlID09PSAnY29uZmlnbWFwJyk7CgogICAgICBjb25zdCBxdWVzdGlvbnNZYW1sID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1tgJHsgaW5TdG9yZSB9L2J5SWRgXShjb25maWdNYXBSZWxhdGlvbnNoaXA/LnRvVHlwZSwgY29uZmlnTWFwUmVsYXRpb25zaGlwPy50b0lkKT8uZGF0YT8uWydxdWVzdGlvbnMueWFtbCddOwoKICAgICAgcmV0dXJuIGpzeWFtbC5sb2FkKHF1ZXN0aW9uc1lhbWwpPy5xdWVzdGlvbnM7CiAgICB9LAogICAgY3VycmVudE5hbWVzcGFjZSgpIHsKICAgICAgcmV0dXJuIHRoaXMubmFtZXNwYWNlcy5maW5kKChuYW1lc3BhY2UpID0+IG5hbWVzcGFjZS5pZCA9PT0gdGhpcy52YWx1ZT8ubWV0YWRhdGE/Lm5hbWVzcGFjZSk7CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgZ2V0TmFtZXNwYWNlQ29uZmlnTWFwSWQobmFtZXNwYWNlKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnROYW1lc3BhY2U/Lm1ldGFkYXRhPy5yZWxhdGlvbnNoaXBzLmZpbmQoKHJlbGF0aW9uc2hpcCkgPT4gcmVsYXRpb25zaGlwPy50b1R5cGUgPT09ICdjb25maWdtYXAnKT8udG9JZDsKICAgIH0sCiAgICBhc3luYyBnZXRDb25maWdNYXAoaWQpIHsKICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmQnLCB7IHR5cGU6IENPTkZJR19NQVAsIGlkIH0pOwogICAgfSwKICAgIG5hbWVzcGFjZUZpbHRlcihuYW1lc3BhY2UpIHsKICAgICAgY29uc3QgZXhjbHVkZVByb2plY3RzID0gWy4uLnRoaXMuc3lzdGVtTmFtZXNwYWNlcz8uc3lzdGVtUHJvamVjdExhYmVsVmFsdWVzIHx8IFtdLCB0aGlzLnN5c3RlbU5hbWVzcGFjZXM/LnByb2plY3RSZWxlYXNlTGFiZWxWYWx1ZV07CgogICAgICByZXR1cm4gbmFtZXNwYWNlPy5wcm9qZWN0ICYmIG5hbWVzcGFjZT8ubWV0YWRhdGE/LmxhYmVscz8uWydoZWxtLmNhdHRsZS5pby9oZWxtLXByb2plY3Qtb3BlcmF0ZWQnXSAmJiAhZXhjbHVkZVByb2plY3RzLmluY2x1ZGVzKG5hbWVzcGFjZS5wcm9qZWN0SWQpOwogICAgfSwKICAgIG5hbWVzcGFjZU1hcHBlcihuYW1lc3BhY2UpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAuLi5uYW1lc3BhY2UsCiAgICAgICAgY29uZmlnTWFwSWQ6IHRoaXMuZ2V0TmFtZXNwYWNlQ29uZmlnTWFwSWQobmFtZXNwYWNlKSwKICAgICAgICBsYWJlbDogICAgICAgbmFtZXNwYWNlPy5wcm9qZWN0Py5zcGVjPy5kaXNwbGF5TmFtZSwKICAgICAgICB2YWx1ZTogICAgICAgbmFtZXNwYWNlPy5pZCwKICAgICAgfTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["helm.cattle.io.projecthelmchart.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"helm.cattle.io.projecthelmchart.vue","sourceRoot":"node_modules/@rancher/shell/edit","sourcesContent":["<script>\nimport Tabbed from '@shell/components/Tabbed';\nimport createEditView from '@shell/mixins/create-edit-view';\nimport CruResource from '@shell/components/CruResource';\nimport Questions from '@shell/components/Questions';\nimport { CONFIG_MAP, NAMESPACE } from '@shell/config/types';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport Loading from '@shell/components/Loading';\nimport jsyaml from 'js-yaml';\n\nexport default {\n  components: {\n    CruResource,\n    LabeledSelect,\n    LabeledInput,\n    Tabbed,\n    Questions,\n    Loading\n  },\n\n  mixins: [createEditView],\n\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n\n  async fetch() {\n    await this.$store.dispatch('catalog/load');\n    const inStore = this.$store.getters['currentStore'](NAMESPACE);\n\n    // this seems excessive but if we're gonna pull up specific configMaps we need then we need the configmaps to be in the store.\n    // ToDo: try to find a better way of loading these or just load the ones we need\n    await this.$store.dispatch(`${ inStore }/findAll`, { type: CONFIG_MAP });\n\n    const federatorSystemNamespacesConfigMap = await this.getConfigMap('cattle-monitoring-system/prometheus-federator-system-namespaces');\n\n    this.systemNamespaces = JSON.parse(federatorSystemNamespacesConfigMap?.data?.['system-namespaces.json']);\n\n    this.namespaces = this.$store.getters[`${ inStore }/all`](NAMESPACE)\n      .filter(this.namespaceFilter)\n      .map(this.namespaceMapper);\n\n    this.loading = false;\n  },\n\n  data() {\n    if (!this.value.spec.values) {\n      this.$set(this.value.spec, 'values', {});\n    }\n\n    return {\n      systemNamespaces: null,\n      namespaces:       [],\n      loading:          true\n    };\n  },\n\n  computed: {\n    selectedNamespaceQuestions() {\n      const inStore = this.$store.getters['currentStore']();\n\n      const configMapRelationship = this.currentNamespace?.metadata?.relationships.find((relationship) => relationship?.toType === 'configmap');\n\n      const questionsYaml = this.$store.getters[`${ inStore }/byId`](configMapRelationship?.toType, configMapRelationship?.toId)?.data?.['questions.yaml'];\n\n      return jsyaml.load(questionsYaml)?.questions;\n    },\n    currentNamespace() {\n      return this.namespaces.find((namespace) => namespace.id === this.value?.metadata?.namespace);\n    }\n  },\n\n  methods: {\n    getNamespaceConfigMapId(namespace) {\n      return this.currentNamespace?.metadata?.relationships.find((relationship) => relationship?.toType === 'configmap')?.toId;\n    },\n    async getConfigMap(id) {\n      return await this.$store.dispatch('cluster/find', { type: CONFIG_MAP, id });\n    },\n    namespaceFilter(namespace) {\n      const excludeProjects = [...this.systemNamespaces?.systemProjectLabelValues || [], this.systemNamespaces?.projectReleaseLabelValue];\n\n      return namespace?.project && namespace?.metadata?.labels?.['helm.cattle.io/helm-project-operated'] && !excludeProjects.includes(namespace.projectId);\n    },\n    namespaceMapper(namespace) {\n      return {\n        ...namespace,\n        configMapId: this.getNamespaceConfigMapId(namespace),\n        label:       namespace?.project?.spec?.displayName,\n        value:       namespace?.id,\n      };\n    }\n  }\n};\n</script>\n\n<template>\n  <CruResource\n    v-if=\"!loading\"\n    :done-route=\"doneRoute\"\n    :resource=\"value\"\n    :mode=\"mode\"\n    :errors=\"errors\"\n    :apply-hooks=\"applyHooks\"\n    @finish=\"save\"\n  >\n    <div class=\"row\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.metadata.namespace\"\n          :label=\"t('namespace.project.label')\"\n          :options=\"namespaces\"\n          required\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.metadata.description\"\n          :label=\"t('nameNsDescription.description.label')\"\n        />\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col span-12\">\n        <Tabbed\n          v-if=\"!!currentNamespace && selectedNamespaceQuestions\"\n          ref=\"tabs\"\n          :side-tabs=\"true\"\n        >\n          <Questions\n            v-model=\"value.spec.values\"\n            tabbed=\"multiple\"\n            :target-namespace=\"value.metadata.namespace\"\n            :source=\"selectedNamespaceQuestions\"\n          />\n        </Tabbed>\n      </div>\n    </div>\n  </CruResource>\n  <Loading v-else />\n</template>\n\n<style lang=\"scss\" scoped>\n.row {\n  margin-bottom: 20px;\n}\n</style>\n"]}]}