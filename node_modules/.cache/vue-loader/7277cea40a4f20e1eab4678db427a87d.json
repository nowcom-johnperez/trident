{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster/DrainOptions.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster/DrainOptions.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBSYWRpb0dyb3VwIGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vUmFkaW8vUmFkaW9Hcm91cC52dWUnOwppbXBvcnQgQ2hlY2tib3ggZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9DaGVja2JveC9DaGVja2JveC52dWUnOwppbXBvcnQgVW5pdElucHV0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vVW5pdElucHV0LnZ1ZSc7CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKCmNvbnN0IERFRkFVTFRTID0gewogIGRlbGV0ZUVtcHR5RGlyRGF0YTogICAgICAgICAgICAgIHRydWUsIC8vIFNob3c7IEtpbGwgcG9kcyB1c2luZyBlbXB0eURpciB2b2x1bWVzIGFuZCBsb3NlIHRoZSBkYXRhCiAgZGlzYWJsZUV2aWN0aW9uOiAgICAgICAgICAgICAgICAgZmFsc2UsIC8vIEhpZGU7IGZhbHNlID0gZXZpY3QgcG9kcywgdHJ1ZSA9IGRlbGV0ZSBwb2RzCiAgZW5hYmxlZDogICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UsIC8vIFNob3c7IHRydWUgPSBOb2RlcyBtdXN0IGJlIGRyYWluZWQgYmVmb3JlIHVwZ3JhZGU7IGZhbHNlID0gWU9MTwogIGZvcmNlOiAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBTaG93OyB0cnVlID0gRGVsZXRlIHN0YW5kYWxvbmUgcG9kcywgZmFsc2UgPSBmYWlsIGlmIHRoZXJlIGFyZSBhbnkKICBncmFjZVBlcmlvZDogICAgICAgICAgICAgICAgICAgICAtMSwgLy8gU2hvdzsgUG9kIHNodXQgZG93biB0aW1lLCBuZWdhdGl2ZSB2YWx1ZSB1c2VzIHBvZCBkZWZhdWx0CiAgaWdub3JlRGFlbW9uU2V0czogICAgICAgICAgICAgICAgdHJ1ZSwgLy8gSGlkZTsgdHJ1ZSA9IHdvcmssIGZhbHNlID0gbmV2ZXIgd29yayBiZWNhdXNlIHRoZXJlJ3MgYWx3YXlzIGRhZW1vblNldHMKICBza2lwV2FpdEZvckRlbGV0ZVRpbWVvdXRTZWNvbmRzOiAwLCAvLyBIaWRlOyBJZiB0aGUgcG9kIGRlbGV0aW9uIHRpbWUgaXMgb2xkZXIgdGhhbiB0aGlzID4gMCwgZG9uJ3Qgd2FpdCwgZm9yIHNvbWUgcmVhc29uCiAgdGltZW91dDogICAgICAgICAgICAgICAgICAgICAgICAgMTIwLCAvLyBTaG93OyBHaXZlIHVwIGFmdGVyIHRoaXMgbWFueSBzZWNvbmRzCn07CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgUmFkaW9Hcm91cCwgQ2hlY2tib3gsIFVuaXRJbnB1dAogIH0sCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4ge30sCiAgICB9LAoKICAgIG1vZGU6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IG91dCA9IHt9OwoKICAgIGZvciAoIGNvbnN0IGsgaW4gREVGQVVMVFMgKSB7CiAgICAgIGlmICggdHlwZW9mIHRoaXMudmFsdWVba10gPT09ICd1bmRlZmluZWQnICkgewogICAgICAgIG91dFtrXSA9IERFRkFVTFRTW2tdOwogICAgICB9IGVsc2UgewogICAgICAgIG91dFtrXSA9IHRoaXMudmFsdWVba107CiAgICAgIH0KICAgIH0KCiAgICBvdXQuY3VzdG9tR3JhY2VQZXJpb2QgPSBvdXQuZ3JhY2VQZXJpb2QgPj0gMDsKICAgIG91dC5jdXN0b21UaW1lb3V0ID0gb3V0LnRpbWVvdXQgPj0gMDsKCiAgICByZXR1cm4gb3V0OwogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnVwZGF0ZSgpOwogIH0sCgogIGNvbXB1dGVkOiB7IC4uLm1hcEdldHRlcnMoeyB0OiAnaTE4bi90JyB9KSB9LAoKICBtZXRob2RzOiB7CiAgICB1cGRhdGUoKSB7CiAgICAgIGNvbnN0IG91dCA9IHt9OwoKICAgICAgZm9yICggY29uc3QgayBpbiBERUZBVUxUUyApIHsKICAgICAgICBvdXRba10gPSB0aGlzW2tdOwogICAgICB9CgogICAgICBpZiAoICF0aGlzLmN1c3RvbUdyYWNlUGVyaW9kICkgewogICAgICAgIG91dC5ncmFjZVBlcmlvZCA9IC0xOwogICAgICB9CgogICAgICBpZiAoICF0aGlzLmN1c3RvbVRpbWVvdXQgKSB7CiAgICAgICAgb3V0LnRpbWVvdXQgPSAwOwogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIG91dCk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["DrainOptions.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"DrainOptions.vue","sourceRoot":"node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster","sourcesContent":["<script>\nimport RadioGroup from '@components/Form/Radio/RadioGroup.vue';\nimport Checkbox from '@components/Form/Checkbox/Checkbox.vue';\nimport UnitInput from '@shell/components/form/UnitInput.vue';\nimport { mapGetters } from 'vuex';\n\nconst DEFAULTS = {\n  deleteEmptyDirData:              true, // Show; Kill pods using emptyDir volumes and lose the data\n  disableEviction:                 false, // Hide; false = evict pods, true = delete pods\n  enabled:                         false, // Show; true = Nodes must be drained before upgrade; false = YOLO\n  force:                           false, // Show; true = Delete standalone pods, false = fail if there are any\n  gracePeriod:                     -1, // Show; Pod shut down time, negative value uses pod default\n  ignoreDaemonSets:                true, // Hide; true = work, false = never work because there's always daemonSets\n  skipWaitForDeleteTimeoutSeconds: 0, // Hide; If the pod deletion time is older than this > 0, don't wait, for some reason\n  timeout:                         120, // Show; Give up after this many seconds\n};\n\nexport default {\n  components: {\n    RadioGroup, Checkbox, UnitInput\n  },\n  props: {\n    value: {\n      type:    Object,\n      default: () => {},\n    },\n\n    mode: {\n      type:     String,\n      required: true,\n    }\n  },\n\n  data() {\n    const out = {};\n\n    for ( const k in DEFAULTS ) {\n      if ( typeof this.value[k] === 'undefined' ) {\n        out[k] = DEFAULTS[k];\n      } else {\n        out[k] = this.value[k];\n      }\n    }\n\n    out.customGracePeriod = out.gracePeriod >= 0;\n    out.customTimeout = out.timeout >= 0;\n\n    return out;\n  },\n\n  created() {\n    this.update();\n  },\n\n  computed: { ...mapGetters({ t: 'i18n/t' }) },\n\n  methods: {\n    update() {\n      const out = {};\n\n      for ( const k in DEFAULTS ) {\n        out[k] = this[k];\n      }\n\n      if ( !this.customGracePeriod ) {\n        out.gracePeriod = -1;\n      }\n\n      if ( !this.customTimeout ) {\n        out.timeout = 0;\n      }\n\n      this.$emit('input', out);\n    },\n  },\n};\n</script>\n\n<template>\n  <div>\n    <RadioGroup\n      v-model=\"enabled\"\n      name=\"enabled\"\n      :options=\"[false, true]\"\n      :label=\"t('cluster.rke2.drain.label')\"\n      :labels=\"[t('generic.no'), t('generic.yes')]\"\n      :tooltip=\"t('cluster.rke2.drain.toolTip')\"\n      :mode=\"mode\"\n      @input=\"update\"\n    />\n\n    <template v-if=\"enabled\">\n      <div class=\"mt-20\">\n        <Checkbox\n          v-model=\"deleteEmptyDirData\"\n          label-key=\"cluster.rke2.drain.deleteEmptyDir.label\"\n          tooltip-key=\"cluster.rke2.drain.deleteEmptyDir.tooltip\"\n          @input=\"update\"\n        />\n      </div>\n      <div>\n        <Checkbox\n          v-model=\"force\"\n          label=\"Delete standalone pods\"\n          label-key=\"cluster.rke2.drain.force.label\"\n          tooltip=\"Delete standalone pods which are not managed by a Workload controller (Deployment, Job, etc).  Draining will fail if this is not set and there are standalone pods.\"\n          tooltop-key=\"cluster.rke2.drain.force.tooltip\"\n          @input=\"update\"\n        />\n      </div>\n      <div>\n        <Checkbox\n          v-model=\"customGracePeriod\"\n          label-key=\"cluster.rke2.drain.gracePeriod.checkboxLabel\"\n          @input=\"update\"\n        />\n        <UnitInput\n          v-if=\"customGracePeriod\"\n          v-model=\"gracePeriod\"\n          label-key=\"cluster.rke2.drain.gracePeriod.inputLabel\"\n          :suffix=\"t('suffix.seconds', {count: timeout})\"\n          class=\"mb-10\"\n          @input=\"update\"\n        />\n      </div>\n      <div>\n        <Checkbox\n          v-model=\"customTimeout\"\n          label-key=\"cluster.rke2.drain.timeout.checkboxLabel\"\n          @input=\"update\"\n        />\n        <UnitInput\n          v-if=\"customTimeout\"\n          v-model=\"timeout\"\n          label-key=\"cluster.rke2.drain.timeout.inputLabel\"\n          :suffix=\"t('suffix.seconds', {count: timeout})\"\n          class=\"drain-timeout\"\n          @input=\"update\"\n        />\n      </div>\n    </template>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  $drain-timeout-index: 18px;\n\n  .drain-timeout {\n    margin-top: 5px;\n    margin-left: $drain-timeout-index;\n    width: calc(100% - $drain-timeout-index);\n  }\n</style>\n"]}]}