{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/rancher-backup/S3.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/rancher-backup/S3.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IHsgQ2hlY2tib3ggfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0NoZWNrYm94JzsKaW1wb3J0IEZpbGVTZWxlY3RvciBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0ZpbGVTZWxlY3Rvcic7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBMYWJlbGVkSW5wdXQsCiAgICBDaGVja2JveCwKICAgIEZpbGVTZWxlY3RvciwKICAgIExhYmVsZWRTZWxlY3QsCiAgfSwKCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSwKICAgIG1vZGU6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAnY3JlYXRlJwogICAgfSwKCiAgICBzZWNyZXRzOiB7CiAgICAgIHR5cGU6ICAgIEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiBbXQogICAgfQogIH0sCgogIG1vdW50ZWQoKSB7CiAgICB0aGlzLiRlbWl0KCd2YWxpZCcsIHRoaXMudmFsaWQpOwogIH0sCgogIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLiRlbWl0KCd2YWxpZCcsIHRydWUpOwogIH0sCgogIHdhdGNoOiB7CiAgICB2YWxpZCgpIHsKICAgICAgdGhpcy4kZW1pdCgndmFsaWQnLCB0aGlzLnZhbGlkKTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBjcmVkZW50aWFsU2VjcmV0OiB7CiAgICAgIGdldCgpIHsKICAgICAgICBjb25zdCB7IGNyZWRlbnRpYWxTZWNyZXROYW1lLCBjcmVkZW50aWFsU2VjcmV0TmFtZXNwYWNlIH0gPSB0aGlzLnZhbHVlOwoKICAgICAgICByZXR1cm4geyBtZXRhZGF0YTogeyBuYW1lOiBjcmVkZW50aWFsU2VjcmV0TmFtZSwgbmFtZXNwYWNlOiBjcmVkZW50aWFsU2VjcmV0TmFtZXNwYWNlIH0gfTsKICAgICAgfSwKCiAgICAgIHNldChuZXUpIHsKICAgICAgICBjb25zdCB7IG5hbWUsIG5hbWVzcGFjZSB9ID0gbmV1Lm1ldGFkYXRhOwoKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZSwgJ2NyZWRlbnRpYWxTZWNyZXROYW1lJywgbmFtZSk7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUsICdjcmVkZW50aWFsU2VjcmV0TmFtZXNwYWNlJywgbmFtZXNwYWNlKTsKICAgICAgfQogICAgfSwKICAgIHZhbGlkKCkgewogICAgICByZXR1cm4gISF0aGlzLnZhbHVlLmVuZHBvaW50ICYmICEhdGhpcy52YWx1ZS5idWNrZXROYW1lOwogICAgfSwKICAgIC4uLm1hcEdldHRlcnMoeyB0OiAnaTE4bi90JyB9KQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHNldENBKGNhKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgZW5jb2RlZCA9IGJ0b2EoY2EpOwoKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZSwgJ2VuZHBvaW50Q0EnLCBlbmNvZGVkKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICAgICAgY29uc29sZS53YXJuKGUpOwogICAgICB9CiAgICB9CiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIGNvbnN0IHsgY3JlZGVudGlhbFNlY3JldE5hbWUsIGNyZWRlbnRpYWxTZWNyZXROYW1lc3BhY2UgfSA9IHRoaXMudmFsdWU7CgogICAgaWYgKGNyZWRlbnRpYWxTZWNyZXROYW1lICYmICFjcmVkZW50aWFsU2VjcmV0TmFtZXNwYWNlKSB7CiAgICAgIHRoaXMudmFsdWUuY3JlZGVudGlhbFNlY3JldE5hbWUgPSAnJzsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["S3.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"S3.vue","sourceRoot":"node_modules/@rancher/shell/chart/rancher-backup","sourcesContent":["<script>\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { mapGetters } from 'vuex';\n\nexport default {\n  components: {\n    LabeledInput,\n    Checkbox,\n    FileSelector,\n    LabeledSelect,\n  },\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    mode: {\n      type:    String,\n      default: 'create'\n    },\n\n    secrets: {\n      type:    Array,\n      default: () => []\n    }\n  },\n\n  mounted() {\n    this.$emit('valid', this.valid);\n  },\n\n  beforeDestroy() {\n    this.$emit('valid', true);\n  },\n\n  watch: {\n    valid() {\n      this.$emit('valid', this.valid);\n    }\n  },\n  computed: {\n    credentialSecret: {\n      get() {\n        const { credentialSecretName, credentialSecretNamespace } = this.value;\n\n        return { metadata: { name: credentialSecretName, namespace: credentialSecretNamespace } };\n      },\n\n      set(neu) {\n        const { name, namespace } = neu.metadata;\n\n        this.$set(this.value, 'credentialSecretName', name);\n        this.$set(this.value, 'credentialSecretNamespace', namespace);\n      }\n    },\n    valid() {\n      return !!this.value.endpoint && !!this.value.bucketName;\n    },\n    ...mapGetters({ t: 'i18n/t' })\n  },\n\n  methods: {\n    setCA(ca) {\n      try {\n        const encoded = btoa(ca);\n\n        this.$set(this.value, 'endpointCA', encoded);\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.warn(e);\n      }\n    }\n  },\n\n  created() {\n    const { credentialSecretName, credentialSecretNamespace } = this.value;\n\n    if (credentialSecretName && !credentialSecretNamespace) {\n      this.value.credentialSecretName = '';\n    }\n  },\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row mb-10\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"credentialSecret\"\n          :get-option-label=\"opt=>opt.metadata.name || ''\"\n          option-key=\"id\"\n          :mode=\"mode\"\n          :options=\"secrets\"\n          :label=\"t('backupRestoreOperator.s3.credentialSecretName')\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.bucketName\"\n          data-testid=\"S3-bucketName\"\n          :mode=\"mode\"\n          :label=\"t('backupRestoreOperator.s3.bucketName')\"\n          required\n        />\n      </div>\n    </div>\n    <div class=\"row mb-10\">\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.region\"\n          :mode=\"mode\"\n          :label=\"t('backupRestoreOperator.s3.region')\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.folder\"\n          :mode=\"mode\"\n          :label=\"t('backupRestoreOperator.s3.folder')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mb-10\">\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.endpoint\"\n          :mode=\"mode\"\n          :label=\"t('backupRestoreOperator.s3.endpoint')\"\n          data-testid=\"S3-endpoint\"\n          required\n        />\n        <Checkbox\n          v-model=\"value.insecureTLSSkipVerify\"\n          class=\"mt-10\"\n          :mode=\"mode\"\n          :label=\"t('backupRestoreOperator.s3.insecureTLSSkipVerify')\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"value.endpointCA\"\n          :mode=\"mode\"\n          type=\"multiline\"\n          :label=\"t('backupRestoreOperator.s3.endpointCA.label')\"\n        />\n        <div class=\"ca-controls\">\n          <FileSelector\n            v-if=\"mode!=='view'\"\n            class=\"btn btn-sm role-primary mt-5\"\n            :mode=\"mode\"\n            :label=\"t('generic.readFromFile')\"\n            @selected=\"e=> setCA(e)\"\n          />\n          <div class=\"ca-tooltip\">\n            <i\n              v-clean-tooltip=\"t('backupRestoreOperator.s3.endpointCA.prompt')\"\n              class=\"icon icon-info\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n  .ca-controls {\n    display: flex;\n\n    .ca-tooltip {\n      flex: 1;\n      margin-top: 4px;\n      text-align: right;\n\n      > i {\n        font-size: 16px;\n      };\n    }\n  }\n</style>\n"]}]}