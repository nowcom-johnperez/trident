{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/PromptRemove.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/PromptRemove.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFN0YXRlLCBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IGdldCwgaXNFbXB0eSB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgeyBlc2NhcGVIdG1sLCByZXNvdXJjZU5hbWVzIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IENhcmQgfSBmcm9tICdAY29tcG9uZW50cy9DYXJkJzsKaW1wb3J0IHsgQ2hlY2tib3ggfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0NoZWNrYm94JzsKaW1wb3J0IHsgYWx0ZXJuYXRlTGFiZWwgfSBmcm9tICdAc2hlbGwvdXRpbHMvcGxhdGZvcm0nOwppbXBvcnQgeyB1bmlxIH0gZnJvbSAnQHNoZWxsL3V0aWxzL2FycmF5JzsKaW1wb3J0IEFzeW5jQnV0dG9uIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0FzeW5jQnV0dG9uJzsKaW1wb3J0IHsgQ0FUQUxPRyBhcyBDQVRBTE9HX0FOTk9UQVRJT05TIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBDQVRBTE9HIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUHJvbXB0UmVtb3ZlJywKCiAgY29tcG9uZW50czogewogICAgQ2FyZCwgQ2hlY2tib3gsIEFzeW5jQnV0dG9uLCBMYWJlbGVkSW5wdXQKICB9LAogIHByb3BzOiB7CiAgICAvKioKICAgICAqIEluaGVyaXRlZCBnbG9iYWwgaWRlbnRpZmllciBwcmVmaXggZm9yIHRlc3RzCiAgICAgKiBEZWZpbmUgYSB0ZXJtIGJhc2VkIG9uIHRoZSBwYXJlbnQgY29tcG9uZW50IHRvIGF2b2lkIGNvbmZsaWN0cyBvbiBtdWx0aXBsZSBjb21wb25lbnRzCiAgICAgKi8KICAgIGNvbXBvbmVudFRlc3RpZDogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdwcm9tcHQtcmVtb3ZlJwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIGNvbnN0IHsgcmVzb3VyY2UgfSA9IHRoaXMuJHJvdXRlLnBhcmFtczsKCiAgICByZXR1cm4gewogICAgICBoYXNDdXN0b21SZW1vdmU6ICAgICBmYWxzZSwKICAgICAgcmFuZG9tUG9zaXRpb246ICAgICAgTWF0aC5yYW5kb20oKSwKICAgICAgY29uZmlybU5hbWU6ICAgICAgICAgJycsCiAgICAgIGVycm9yOiAgICAgICAgICAgICAgICcnLAogICAgICB3YXJuaW5nOiAgICAgICAgICAgICAnJywKICAgICAgcHJldmVudERlbGV0ZTogICAgICAgZmFsc2UsCiAgICAgIHJlbW92ZUNvbXBvbmVudDogICAgIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2ltcG9ydEN1c3RvbVByb21wdFJlbW92ZSddKHJlc291cmNlKSwKICAgICAgY2hhcnRzVG9SZW1vdmVJc0FwcDogZmFsc2UsCiAgICAgIGNoYXJ0c0RlbGV0ZUNyZDogICAgIGZhbHNlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIG5hbWVzKCkgewogICAgICByZXR1cm4gdGhpcy50b1JlbW92ZS5tYXAoKG9iaikgPT4gb2JqLm5hbWVEaXNwbGF5KS5zbGljZSgwLCA1KTsKICAgIH0sCgogICAgbmFtZVRvTWF0Y2hQb3NpdGlvbigpIHsKICAgICAgY29uc3QgdmlzaWJsZU5hbWVzID0gTWF0aC5taW4oNSwgdGhpcy5uYW1lcy5sZW5ndGgpOwogICAgICBjb25zdCByYW5kb21OYW1lUG9zID0gTWF0aC5mbG9vcih0aGlzLnJhbmRvbVBvc2l0aW9uICogdmlzaWJsZU5hbWVzKTsKCiAgICAgIHJldHVybiByYW5kb21OYW1lUG9zOwogICAgfSwKCiAgICBuYW1lVG9NYXRjaCgpIHsKICAgICAgcmV0dXJuIHRoaXMubmFtZXNbdGhpcy5uYW1lVG9NYXRjaFBvc2l0aW9uXTsKICAgIH0sCgogICAgdHlwZSgpIHsKICAgICAgY29uc3QgdHlwZXMgPSBuZXcgU2V0KHRoaXMudG9SZW1vdmUucmVkdWNlKChhcnJheSwgZWFjaCkgPT4gewogICAgICAgIGFycmF5LnB1c2goZWFjaC50eXBlKTsKCiAgICAgICAgcmV0dXJuIGFycmF5OwogICAgICB9LCBbXSkpOwoKICAgICAgaWYgKHR5cGVzLnNpemUgPiAxKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudCgnZ2VuZXJpYy5yZXNvdXJjZScsIHsgY291bnQ6IHRoaXMudG9SZW1vdmUubGVuZ3RoIH0pOwogICAgICB9CgogICAgICBjb25zdCBzY2hlbWEgPSB0aGlzLnRvUmVtb3ZlWzBdPy5zY2hlbWE7CgogICAgICBpZiAoICFzY2hlbWEgKSB7CiAgICAgICAgcmV0dXJuIGByZXNvdXJjZSR7IHRoaXMudG9SZW1vdmUubGVuZ3RoID09PSAxID8gJycgOiAncycgfWA7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9sYWJlbEZvciddKHNjaGVtYSwgdGhpcy50b1JlbW92ZS5sZW5ndGgpOwogICAgfSwKCiAgICBzZWxmTGlua3MoKSB7CiAgICAgIHJldHVybiB0aGlzLnRvUmVtb3ZlLm1hcCgocmVzb3VyY2UpID0+IHsKICAgICAgICByZXR1cm4gZ2V0KHJlc291cmNlLCAnbGlua3Muc2VsZicpOwogICAgICB9KTsKICAgIH0sCgogICAgbmVlZHNDb25maXJtKCkgewogICAgICBjb25zdCBmaXJzdCA9IHRoaXMudG9SZW1vdmVbMF07CgogICAgICByZXR1cm4gZmlyc3Q/LmNvbmZpcm1SZW1vdmU7CiAgICB9LAoKICAgIHBsdXNNb3JlKCkgewogICAgICBjb25zdCByZW1haW5pbmcgPSB0aGlzLnRvUmVtb3ZlLmxlbmd0aCAtIHRoaXMubmFtZXMubGVuZ3RoOwoKICAgICAgcmV0dXJuIHRoaXMudCgncHJvbXB0UmVtb3ZlLmFuZE90aGVycycsIHsgY291bnQ6IHJlbWFpbmluZyB9KTsKICAgIH0sCgogICAgLy8gaWYgdGhlIGN1cnJlbnQgcm91dGUgZW5kcyB3aXRoIHRoZSBJRCBvZiB0aGUgcmVzb3VyY2UgYmVpbmcgZGVsZXRlZCwgd2hhdGV2ZXIgcGFnZSB0aGlzIGlzIHdvbnQgYmUgdmFsaWQgYWZ0ZXIgc3VjY2Vzc2Z1bCBkZWxldGlvbjogbmF2aWdhdGUgYXdheQogICAgZG9uZUxvY2F0aW9uKCkgewogICAgICAvLyBpZiBkZWxldGluZyBtb3JlIHRoYW4gb25lIHJlc291cmNlLCB0aGlzIGlzIGhhcHBlbmluZyBpbiBsaXN0IHZpZXcgYW5kIHNob3VsZG4ndCByZWRpcmVjdCBhbnl3aGVyZQogICAgICBpZiAodGhpcy50b1JlbW92ZS5sZW5ndGggPiAxKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnRvUmVtb3ZlWzBdLmRvbmVMb2NhdGlvblJlbW92ZSkgewogICAgICAgIHJldHVybiB0aGlzLnRvUmVtb3ZlWzBdLmRvbmVMb2NhdGlvblJlbW92ZTsKICAgICAgfQoKICAgICAgY29uc3QgY3VycmVudFJvdXRlID0gdGhpcy50b1JlbW92ZVswXS5jdXJyZW50Um91dGUoKTsKICAgICAgY29uc3Qgb3V0ID0ge307CiAgICAgIGNvbnN0IHBhcmFtcyA9IHsgLi4uY3VycmVudFJvdXRlLnBhcmFtcyB9OwoKICAgICAgaWYgKHBhcmFtcy5pZCAmJiAocGFyYW1zLmlkID09PSB0aGlzLnRvUmVtb3ZlWzBdPy5tZXRhZGF0YT8ubmFtZSB8fCBwYXJhbXMuaWQgPT09IHRoaXMudG9SZW1vdmVbMF0uaWQpKSB7CiAgICAgICAgbGV0IHsgbmFtZSA9ICcnIH0gPSBjdXJyZW50Um91dGU7CgogICAgICAgIGNvbnN0IGlkSW5kZXggPSBuYW1lLmluZGV4T2YoJy1pZCcpOwoKICAgICAgICBpZiAoaWRJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIG5hbWUgPSBuYW1lLnNsaWNlKDAsIGlkSW5kZXgpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHBhcmFtcy5uYW1lc3BhY2UpIHsKICAgICAgICAgIGNvbnN0IG5hbWVzcGFjZUluZGV4ID0gbmFtZS5pbmRleE9mKCctbmFtZXNwYWNlJyk7CgogICAgICAgICAgaWYgKG5hbWVzcGFjZUluZGV4ICE9PSAtMSkgewogICAgICAgICAgICBuYW1lID0gbmFtZS5zbGljZSgwLCBuYW1lc3BhY2VJbmRleCk7CiAgICAgICAgICB9CiAgICAgICAgICBkZWxldGUgcGFyYW1zLm5hbWVzcGFjZTsKICAgICAgICB9CiAgICAgICAgZGVsZXRlIHBhcmFtcy5pZDsKCiAgICAgICAgb3V0LnBhcmFtcyA9IHBhcmFtczsKICAgICAgICBvdXQubmFtZSA9IG5hbWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXQ7CiAgICB9LAoKICAgIGN1cnJlbnRSb3V0ZXIoKSB7CiAgICAgIC8vIC4uLmRvbid0IG5lZWQgYSByb3V0ZXIgaWYgdGhlcmUncyBubyByb3V0ZSB0byBnbyB0bwogICAgICBpZiAoIXRoaXMuZG9uZUxvY2F0aW9uKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMudG9SZW1vdmVbMF0uY3VycmVudFJvdXRlcigpOwogICAgICB9CiAgICB9LAoKICAgIHByb3RpcCgpIHsKICAgICAgcmV0dXJuIHRoaXMudCgncHJvbXB0UmVtb3ZlLnByb3RpcCcsIHsgYWx0ZXJuYXRlTGFiZWwgfSk7CiAgICB9LAoKICAgIGRlbGV0ZURpc2FibGVkKCkgewogICAgICBjb25zdCBjb25maXJtRmFpbGVkID0gdGhpcy5uZWVkc0NvbmZpcm0gJiYgdGhpcy5jb25maXJtTmFtZSAhPT0gdGhpcy5uYW1lVG9NYXRjaDsKCiAgICAgIHJldHVybiB0aGlzLnByZXZlbnREZWxldGUgfHwgY29uZmlybUZhaWxlZDsKICAgIH0sCgogICAgLi4ubWFwU3RhdGUoJ2FjdGlvbi1tZW51JywgWydzaG93UHJvbXB0UmVtb3ZlJywgJ3RvUmVtb3ZlJ10pLAogICAgLi4ubWFwR2V0dGVycyh7IHQ6ICdpMThuL3QnIH0pLAogIH0sCgogIHdhdGNoOiB7CiAgICBzaG93UHJvbXB0UmVtb3ZlKHNob3cpIHsKICAgICAgaWYgKHNob3cpIHsKICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMudG9SZW1vdmVbMF07CgogICAgICAgIGlmICh0aGlzLmN1cnJlbnRSb3V0ZXI/LmN1cnJlbnRSb3V0ZT8ubmFtZSA9PT0gJ2MtY2x1c3Rlci1leHBsb3Jlci10b29scycgJiYKICAgICAgICAgICAgc2VsZWN0ZWQudHlwZSA9PT0gQ0FUQUxPRy5BUFAgJiYKICAgICAgICAgICAgc2VsZWN0ZWQuc3BlYz8uY2hhcnQ/Lm1ldGFkYXRhPy5hbm5vdGF0aW9uc1tDQVRBTE9HX0FOTk9UQVRJT05TLkFVVE9fSU5TVEFMTF0pIHsKICAgICAgICAgIHRoaXMuY2hhcnRzVG9SZW1vdmVJc0FwcCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRtb2RhbC5zaG93KCdwcm9tcHRSZW1vdmUnKTsKCiAgICAgICAgbGV0IHsgcmVzb3VyY2UgfSA9IHRoaXMuJHJvdXRlLnBhcmFtczsKCiAgICAgICAgaWYgKHRoaXMudG9SZW1vdmUubGVuZ3RoID4gMCkgewogICAgICAgICAgcmVzb3VyY2UgPSBzZWxlY3RlZC50eXBlOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5oYXNDdXN0b21SZW1vdmUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9oYXNDdXN0b21Qcm9tcHRSZW1vdmUnXShyZXNvdXJjZSk7CgogICAgICAgIHRoaXMucmVtb3ZlQ29tcG9uZW50ID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1sndHlwZS1tYXAvaW1wb3J0Q3VzdG9tUHJvbXB0UmVtb3ZlJ10ocmVzb3VyY2UpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1vZGFsLmhpZGUoJ3Byb21wdFJlbW92ZScpOwogICAgICB9CiAgICB9LAoKICAgIC8vIGNoZWNrIGZvciBhbnkgcmVzb3VyY2VzIHdpdGggYSBkZWxldGlvbiBwcmV2ZW50aW9uIG1lc3NhZ2UsCiAgICAvLyBpZiBub25lIGZvdW5kIChkZWxldGUgaXMgYWxsb3dlZCksIHRoZW4gY2hlY2sgZm9yIGFueSByZXNvdXJjZXMgd2l0aCBhIHdhcm5pbmcgbWVzc2FnZQogICAgdG9SZW1vdmUobmV1KSB7CiAgICAgIGxldCBtZXNzYWdlOwogICAgICBjb25zdCBwcmV2ZW50RGVsZXRpb25NZXNzYWdlcyA9IG5ldS5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0ucHJldmVudERlbGV0aW9uTWVzc2FnZSk7CgogICAgICB0aGlzLnByZXZlbnREZWxldGUgPSBmYWxzZTsKCiAgICAgIGlmICghIXByZXZlbnREZWxldGlvbk1lc3NhZ2VzLmxlbmd0aCkgewogICAgICAgIHRoaXMucHJldmVudERlbGV0ZSA9IHRydWU7CiAgICAgICAgbWVzc2FnZSA9IHByZXZlbnREZWxldGlvbk1lc3NhZ2VzWzBdLnByZXZlbnREZWxldGlvbk1lc3NhZ2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3Qgd2FybkRlbGV0aW9uTWVzc2FnZXMgPSBuZXUuZmlsdGVyKChpdGVtKSA9PiBpdGVtLndhcm5EZWxldGlvbk1lc3NhZ2UpOwoKICAgICAgICBpZiAoISF3YXJuRGVsZXRpb25NZXNzYWdlcy5sZW5ndGgpIHsKICAgICAgICAgIG1lc3NhZ2UgPSB3YXJuRGVsZXRpb25NZXNzYWdlc1swXS53YXJuRGVsZXRpb25NZXNzYWdlOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgPT09ICdmdW5jdGlvbicgKSB7CiAgICAgICAgdGhpcy53YXJuaW5nID0gbWVzc2FnZSh0aGlzLnRvUmVtb3ZlKTsKICAgICAgfSBlbHNlIGlmICghIW1lc3NhZ2UpIHsKICAgICAgICB0aGlzLndhcm5pbmcgPSBtZXNzYWdlOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMud2FybmluZyA9ICcnOwogICAgICB9CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgcmVzb3VyY2VOYW1lcywKICAgIGVzY2FwZUh0bWwsCiAgICBjbG9zZSgpIHsKICAgICAgdGhpcy5jb25maXJtTmFtZSA9ICcnOwogICAgICB0aGlzLmVycm9yID0gJyc7CiAgICAgIHRoaXMuY2hhcnRzRGVsZXRlQ3JkID0gZmFsc2U7CiAgICAgIHRoaXMuY2hhcnRzVG9SZW1vdmVJc0FwcCA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2FjdGlvbi1tZW51L3RvZ2dsZVByb21wdFJlbW92ZScpOwogICAgfSwKCiAgICBhc3luYyByZW1vdmUoYnRuQ0IpIHsKICAgICAgaWYgKHRoaXMuZG9uZUxvY2F0aW9uKSB7CiAgICAgICAgLy8gZG9uZUxvY2F0aW9uIHdpbGwgcmVjb21wdXRlIHRvIHVuZGVmaW5lZCB3aGVuIGRlbGV0ZSByZXF1ZXN0IGNvbXBsZXRlcwogICAgICAgIHRoaXMuY2FjaGVkRG9uZUxvY2F0aW9uID0geyAuLi50aGlzLmRvbmVMb2NhdGlvbiB9OwogICAgICB9CgogICAgICBpZiAodGhpcy5oYXNDdXN0b21SZW1vdmUgJiYgdGhpcy4kcmVmcz8uY3VzdG9tUHJvbXB0Py5yZW1vdmUpIHsKICAgICAgICBsZXQgaGFuZGxlZCA9IHRoaXMuJHJlZnMuY3VzdG9tUHJvbXB0LnJlbW92ZShidG5DQik7CgogICAgICAgIC8vIElmIHRoZSByZXNwb25zZSBpcyBhIHByb21pc2UsIHRoZW4gd2FpdCBmb3IgdGhlIHByb21pc2UKICAgICAgICBpZiAoaGFuZGxlZCAmJiBoYW5kbGVkLnRoZW4pIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGhhbmRsZWQgPSBhd2FpdCBoYW5kbGVkOwogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIHRoaXMuZXJyb3IgPSBlcnI7CiAgICAgICAgICAgIGJ0bkNCKGZhbHNlKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIElmIHRoZSByZW1vdmUgZnVuY3Rpb24gZm9yIHRoZSBjdXN0b20gZGlhbG9nIGhhbmRsZWQgdGhlIHJlcXVlc3QsIGl0IGNhbiByZXR1cm4gdHJ1ZSBvciBub3QgcmV0dXJuIGFueXRoaW5nCiAgICAgICAgLy8gaWYgaXQgcmV0dXJuZWQgZmFsc2UsIHRoZW4gaXQgd2FudHMgdXMgdG8gY29udGludWUgd2l0aCB0aGUgZGVsZXRpb24gbG9naWMgYmVsb3cgLSB0aGlzIGlzIHVzZWZ1bAogICAgICAgIC8vIHdoZXJlIHRoZSBjdXN0b20gZGlhbG9nIG5lZWRzIHRvIGRlbGV0ZSBhZGRpdGlvbmFsIHJlc291cmNlcyAtIGl0IGhhbmRsZXMgdGhvc2UgYW5kIHJldHJ1cm5zIGZhbHNlIHRvIGdldCB1cwogICAgICAgIC8vIHRvIGRlbGV0ZSB0aGUgbWFpbiByZXNvdXJjZQogICAgICAgIGlmIChoYW5kbGVkID09PSB1bmRlZmluZWQgfHwgaGFuZGxlZCkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICBjb25zdCBzZXJpYWxSZW1vdmUgPSB0aGlzLnRvUmVtb3ZlLnNvbWUoKHJlc291cmNlKSA9PiByZXNvdXJjZS5yZW1vdmVTZXJpYWxseSk7CgogICAgICBpZiAoc2VyaWFsUmVtb3ZlKSB7CiAgICAgICAgdGhpcy5zZXJpYWxSZW1vdmUoYnRuQ0IpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucGFyYWxsZWxSZW1vdmUoYnRuQ0IpOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgc2VyaWFsUmVtb3ZlKGJ0bkNCKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3Qgc3Bvb2ZlZFR5cGVzID0gdGhpcy5nZXRTcG9vZmVkVHlwZXModGhpcy50b1JlbW92ZSk7CgogICAgICAgIGZvciAoY29uc3QgcmVzb3VyY2Ugb2YgdGhpcy50b1JlbW92ZSkgewogICAgICAgICAgYXdhaXQgcmVzb3VyY2UucmVtb3ZlKCk7CiAgICAgICAgfQoKICAgICAgICBhd2FpdCB0aGlzLnJlZnJlc2hTcG9vZmVkVHlwZXMoc3Bvb2ZlZFR5cGVzKTsKICAgICAgICB0aGlzLmRvbmUoKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5lcnJvciA9IGVyci5tZXNzYWdlIHx8IGVycjsKICAgICAgICBidG5DQihmYWxzZSk7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBwYXJhbGxlbFJlbW92ZShidG5DQikgewogICAgICB0cnkgewogICAgICAgIGlmICh0eXBlb2YgdGhpcy50b1JlbW92ZVswXS5idWxrUmVtb3ZlICE9PSAndW5kZWZpbmVkJykgewogICAgICAgICAgYXdhaXQgdGhpcy50b1JlbW92ZVswXS5idWxrUmVtb3ZlKHRoaXMudG9SZW1vdmUsIHt9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwodGhpcy50b1JlbW92ZS5tYXAoKHJlc291cmNlKSA9PiByZXNvdXJjZS5yZW1vdmUoKSkpOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3Bvb2ZlZFR5cGVzID0gdGhpcy5nZXRTcG9vZmVkVHlwZXModGhpcy50b1JlbW92ZSk7CgogICAgICAgIGF3YWl0IHRoaXMucmVmcmVzaFNwb29mZWRUeXBlcyhzcG9vZmVkVHlwZXMpOwoKICAgICAgICB0aGlzLmRvbmUoKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5lcnJvciA9IGVyci5tZXNzYWdlIHx8IGVycjsKICAgICAgICBidG5DQihmYWxzZSk7CiAgICAgIH0KICAgIH0sCiAgICBkb25lKCkgewogICAgICBpZiAoIHRoaXMuY2FjaGVkRG9uZUxvY2F0aW9uICYmICFpc0VtcHR5KHRoaXMuY2FjaGVkRG9uZUxvY2F0aW9uKSApIHsKICAgICAgICB0aGlzLmN1cnJlbnRSb3V0ZXIucHVzaCh0aGlzLmNhY2hlZERvbmVMb2NhdGlvbik7CiAgICAgIH0KICAgICAgdGhpcy5jbG9zZSgpOwogICAgfSwKICAgIGdldFNwb29mZWRUeXBlcyhyZXNvdXJjZXMpIHsKICAgICAgY29uc3QgdW5pcXVlUmVzb3VyY2VUeXBlcyA9IHVuaXEodGhpcy50b1JlbW92ZS5tYXAoKHJlc291cmNlKSA9PiByZXNvdXJjZS50eXBlKSk7CgogICAgICByZXR1cm4gdW5pcXVlUmVzb3VyY2VUeXBlcy5maWx0ZXIodGhpcy4kc3RvcmUuZ2V0dGVyc1sndHlwZS1tYXAvaXNTcG9vZmVkJ10pOwogICAgfSwKCiAgICAvLyBJZiBzcG9vZmVkIHdlIG5lZWQgdG8gcmVsb2FkIHRoZSB2YWx1ZXMgYXMgdGhlIHNlcnZlciBjYW4ndCBoYXZlIHdhdGNoZXJzIGZvciB0aGVtLgogICAgcmVmcmVzaFNwb29mZWRUeXBlcyh0eXBlcykgewogICAgICBjb25zdCBpblN0b3JlID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY3VycmVudFByb2R1Y3QnXS5pblN0b3JlOwogICAgICBjb25zdCBwcm9taXNlcyA9IHR5cGVzLm1hcCgodHlwZSkgPT4gdGhpcy4kc3RvcmUuZGlzcGF0Y2goYCR7IGluU3RvcmUgfS9maW5kQWxsYCwgeyB0eXBlLCBvcHQ6IHsgZm9yY2U6IHRydWUgfSB9LCB7IHJvb3Q6IHRydWUgfSkpOwoKICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTsKICAgIH0sCgogICAgYXN5bmMgY2hhcnRBZGRDcmRUb1JlbW92ZSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLnRvUmVtb3ZlWzBdLnJlbGF0ZWRSZXNvdXJjZXNUb1JlbW92ZSgpOwoKICAgICAgICBpZiAoIXRoaXMudG9SZW1vdmUuaW5jbHVkZXMocmVzKSkgewogICAgICAgICAgdGhpcy50b1JlbW92ZS5wdXNoKHJlcyk7CiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5jaGFydHNEZWxldGVDcmQpIHsKICAgICAgICAgIHRoaXMudG9SZW1vdmUucG9wKHJlcyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICB0aGlzLmVycm9yID0gZXJyOwogICAgICAgIHRoaXMuY2hhcnRzRGVsZXRlQ3JkID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["PromptRemove.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PromptRemove.vue","sourceRoot":"node_modules/@rancher/shell/components","sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { get, isEmpty } from '@shell/utils/object';\nimport { escapeHtml, resourceNames } from '@shell/utils/string';\nimport { Card } from '@components/Card';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport { alternateLabel } from '@shell/utils/platform';\nimport { uniq } from '@shell/utils/array';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { CATALOG } from '@shell/config/types';\nimport { LabeledInput } from '@components/Form/LabeledInput';\n\nexport default {\n  name: 'PromptRemove',\n\n  components: {\n    Card, Checkbox, AsyncButton, LabeledInput\n  },\n  props: {\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type:    String,\n      default: 'prompt-remove'\n    }\n  },\n  data() {\n    const { resource } = this.$route.params;\n\n    return {\n      hasCustomRemove:     false,\n      randomPosition:      Math.random(),\n      confirmName:         '',\n      error:               '',\n      warning:             '',\n      preventDelete:       false,\n      removeComponent:     this.$store.getters['type-map/importCustomPromptRemove'](resource),\n      chartsToRemoveIsApp: false,\n      chartsDeleteCrd:     false\n    };\n  },\n  computed: {\n    names() {\n      return this.toRemove.map((obj) => obj.nameDisplay).slice(0, 5);\n    },\n\n    nameToMatchPosition() {\n      const visibleNames = Math.min(5, this.names.length);\n      const randomNamePos = Math.floor(this.randomPosition * visibleNames);\n\n      return randomNamePos;\n    },\n\n    nameToMatch() {\n      return this.names[this.nameToMatchPosition];\n    },\n\n    type() {\n      const types = new Set(this.toRemove.reduce((array, each) => {\n        array.push(each.type);\n\n        return array;\n      }, []));\n\n      if (types.size > 1) {\n        return this.t('generic.resource', { count: this.toRemove.length });\n      }\n\n      const schema = this.toRemove[0]?.schema;\n\n      if ( !schema ) {\n        return `resource${ this.toRemove.length === 1 ? '' : 's' }`;\n      }\n\n      return this.$store.getters['type-map/labelFor'](schema, this.toRemove.length);\n    },\n\n    selfLinks() {\n      return this.toRemove.map((resource) => {\n        return get(resource, 'links.self');\n      });\n    },\n\n    needsConfirm() {\n      const first = this.toRemove[0];\n\n      return first?.confirmRemove;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n\n    // if the current route ends with the ID of the resource being deleted, whatever page this is wont be valid after successful deletion: navigate away\n    doneLocation() {\n      // if deleting more than one resource, this is happening in list view and shouldn't redirect anywhere\n      if (this.toRemove.length > 1) {\n        return null;\n      }\n\n      if (this.toRemove[0].doneLocationRemove) {\n        return this.toRemove[0].doneLocationRemove;\n      }\n\n      const currentRoute = this.toRemove[0].currentRoute();\n      const out = {};\n      const params = { ...currentRoute.params };\n\n      if (params.id && (params.id === this.toRemove[0]?.metadata?.name || params.id === this.toRemove[0].id)) {\n        let { name = '' } = currentRoute;\n\n        const idIndex = name.indexOf('-id');\n\n        if (idIndex !== -1) {\n          name = name.slice(0, idIndex);\n        }\n\n        if (params.namespace) {\n          const namespaceIndex = name.indexOf('-namespace');\n\n          if (namespaceIndex !== -1) {\n            name = name.slice(0, namespaceIndex);\n          }\n          delete params.namespace;\n        }\n        delete params.id;\n\n        out.params = params;\n        out.name = name;\n      }\n\n      return out;\n    },\n\n    currentRouter() {\n      // ...don't need a router if there's no route to go to\n      if (!this.doneLocation) {\n        return null;\n      } else {\n        return this.toRemove[0].currentRouter();\n      }\n    },\n\n    protip() {\n      return this.t('promptRemove.protip', { alternateLabel });\n    },\n\n    deleteDisabled() {\n      const confirmFailed = this.needsConfirm && this.confirmName !== this.nameToMatch;\n\n      return this.preventDelete || confirmFailed;\n    },\n\n    ...mapState('action-menu', ['showPromptRemove', 'toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n  },\n\n  watch: {\n    showPromptRemove(show) {\n      if (show) {\n        const selected = this.toRemove[0];\n\n        if (this.currentRouter?.currentRoute?.name === 'c-cluster-explorer-tools' &&\n            selected.type === CATALOG.APP &&\n            selected.spec?.chart?.metadata?.annotations[CATALOG_ANNOTATIONS.AUTO_INSTALL]) {\n          this.chartsToRemoveIsApp = true;\n        }\n\n        this.$modal.show('promptRemove');\n\n        let { resource } = this.$route.params;\n\n        if (this.toRemove.length > 0) {\n          resource = selected.type;\n        }\n\n        this.hasCustomRemove = this.$store.getters['type-map/hasCustomPromptRemove'](resource);\n\n        this.removeComponent = this.$store.getters['type-map/importCustomPromptRemove'](resource);\n      } else {\n        this.$modal.hide('promptRemove');\n      }\n    },\n\n    // check for any resources with a deletion prevention message,\n    // if none found (delete is allowed), then check for any resources with a warning message\n    toRemove(neu) {\n      let message;\n      const preventDeletionMessages = neu.filter((item) => item.preventDeletionMessage);\n\n      this.preventDelete = false;\n\n      if (!!preventDeletionMessages.length) {\n        this.preventDelete = true;\n        message = preventDeletionMessages[0].preventDeletionMessage;\n      } else {\n        const warnDeletionMessages = neu.filter((item) => item.warnDeletionMessage);\n\n        if (!!warnDeletionMessages.length) {\n          message = warnDeletionMessages[0].warnDeletionMessage;\n        }\n      }\n      if (typeof message === 'function' ) {\n        this.warning = message(this.toRemove);\n      } else if (!!message) {\n        this.warning = message;\n      } else {\n        this.warning = '';\n      }\n    }\n  },\n\n  methods: {\n    resourceNames,\n    escapeHtml,\n    close() {\n      this.confirmName = '';\n      this.error = '';\n      this.chartsDeleteCrd = false;\n      this.chartsToRemoveIsApp = false;\n      this.$store.commit('action-menu/togglePromptRemove');\n    },\n\n    async remove(btnCB) {\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        this.cachedDoneLocation = { ...this.doneLocation };\n      }\n\n      if (this.hasCustomRemove && this.$refs?.customPrompt?.remove) {\n        let handled = this.$refs.customPrompt.remove(btnCB);\n\n        // If the response is a promise, then wait for the promise\n        if (handled && handled.then) {\n          try {\n            handled = await handled;\n          } catch (err) {\n            this.error = err;\n            btnCB(false);\n\n            return;\n          }\n        }\n\n        // If the remove function for the custom dialog handled the request, it can return true or not return anything\n        // if it returned false, then it wants us to continue with the deletion logic below - this is useful\n        // where the custom dialog needs to delete additional resources - it handles those and retrurns false to get us\n        // to delete the main resource\n        if (handled === undefined || handled) {\n          return;\n        }\n      }\n      const serialRemove = this.toRemove.some((resource) => resource.removeSerially);\n\n      if (serialRemove) {\n        this.serialRemove(btnCB);\n      } else {\n        this.parallelRemove(btnCB);\n      }\n    },\n    async serialRemove(btnCB) {\n      try {\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        for (const resource of this.toRemove) {\n          await resource.remove();\n        }\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    async parallelRemove(btnCB) {\n      try {\n        if (typeof this.toRemove[0].bulkRemove !== 'undefined') {\n          await this.toRemove[0].bulkRemove(this.toRemove, {});\n        } else {\n          await Promise.all(this.toRemove.map((resource) => resource.remove()));\n        }\n\n        const spoofedTypes = this.getSpoofedTypes(this.toRemove);\n\n        await this.refreshSpoofedTypes(spoofedTypes);\n\n        this.done();\n      } catch (err) {\n        this.error = err.message || err;\n        btnCB(false);\n      }\n    },\n    done() {\n      if ( this.cachedDoneLocation && !isEmpty(this.cachedDoneLocation) ) {\n        this.currentRouter.push(this.cachedDoneLocation);\n      }\n      this.close();\n    },\n    getSpoofedTypes(resources) {\n      const uniqueResourceTypes = uniq(this.toRemove.map((resource) => resource.type));\n\n      return uniqueResourceTypes.filter(this.$store.getters['type-map/isSpoofed']);\n    },\n\n    // If spoofed we need to reload the values as the server can't have watchers for them.\n    refreshSpoofedTypes(types) {\n      const inStore = this.$store.getters['currentProduct'].inStore;\n      const promises = types.map((type) => this.$store.dispatch(`${ inStore }/findAll`, { type, opt: { force: true } }, { root: true }));\n\n      return Promise.all(promises);\n    },\n\n    async chartAddCrdToRemove() {\n      try {\n        const res = await this.toRemove[0].relatedResourcesToRemove();\n\n        if (!this.toRemove.includes(res)) {\n          this.toRemove.push(res);\n        } else if (!this.chartsDeleteCrd) {\n          this.toRemove.pop(res);\n        }\n      } catch (err) {\n        this.error = err;\n        this.chartsDeleteCrd = false;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <modal\n    class=\"remove-modal\"\n    name=\"promptRemove\"\n    :width=\"400\"\n    height=\"auto\"\n    styles=\"max-height: 100vh;\"\n    @closed=\"close\"\n  >\n    <Card\n      class=\"prompt-remove\"\n      :show-highlight-border=\"false\"\n    >\n      <h4\n        slot=\"title\"\n        class=\"text-default-text\"\n      >\n        {{ t('promptRemove.title') }}\n      </h4>\n      <div slot=\"body\">\n        <div class=\"mb-10\">\n          <template v-if=\"!hasCustomRemove\">\n            {{ t('promptRemove.attemptingToRemove', { type }) }} <span\n              v-clean-html=\"resourceNames(names, plusMore, t)\"\n            />\n          </template>\n\n          <template>\n            <component\n              :is=\"removeComponent\"\n              v-if=\"hasCustomRemove\"\n              ref=\"customPrompt\"\n              v-model=\"toRemove\"\n              v-bind=\"_data\"\n              :close=\"close\"\n              :needs-confirm=\"needsConfirm\"\n              :value=\"toRemove\"\n              :names=\"names\"\n              :type=\"type\"\n              @errors=\"e => error = e\"\n              @done=\"done\"\n            />\n            <div\n              v-if=\"needsConfirm\"\n              class=\"mt-10\"\n            >\n              <span\n                v-clean-html=\"t('promptRemove.confirmName', { nameToMatch: escapeHtml(nameToMatch) }, true)\"\n              />\n            </div>\n          </template>\n        </div>\n        <LabeledInput\n          v-if=\"needsConfirm\"\n          id=\"confirm\"\n          v-model=\"confirmName\"\n          v-focus\n          :data-testid=\"componentTestid + '-input'\"\n          type=\"text\"\n        >\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n          <div\n            v-if=\"!needsConfirm\"\n            class=\"text-info mt-20\"\n          >\n            {{ protip }}\n          </div>\n          <Checkbox\n            v-if=\"chartsToRemoveIsApp\"\n            v-model=\"chartsDeleteCrd\"\n            label-key=\"promptRemoveApp.removeCrd\"\n            class=\"mt-10 type\"\n            @input=\"chartAddCrdToRemove\"\n          />\n        </labeledinput>\n        <template v-else>\n          <div class=\"text-warning mb-10 mt-10\">\n            {{ warning }}\n          </div>\n          <div class=\"text-error mb-10 mt-10\">\n            {{ error }}\n          </div>\n        </template>\n      </div>\n      <template #actions>\n        <button\n          class=\"btn role-secondary\"\n          @click=\"close\"\n        >\n          {{ t('generic.cancel') }}\n        </button>\n        <div class=\"spacer\" />\n        <AsyncButton\n          mode=\"delete\"\n          class=\"btn bg-error ml-10\"\n          :disabled=\"deleteDisabled\"\n          :data-testid=\"componentTestid + '-confirm-button'\"\n          @click=\"remove\"\n        />\n      </template>\n    </Card>\n  </modal>\n</template>\n\n<style lang='scss'>\n  .prompt-remove {\n    &.card-container {\n      box-shadow: none;\n    }\n    #confirm {\n      width: 90%;\n      margin-left: 3px;\n    }\n\n    .remove-modal {\n        border-radius: var(--border-radius);\n        overflow: scroll;\n        max-height: 100vh;\n        & ::-webkit-scrollbar-corner {\n          background: rgba(0,0,0,0);\n        }\n    }\n\n    .actions {\n      text-align: right;\n    }\n\n    .card-actions {\n      display: flex;\n\n      .spacer {\n        flex: 1;\n      }\n    }\n  }\n</style>\n"]}]}