{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/networking.istio.io.destinationrule/LoadBalancer.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/networking.istio.io.destinationrule/LoadBalancer.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IHsgUmFkaW9Hcm91cCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vUmFkaW8nOwppbXBvcnQgeyBnZXQgfSBmcm9tICdAc2hlbGwvdXRpbHMvb2JqZWN0JzsKCmV4cG9ydCBkZWZhdWx0IHsKCiAgY29tcG9uZW50czogewogICAgUmFkaW9Hcm91cCwKICAgIExhYmVsZWRTZWxlY3QsCiAgICBMYWJlbGVkSW5wdXQKICB9LAoKICBwcm9wczogewogICAgbW9kZTogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdlZGl0JwogICAgfSwKCiAgICAvLyBkZXN0aW5hdGlvbnJ1bGUuc3BlYy50cmFmZmljUG9saWN5LmxvYWRCYWxhbmNlcgogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgT2JqZWN0LAogICAgICBkZWZhdWx0OiAoKSA9PiB7fQogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICAvLyBhdHRlbXB0IHRvIGluaXRpYWxpemUgdXNlU2ltcGxlIGFuZCBoYXNoTW9kZSBvZmYgZXhpc3RpbmcgcHJvcGVydGllcyBzbyB0aGUgcmlnaHQgcmFkaW8gb3B0cyBhcmUgc2VsZWN0ZWQgd2hlbiBtb2RlPWVkaXQKICAgIGNvbnN0IHVzZVNpbXBsZSA9ICEhdGhpcy52YWx1ZS5zaW1wbGU7CiAgICBsZXQgaGFzaE1vZGU7CgogICAgaWYgKCEhZ2V0KHRoaXMudmFsdWUsICdjb25zaXN0ZW50SGFzaC5odHRwSGVhZGVyTmFtZScpKSB7CiAgICAgIGhhc2hNb2RlID0gJ3VzZUhlYWRlcic7CiAgICB9IGVsc2UgaWYgKCEhZ2V0KHRoaXMudmFsdWUsICdjb25zaXN0ZW50SGFzaC5odHRwQ29va2llJykpIHsKICAgICAgaGFzaE1vZGUgPSAndXNlQ29va2llJzsKICAgIH0gZWxzZSBpZiAoISFnZXQodGhpcy52YWx1ZSwgJ2NvbnNpc3RlbnRIYXNoLnVzZVNvdXJjZUlwJykpIHsKICAgICAgaGFzaE1vZGUgPSAndXNlSVAnOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHVzZVNpbXBsZSwKICAgICAgaGFzaE1vZGUsCgogICAgICBzaW1wbGVPcHRpb25zOiBbJ1JPVU5EX1JPQklOJywgJ0xFQVNUX0NPTk4nLCAnUkFORE9NJywgJ1BBU1NUSFJPVUdIJ10sCiAgICAgIG1vZGVPcHRpb25zOiAgIFsKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdpc3Rpby5kZXN0aW5hdGlvblJ1bGUubG9hZEJhbGFuY2VyLnNpbXBsZS5sYWJlbCcpLAogICAgICAgICAgdmFsdWU6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdpc3Rpby5kZXN0aW5hdGlvblJ1bGUubG9hZEJhbGFuY2VyLmNvbnNpc3RlbnRIYXNoLmxhYmVsJyksCiAgICAgICAgICB2YWx1ZTogZmFsc2UKICAgICAgICB9LAogICAgICBdLAogICAgICBoYXNoTW9kZU9wdGlvbnM6IFsKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdpc3Rpby5kZXN0aW5hdGlvblJ1bGUubG9hZEJhbGFuY2VyLmNvbnNpc3RlbnRIYXNoLm1vZGUuaGVhZGVyLmxhYmVsJyksCiAgICAgICAgICB2YWx1ZTogJ3VzZUhlYWRlcicKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ2lzdGlvLmRlc3RpbmF0aW9uUnVsZS5sb2FkQmFsYW5jZXIuY29uc2lzdGVudEhhc2gubW9kZS5jb29raWUubGFiZWwnKSwKICAgICAgICAgIHZhbHVlOiAndXNlQ29va2llJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnaXN0aW8uZGVzdGluYXRpb25SdWxlLmxvYWRCYWxhbmNlci5jb25zaXN0ZW50SGFzaC5tb2RlLnNvdXJjZUlwLmxhYmVsJyksCiAgICAgICAgICB2YWx1ZTogJ3VzZUlwJwogICAgICAgIH0KICAgICAgXSwKICAgIH07CiAgfSwKCiAgd2F0Y2g6IHsKICAgIHVzZVNpbXBsZShuZXUpIHsKICAgICAgaWYgKG5ldSkgewogICAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlLmNvbnNpc3RlbnRIYXNoOwogICAgICAgIHRoaXMudmFsdWUuc2ltcGxlID0gdGhpcy5zaW1wbGVPcHRpb25zWzBdOwogICAgICB9IGVsc2UgewogICAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlLnNpbXBsZTsKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZSwgJ2NvbnNpc3RlbnRIYXNoJywgeyBtaW5pbXVtUmluZ1NpemU6IDEwMjQgfSk7CiAgICAgICAgLy8gc2V0IGhhc2hNb2RlIGhlcmUgdG8gdHJpZ2dlciB3YXRjaGVyIGFuZCBpbml0aWFsaXplIHJlbGV2YW50IG9iamVjdCBwcm9wcwogICAgICAgIHRoaXMuaGFzaE1vZGUgPSAndXNlSGVhZGVyJzsKICAgICAgfQogICAgfSwKCiAgICBoYXNoTW9kZShuZXUpIHsKICAgICAgc3dpdGNoIChuZXUpIHsKICAgICAgY2FzZSAndXNlSGVhZGVyJzoKICAgICAgICBkZWxldGUgdGhpcy52YWx1ZS5jb25zaXN0ZW50SGFzaC5odHRwQ29va2llOwogICAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlLmNvbnNpc3RlbnRIYXNoLnVzZVNvdXJjZUlwOwogICAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLmNvbnNpc3RlbnRIYXNoLCAnaHR0cEhlYWRlck5hbWUnLCAnJyk7CiAgICAgICAgYnJlYWs7CiAgICAgIGNhc2UgJ3VzZUNvb2tpZSc6CiAgICAgICAgZGVsZXRlIHRoaXMudmFsdWUuY29uc2lzdGVudEhhc2guaHR0cEhlYWRlck5hbWU7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUuY29uc2lzdGVudEhhc2gsICdodHRwQ29va2llJywge30pOwogICAgICAgIGJyZWFrOwogICAgICBkZWZhdWx0OgogICAgICAgIGRlbGV0ZSB0aGlzLnZhbHVlLmNvbnNpc3RlbnRIYXNoLmh0dHBDb29raWU7CiAgICAgICAgZGVsZXRlIHRoaXMudmFsdWUuY29uc2lzdGVudEhhc2guaHR0cEhlYWRlck5hbWU7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUuY29uc2lzdGVudEhhc2gsICd1c2VTb3VyY2VJcCcsIHRydWUpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["LoadBalancer.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LoadBalancer.vue","sourceRoot":"node_modules/@rancher/shell/edit/networking.istio.io.destinationrule","sourcesContent":["<script>\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport { RadioGroup } from '@components/Form/Radio';\nimport { get } from '@shell/utils/object';\n\nexport default {\n\n  components: {\n    RadioGroup,\n    LabeledSelect,\n    LabeledInput\n  },\n\n  props: {\n    mode: {\n      type:    String,\n      default: 'edit'\n    },\n\n    // destinationrule.spec.trafficPolicy.loadBalancer\n    value: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    // attempt to initialize useSimple and hashMode off existing properties so the right radio opts are selected when mode=edit\n    const useSimple = !!this.value.simple;\n    let hashMode;\n\n    if (!!get(this.value, 'consistentHash.httpHeaderName')) {\n      hashMode = 'useHeader';\n    } else if (!!get(this.value, 'consistentHash.httpCookie')) {\n      hashMode = 'useCookie';\n    } else if (!!get(this.value, 'consistentHash.useSourceIp')) {\n      hashMode = 'useIP';\n    }\n\n    return {\n      useSimple,\n      hashMode,\n\n      simpleOptions: ['ROUND_ROBIN', 'LEAST_CONN', 'RANDOM', 'PASSTHROUGH'],\n      modeOptions:   [\n        {\n          label: this.t('istio.destinationRule.loadBalancer.simple.label'),\n          value: true\n        }, {\n          label: this.t('istio.destinationRule.loadBalancer.consistentHash.label'),\n          value: false\n        },\n      ],\n      hashModeOptions: [\n        {\n          label: this.t('istio.destinationRule.loadBalancer.consistentHash.mode.header.label'),\n          value: 'useHeader'\n        },\n        {\n          label: this.t('istio.destinationRule.loadBalancer.consistentHash.mode.cookie.label'),\n          value: 'useCookie'\n        },\n        {\n          label: this.t('istio.destinationRule.loadBalancer.consistentHash.mode.sourceIp.label'),\n          value: 'useIp'\n        }\n      ],\n    };\n  },\n\n  watch: {\n    useSimple(neu) {\n      if (neu) {\n        delete this.value.consistentHash;\n        this.value.simple = this.simpleOptions[0];\n      } else {\n        delete this.value.simple;\n        this.$set(this.value, 'consistentHash', { minimumRingSize: 1024 });\n        // set hashMode here to trigger watcher and initialize relevant object props\n        this.hashMode = 'useHeader';\n      }\n    },\n\n    hashMode(neu) {\n      switch (neu) {\n      case 'useHeader':\n        delete this.value.consistentHash.httpCookie;\n        delete this.value.consistentHash.useSourceIp;\n        this.$set(this.value.consistentHash, 'httpHeaderName', '');\n        break;\n      case 'useCookie':\n        delete this.value.consistentHash.httpHeaderName;\n        this.$set(this.value.consistentHash, 'httpCookie', {});\n        break;\n      default:\n        delete this.value.consistentHash.httpCookie;\n        delete this.value.consistentHash.httpHeaderName;\n        this.$set(this.value.consistentHash, 'useSourceIp', true);\n        break;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row\">\n      <RadioGroup\n        v-model=\"useSimple\"\n        name=\"loadBalancer\"\n        :mode=\"mode\"\n        :options=\"modeOptions\"\n      />\n    </div>\n    <div\n      v-if=\"useSimple\"\n      class=\"row\"\n    >\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.simple\"\n          :options=\"simpleOptions\"\n          :label=\"t('istio.destinationRule.loadBalancer.label')\"\n          :mode=\"mode\"\n        />\n      </div>\n    </div>\n    <template v-else>\n      <div class=\"row mt-20\">\n        <div class=\"col span-6\">\n          <RadioGroup\n            v-model=\"hashMode\"\n            name=\"HashOptions\"\n            :mode=\"mode\"\n            :options=\"hashModeOptions\"\n            :label=\"t('istio.destinationRule.loadBalancer.consistentHash.mode.label')\"\n          />\n        </div>\n      </div>\n      <div class=\"row mb-20\">\n        <div class=\"col span-6\">\n          <LabeledInput\n            v-model=\"value.consistentHash.minimumRingSize\"\n            :label=\"t('istio.destinationRule.loadBalancer.consistentHash.minimumRingSize.label')\"\n            type=\"number\"\n          />\n        </div>\n      </div>\n      <div\n        v-if=\"hashMode === 'useHeader'\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <LabeledInput\n            v-model=\"value.consistentHash.httpHeaderName\"\n            :label=\"t('istio.destinationRule.loadBalancer.consistentHash.httpHeaderName.label')\"\n            :placeholder=\"t('istio.destinationRule.loadBalancer.consistentHash.httpHeaderName.placeholder')\"\n          />\n        </div>\n      </div>\n\n      <div\n        v-if=\"hashMode === 'useCookie'\"\n        class=\"row\"\n      >\n        <div class=\"col span-4\">\n          <LabeledInput\n            v-model=\"value.consistentHash.httpCookie.name\"\n            :label=\"t('istio.destinationRule.loadBalancer.consistentHash.httpCookie.name.label')\"\n            :placeholder=\"t('istio.destinationRule.loadBalancer.consistentHash.httpCookie.name.placeholder')\"\n            required\n          />\n        </div>\n        <div class=\"col span-4\">\n          <LabeledInput\n            v-model=\"value.consistentHash.httpCookie.path\"\n            :label=\"t('istio.destinationRule.loadBalancer.consistentHash.httpCookie.path.label')\"\n            :placeholder=\"t('istio.destinationRule.loadBalancer.consistentHash.httpCookie.path.placeholder')\"\n          />\n        </div>\n        <div class=\"col span-4\">\n          <LabeledInput\n            v-model=\"value.consistentHash.httpCookie.ttl\"\n            :label=\"t('istio.destinationRule.loadBalancer.consistentHash.httpCookie.ttl.label')\"\n            :placeholder=\"t('istio.destinationRule.loadBalancer.consistentHash.httpCookie.ttl.placeholder')\"\n            required\n          />\n        </div>\n      </div>\n    </template>\n  </div>\n</template>\n"]}]}