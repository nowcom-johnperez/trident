{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/settings/links.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/settings/links.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgQXN5bmNCdXR0b24gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvQXN5bmNCdXR0b24nOwppbXBvcnQgQmFubmVyIGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lci9CYW5uZXIudnVlJzsKaW1wb3J0IHsgTUFOQUdFTUVOVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBmZXRjaE9yQ3JlYXRlU2V0dGluZyB9IGZyb20gJ0BzaGVsbC91dGlscy9zZXR0aW5ncyc7CmltcG9ydCB7IFNFVFRJTkcgfSBmcm9tICdAc2hlbGwvY29uZmlnL3NldHRpbmdzJzsKaW1wb3J0IHsgX0VESVQsIF9WSUVXIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgS2V5VmFsdWUgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9LZXlWYWx1ZSc7CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgaXNSYW5jaGVyUHJpbWUgfSBmcm9tICdAc2hlbGwvY29uZmlnL3ZlcnNpb24nOwppbXBvcnQgRGVmYXVsdExpbmtzRWRpdG9yIGZyb20gJy4vRGVmYXVsdExpbmtzRWRpdG9yJzsKaW1wb3J0IHsgQ1VTVE9NX0xJTktTX1ZFUlNJT04sIGZldGNoTGlua3MgfSBmcm9tICdAc2hlbGwvY29uZmlnL2hvbWUtbGlua3MnOwoKZXhwb3J0IGRlZmF1bHQgewogIGxheW91dDogICAgICdhdXRoZW50aWNhdGVkJywKICBjb21wb25lbnRzOiB7CiAgICBLZXlWYWx1ZSwKICAgIExvYWRpbmcsCiAgICBBc3luY0J1dHRvbiwKICAgIEJhbm5lciwKICAgIERlZmF1bHRMaW5rc0VkaXRvciwKICB9LAogIGFzeW5jIGZldGNoKCkgewogICAgdGhpcy52YWx1ZSA9IGF3YWl0IGZldGNoTGlua3ModGhpcy4kc3RvcmUsIHRoaXMuaGFzU3VwcG9ydCwgZmFsc2UsIChzdHIpID0+IHRoaXMudChzdHIpKTsKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGVmYXVsdHNEaXNhYmxlZDogdHJ1ZSwKICAgICAgaXNSYW5jaGVyUHJpbWU6ICAgaXNSYW5jaGVyUHJpbWUoKSwKICAgICAgdWlDdXN0b21MaW5rczogICAge30sCiAgICAgIGJhbm5lclZhbDogICAgICAgIHt9LAogICAgICB2YWx1ZTogICAgICAgICAgICBbXSwKICAgICAgZXJyb3JzOiAgICAgICAgICAgW10sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoeyBtdWx0aVdpdGhGYWxsYmFjazogJ2kxOG4vbXVsdGlXaXRoRmFsbGJhY2snIH0pLAoKICAgIG1vZGUoKSB7CiAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuJHN0b3JlLmdldHRlcnNbYG1hbmFnZW1lbnQvc2NoZW1hRm9yYF0oTUFOQUdFTUVOVC5TRVRUSU5HKTsKCiAgICAgIHJldHVybiBzY2hlbWE/LnJlc291cmNlTWV0aG9kcz8uaW5jbHVkZXMoJ1BVVCcpID8gX0VESVQgOiBfVklFVzsKICAgIH0sCgogICAgYWxsVmFsdWVzKCkgewogICAgICByZXR1cm4gewogICAgICAgIHZlcnNpb246ICBDVVNUT01fTElOS1NfVkVSU0lPTiwKICAgICAgICBkZWZhdWx0czogdGhpcy52YWx1ZS5kZWZhdWx0cy5maWx0ZXIoKG9iaikgPT4gb2JqLmVuYWJsZWQpLm1hcCgob2JqKSA9PiBvYmoua2V5KSwKICAgICAgICBjdXN0b206ICAgdGhpcy52YWx1ZS5jdXN0b20KICAgICAgfTsKICAgIH0sCgogICAgaGFzU3VwcG9ydCgpIHsKICAgICAgcmV0dXJuIGlzUmFuY2hlclByaW1lKCkgfHwgdGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9ieUlkJ10oTUFOQUdFTUVOVC5TRVRUSU5HLCBTRVRUSU5HLlNVUFBPUlRFRCApPy52YWx1ZSA9PT0gJ3RydWUnOwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlcHJlY2F0ZUlzc3VlTGlua3MoKSB7CiAgICAgIGlmICh0aGlzLnVpSXNzdWVzU2V0dGluZy52YWx1ZSB8fCB0aGlzLnVpSXNzdWVzU2V0dGluZy52YWx1ZSkgewogICAgICAgIHRoaXMudWlJc3N1ZXNTZXR0aW5nLnZhbHVlID0gJyc7CiAgICAgICAgdGhpcy51aUNvbW11bml0eVNldHRpbmcudmFsdWUgPSAnJzsKCiAgICAgICAgcmV0dXJuIHRoaXMudWlJc3N1ZXNTZXR0aW5nLnNhdmUoKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBzYXZlKGJ0bkNCKSB7CiAgICAgIHRoaXMuZXJyb3JzID0gW107CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgdWlDdXN0b21MaW5rcyA9IGF3YWl0IGZldGNoT3JDcmVhdGVTZXR0aW5nKHRoaXMuJHN0b3JlLCBTRVRUSU5HLlVJX0NVU1RPTV9MSU5LUywgJycpOwoKICAgICAgICB1aUN1c3RvbUxpbmtzLnZhbHVlID0gSlNPTi5zdHJpbmdpZnkodGhpcy5hbGxWYWx1ZXMpOwoKICAgICAgICBhd2FpdCB1aUN1c3RvbUxpbmtzLnNhdmUoKTsKCiAgICAgICAgdGhpcy52YWx1ZSA9IGF3YWl0IGZldGNoTGlua3ModGhpcy4kc3RvcmUsIHRoaXMuaGFzU3VwcG9ydCwgZmFsc2UsIChzdHIpID0+IHRoaXMudChzdHIpKTsKICAgICAgICBidG5DQih0cnVlKTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5lcnJvcnMucHVzaChlcnIpOwogICAgICAgIGJ0bkNCKGZhbHNlKTsKICAgICAgfQogICAgfSwKICB9Cn07Cg=="},{"version":3,"sources":["links.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"links.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/settings","sourcesContent":["<script>\nimport Loading from '@shell/components/Loading';\nimport AsyncButton from '@shell/components/AsyncButton';\nimport Banner from '@components/Banner/Banner.vue';\nimport { MANAGEMENT } from '@shell/config/types';\nimport { fetchOrCreateSetting } from '@shell/utils/settings';\nimport { SETTING } from '@shell/config/settings';\nimport { _EDIT, _VIEW } from '@shell/config/query-params';\nimport KeyValue from '@shell/components/form/KeyValue';\nimport { mapGetters } from 'vuex';\nimport { isRancherPrime } from '@shell/config/version';\nimport DefaultLinksEditor from './DefaultLinksEditor';\nimport { CUSTOM_LINKS_VERSION, fetchLinks } from '@shell/config/home-links';\n\nexport default {\n  layout:     'authenticated',\n  components: {\n    KeyValue,\n    Loading,\n    AsyncButton,\n    Banner,\n    DefaultLinksEditor,\n  },\n  async fetch() {\n    this.value = await fetchLinks(this.$store, this.hasSupport, false, (str) => this.t(str));\n  },\n\n  data() {\n    return {\n      defaultsDisabled: true,\n      isRancherPrime:   isRancherPrime(),\n      uiCustomLinks:    {},\n      bannerVal:        {},\n      value:            [],\n      errors:           [],\n    };\n  },\n  computed: {\n    ...mapGetters({ multiWithFallback: 'i18n/multiWithFallback' }),\n\n    mode() {\n      const schema = this.$store.getters[`management/schemaFor`](MANAGEMENT.SETTING);\n\n      return schema?.resourceMethods?.includes('PUT') ? _EDIT : _VIEW;\n    },\n\n    allValues() {\n      return {\n        version:  CUSTOM_LINKS_VERSION,\n        defaults: this.value.defaults.filter((obj) => obj.enabled).map((obj) => obj.key),\n        custom:   this.value.custom\n      };\n    },\n\n    hasSupport() {\n      return isRancherPrime() || this.$store.getters['management/byId'](MANAGEMENT.SETTING, SETTING.SUPPORTED )?.value === 'true';\n    },\n  },\n  methods: {\n    deprecateIssueLinks() {\n      if (this.uiIssuesSetting.value || this.uiIssuesSetting.value) {\n        this.uiIssuesSetting.value = '';\n        this.uiCommunitySetting.value = '';\n\n        return this.uiIssuesSetting.save();\n      }\n    },\n\n    async save(btnCB) {\n      this.errors = [];\n      try {\n        const uiCustomLinks = await fetchOrCreateSetting(this.$store, SETTING.UI_CUSTOM_LINKS, '');\n\n        uiCustomLinks.value = JSON.stringify(this.allValues);\n\n        await uiCustomLinks.save();\n\n        this.value = await fetchLinks(this.$store, this.hasSupport, false, (str) => this.t(str));\n        btnCB(true);\n      } catch (err) {\n        this.errors.push(err);\n        btnCB(false);\n      }\n    },\n  }\n};\n</script>\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <h1 class=\"mb-20\">\n      {{ t(\"customLinks.label\") }}\n    </h1>\n    <div>\n      <label class=\"text-label\">\n        {{ t(`customLinks.description`, {}, true) }}\n      </label>\n    </div>\n    <div class=\"mt-20\">\n      <KeyValue\n        v-model=\"value.custom\"\n        :title=\"'Custom Links'\"\n        :as-map=\"false\"\n        key-name=\"label\"\n        :key-label=\"t('customLinks.settings.keyLabel')\"\n        :value-label=\"t('customLinks.settings.valueLabel')\"\n        :add-label=\"t('customLinks.addLink')\"\n        :read-allowed=\"false\"\n        :protip=\"false\"\n        :mode=\"mode\"\n      />\n    </div>\n    <div class=\"ui-links-setting mt-20\">\n      <DefaultLinksEditor\n        v-model=\"value.defaults\"\n        :mode=\"mode\"\n      />\n    </div>\n    <template v-for=\"err in errors\">\n      <Banner\n        :key=\"err\"\n        color=\"error\"\n        :label=\"err\"\n      />\n    </template>\n    <div\n      v-if=\"mode === 'edit'\"\n      class=\"mt-20\"\n    >\n      <AsyncButton\n        class=\"pull-right\"\n        mode=\"apply\"\n        @click=\"save\"\n      />\n    </div>\n  </div>\n</template>\n<style scoped lang='scss'>\n.overlay {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background-color: var(--overlay-bg);\n  z-index: 1;\n}\n.ui-links-setting {\n  P {\n    line-height: 1.25;\n    margin-bottom: 10px;\n  }\n\n  .underline {\n    text-decoration: underline;\n  }\n}\n.action {\n  display: flex;\n  input {\n    margin-right: 5px;\n  }\n}\n</style>\n"]}]}