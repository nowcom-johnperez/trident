{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/secret/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/secret/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFNFQ1JFVF9UWVBFUyBhcyBUWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2VjcmV0JzsKaW1wb3J0IHsgTUFOQUdFTUVOVCwgTkFNRVNQQUNFLCBERUZBVUxUX1dPUktTUEFDRSB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsKaW1wb3J0IE5hbWVOc0Rlc2NyaXB0aW9uIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTmFtZU5zRGVzY3JpcHRpb24nOwppbXBvcnQgeyBMYWJlbGVkSW5wdXQgfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0xhYmVsZWRJbnB1dCc7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCBDcnVSZXNvdXJjZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9DcnVSZXNvdXJjZSc7CmltcG9ydCB7CiAgQ0xPVURfQ1JFREVOVElBTCwgX0NMT05FLCBfQ1JFQVRFLCBfRURJVCwgX0ZMQUdHRUQKfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgVGFiYmVkIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZCc7CmltcG9ydCBUYWIgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVGFiYmVkL1RhYic7CmltcG9ydCBMYWJlbHMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9MYWJlbHMnOwppbXBvcnQgeyBISURFX1NFTlNJVElWRSB9IGZyb20gJ0BzaGVsbC9zdG9yZS9wcmVmcyc7CmltcG9ydCB7IENBUEkgfSBmcm9tICdAc2hlbGwvY29uZmlnL2xhYmVscy1hbm5vdGF0aW9ucyc7CmltcG9ydCB7IGNsZWFyLCB1bmlxIH0gZnJvbSAnQHNoZWxsL3V0aWxzL2FycmF5JzsKaW1wb3J0IHsgTkFNRSBhcyBNQU5BR0VSIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9wcm9kdWN0L21hbmFnZXInOwppbXBvcnQgU2VsZWN0SWNvbkdyaWQgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvU2VsZWN0SWNvbkdyaWQnOwppbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdAc2hlbGwvdXRpbHMvc29ydCc7CmltcG9ydCB7IHVjRmlyc3QgfSBmcm9tICdAc2hlbGwvdXRpbHMvc3RyaW5nJzsKCmNvbnN0IGNyZWF0YWJsZVR5cGVzID0gWwogIFRZUEVTLk9QQVFVRSwKICBUWVBFUy5ET0NLRVJfSlNPTiwKICBUWVBFUy5UTFMsCiAgVFlQRVMuU1NILAogIFRZUEVTLkJBU0lDLApdOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDcnVTZWNyZXQnLAoKICBjb21wb25lbnRzOiB7CiAgICBMYWJlbGVkSW5wdXQsCiAgICBMYWJlbGVkU2VsZWN0LAogICAgTG9hZGluZywKICAgIE5hbWVOc0Rlc2NyaXB0aW9uLAogICAgQ3J1UmVzb3VyY2UsCiAgICBUYWJiZWQsCiAgICBUYWIsCiAgICBMYWJlbHMsCiAgICBTZWxlY3RJY29uR3JpZAogIH0sCgogIG1peGluczogW0NyZWF0ZUVkaXRWaWV3XSwKCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBpZiAoIHRoaXMuaXNDbG91ZCApIHsKICAgICAgdGhpcy5ub2RlRHJpdmVycyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuTk9ERV9EUklWRVIgfSk7CiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IG5ld0Nsb3VkQ3JlZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5W0NMT1VEX0NSRURFTlRJQUxdID09PSBfRkxBR0dFRDsKICAgIGNvbnN0IGVkaXRDbG91ZENyZWQgPSB0aGlzLm1vZGUgPT09IF9FRElUICYmIHRoaXMudmFsdWUuX3R5cGUgPT09IFRZUEVTLkNMT1VEX0NSRURFTlRJQUw7CiAgICBjb25zdCBjbG9uZUNsb3VkQ3JlZCA9IHRoaXMucmVhbE1vZGUgPT09IF9DTE9ORSAmJiB0aGlzLmxpdmVWYWx1ZS5fdHlwZSA9PT0gVFlQRVMuQ0xPVURfQ1JFREVOVElBTDsKICAgIGNvbnN0IGlzQ2xvdWQgPSBuZXdDbG91ZENyZWQgfHwgZWRpdENsb3VkQ3JlZCB8fCBjbG9uZUNsb3VkQ3JlZDsKCiAgICBpZiAoIG5ld0Nsb3VkQ3JlZCApIHsKICAgICAgdGhpcy52YWx1ZS5tZXRhZGF0YS5uYW1lc3BhY2UgPSBERUZBVUxUX1dPUktTUEFDRTsKCiAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLm1ldGFkYXRhLCAnbmFtZScsICcnKTsKCiAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLCAnZGF0YScsIHt9KTsKICAgIH0KCiAgICBjb25zdCBzZWNyZXRUeXBlcyA9IFsKICAgICAgewogICAgICAgIGxhYmVsOiAnQ3VzdG9tJywKICAgICAgICB2YWx1ZTogJ2N1c3RvbScKICAgICAgfSwKICAgICAgewogICAgICAgIGxhYmVsOiAgICAnZGl2aWRlcicsCiAgICAgICAgZGlzYWJsZWQ6IHRydWUsCiAgICAgICAga2luZDogICAgICdkaXZpZGVyJwogICAgICB9CiAgICBdOwoKICAgIE9iamVjdC52YWx1ZXMoVFlQRVMpLmZvckVhY2goKHQpID0+IHsKICAgICAgc2VjcmV0VHlwZXMucHVzaCh7CiAgICAgICAgbGFiZWw6IHQsCiAgICAgICAgdmFsdWU6IHQKICAgICAgfSk7CiAgICB9KTsKCiAgICByZXR1cm4gewogICAgICBpc0Nsb3VkLAogICAgICBub2RlRHJpdmVyczogICAgICAgbnVsbCwKICAgICAgc2VjcmV0VHlwZXMsCiAgICAgIHNlY3JldFR5cGU6ICAgICAgICB0aGlzLnZhbHVlLl90eXBlLAogICAgICBpbml0aWFsU2VjcmV0VHlwZTogdGhpcy52YWx1ZS5fdHlwZQogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgaXNDdXN0b21TZWNyZXRDcmVhdGUoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9DUkVBVEUgJiYgdGhpcy4kcm91dGUucXVlcnkudHlwZSA9PT0gJ2N1c3RvbSc7CiAgICB9LAogICAgc2hvd0N1c3RvbVNlY3JldFR5cGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlY3JldFR5cGUgPT09ICdjdXN0b20nOwogICAgfSwKICAgIHR5cGVLZXkoKSB7CiAgICAgIGlmICggdGhpcy5pc0Nsb3VkICkgewogICAgICAgIHJldHVybiAnY2xvdWQnOwogICAgICB9CgogICAgICBzd2l0Y2ggKCB0aGlzLnZhbHVlLl90eXBlICkgewogICAgICBjYXNlIFRZUEVTLlRMUzogcmV0dXJuICd0bHMnOwogICAgICBjYXNlIFRZUEVTLkJBU0lDOiByZXR1cm4gJ2Jhc2ljJzsKICAgICAgY2FzZSBUWVBFUy5ET0NLRVJfSlNPTjogcmV0dXJuICdyZWdpc3RyeSc7CiAgICAgIGNhc2UgVFlQRVMuU1NIOiByZXR1cm4gJ3NzaCc7CiAgICAgIH0KCiAgICAgIHJldHVybiAnZ2VuZXJpYyc7CiAgICB9LAoKICAgIGRhdGFDb21wb25lbnQoKSB7CiAgICAgIHJldHVybiByZXF1aXJlKGBAc2hlbGwvZWRpdC9zZWNyZXQvJHsgdGhpcy50eXBlS2V5IH1gKS5kZWZhdWx0OwogICAgfSwKCiAgICBkcml2ZXJOYW1lKCkgewogICAgICBjb25zdCBkcml2ZXIgPSB0aGlzLnZhbHVlLm1ldGFkYXRhPy5hbm5vdGF0aW9ucz8uW0NBUEkuQ1JFREVOVElBTF9EUklWRVJdOwoKICAgICAgcmV0dXJuIGRyaXZlcjsKICAgIH0sCgogICAgY2xvdWRDb21wb25lbnQoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9oYXNDdXN0b21DbG91ZENyZWRlbnRpYWxDb21wb25lbnQnXSh0aGlzLmRyaXZlck5hbWUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2ltcG9ydENsb3VkQ3JlZGVudGlhbCddKHRoaXMuZHJpdmVyTmFtZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9pbXBvcnRDbG91ZENyZWRlbnRpYWwnXSgnZ2VuZXJpYycpOwogICAgfSwKCiAgICAvLyBhcnJheSBvZiBpZCwgbGFiZWwsIGRlc2NyaXB0aW9uLCBpbml0aWFscyBmb3IgdHlwZSBzZWxlY3Rpb24gc3RlcAogICAgc2VjcmV0U3ViVHlwZXMoKSB7CiAgICAgIGNvbnN0IG91dCA9IFtdOwoKICAgICAgLy8gQ2xvdWQgY3JlZGVudGlhbHMKICAgICAgaWYgKCB0aGlzLmlzQ2xvdWQgKSB7CiAgICAgICAgY29uc3QgbWFjaGluZVR5cGVzID0gdW5pcSh0aGlzLm5vZGVEcml2ZXJzCiAgICAgICAgICAuZmlsdGVyKCh4KSA9PiB4LnNwZWMuYWN0aXZlKQogICAgICAgICAgLm1hcCgoeCkgPT4geC5zcGVjLmRpc3BsYXlOYW1lIHx8IHguaWQpCiAgICAgICAgICAubWFwKCh4KSA9PiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwbHVnaW5zL2NyZWRlbnRpYWxEcml2ZXJGb3InXSh4KSkKICAgICAgICApOwoKICAgICAgICBmb3IgKCBjb25zdCBpZCBvZiBtYWNoaW5lVHlwZXMgKSB7CiAgICAgICAgICBsZXQgYmFubmVySW1hZ2UsIGJhbm5lckFiYnJ2OwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGJhbm5lckltYWdlID0gcmVxdWlyZShgfnNoZWxsL2Fzc2V0cy9pbWFnZXMvcHJvdmlkZXJzLyR7IGlkIH0uc3ZnYCk7CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGJhbm5lckltYWdlID0gbnVsbDsKICAgICAgICAgICAgYmFubmVyQWJicnYgPSB0aGlzLmluaXRpYWxEaXNwbGF5Rm9yKGlkKTsKICAgICAgICAgIH0KCiAgICAgICAgICBvdXQucHVzaCh7CiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBsYWJlbDogdGhpcy50eXBlRGlzcGxheShDQVBJLkNSRURFTlRJQUxfRFJJVkVSLCBpZCksCiAgICAgICAgICAgIGJhbm5lckltYWdlLAogICAgICAgICAgICBiYW5uZXJBYmJydgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIE90aGVyIGtpbmRzCiAgICAgICAgZm9yICggY29uc3QgaWQgb2YgY3JlYXRhYmxlVHlwZXMgKSB7CiAgICAgICAgICBvdXQucHVzaCh7CiAgICAgICAgICAgIGlkLAogICAgICAgICAgICBsYWJlbDogICAgICAgdGhpcy50eXBlRGlzcGxheShpZCksCiAgICAgICAgICAgIGJhbm5lckFiYnJ2OiB0aGlzLmluaXRpYWxEaXNwbGF5Rm9yKGlkKSwKICAgICAgICAgICAgZGVzY3JpcHRpb246IHRoaXMudChgc2VjcmV0LnR5cGVEZXNjcmlwdGlvbnMuJyR7IGlkIH0nLmRlc2NyaXB0aW9uYCksCiAgICAgICAgICAgIGRvY0xpbms6ICAgICB0aGlzLnQoYHNlY3JldC50eXBlRGVzY3JpcHRpb25zLickeyBpZCB9Jy5kb2NMaW5rYCkKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgb3V0LnB1c2goewogICAgICAgICAgaWQ6ICAgICAgICAgICdjdXN0b20nLAogICAgICAgICAgbGFiZWw6ICAgICAgIHRoaXMudCgnc2VjcmV0LmN1c3RvbVR5cGUnKSwKICAgICAgICAgIGJhbm5lckFiYnJ2OiB0aGlzLmluaXRpYWxEaXNwbGF5Rm9yKCdjdXN0b20nKSwKICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnQoJ3NlY3JldC50eXBlRGVzY3JpcHRpb25zLmN1c3RvbS5kZXNjcmlwdGlvbicpCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzb3J0Qnkob3V0LCAnbGFiZWwnKTsKICAgIH0sCgogICAgbmFtZXNwYWNlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvYWxsJ10oTkFNRVNQQUNFKS5tYXAoKG9iaikgPT4gewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsYWJlbDogb2JqLm5hbWVEaXNwbGF5LAogICAgICAgICAgdmFsdWU6IG9iai5pZCwKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sCgogICAgaGlkZVNlbnNpdGl2ZURhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwcmVmcy9nZXQnXShISURFX1NFTlNJVElWRSk7CiAgICB9LAoKICAgIGRhdGFMYWJlbCgpIHsKICAgICAgc3dpdGNoICh0aGlzLnZhbHVlLl90eXBlKSB7CiAgICAgIGNhc2UgVFlQRVMuVExTOgogICAgICAgIHJldHVybiB0aGlzLnQoJ3NlY3JldC5jZXJ0aWZpY2F0ZS5jZXJ0aWZpY2F0ZScpOwogICAgICBjYXNlIFRZUEVTLlNTSDoKICAgICAgICByZXR1cm4gdGhpcy50KCdzZWNyZXQuc3NoLmtleXMnKTsKICAgICAgY2FzZSBUWVBFUy5CQVNJQzoKICAgICAgICByZXR1cm4gdGhpcy50KCdzZWNyZXQuYXV0aGVudGljYXRpb24nKTsKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gdGhpcy50KCdzZWNyZXQuZGF0YScpOwogICAgICB9CiAgICB9LAoKICAgIGRvbmVSb3V0ZSgpIHsKICAgICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjdXJyZW50UHJvZHVjdCddLm5hbWUgPT09IE1BTkFHRVIgKSB7CiAgICAgICAgcmV0dXJuICdjLWNsdXN0ZXItbWFuYWdlci1zZWNyZXQnOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnYy1jbHVzdGVyLXByb2R1Y3QtcmVzb3VyY2UnOwogICAgICB9CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNhdmVTZWNyZXQoYnRuQ2IpIHsKICAgICAgaWYgKCB0aGlzLmVycm9ycyApIHsKICAgICAgICBjbGVhcih0aGlzLmVycm9ycyk7CiAgICAgIH0KCiAgICAgIGlmICggdHlwZW9mIHRoaXMuJHJlZnMuY2xvdWRDb21wb25lbnQ/LnRlc3QgPT09ICdmdW5jdGlvbicgKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuJHJlZnMuY2xvdWRDb21wb25lbnQudGVzdCgpOwoKICAgICAgICAgIGlmICggIXJlcyB8fCByZXM/LmVycm9ycykgewogICAgICAgICAgICBpZiAocmVzPy5lcnJvcnMpIHsKICAgICAgICAgICAgICB0aGlzLmVycm9ycyA9IHJlcy5lcnJvcnM7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5lcnJvcnMgPSBbJ0F1dGhlbnRpY2F0aW9uIHRlc3QgZmFpbGVkLCBwbGVhc2UgY2hlY2sgeW91ciBjcmVkZW50aWFscyddOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJ0bkNiKGZhbHNlKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICB0aGlzLmVycm9ycyA9IFtlXTsKICAgICAgICAgIGJ0bkNiKGZhbHNlKTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5zYXZlKGJ0bkNiKTsKICAgIH0sCgogICAgc2VsZWN0VHlwZSh0eXBlKSB7CiAgICAgIGxldCBkcml2ZXI7CgogICAgICBpZiAoIHRoaXMuaXNDbG91ZCApIHsKICAgICAgICBpZiAoIHR5cGUgPT09IFRZUEVTLkNMT1VEX0NSRURFTlRJQUwgKSB7CiAgICAgICAgICAvLyBDbG9uZSBnb2VzIHRocm91Z2ggaGVyZQogICAgICAgICAgZHJpdmVyID0gdGhpcy5kcml2ZXJOYW1lOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBkcml2ZXIgPSB0eXBlOwogICAgICAgICAgdHlwZSA9IFRZUEVTLkNMT1VEX0NSRURFTlRJQUw7CiAgICAgICAgfQoKICAgICAgICBpZiAoIHRoaXMubW9kZSA9PT0gX0NSRUFURSApIHsKICAgICAgICAgIHRoaXMudmFsdWUuc2V0QW5ub3RhdGlvbihDQVBJLkNSRURFTlRJQUxfRFJJVkVSLCBkcml2ZXIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUsICdfdHlwZScsIHR5cGUpOwogICAgICB0aGlzLiRlbWl0KCdzZXQtc3VidHlwZScsIHRoaXMudHlwZURpc3BsYXkodHlwZSwgZHJpdmVyKSk7CgogICAgICB0aGlzLnNlY3JldFR5cGUgPSB0eXBlOwoKICAgICAgaWYgKHRoaXMubW9kZSA9PT0gX0NSRUFURSAmJiB0eXBlID09PSAnY3VzdG9tJykgewogICAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLCAnX3R5cGUnLCAnJyk7CiAgICAgIH0KICAgIH0sCgogICAgdHlwZURpc3BsYXkodHlwZSwgZHJpdmVyKSB7CiAgICAgIGlmICggdHlwZSA9PT0gQ0FQSS5DUkVERU5USUFMX0RSSVZFUiApIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi93aXRoRmFsbGJhY2snXShgY2x1c3Rlci5wcm92aWRlci4iJHsgZHJpdmVyIH0iYCwgbnVsbCwgZHJpdmVyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBmYWxsYmFjayA9IHR5cGUucmVwbGFjZSgvXmt1YmVybmV0ZXMuaW9cLy8sICcnKTsKCiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2kxOG4vd2l0aEZhbGxiYWNrJ10oYHNlY3JldC50eXBlcy4iJHsgdHlwZSB9ImAsIG51bGwsIGZhbGxiYWNrKTsKICAgICAgfQogICAgfSwKCiAgICBpbml0aWFsRGlzcGxheUZvcih0eXBlKSB7CiAgICAgIGNvbnN0IGZhbGxiYWNrID0gKHVjRmlyc3QodGhpcy50eXBlRGlzcGxheSh0eXBlKSB8fCAnJykucmVwbGFjZSgvW15BLVpdL2csICcnKSB8fCB0eXBlKS5zdWJzdHIoMCwgMyk7CgogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi93aXRoRmFsbGJhY2snXShgc2VjcmV0LmluaXRpYWxzLiIkeyB0eXBlIH0iYCwgbnVsbCwgZmFsbGJhY2spOwogICAgfSwKCiAgICBzZWxlY3RDdXN0b21UeXBlKHR5cGUpIHsKICAgICAgaWYgKHR5cGUgIT09ICdjdXN0b20nKSB7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUsICdfdHlwZScsIHR5cGUpOwogICAgICB9CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/edit/secret","sourcesContent":["<script>\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\nimport { MANAGEMENT, NAMESPACE, DEFAULT_WORKSPACE } from '@shell/config/types';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport NameNsDescription from '@shell/components/form/NameNsDescription';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport CruResource from '@shell/components/CruResource';\nimport {\n  CLOUD_CREDENTIAL, _CLONE, _CREATE, _EDIT, _FLAGGED\n} from '@shell/config/query-params';\nimport Loading from '@shell/components/Loading';\nimport Tabbed from '@shell/components/Tabbed';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport Labels from '@shell/components/form/Labels';\nimport { HIDE_SENSITIVE } from '@shell/store/prefs';\nimport { CAPI } from '@shell/config/labels-annotations';\nimport { clear, uniq } from '@shell/utils/array';\nimport { NAME as MANAGER } from '@shell/config/product/manager';\nimport SelectIconGrid from '@shell/components/SelectIconGrid';\nimport { sortBy } from '@shell/utils/sort';\nimport { ucFirst } from '@shell/utils/string';\n\nconst creatableTypes = [\n  TYPES.OPAQUE,\n  TYPES.DOCKER_JSON,\n  TYPES.TLS,\n  TYPES.SSH,\n  TYPES.BASIC,\n];\n\nexport default {\n  name: 'CruSecret',\n\n  components: {\n    LabeledInput,\n    LabeledSelect,\n    Loading,\n    NameNsDescription,\n    CruResource,\n    Tabbed,\n    Tab,\n    Labels,\n    SelectIconGrid\n  },\n\n  mixins: [CreateEditView],\n\n  async fetch() {\n    if ( this.isCloud ) {\n      this.nodeDrivers = await this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_DRIVER });\n    }\n  },\n\n  data() {\n    const newCloudCred = this.$route.query[CLOUD_CREDENTIAL] === _FLAGGED;\n    const editCloudCred = this.mode === _EDIT && this.value._type === TYPES.CLOUD_CREDENTIAL;\n    const cloneCloudCred = this.realMode === _CLONE && this.liveValue._type === TYPES.CLOUD_CREDENTIAL;\n    const isCloud = newCloudCred || editCloudCred || cloneCloudCred;\n\n    if ( newCloudCred ) {\n      this.value.metadata.namespace = DEFAULT_WORKSPACE;\n\n      this.$set(this.value.metadata, 'name', '');\n\n      this.$set(this.value, 'data', {});\n    }\n\n    const secretTypes = [\n      {\n        label: 'Custom',\n        value: 'custom'\n      },\n      {\n        label:    'divider',\n        disabled: true,\n        kind:     'divider'\n      }\n    ];\n\n    Object.values(TYPES).forEach((t) => {\n      secretTypes.push({\n        label: t,\n        value: t\n      });\n    });\n\n    return {\n      isCloud,\n      nodeDrivers:       null,\n      secretTypes,\n      secretType:        this.value._type,\n      initialSecretType: this.value._type\n    };\n  },\n\n  computed: {\n    isCustomSecretCreate() {\n      return this.mode === _CREATE && this.$route.query.type === 'custom';\n    },\n    showCustomSecretType() {\n      return this.secretType === 'custom';\n    },\n    typeKey() {\n      if ( this.isCloud ) {\n        return 'cloud';\n      }\n\n      switch ( this.value._type ) {\n      case TYPES.TLS: return 'tls';\n      case TYPES.BASIC: return 'basic';\n      case TYPES.DOCKER_JSON: return 'registry';\n      case TYPES.SSH: return 'ssh';\n      }\n\n      return 'generic';\n    },\n\n    dataComponent() {\n      return require(`@shell/edit/secret/${ this.typeKey }`).default;\n    },\n\n    driverName() {\n      const driver = this.value.metadata?.annotations?.[CAPI.CREDENTIAL_DRIVER];\n\n      return driver;\n    },\n\n    cloudComponent() {\n      if (this.$store.getters['type-map/hasCustomCloudCredentialComponent'](this.driverName)) {\n        return this.$store.getters['type-map/importCloudCredential'](this.driverName);\n      }\n\n      return this.$store.getters['type-map/importCloudCredential']('generic');\n    },\n\n    // array of id, label, description, initials for type selection step\n    secretSubTypes() {\n      const out = [];\n\n      // Cloud credentials\n      if ( this.isCloud ) {\n        const machineTypes = uniq(this.nodeDrivers\n          .filter((x) => x.spec.active)\n          .map((x) => x.spec.displayName || x.id)\n          .map((x) => this.$store.getters['plugins/credentialDriverFor'](x))\n        );\n\n        for ( const id of machineTypes ) {\n          let bannerImage, bannerAbbrv;\n\n          try {\n            bannerImage = require(`~shell/assets/images/providers/${ id }.svg`);\n          } catch (e) {\n            bannerImage = null;\n            bannerAbbrv = this.initialDisplayFor(id);\n          }\n\n          out.push({\n            id,\n            label: this.typeDisplay(CAPI.CREDENTIAL_DRIVER, id),\n            bannerImage,\n            bannerAbbrv\n          });\n        }\n      } else {\n        // Other kinds\n        for ( const id of creatableTypes ) {\n          out.push({\n            id,\n            label:       this.typeDisplay(id),\n            bannerAbbrv: this.initialDisplayFor(id),\n            description: this.t(`secret.typeDescriptions.'${ id }'.description`),\n            docLink:     this.t(`secret.typeDescriptions.'${ id }'.docLink`)\n          });\n        }\n\n        out.push({\n          id:          'custom',\n          label:       this.t('secret.customType'),\n          bannerAbbrv: this.initialDisplayFor('custom'),\n          description: this.t('secret.typeDescriptions.custom.description')\n        });\n      }\n\n      return sortBy(out, 'label');\n    },\n\n    namespaces() {\n      return this.$store.getters['cluster/all'](NAMESPACE).map((obj) => {\n        return {\n          label: obj.nameDisplay,\n          value: obj.id,\n        };\n      });\n    },\n\n    hideSensitiveData() {\n      return this.$store.getters['prefs/get'](HIDE_SENSITIVE);\n    },\n\n    dataLabel() {\n      switch (this.value._type) {\n      case TYPES.TLS:\n        return this.t('secret.certificate.certificate');\n      case TYPES.SSH:\n        return this.t('secret.ssh.keys');\n      case TYPES.BASIC:\n        return this.t('secret.authentication');\n      default:\n        return this.t('secret.data');\n      }\n    },\n\n    doneRoute() {\n      if ( this.$store.getters['currentProduct'].name === MANAGER ) {\n        return 'c-cluster-manager-secret';\n      } else {\n        return 'c-cluster-product-resource';\n      }\n    },\n  },\n\n  methods: {\n    async saveSecret(btnCb) {\n      if ( this.errors ) {\n        clear(this.errors);\n      }\n\n      if ( typeof this.$refs.cloudComponent?.test === 'function' ) {\n        try {\n          const res = await this.$refs.cloudComponent.test();\n\n          if ( !res || res?.errors) {\n            if (res?.errors) {\n              this.errors = res.errors;\n            } else {\n              this.errors = ['Authentication test failed, please check your credentials'];\n            }\n            btnCb(false);\n\n            return;\n          }\n        } catch (e) {\n          this.errors = [e];\n          btnCb(false);\n\n          return;\n        }\n      }\n\n      return this.save(btnCb);\n    },\n\n    selectType(type) {\n      let driver;\n\n      if ( this.isCloud ) {\n        if ( type === TYPES.CLOUD_CREDENTIAL ) {\n          // Clone goes through here\n          driver = this.driverName;\n        } else {\n          driver = type;\n          type = TYPES.CLOUD_CREDENTIAL;\n        }\n\n        if ( this.mode === _CREATE ) {\n          this.value.setAnnotation(CAPI.CREDENTIAL_DRIVER, driver);\n        }\n      }\n\n      this.$set(this.value, '_type', type);\n      this.$emit('set-subtype', this.typeDisplay(type, driver));\n\n      this.secretType = type;\n\n      if (this.mode === _CREATE && type === 'custom') {\n        this.$set(this.value, '_type', '');\n      }\n    },\n\n    typeDisplay(type, driver) {\n      if ( type === CAPI.CREDENTIAL_DRIVER ) {\n        return this.$store.getters['i18n/withFallback'](`cluster.provider.\"${ driver }\"`, null, driver);\n      } else {\n        const fallback = type.replace(/^kubernetes.io\\//, '');\n\n        return this.$store.getters['i18n/withFallback'](`secret.types.\"${ type }\"`, null, fallback);\n      }\n    },\n\n    initialDisplayFor(type) {\n      const fallback = (ucFirst(this.typeDisplay(type) || '').replace(/[^A-Z]/g, '') || type).substr(0, 3);\n\n      return this.$store.getters['i18n/withFallback'](`secret.initials.\"${ type }\"`, null, fallback);\n    },\n\n    selectCustomType(type) {\n      if (type !== 'custom') {\n        this.$set(this.value, '_type', type);\n      }\n    }\n  },\n};\n</script>\n\n<template>\n  <form class=\"filled-height\">\n    <Loading v-if=\"$fetchState.pending\" />\n    <CruResource\n      v-else\n      :mode=\"mode\"\n      :validation-passed=\"true\"\n      :selected-subtype=\"value._type\"\n      :resource=\"value\"\n      :errors=\"errors\"\n      :done-route=\"doneRoute\"\n      :subtypes=\"secretSubTypes\"\n      @finish=\"saveSecret\"\n      @select-type=\"selectType\"\n      @error=\"e=>errors = e\"\n    >\n      <NameNsDescription\n        v-model=\"value\"\n        :mode=\"mode\"\n        :namespaced=\"!isCloud\"\n      />\n\n      <div\n        v-if=\"isCustomSecretCreate\"\n        class=\"row\"\n      >\n        <div class=\"col span-3\">\n          <LabeledSelect\n            v-model=\"secretType\"\n            :options=\"secretTypes\"\n            :searchable=\"false\"\n            :mode=\"mode\"\n            :multiple=\"false\"\n            :reduce=\"(e) => e.value\"\n            label-key=\"secret.type\"\n            required\n            @input=\"selectCustomType\"\n          />\n        </div>\n\n        <div class=\"col span-3\">\n          <LabeledInput\n            v-if=\"showCustomSecretType\"\n            ref=\"customType\"\n            v-model=\"value._type\"\n            v-focus\n            label-key=\"secret.customType\"\n            :mode=\"mode\"\n            required\n          />\n        </div>\n      </div>\n\n      <div class=\"spacer\" />\n      <component\n        :is=\"cloudComponent\"\n        v-if=\"isCloud\"\n        ref=\"cloudComponent\"\n        :driver-name=\"driverName\"\n        :value=\"value\"\n        :mode=\"mode\"\n        :hide-sensitive-data=\"hideSensitiveData\"\n      />\n      <Tabbed\n        v-else\n        :side-tabs=\"true\"\n        default-tab=\"data\"\n      >\n        <Tab\n          name=\"data\"\n          :label=\"dataLabel\"\n          :weight=\"99\"\n        >\n          <component\n            :is=\"dataComponent\"\n            :value=\"value\"\n            :mode=\"mode\"\n            :hide-sensitive-data=\"hideSensitiveData\"\n          />\n        </Tab>\n        <Tab\n          name=\"labels\"\n          label-key=\"generic.labelsAndAnnotations\"\n          :weight=\"-1\"\n        >\n          <Labels\n            v-model=\"value\"\n            :mode=\"mode\"\n          />\n        </Tab>\n      </Tabbed>\n    </CruResource>\n  </form>\n</template>\n\n<style lang='scss'>\n</style>\n"]}]}