{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/secret/registry.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/secret/registry.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKaW1wb3J0IHsgUmFkaW9Hcm91cCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vUmFkaW8nOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgTGFiZWxlZElucHV0LCBSYWRpb0dyb3VwIH0sCgogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiAgICAgT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCgogICAgbW9kZTogewogICAgICB0eXBlOiAgICAgU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgbGV0IHJlZ2lzdHJ5UHJvdmlkZXIgPSAnQ3VzdG9tJzsKCiAgICBsZXQgYXV0aHM7CgogICAgdHJ5IHsKICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZSh0aGlzLnZhbHVlLmRlY29kZWREYXRhWycuZG9ja2VyY29uZmlnanNvbiddKTsKCiAgICAgIGF1dGhzID0gcGFyc2VkLmF1dGhzOwogICAgfSBjYXRjaCAoZSkge30KCiAgICBhdXRocyA9IGF1dGhzIHx8IHt9OwoKICAgIGNvbnN0IHJlZ2lzdHJ5VXJsID0gT2JqZWN0LmtleXMoYXV0aHMpWzBdIHx8ICcnOwoKICAgIGlmIChyZWdpc3RyeVVybCA9PT0gJ2luZGV4LmRvY2tlci5pby92MS8nKSB7CiAgICAgIHJlZ2lzdHJ5UHJvdmlkZXIgPSAnRG9ja2VySHViJzsKICAgIH0gZWxzZSBpZiAocmVnaXN0cnlVcmwgPT09ICdxdWF5LmlvJykgewogICAgICByZWdpc3RyeVByb3ZpZGVyID0gJ1F1YXkuaW8nOwogICAgfSBlbHNlIGlmIChyZWdpc3RyeVVybC5pbmNsdWRlcygnYXJ0aWZhY3RvcnknKSkgewogICAgICByZWdpc3RyeVByb3ZpZGVyID0gJ0FydGlmYWN0b3J5JzsKICAgIH0KCiAgICBjb25zdCB1c2VybmFtZSA9IGF1dGhzW3JlZ2lzdHJ5VXJsXT8udXNlcm5hbWUgfHwgJyc7CiAgICBjb25zdCBwYXNzd29yZCA9IGF1dGhzW3JlZ2lzdHJ5VXJsXT8ucGFzc3dvcmQgfHwgJyc7CgogICAgcmV0dXJuIHsKICAgICAgcmVnaXN0cnlQcm92aWRlciwKICAgICAgdXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkLAogICAgICByZWdpc3RyeVVybCwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHJlZ2lzdHJ5QWRkcmVzc2VzKCkgewogICAgICByZXR1cm4gWydDdXN0b20nLCAnRG9ja2VySHViJywgJ1F1YXkuaW8nLCAnQXJ0aWZhY3RvcnknXTsKICAgIH0sCgogICAgbmVlZHNEb2NrZXJTZXJ2ZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLnJlZ2lzdHJ5UHJvdmlkZXIgPT09ICdBcnRpZmFjdG9yeScgfHwgdGhpcy5yZWdpc3RyeVByb3ZpZGVyID09PSAnQ3VzdG9tJzsKICAgIH0sCgogICAgZG9ja2VyY29uZmlnanNvbigpIHsKICAgICAgbGV0IGRvY2tlclNlcnZlciA9IHRoaXMucmVnaXN0cnlQcm92aWRlciA9PT0gJ0RvY2tlckh1YicgPyAnaW5kZXguZG9ja2VyLmlvL3YxLycgOiAncXVheS5pbyc7CgogICAgICBpZiAodGhpcy5uZWVkc0RvY2tlclNlcnZlcikgewogICAgICAgIGRvY2tlclNlcnZlciA9IHRoaXMucmVnaXN0cnlVcmw7CiAgICAgIH0KCiAgICAgIGlmIChkb2NrZXJTZXJ2ZXIpIHsKICAgICAgICBjb25zdCBjb25maWcgPSB7CiAgICAgICAgICBhdXRoczogewogICAgICAgICAgICBbZG9ja2VyU2VydmVyXTogewogICAgICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXJuYW1lLAogICAgICAgICAgICAgIHBhc3N3b3JkOiB0aGlzLnBhc3N3b3JkLAogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICBjb25zdCBqc29uID0gSlNPTi5zdHJpbmdpZnkoY29uZmlnKTsKCiAgICAgICAgcmV0dXJuIGpzb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgfSwKCiAgd2F0Y2g6IHsKICAgIHJlZ2lzdHJ5UHJvdmlkZXI6ICd1cGRhdGUnLAogICAgcmVnaXN0cnlVcmw6ICAgICAgJ3VwZGF0ZScsCiAgICB1c2VybmFtZTogICAgICAgICAndXBkYXRlJywKICAgIHBhc3N3b3JkOiAgICAgICAgICd1cGRhdGUnLAogIH0sCgogIG1ldGhvZHM6IHsKICAgIHVwZGF0ZSgpIHsKICAgICAgdGhpcy52YWx1ZS5zZXREYXRhKCcuZG9ja2VyY29uZmlnanNvbicsIHRoaXMuZG9ja2VyY29uZmlnanNvbik7CiAgICB9LAogIH0KfTsK"},{"version":3,"sources":["registry.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"registry.vue","sourceRoot":"node_modules/@rancher/shell/edit/secret","sourcesContent":["<script>\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport { RadioGroup } from '@components/Form/Radio';\n\nexport default {\n  components: { LabeledInput, RadioGroup },\n\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n\n    mode: {\n      type:     String,\n      required: true,\n    }\n  },\n\n  data() {\n    let registryProvider = 'Custom';\n\n    let auths;\n\n    try {\n      const parsed = JSON.parse(this.value.decodedData['.dockerconfigjson']);\n\n      auths = parsed.auths;\n    } catch (e) {}\n\n    auths = auths || {};\n\n    const registryUrl = Object.keys(auths)[0] || '';\n\n    if (registryUrl === 'index.docker.io/v1/') {\n      registryProvider = 'DockerHub';\n    } else if (registryUrl === 'quay.io') {\n      registryProvider = 'Quay.io';\n    } else if (registryUrl.includes('artifactory')) {\n      registryProvider = 'Artifactory';\n    }\n\n    const username = auths[registryUrl]?.username || '';\n    const password = auths[registryUrl]?.password || '';\n\n    return {\n      registryProvider,\n      username,\n      password,\n      registryUrl,\n    };\n  },\n\n  computed: {\n    registryAddresses() {\n      return ['Custom', 'DockerHub', 'Quay.io', 'Artifactory'];\n    },\n\n    needsDockerServer() {\n      return this.registryProvider === 'Artifactory' || this.registryProvider === 'Custom';\n    },\n\n    dockerconfigjson() {\n      let dockerServer = this.registryProvider === 'DockerHub' ? 'index.docker.io/v1/' : 'quay.io';\n\n      if (this.needsDockerServer) {\n        dockerServer = this.registryUrl;\n      }\n\n      if (dockerServer) {\n        const config = {\n          auths: {\n            [dockerServer]: {\n              username: this.username,\n              password: this.password,\n            }\n          }\n        };\n        const json = JSON.stringify(config);\n\n        return json;\n      } else {\n        return null;\n      }\n    },\n  },\n\n  watch: {\n    registryProvider: 'update',\n    registryUrl:      'update',\n    username:         'update',\n    password:         'update',\n  },\n\n  methods: {\n    update() {\n      this.value.setData('.dockerconfigjson', this.dockerconfigjson);\n    },\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"row mb-10\">\n      <div class=\"col span-12\">\n        <RadioGroup\n          v-model=\"registryProvider\"\n          name=\"registryProvider\"\n          :mode=\"mode\"\n          :options=\"registryAddresses\"\n        />\n      </div>\n    </div>\n    <div\n      v-if=\"needsDockerServer\"\n      class=\"row mb-20\"\n    >\n      <LabeledInput\n        v-model=\"registryUrl\"\n        required\n        :label=\"t('secret.registry.domainName')\"\n        placeholder=\"e.g. index.docker.io\"\n        :mode=\"mode\"\n      />\n    </div>\n    <div class=\"row mb-20\">\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"username\"\n          :label=\"t('secret.registry.username')\"\n          :mode=\"mode\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledInput\n          v-model=\"password\"\n          :label=\"t('secret.registry.password')\"\n          :mode=\"mode\"\n          type=\"password\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n"]}]}