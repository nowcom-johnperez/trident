{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/LandingPagePreference.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/LandingPagePreference.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcFByZWYsIEFGVEVSX0xPR0lOX1JPVVRFIH0gZnJvbSAnQHNoZWxsL3N0b3JlL3ByZWZzJzsKaW1wb3J0IHsgbWFwRmVhdHVyZSwgTVVMVElfQ0xVU1RFUiB9IGZyb20gJ0BzaGVsbC9zdG9yZS9mZWF0dXJlcyc7CmltcG9ydCB7IFJhZGlvR3JvdXAsIFJhZGlvQnV0dG9uIH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9SYWRpbyc7CgppbXBvcnQgU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vU2VsZWN0JzsKaW1wb3J0IHsgTUFOQUdFTUVOVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBmaWx0ZXJIaWRkZW5Mb2NhbENsdXN0ZXIsIGZpbHRlck9ubHlLdWJlcm5ldGVzQ2x1c3RlcnMgfSBmcm9tICdAc2hlbGwvdXRpbHMvY2x1c3Rlcic7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgUmFkaW9Hcm91cCwKICAgIFJhZGlvQnV0dG9uLAogICAgU2VsZWN0LAogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgdGhpcy5jbHVzdGVycyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7CiAgICAgIHR5cGU6IE1BTkFHRU1FTlQuQ0xVU1RFUiwKICAgICAgb3B0OiAgeyB1cmw6IE1BTkFHRU1FTlQuQ0xVU1RFUiB9CiAgICB9KTsKICB9LAoKICBkYXRhKCkgewogICAgLy8gU3RvcmUgdGhlIHJvdXRlIGFzIGl0IHdhcyBvbiBwYWdlIGxvYWQgKGJlZm9yZSB0aGUgdXNlciBtYXkgaGF2ZSBjaGFuZ2VkIGl0KQogICAgY29uc3QgY3VzdG9tUm91dGUgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwcmVmcy9nZXQnXShBRlRFUl9MT0dJTl9ST1VURSk7CgogICAgcmV0dXJuIHsgY2x1c3RlcnM6IFtdLCBjdXN0b21Sb3V0ZSB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBhZnRlckxvZ2luUm91dGU6IG1hcFByZWYoQUZURVJfTE9HSU5fUk9VVEUpLAogICAgbWNtOiAgICAgICAgICAgICBtYXBGZWF0dXJlKE1VTFRJX0NMVVNURVIpLAoKICAgIHJvdXRlRnJvbURyb3Bkb3duOiB7CiAgICAgIGdldCgpIHsKICAgICAgICBjb25zdCByb3V0ZSA9IHRoaXMuY3VzdG9tUm91dGUgfHwge307CiAgICAgICAgY29uc3Qgb3V0ID0gdGhpcy5yb3V0ZURyb3Bkb3duT3B0aW9ucy5maW5kKChvcHQpID0+IG9wdC52YWx1ZS5uYW1lID09PSByb3V0ZS5uYW1lICYmIG9wdC52YWx1ZS5wYXJhbXM/LmNsdXN0ZXIgPT09IHJvdXRlLnBhcmFtcz8uY2x1c3Rlcik7CgogICAgICAgIHJldHVybiBvdXQgfHwgdGhpcy5yb3V0ZURyb3Bkb3duT3B0aW9uc1swXTsKICAgICAgfSwKICAgICAgc2V0KG5ldSkgewogICAgICAgIHRoaXMuY3VzdG9tUm91dGUgPSBuZXU7CiAgICAgICAgdGhpcy5hZnRlckxvZ2luUm91dGUgPSBuZXU7CiAgICAgIH0KICAgIH0sCgogICAgcm91dGVSYWRpb09wdGlvbnMoKSB7CiAgICAgIGNvbnN0IG9wdGlvbnMgPSBbCiAgICAgICAgewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbGFuZGluZy5sYW5kaW5nUHJlZnMub3B0aW9ucy5ob21lUGFnZScpLAogICAgICAgICAgdmFsdWU6ICdob21lJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbGFuZGluZy5sYW5kaW5nUHJlZnMub3B0aW9ucy5sYXN0VmlzaXRlZCcpLAogICAgICAgICAgdmFsdWU6ICdsYXN0LXZpc2l0ZWQnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdsYW5kaW5nLmxhbmRpbmdQcmVmcy5vcHRpb25zLmN1c3RvbScpLAogICAgICAgICAgdmFsdWU6ICdkcm9wZG93bicKICAgICAgICB9CiAgICAgIF07CgogICAgICAvLyBSZW1vdmUgdGhlIGxhc3Qgb3B0aW9uIGlmIG5vdCBtdWx0aS1jbHVzdGVyCiAgICAgIGlmICghdGhpcy5tY20pIHsKICAgICAgICBvcHRpb25zLnBvcCgpOwogICAgICB9CgogICAgICByZXR1cm4gb3B0aW9uczsKICAgIH0sCgogICAgcm91dGVEcm9wZG93bk9wdGlvbnMoKSB7CiAgICAgIC8vIERyb3AtZG93biBzaG93cyBsaXN0IG9mIGNsdXN0ZXJzIHRoYXQgY2FuIGJlciBzZXQgYXMgbG9naW4gbGFuZGluZyBwYWdlCiAgICAgIGNvbnN0IG91dCA9IFtdOwogICAgICBjb25zdCBrdWJlQ2x1c3RlcnMgPSBmaWx0ZXJIaWRkZW5Mb2NhbENsdXN0ZXIoZmlsdGVyT25seUt1YmVybmV0ZXNDbHVzdGVycyh0aGlzLmNsdXN0ZXJzLCB0aGlzLiRzdG9yZSksIHRoaXMuJHN0b3JlKTsKCiAgICAgIGt1YmVDbHVzdGVycy5mb3JFYWNoKChjKSA9PiB7CiAgICAgICAgaWYgKGMuaXNSZWFkeSkgewogICAgICAgICAgb3V0LnB1c2goewogICAgICAgICAgICBsYWJlbDogYy5uYW1lRGlzcGxheSwKICAgICAgICAgICAgdmFsdWU6IHsKICAgICAgICAgICAgICBuYW1lOiAgICdjLWNsdXN0ZXInLAogICAgICAgICAgICAgIHBhcmFtczogeyBjbHVzdGVyOiBjLmlkIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIG91dC5zb3J0KChhLCBiKSA9PiAoYS5sYWJlbCA+IGIubGFiZWwpID8gMSA6ICgoYi5sYWJlbCA+IGEubGFiZWwpID8gLTEgOiAwKSk7CgogICAgICByZXR1cm4gb3V0OwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHVwZGF0ZUxvZ2luUm91dGUobmV1KSB7CiAgICAgIGlmIChuZXUpIHsKICAgICAgICB0aGlzLmFmdGVyTG9naW5Sb3V0ZSA9IG5ldTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmFmdGVyTG9naW5Sb3V0ZSA9IHRoaXMucm91dGVGcm9tRHJvcGRvd24/LnZhbHVlOwogICAgICB9CiAgICB9LAogIH0KfTsK"},{"version":3,"sources":["LandingPagePreference.vue"],"names":[],"mappings":";AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LandingPagePreference.vue","sourceRoot":"node_modules/@rancher/shell/components","sourcesContent":["<script>\nimport { mapPref, AFTER_LOGIN_ROUTE } from '@shell/store/prefs';\nimport { mapFeature, MULTI_CLUSTER } from '@shell/store/features';\nimport { RadioGroup, RadioButton } from '@components/Form/Radio';\n\nimport Select from '@shell/components/form/Select';\nimport { MANAGEMENT } from '@shell/config/types';\nimport { filterHiddenLocalCluster, filterOnlyKubernetesClusters } from '@shell/utils/cluster';\n\nexport default {\n  components: {\n    RadioGroup,\n    RadioButton,\n    Select,\n  },\n\n  async fetch() {\n    this.clusters = await this.$store.dispatch('management/findAll', {\n      type: MANAGEMENT.CLUSTER,\n      opt:  { url: MANAGEMENT.CLUSTER }\n    });\n  },\n\n  data() {\n    // Store the route as it was on page load (before the user may have changed it)\n    const customRoute = this.$store.getters['prefs/get'](AFTER_LOGIN_ROUTE);\n\n    return { clusters: [], customRoute };\n  },\n\n  computed: {\n    afterLoginRoute: mapPref(AFTER_LOGIN_ROUTE),\n    mcm:             mapFeature(MULTI_CLUSTER),\n\n    routeFromDropdown: {\n      get() {\n        const route = this.customRoute || {};\n        const out = this.routeDropdownOptions.find((opt) => opt.value.name === route.name && opt.value.params?.cluster === route.params?.cluster);\n\n        return out || this.routeDropdownOptions[0];\n      },\n      set(neu) {\n        this.customRoute = neu;\n        this.afterLoginRoute = neu;\n      }\n    },\n\n    routeRadioOptions() {\n      const options = [\n        {\n          label: this.t('landing.landingPrefs.options.homePage'),\n          value: 'home'\n        },\n        {\n          label: this.t('landing.landingPrefs.options.lastVisited'),\n          value: 'last-visited'\n        },\n        {\n          label: this.t('landing.landingPrefs.options.custom'),\n          value: 'dropdown'\n        }\n      ];\n\n      // Remove the last option if not multi-cluster\n      if (!this.mcm) {\n        options.pop();\n      }\n\n      return options;\n    },\n\n    routeDropdownOptions() {\n      // Drop-down shows list of clusters that can ber set as login landing page\n      const out = [];\n      const kubeClusters = filterHiddenLocalCluster(filterOnlyKubernetesClusters(this.clusters, this.$store), this.$store);\n\n      kubeClusters.forEach((c) => {\n        if (c.isReady) {\n          out.push({\n            label: c.nameDisplay,\n            value: {\n              name:   'c-cluster',\n              params: { cluster: c.id }\n            }\n          });\n        }\n      });\n\n      out.sort((a, b) => (a.label > b.label) ? 1 : ((b.label > a.label) ? -1 : 0));\n\n      return out;\n    }\n  },\n\n  methods: {\n    updateLoginRoute(neu) {\n      if (neu) {\n        this.afterLoginRoute = neu;\n      } else {\n        this.afterLoginRoute = this.routeFromDropdown?.value;\n      }\n    },\n  }\n};\n</script>\n\n<template>\n  <div>\n    <p class=\"set-landing-leadin\">\n      {{ t('landing.landingPrefs.body') }}\n    </p>\n    <RadioGroup\n      id=\"login-route\"\n      :value=\"afterLoginRoute\"\n      name=\"login-route\"\n      :options=\"routeRadioOptions\"\n      @input=\"updateLoginRoute\"\n    >\n      <template #2=\"{option, listeners}\">\n        <div class=\"custom-page\">\n          <RadioButton\n            :label=\"option.label\"\n            :val=\"false\"\n            :value=\"afterLoginRoute=== 'home' || afterLoginRoute === 'last-visited'\"\n            v-on=\"listeners\"\n          />\n          <Select\n            v-model=\"routeFromDropdown\"\n            :searchable=\"true\"\n            :disabled=\"afterLoginRoute === 'home' || afterLoginRoute === 'last-visited'\"\n            :clearable=\"false\"\n            :options=\"routeDropdownOptions\"\n            class=\"custom-page-options\"\n          />\n        </div>\n      </template>\n    </RadioGroup>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  .custom-page {\n    .custom-page-options {\n      margin: 5px 0 0 20px;\n      min-width: 320px;\n      width: fit-content;\n    }\n  }\n  .set-landing-leadin {\n    padding-bottom: 10px;\n  }\n</style>\n"]}]}