{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/secret.vue?vue&type=style&index=0&id=30b8c6b8&lang=scss&scoped=true","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/secret.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1716430467357},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/postcss-loader/src/index.js","mtime":1716430467882},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/sass-loader/dist/cjs.js","mtime":1716430453705},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5lbnRyeSB7CiAgbWFyZ2luLXRvcDogMTBweDsKCiAgJjpmaXJzdC1vZi10eXBlIHsKICAgIG1hcmdpbi10b3A6IDA7CiAgfQp9Cg=="},{"version":3,"sources":["secret.vue"],"names":[],"mappings":";AA8RA;AACA;;AAEA;AACA;AACA;AACA","file":"secret.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\nimport { base64Decode } from '@shell/utils/crypto';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport DetailText from '@shell/components/DetailText';\nimport Tab from '@shell/components/Tabbed/Tab';\n\nconst types = [\n  TYPES.OPAQUE,\n  TYPES.DOCKER_JSON,\n  TYPES.TLS,\n  TYPES.SSH,\n  TYPES.BASIC,\n];\nconst registryAddresses = [\n  'DockerHub', 'Quay.io', 'Artifactory', 'Custom'\n];\n\nexport default {\n  components: {\n    ResourceTabs,\n    DetailText,\n    Tab,\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  data() {\n    let username;\n    let password;\n    let registryUrl;\n    let registryProvider = 'Custom';\n    let key;\n    let crt;\n\n    if (this.value._type === TYPES.DOCKER_JSON) {\n      const json = base64Decode(this.value.data['.dockerconfigjson']);\n\n      const { auths } = JSON.parse(json);\n\n      registryUrl = Object.keys(auths)[0];\n\n      if (registryUrl === 'index.docker.io/v1/') {\n        registryProvider = 'DockerHub';\n      } else if (registryUrl === 'quay.io') {\n        registryProvider = 'Quay.io';\n      } else if (registryUrl.includes('artifactory')) {\n        registryProvider = 'Artifactory';\n      }\n\n      username = auths[registryUrl].username;\n      password = auths[registryUrl].password;\n    }\n\n    const data = this.value?.data || {};\n\n    if (this.value._type === TYPES.TLS) {\n      // do not show existing key when editing\n      key = this.mode === 'edit' ? '' : base64Decode(data['tls.key']);\n\n      crt = base64Decode(data['tls.crt']);\n    }\n\n    if (this.value._type === TYPES.SERVICE_ACCT) {\n      key = base64Decode(data['token']);\n      crt = base64Decode(data['ca.crt']);\n    }\n\n    if ( this.value._type === TYPES.BASIC ) {\n      username = base64Decode(data.username || '');\n      password = base64Decode(data.password || '');\n    }\n\n    if ( this.value._type === TYPES.SSH ) {\n      username = base64Decode(data['ssh-publickey'] || '');\n      password = base64Decode(data['ssh-privatekey'] || '');\n    }\n\n    if (!this.value._type) {\n      this.$set(this.value, '_type', TYPES.OPAQUE);\n    }\n\n    return {\n      types,\n      registryAddresses,\n      registryProvider,\n      username,\n      password,\n      registryUrl,\n      key,\n      crt,\n      relatedServices: [],\n    };\n  },\n\n  computed: {\n    isCertificate() {\n      return this.value._type === TYPES.TLS;\n    },\n\n    isSvcAcctToken() {\n      return this.value._type === TYPES.SERVICE_ACCT;\n    },\n\n    isRegistry() {\n      return this.value._type === TYPES.DOCKER_JSON;\n    },\n\n    isSsh() {\n      return this.value._type === TYPES.SSH;\n    },\n\n    isBasicAuth() {\n      return this.value._type === TYPES.BASIC;\n    },\n\n    parsedRows() {\n      const rows = [];\n      const { data = {} } = this.value;\n\n      Object.keys(data).forEach((key) => {\n        const value = base64Decode(data[key]);\n\n        rows.push({\n          key,\n          value\n        });\n      });\n\n      return rows;\n    },\n\n    dataLabel() {\n      switch (this.value._type) {\n      case TYPES.TLS:\n        return this.t('secret.certificate.certificate');\n      case TYPES.SSH:\n        return this.t('secret.ssh.keys');\n      case TYPES.BASIC:\n        return this.t('secret.authentication');\n      default:\n        return this.t('secret.data');\n      }\n    }\n  },\n};\n</script>\n\n<template>\n  <ResourceTabs\n    v-model=\"value\"\n    :mode=\"mode\"\n  >\n    <Tab\n      name=\"data\"\n      :label=\"dataLabel\"\n    >\n      <template v-if=\"isRegistry || isBasicAuth\">\n        <div\n          v-if=\"isRegistry\"\n          class=\"row\"\n        >\n          <div class=\"col span-12\">\n            <DetailText\n              :value=\"registryUrl\"\n              label-key=\"secret.registry.domainName\"\n            />\n          </div>\n        </div>\n        <div class=\"row mt-20\">\n          <div class=\"col span-6\">\n            <DetailText\n              :value=\"username\"\n              label-key=\"secret.registry.username\"\n            />\n          </div>\n          <div class=\"col span-6\">\n            <DetailText\n              :value=\"password\"\n              label-key=\"secret.registry.password\"\n              :conceal=\"true\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <div\n        v-else-if=\"isCertificate\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"key\"\n            label-key=\"secret.certificate.privateKey\"\n            :conceal=\"true\"\n          />\n        </div>\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"crt\"\n            label-key=\"secret.certificate.certificate\"\n          />\n        </div>\n      </div>\n\n      <div\n        v-else-if=\"isSvcAcctToken\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"crt\"\n            label-key=\"secret.serviceAcct.ca\"\n          />\n        </div>\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"key\"\n            label-key=\"secret.serviceAcct.token\"\n            :conceal=\"true\"\n          />\n        </div>\n      </div>\n\n      <div\n        v-else-if=\"isSsh\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"username\"\n            label-key=\"secret.ssh.public\"\n          />\n        </div>\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"password\"\n            label-key=\"secret.ssh.private\"\n            :conceal=\"true\"\n          />\n        </div>\n      </div>\n\n      <div v-else>\n        <div\n          v-for=\"(row,idx) in parsedRows\"\n          :key=\"idx\"\n          class=\"entry\"\n        >\n          <DetailText\n            :value=\"row.value\"\n            :label=\"row.key\"\n            :conceal=\"true\"\n          />\n        </div>\n        <div v-if=\"!parsedRows.length\">\n          <div\n            v-t=\"'sortableTable.noRows'\"\n            class=\"m-20 text-center\"\n          />\n        </div>\n      </div>\n    </Tab>\n  </ResourceTabs>\n</template>\n\n<style lang=\"scss\" scoped>\n  .entry {\n    margin-top: 10px;\n\n    &:first-of-type {\n      margin-top: 0;\n    }\n  }\n</style>\n"]}]}