{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/machine-config/pnap.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/machine-config/pnap.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IE5PUk1BTiB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBleGNlcHRpb25Ub0Vycm9yc0FycmF5LCBzdHJpbmdpZnkgfSBmcm9tICdAc2hlbGwvdXRpbHMvZXJyb3InOwppbXBvcnQgeyBfQ1JFQVRFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCB7IEJhbm5lciB9IGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lcic7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBMb2FkaW5nLAogICAgQmFubmVyLAogICAgTGFiZWxlZFNlbGVjdCwKICAgIExhYmVsZWRJbnB1dCwKICB9LAoKICBtaXhpbnM6IFtDcmVhdGVFZGl0Vmlld10sCgogIHByb3BzOiB7CiAgICBjcmVkZW50aWFsSWQ6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAogICAgZGlzYWJsZWQ6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICB9LAogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgdGhpcy5lcnJvcnMgPSBbXTsKCiAgICB0cnkgewogICAgICBpZiAodGhpcy5jcmVkZW50aWFsSWQpIHsKICAgICAgICB0aGlzLmNyZWRlbnRpYWwgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9maW5kJywgewogICAgICAgICAgdHlwZTogTk9STUFOLkNMT1VEX0NSRURFTlRJQUwsCiAgICAgICAgICBpZDogICB0aGlzLmNyZWRlbnRpYWxJZCwKICAgICAgICB9KTsKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZSwgJ2NsaWVudElkZW50aWZpZXInLCB0aGlzLmNyZWRlbnRpYWwuZGVjb2RlZERhdGEuY2xpZW50SWRlbnRpZmllcik7CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgdGhpcy5jcmVkZW50aWFsID0gbnVsbDsKICAgIH0KCiAgICB0cnkgewogICAgICB0aGlzLmFsbFByb2R1Y3RzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3BuYXAvYWxsUHJvZHVjdHMnLCB7IGNyZWRlbnRpYWxJZDogdGhpcy5jcmVkZW50aWFsSWQgfSk7CgogICAgICB0aGlzLm9zQ2hvaWNlcyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdwbmFwL29zQ2hvaWNlcycsIHsgY3JlZGVudGlhbElkOiB0aGlzLmNyZWRlbnRpYWxJZCB9KTsKCiAgICAgIGNvbnN0IHNlcnZlck9zID0gdGhpcy5vc0Nob2ljZXNbMF0udmFsdWU7CgogICAgICBpZiAoIXRoaXMudmFsdWUuc2VydmVyT3MpIHsKICAgICAgICB0aGlzLnZhbHVlLnNlcnZlck9zID0gc2VydmVyT3M7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLnZhbHVlLnNlcnZlckxvY2F0aW9uKSB7CiAgICAgICAgdGhpcy52YWx1ZS5zZXJ2ZXJMb2NhdGlvbiA9ICdQSFgnOwogICAgICB9CiAgICAgIGlmICghdGhpcy52YWx1ZS5zZXJ2ZXJUeXBlKSB7CiAgICAgICAgdGhpcy52YWx1ZS5zZXJ2ZXJUeXBlID0gJ3MxLmMxLm1lZGl1bSc7CiAgICAgIH0KICAgICAgdGhpcy51cGRhdGVJbnRlcmZhY2VzKCk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHRoaXMuZXJyb3JzID0gZXhjZXB0aW9uVG9FcnJvcnNBcnJheShlKTsKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY3JlZGVudGlhbDogIG51bGwsCiAgICAgIGFsbFByb2R1Y3RzOiBudWxsLAogICAgICBvc0Nob2ljZXM6ICAgbnVsbCwKICAgIH07CiAgfSwKCiAgd2F0Y2g6IHsKICAgICdjcmVkZW50aWFsSWQnKCkgewogICAgICB0aGlzLiRmZXRjaCgpOwogICAgfSwKICB9LAoKICBjb21wdXRlZDogewogICAgaXNDcmVhdGUoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9DUkVBVEU7CiAgICB9LAogICAgbG9jYXRpb25DaG9pY2VzKCkgewogICAgICBjb25zdCBwcm9kdWN0cyA9IHRoaXMuYWxsUHJvZHVjdHM7CiAgICAgIGNvbnN0IHJlc3VsdCA9IFtdOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocHJvZHVjdHMpKSB7CiAgICAgICAgY29uc3QgbWFwID0gbmV3IE1hcCgpOwoKICAgICAgICBmb3IgKGNvbnN0IHByb2Qgb2YgcHJvZHVjdHMpIHsKICAgICAgICAgIGZvciAoY29uc3QgcGxhbiBvZiBwcm9kLnBsYW5zKSB7CiAgICAgICAgICAgIGlmICghbWFwLmhhcyhwbGFuLmxvY2F0aW9uKSkgewogICAgICAgICAgICAgIG1hcC5zZXQocGxhbi5sb2NhdGlvbiwgdHJ1ZSk7CiAgICAgICAgICAgICAgcmVzdWx0LnB1c2goeyB2YWx1ZTogcGxhbi5sb2NhdGlvbiwgbGFiZWw6IHBsYW4ubG9jYXRpb24gfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmVzdWx0LnB1c2goeyB2YWx1ZTogcHJvZHVjdHMubWVzc2FnZSB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICB0eXBlQ2hvaWNlcygpIHsKICAgICAgY29uc3QgcHJvZHVjdHMgPSB0aGlzLmFsbFByb2R1Y3RzOwogICAgICBjb25zdCByZXN1bHQgPSBbXTsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHByb2R1Y3RzKSkgewogICAgICAgIGNvbnN0IG1hcCA9IG5ldyBNYXAoKTsKICAgICAgICBjb25zdCBzZXJ2ZXJMb2NhdGlvbiA9IHRoaXMudmFsdWUuc2VydmVyTG9jYXRpb247CgogICAgICAgIGZvciAoY29uc3QgcHJvZCBvZiBwcm9kdWN0cykgewogICAgICAgICAgZm9yIChjb25zdCBwbGFuIG9mIHByb2QucGxhbnMpIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICFtYXAuaGFzKHByb2QucHJvZHVjdENvZGUpICYmCiAgICAgICAgICAgICAgcGxhbi5sb2NhdGlvbiA9PT0gc2VydmVyTG9jYXRpb24KICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgbWFwLnNldChwcm9kLnByb2R1Y3RDb2RlLCB0cnVlKTsKICAgICAgICAgICAgICByZXN1bHQucHVzaCh7CiAgICAgICAgICAgICAgICB2YWx1ZTogcHJvZC5wcm9kdWN0Q29kZSwKICAgICAgICAgICAgICAgIGxhYmVsOiBgJHsgcHJvZC5wcm9kdWN0Q29kZSB9IC0gJCR7IHBsYW4ucHJpY2UgfS9ob3VyYCwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoIW1hcC5oYXModGhpcy52YWx1ZS5zZXJ2ZXJUeXBlKSAmJiBwcm9kdWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLnByZXNlbGVjdEZpcnN0KHJlc3VsdFswXS52YWx1ZSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdC5wdXNoKHsgdmFsdWU6IHByb2R1Y3RzLm1lc3NhZ2UgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9LAogICAgdHlwZSgpIHsKICAgICAgY29uc3QgcHJvZHVjdHMgPSB0aGlzLmFsbFByb2R1Y3RzOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkocHJvZHVjdHMpKSB7CiAgICAgICAgY29uc3Qgc2VydmVyTG9jYXRpb24gPSB0aGlzLnZhbHVlLnNlcnZlckxvY2F0aW9uOwogICAgICAgIGNvbnN0IHNlcnZlclR5cGUgPSB0aGlzLnZhbHVlLnNlcnZlclR5cGU7CgogICAgICAgIGZvciAoY29uc3QgcHJvZCBvZiBwcm9kdWN0cykgewogICAgICAgICAgZm9yIChjb25zdCBwbGFuIG9mIHByb2QucGxhbnMpIHsKICAgICAgICAgICAgaWYgKHByb2QucHJvZHVjdENvZGUgPT09IHNlcnZlclR5cGUgJiYgcGxhbi5sb2NhdGlvbiA9PT0gc2VydmVyTG9jYXRpb24pIHsKICAgICAgICAgICAgICByZXR1cm4gcHJvZDsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHByb2R1Y3RzLm1lc3NhZ2U7CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIHN0cmluZ2lmeSwKCiAgICB1cGRhdGVJbnRlcmZhY2VzKCkgewogICAgICBpZiAoIXRoaXMudmFsdWUuaW50ZXJmYWNlcykgewogICAgICAgIHRoaXMudmFsdWUuaW50ZXJmYWNlcyA9IFtdOwogICAgICB9CiAgICB9LAoKICAgIHByZXNlbGVjdEZpcnN0KHZhbCkgewogICAgICB0aGlzLnZhbHVlLnNlcnZlclR5cGUgPSB2YWw7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["pnap.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"pnap.vue","sourceRoot":"node_modules/@rancher/shell/machine-config","sourcesContent":["<script>\nimport { NORMAN } from '@shell/config/types';\nimport { exceptionToErrorsArray, stringify } from '@shell/utils/error';\nimport { _CREATE } from '@shell/config/query-params';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport Loading from '@shell/components/Loading';\nimport { Banner } from '@components/Banner';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\n\nexport default {\n  components: {\n    Loading,\n    Banner,\n    LabeledSelect,\n    LabeledInput,\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    credentialId: {\n      type:     String,\n      required: true,\n    },\n    disabled: {\n      type:    Boolean,\n      default: false,\n    },\n  },\n\n  async fetch() {\n    this.errors = [];\n\n    try {\n      if (this.credentialId) {\n        this.credential = await this.$store.dispatch('rancher/find', {\n          type: NORMAN.CLOUD_CREDENTIAL,\n          id:   this.credentialId,\n        });\n        this.$set(this.value, 'clientIdentifier', this.credential.decodedData.clientIdentifier);\n      }\n    } catch (e) {\n      this.credential = null;\n    }\n\n    try {\n      this.allProducts = await this.$store.dispatch('pnap/allProducts', { credentialId: this.credentialId });\n\n      this.osChoices = await this.$store.dispatch('pnap/osChoices', { credentialId: this.credentialId });\n\n      const serverOs = this.osChoices[0].value;\n\n      if (!this.value.serverOs) {\n        this.value.serverOs = serverOs;\n      }\n      if (!this.value.serverLocation) {\n        this.value.serverLocation = 'PHX';\n      }\n      if (!this.value.serverType) {\n        this.value.serverType = 's1.c1.medium';\n      }\n      this.updateInterfaces();\n    } catch (e) {\n      this.errors = exceptionToErrorsArray(e);\n    }\n  },\n\n  data() {\n    return {\n      credential:  null,\n      allProducts: null,\n      osChoices:   null,\n    };\n  },\n\n  watch: {\n    'credentialId'() {\n      this.$fetch();\n    },\n  },\n\n  computed: {\n    isCreate() {\n      return this.mode === _CREATE;\n    },\n    locationChoices() {\n      const products = this.allProducts;\n      const result = [];\n\n      if (Array.isArray(products)) {\n        const map = new Map();\n\n        for (const prod of products) {\n          for (const plan of prod.plans) {\n            if (!map.has(plan.location)) {\n              map.set(plan.location, true);\n              result.push({ value: plan.location, label: plan.location });\n            }\n          }\n        }\n      } else {\n        result.push({ value: products.message });\n      }\n\n      return result;\n    },\n    typeChoices() {\n      const products = this.allProducts;\n      const result = [];\n\n      if (Array.isArray(products)) {\n        const map = new Map();\n        const serverLocation = this.value.serverLocation;\n\n        for (const prod of products) {\n          for (const plan of prod.plans) {\n            if (\n              !map.has(prod.productCode) &&\n              plan.location === serverLocation\n            ) {\n              map.set(prod.productCode, true);\n              result.push({\n                value: prod.productCode,\n                label: `${ prod.productCode } - $${ plan.price }/hour`,\n              });\n            }\n          }\n        }\n        if (!map.has(this.value.serverType) && products.length > 0) {\n          this.preselectFirst(result[0].value);\n        }\n      } else {\n        result.push({ value: products.message });\n      }\n\n      return result;\n    },\n    type() {\n      const products = this.allProducts;\n\n      if (Array.isArray(products)) {\n        const serverLocation = this.value.serverLocation;\n        const serverType = this.value.serverType;\n\n        for (const prod of products) {\n          for (const plan of prod.plans) {\n            if (prod.productCode === serverType && plan.location === serverLocation) {\n              return prod;\n            }\n          }\n        }\n      }\n\n      return products.message;\n    },\n  },\n\n  methods: {\n    stringify,\n\n    updateInterfaces() {\n      if (!this.value.interfaces) {\n        this.value.interfaces = [];\n      }\n    },\n\n    preselectFirst(val) {\n      this.value.serverType = val;\n    },\n  },\n};\n</script>\n\n<template>\n  <Loading\n    v-if=\"$fetchState.pending\"\n    :delayed=\"true\"\n  />\n  <div v-else-if=\"errors.length\">\n    <div\n      v-for=\"(err, idx) in errors\"\n      :key=\"idx\"\n    >\n      <Banner\n        color=\"error\"\n        :label=\"stringify(err)\"\n      />\n    </div>\n  </div>\n  <div v-else>\n    <div class=\"row mt-20\">\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.serverLocation\"\n          :mode=\"mode\"\n          :options=\"locationChoices\"\n          :searchable=\"true\"\n          :required=\"true\"\n          :disabled=\"disabled\"\n          :label=\"t('cluster.machineConfig.pnap.serverLocation.label')\"\n        />\n      </div>\n      <div class=\"col span-6\">\n        <LabeledSelect\n          v-model=\"value.serverType\"\n          :mode=\"mode\"\n          :options=\"typeChoices\"\n          :searchable=\"true\"\n          :required=\"true\"\n          :disabled=\"disabled\"\n          :label=\"t('cluster.machineConfig.pnap.serverType.label')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mt-20\">\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.cpu\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverCpu.label')\"\n        />\n      </div>\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.coresPerCpu\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverCoresPerCpu.label')\"\n        />\n      </div>\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.cpuCount\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverCpuCount.label')\"\n        />\n      </div>\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.cpuFrequency\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverCpuFrequency.label')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mt-20\">\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.ramInGb\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverRam.label')\"\n        />\n      </div>\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.storage\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverStorage.label')\"\n        />\n      </div>\n      <div class=\"col span-3\">\n        <LabeledInput\n          v-model=\"type.metadata.network\"\n          :mode=\"mode\"\n          :disabled=\"true\"\n          :label=\"t('cluster.machineConfig.pnap.serverNetwork.label')\"\n        />\n      </div>\n      <div class=\"col span-3\">\n        <LabeledSelect\n          v-model=\"value.serverOs\"\n          :mode=\"mode\"\n          :options=\"osChoices\"\n          :searchable=\"true\"\n          :required=\"true\"\n          :disabled=\"disabled\"\n          :label=\"t('cluster.machineConfig.pnap.serverOs.label')\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n"]}]}