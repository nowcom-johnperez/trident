{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/networking.k8s.io.ingress/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/networking.k8s.io.ingress/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGFsbEhhc2ggfSBmcm9tICdAc2hlbGwvdXRpbHMvcHJvbWlzZSc7CmltcG9ydCB7IFNFQ1JFVCwgU0VSVklDRSwgSU5HUkVTU19DTEFTUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgTmFtZU5zRGVzY3JpcHRpb24gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9OYW1lTnNEZXNjcmlwdGlvbic7CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgRm9ybVZhbGlkYXRpb24gZnJvbSAnQHNoZWxsL21peGlucy9mb3JtLXZhbGlkYXRpb24nOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgQ3J1UmVzb3VyY2UgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvQ3J1UmVzb3VyY2UnOwppbXBvcnQgTGFiZWxzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxzJzsKaW1wb3J0IEVycm9yIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vRXJyb3InOwppbXBvcnQgVGFiYmVkIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZCc7CmltcG9ydCB7IGdldCwgc2V0IH0gZnJvbSAnQHNoZWxsL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IFNFQ1JFVF9UWVBFUyBhcyBUWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2VjcmV0JzsKaW1wb3J0IERlZmF1bHRCYWNrZW5kIGZyb20gJy4vRGVmYXVsdEJhY2tlbmQnOwppbXBvcnQgQ2VydGlmaWNhdGVzIGZyb20gJy4vQ2VydGlmaWNhdGVzJzsKaW1wb3J0IFJ1bGVzIGZyb20gJy4vUnVsZXMnOwppbXBvcnQgSW5ncmVzc0NsYXNzIGZyb20gJy4vSW5ncmVzc0NsYXNzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAgICAgICAnQ1JVSW5ncmVzcycsCiAgY29tcG9uZW50czogewogICAgSW5ncmVzc0NsYXNzLAogICAgQ2VydGlmaWNhdGVzLAogICAgQ3J1UmVzb3VyY2UsCiAgICBEZWZhdWx0QmFja2VuZCwKICAgIExhYmVscywKICAgIE5hbWVOc0Rlc2NyaXB0aW9uLAogICAgUnVsZXMsCiAgICBUYWIsCiAgICBUYWJiZWQsCiAgICBFcnJvcgogIH0sCiAgbWl4aW5zOiBbQ3JlYXRlRWRpdFZpZXcsIEZvcm1WYWxpZGF0aW9uXSwKICBwcm9wczogIHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfSwKICAgIG1vZGU6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAnZWRpdCcKICAgIH0KICB9LAogIGFzeW5jIGZldGNoKCkgewogICAgdGhpcy5pbmdyZXNzQ2xhc3NTY2hlbWEgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzW2BjbHVzdGVyL3NjaGVtYUZvcmBdKElOR1JFU1NfQ0xBU1MpOwogICAgY29uc3QgaGFzaCA9IGF3YWl0IGFsbEhhc2goewogICAgICBzZWNyZXRzOiAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogU0VDUkVUIH0pLAogICAgICBzZXJ2aWNlczogICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogU0VSVklDRSB9KSwKICAgICAgaW5ncmVzc0NsYXNzZXM6IHRoaXMuaW5ncmVzc0NsYXNzU2NoZW1hID8gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogSU5HUkVTU19DTEFTUyB9KSA6IFByb21pc2UucmVzb2x2ZShbXSksCiAgICB9KTsKCiAgICB0aGlzLmFsbFNlcnZpY2VzID0gaGFzaC5zZXJ2aWNlczsKICAgIHRoaXMuYWxsU2VjcmV0cyA9IGhhc2guc2VjcmV0czsKICAgIHRoaXMuYWxsSW5ncmVzc0NsYXNzZXMgPSBoYXNoLmluZ3Jlc3NDbGFzc2VzOwogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGluZ3Jlc3NDbGFzc1NjaGVtYTogbnVsbCwKICAgICAgYWxsU2VjcmV0czogICAgICAgICBbXSwKICAgICAgYWxsU2VydmljZXM6ICAgICAgICBbXSwKICAgICAgYWxsSW5ncmVzc0NsYXNzZXM6ICBbXSwKICAgICAgZnZGb3JtUnVsZVNldHM6ICAgICBbCiAgICAgICAgewogICAgICAgICAgcGF0aDogJ21ldGFkYXRhLm5hbWUnLCBydWxlczogWydyZXF1aXJlZCcsICdob3N0bmFtZSddLCB0cmFuc2xhdGlvbktleTogJ25hbWVOc0Rlc2NyaXB0aW9uLm5hbWUubGFiZWwnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBwYXRoOiAnc3BlYy5ydWxlcy5ob3N0JywgcnVsZXM6IFsnd2lsZGNhcmRIb3N0bmFtZSddLCB0cmFuc2xhdGlvbktleTogJ2luZ3Jlc3MucnVsZXMucmVxdWVzdEhvc3QubGFiZWwnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBwYXRoOiAnc3BlYy5ydWxlcy5odHRwLnBhdGhzLnBhdGgnLCBydWxlczogWydhYnNvbHV0ZVBhdGgnXSwgdHJhbnNsYXRpb25LZXk6ICdpbmdyZXNzLnJ1bGVzLnBhdGgubGFiZWwnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBwYXRoOiAnc3BlYy5ydWxlcy5odHRwLnBhdGhzLmJhY2tlbmQuc2VydmljZS5wb3J0Lm51bWJlcicsIHJ1bGVzOiBbJ3JlcXVpcmVkJ10sIHRyYW5zbGF0aW9uS2V5OiAnaW5ncmVzcy5ydWxlcy5wb3J0LmxhYmVsJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgcGF0aDogJ3NwZWMucnVsZXMuaHR0cC5wYXRocy5iYWNrZW5kLnNlcnZpY2UubmFtZScsIHJ1bGVzOiBbJ3JlcXVpcmVkJ10sIHRyYW5zbGF0aW9uS2V5OiAnaW5ncmVzcy5ydWxlcy50YXJnZXQubGFiZWwnCiAgICAgICAgfSwKICAgICAgICB7IHBhdGg6ICdzcGVjJywgcnVsZXM6IFsnYmFja0VuZE9yUnVsZXMnXSB9LAogICAgICAgIHsKICAgICAgICAgIHBhdGg6ICdzcGVjLmRlZmF1bHRCYWNrZW5kLnNlcnZpY2UubmFtZScsIHJ1bGVzOiBbJ3JlcXVpcmVkJ10sIHRyYW5zbGF0aW9uS2V5OiAnaW5ncmVzcy5kZWZhdWx0QmFja2VuZC50YXJnZXRTZXJ2aWNlLmxhYmVsJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgcGF0aDogJ3NwZWMuZGVmYXVsdEJhY2tlbmQuc2VydmljZS5wb3J0Lm51bWJlcicsIHJ1bGVzOiBbJ3JlcXVpcmVkJywgJ3JlcXVpcmVkSW50JywgJ3BvcnROdW1iZXInXSwgdHJhbnNsYXRpb25LZXk6ICdpbmdyZXNzLmRlZmF1bHRCYWNrZW5kLnBvcnQubGFiZWwnCiAgICAgICAgfSwKICAgICAgICB7IHBhdGg6ICdzcGVjLnRscy5ob3N0cycsIHJ1bGVzOiBbJ3JlcXVpcmVkJywgJ3dpbGRjYXJkSG9zdG5hbWUnXSB9CiAgICAgIF0sCiAgICAgIGZ2UmVwb3J0ZWRWYWxpZGF0aW9uUGF0aHM6IFsnc3BlYy5ydWxlcy5odHRwLnBhdGhzLmJhY2tlbmQuc2VydmljZS5wb3J0Lm51bWJlcicsICdzcGVjLnJ1bGVzLmh0dHAucGF0aHMucGF0aCcsICdzcGVjLnJ1bGVzLmh0dHAucGF0aHMuYmFja2VuZC5zZXJ2aWNlLm5hbWUnXQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBmdkV4dHJhUnVsZXMoKSB7CiAgICAgIGNvbnN0IGJhY2tFbmRPclJ1bGVzID0gKHNwZWMpID0+IHsKICAgICAgICBjb25zdCB7IHJ1bGVzID0gW10sIGRlZmF1bHRCYWNrZW5kIH0gPSBzcGVjOwoKICAgICAgICBjb25zdCB2YWxpZFJ1bGVzID0gcnVsZXMubGVuZ3RoID4gMDsKICAgICAgICBjb25zdCB2YWxpZERlZmF1bHRCYWNrZW5kID0gISFkZWZhdWx0QmFja2VuZD8uc2VydmljZTsKCiAgICAgICAgaWYgKCF2YWxpZFJ1bGVzICYmICF2YWxpZERlZmF1bHRCYWNrZW5kKSB7CiAgICAgICAgICByZXR1cm4gdGhpcy50KCdpbmdyZXNzLnJ1bGVzT3JCYWNrZW5kU3BlY2lmaWVkJyk7CiAgICAgICAgfQogICAgICB9OwoKICAgICAgcmV0dXJuIHsgYmFja0VuZE9yUnVsZXMgfTsKICAgIH0sCiAgICB0YWJFcnJvcnMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgcnVsZXM6ICAgICAgICAgIHRoaXMuZnZHZXRQYXRoRXJyb3JzKFsnc3BlYy5ydWxlcy5ob3N0JywgJ3NwZWMucnVsZXMuaHR0cC5wYXRocy5wYXRoJywgJ3NwZWMucnVsZXMuaHR0cC5wYXRocy5iYWNrZW5kLnNlcnZpY2UucG9ydC5udW1iZXInLCAnc3BlYy5ydWxlcy5odHRwLnBhdGhzLmJhY2tlbmQuc2VydmljZS5uYW1lJ10pPy5sZW5ndGggPiAwLAogICAgICAgIGRlZmF1bHRCYWNrZW5kOiB0aGlzLmZ2R2V0UGF0aEVycm9ycyhbJ3NwZWMuZGVmYXVsdEJhY2tlbmQuc2VydmljZS5uYW1lJywgJ3NwZWMuZGVmYXVsdEJhY2tlbmQuc2VydmljZS5wb3J0Lm51bWJlciddKT8ubGVuZ3RoID4gMAogICAgICB9OwogICAgfSwKICAgIHJ1bGVzUGF0aFJ1bGVzKCkgewogICAgICByZXR1cm4gewogICAgICAgIHJlcXVlc3RIb3N0OiB0aGlzLmZ2R2V0QW5kUmVwb3J0UGF0aFJ1bGVzKCdzcGVjLnJ1bGVzLmhvc3QnKSwKICAgICAgICBwYXRoOiAgICAgICAgdGhpcy5mdkdldEFuZFJlcG9ydFBhdGhSdWxlcygnc3BlYy5ydWxlcy5odHRwLnBhdGhzLnBhdGgnKSwKICAgICAgICBwb3J0OiAgICAgICAgdGhpcy5mdkdldEFuZFJlcG9ydFBhdGhSdWxlcygnc3BlYy5ydWxlcy5odHRwLnBhdGhzLmJhY2tlbmQuc2VydmljZS5wb3J0Lm51bWJlcicpLAogICAgICAgIHRhcmdldDogICAgICB0aGlzLmZ2R2V0QW5kUmVwb3J0UGF0aFJ1bGVzKCdzcGVjLnJ1bGVzLmh0dHAucGF0aHMuYmFja2VuZC5zZXJ2aWNlLm5hbWUnKSwKCiAgICAgIH07CiAgICB9LAogICAgZGVmYXVsdEJhY2tlbmRQYXRoUnVsZXMoKSB7CiAgICAgIGNvbnN0IHJ1bGVzRXhpc3QgPSAodGhpcy52YWx1ZT8uc3BlYz8ucnVsZXMgfHwgW10pLmxlbmd0aCA+IDA7CiAgICAgIGNvbnN0IGRlZmF1bHRCYWNrZW5kRXhpc3QgPSAhIXRoaXMudmFsdWU/LnNwZWM/LmRlZmF1bHRCYWNrZW5kPy5zZXJ2aWNlOwoKICAgICAgaWYgKCFydWxlc0V4aXN0IHx8IGRlZmF1bHRCYWNrZW5kRXhpc3QpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbmFtZTogdGhpcy5mdkdldEFuZFJlcG9ydFBhdGhSdWxlcygnc3BlYy5kZWZhdWx0QmFja2VuZC5zZXJ2aWNlLm5hbWUnKSwKICAgICAgICAgIHBvcnQ6IHRoaXMuZnZHZXRBbmRSZXBvcnRQYXRoUnVsZXMoJ3NwZWMuZGVmYXVsdEJhY2tlbmQuc2VydmljZS5wb3J0Lm51bWJlcicpLAogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiB7IG5hbWU6IFtdLCBwb3J0OiBbXSB9OwogICAgfSwKICAgIHNlcnZpY2VUYXJnZXRzKCkgewogICAgICByZXR1cm4gdGhpcy5maWx0ZXJCeUN1cnJlbnRSZXNvdXJjZU5hbWVzcGFjZSh0aGlzLmFsbFNlcnZpY2VzKQogICAgICAgIC5tYXAoKHNlcnZpY2UpID0+ICh7CiAgICAgICAgICBsYWJlbDogc2VydmljZS5tZXRhZGF0YS5uYW1lLAogICAgICAgICAgdmFsdWU6IHNlcnZpY2UubWV0YWRhdGEubmFtZSwKICAgICAgICAgIHBvcnRzOiBzZXJ2aWNlLnNwZWMucG9ydHM/Lm1hcCgocCkgPT4gcC5wb3J0KQogICAgICAgIH0pKTsKICAgIH0sCiAgICBmaXJzdFRhYkxhYmVsKCkgewogICAgICByZXR1cm4gdGhpcy5pc1ZpZXcgPyB0aGlzLnQoJ2luZ3Jlc3MucnVsZXNBbmRDZXJ0aWZpY2F0ZXMudGl0bGUnKSA6IHRoaXMudCgnaW5ncmVzcy5ydWxlcy50aXRsZScpOwogICAgfSwKICAgIGNlcnRpZmljYXRlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyQnlDdXJyZW50UmVzb3VyY2VOYW1lc3BhY2UodGhpcy5hbGxTZWNyZXRzLmZpbHRlcigoc2VjcmV0KSA9PiBzZWNyZXQuX3R5cGUgPT09IFRZUEVTLlRMUykpLm1hcCgoc2VjcmV0KSA9PiB7CiAgICAgICAgY29uc3QgeyBpZCB9ID0gc2VjcmV0OwoKICAgICAgICByZXR1cm4gaWQuc2xpY2UoaWQuaW5kZXhPZignLycpICsgMSk7CiAgICAgIH0pOwogICAgfSwKICAgIGluZ3Jlc3NDbGFzc2VzKCkgewogICAgICByZXR1cm4gdGhpcy5hbGxJbmdyZXNzQ2xhc3Nlcy5tYXAoKGluZ3Jlc3NDbGFzcykgPT4gKHsKICAgICAgICBsYWJlbDogaW5ncmVzc0NsYXNzLm1ldGFkYXRhLm5hbWUsCiAgICAgICAgdmFsdWU6IGluZ3Jlc3NDbGFzcy5tZXRhZGF0YS5uYW1lLAogICAgICB9KSk7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLCAnc3BlYycsIHRoaXMudmFsdWUuc3BlYyB8fCB7fSk7CiAgICB0aGlzLiRzZXQodGhpcy52YWx1ZS5zcGVjLCAncnVsZXMnLCB0aGlzLnZhbHVlLnNwZWMucnVsZXMgfHwgW3t9XSk7CiAgICB0aGlzLiRzZXQodGhpcy52YWx1ZS5zcGVjLCAnYmFja2VuZCcsIHRoaXMudmFsdWUuc3BlYy5iYWNrZW5kIHx8IHt9KTsKCiAgICBpZiAoIXRoaXMudmFsdWUuc3BlYy50bHMgfHwgT2JqZWN0LmtleXModGhpcy52YWx1ZS5zcGVjLnRsc1swXSB8fCB7fSkubGVuZ3RoID09PSAwKSB7CiAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLnNwZWMsICd0bHMnLCBbXSk7CiAgICB9CgogICAgdGhpcy5yZWdpc3RlckJlZm9yZUhvb2sodGhpcy53aWxsU2F2ZSwgJ3dpbGxTYXZlJyk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBmaWx0ZXJCeUN1cnJlbnRSZXNvdXJjZU5hbWVzcGFjZShyZXNvdXJjZXMpIHsKICAgICAgLy8gV2hlbiBjb25maWd1cmluZyBhbiBJbmdyZXNzLCB0aGUgb3B0aW9ucyBmb3IgU2VjcmV0cyBhbmQKICAgICAgLy8gZGVmYXVsdCBiYWNrZW5kIFNlcnZpY2VzIGFyZSBsaW1pdGVkIHRvIHRoZSBuYW1lc3BhY2Ugb2YgdGhlIEluZ3Jlc3MuCiAgICAgIHJldHVybiByZXNvdXJjZXMuZmlsdGVyKChyZXNvdXJjZSkgPT4gewogICAgICAgIHJldHVybiByZXNvdXJjZS5tZXRhZGF0YS5uYW1lc3BhY2UgPT09IHRoaXMudmFsdWUubWV0YWRhdGEubmFtZXNwYWNlOwogICAgICB9KTsKICAgIH0sCiAgICB3aWxsU2F2ZSgpIHsKICAgICAgY29uc3QgYmFja2VuZCA9IGdldCh0aGlzLnZhbHVlLnNwZWMsIHRoaXMudmFsdWUuZGVmYXVsdEJhY2tlbmRQYXRoKTsKICAgICAgY29uc3Qgc2VydmljZU5hbWUgPSBnZXQoYmFja2VuZCwgdGhpcy52YWx1ZS5zZXJ2aWNlTmFtZVBhdGgpOwogICAgICBjb25zdCBzZXJ2aWNlUG9ydCA9IGdldChiYWNrZW5kLCB0aGlzLnZhbHVlLnNlcnZpY2VQb3J0UGF0aCk7CgogICAgICBpZiAoYmFja2VuZCAmJiAoIXNlcnZpY2VOYW1lIHx8ICFzZXJ2aWNlUG9ydCkpIHsKICAgICAgICBjb25zdCBwYXRoID0gdGhpcy52YWx1ZS5kZWZhdWx0QmFja2VuZFBhdGg7CgogICAgICAgIHNldCh0aGlzLnZhbHVlLnNwZWMsIHBhdGgsIG51bGwpOwogICAgICB9CiAgICB9LAogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/edit/networking.k8s.io.ingress","sourcesContent":["<script>\nimport { allHash } from '@shell/utils/promise';\nimport { SECRET, SERVICE, INGRESS_CLASS } from '@shell/config/types';\nimport NameNsDescription from '@shell/components/form/NameNsDescription';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport FormValidation from '@shell/mixins/form-validation';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport CruResource from '@shell/components/CruResource';\nimport Labels from '@shell/components/form/Labels';\nimport Error from '@shell/components/form/Error';\nimport Tabbed from '@shell/components/Tabbed';\nimport { get, set } from '@shell/utils/object';\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\nimport DefaultBackend from './DefaultBackend';\nimport Certificates from './Certificates';\nimport Rules from './Rules';\nimport IngressClass from './IngressClass';\n\nexport default {\n  name:       'CRUIngress',\n  components: {\n    IngressClass,\n    Certificates,\n    CruResource,\n    DefaultBackend,\n    Labels,\n    NameNsDescription,\n    Rules,\n    Tab,\n    Tabbed,\n    Error\n  },\n  mixins: [CreateEditView, FormValidation],\n  props:  {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    mode: {\n      type:    String,\n      default: 'edit'\n    }\n  },\n  async fetch() {\n    this.ingressClassSchema = this.$store.getters[`cluster/schemaFor`](INGRESS_CLASS);\n    const hash = await allHash({\n      secrets:        this.$store.dispatch('cluster/findAll', { type: SECRET }),\n      services:       this.$store.dispatch('cluster/findAll', { type: SERVICE }),\n      ingressClasses: this.ingressClassSchema ? this.$store.dispatch('cluster/findAll', { type: INGRESS_CLASS }) : Promise.resolve([]),\n    });\n\n    this.allServices = hash.services;\n    this.allSecrets = hash.secrets;\n    this.allIngressClasses = hash.ingressClasses;\n  },\n  data() {\n    return {\n      ingressClassSchema: null,\n      allSecrets:         [],\n      allServices:        [],\n      allIngressClasses:  [],\n      fvFormRuleSets:     [\n        {\n          path: 'metadata.name', rules: ['required', 'hostname'], translationKey: 'nameNsDescription.name.label'\n        },\n        {\n          path: 'spec.rules.host', rules: ['wildcardHostname'], translationKey: 'ingress.rules.requestHost.label'\n        },\n        {\n          path: 'spec.rules.http.paths.path', rules: ['absolutePath'], translationKey: 'ingress.rules.path.label'\n        },\n        {\n          path: 'spec.rules.http.paths.backend.service.port.number', rules: ['required'], translationKey: 'ingress.rules.port.label'\n        },\n        {\n          path: 'spec.rules.http.paths.backend.service.name', rules: ['required'], translationKey: 'ingress.rules.target.label'\n        },\n        { path: 'spec', rules: ['backEndOrRules'] },\n        {\n          path: 'spec.defaultBackend.service.name', rules: ['required'], translationKey: 'ingress.defaultBackend.targetService.label'\n        },\n        {\n          path: 'spec.defaultBackend.service.port.number', rules: ['required', 'requiredInt', 'portNumber'], translationKey: 'ingress.defaultBackend.port.label'\n        },\n        { path: 'spec.tls.hosts', rules: ['required', 'wildcardHostname'] }\n      ],\n      fvReportedValidationPaths: ['spec.rules.http.paths.backend.service.port.number', 'spec.rules.http.paths.path', 'spec.rules.http.paths.backend.service.name']\n    };\n  },\n  computed: {\n    fvExtraRules() {\n      const backEndOrRules = (spec) => {\n        const { rules = [], defaultBackend } = spec;\n\n        const validRules = rules.length > 0;\n        const validDefaultBackend = !!defaultBackend?.service;\n\n        if (!validRules && !validDefaultBackend) {\n          return this.t('ingress.rulesOrBackendSpecified');\n        }\n      };\n\n      return { backEndOrRules };\n    },\n    tabErrors() {\n      return {\n        rules:          this.fvGetPathErrors(['spec.rules.host', 'spec.rules.http.paths.path', 'spec.rules.http.paths.backend.service.port.number', 'spec.rules.http.paths.backend.service.name'])?.length > 0,\n        defaultBackend: this.fvGetPathErrors(['spec.defaultBackend.service.name', 'spec.defaultBackend.service.port.number'])?.length > 0\n      };\n    },\n    rulesPathRules() {\n      return {\n        requestHost: this.fvGetAndReportPathRules('spec.rules.host'),\n        path:        this.fvGetAndReportPathRules('spec.rules.http.paths.path'),\n        port:        this.fvGetAndReportPathRules('spec.rules.http.paths.backend.service.port.number'),\n        target:      this.fvGetAndReportPathRules('spec.rules.http.paths.backend.service.name'),\n\n      };\n    },\n    defaultBackendPathRules() {\n      const rulesExist = (this.value?.spec?.rules || []).length > 0;\n      const defaultBackendExist = !!this.value?.spec?.defaultBackend?.service;\n\n      if (!rulesExist || defaultBackendExist) {\n        return {\n          name: this.fvGetAndReportPathRules('spec.defaultBackend.service.name'),\n          port: this.fvGetAndReportPathRules('spec.defaultBackend.service.port.number'),\n        };\n      }\n\n      return { name: [], port: [] };\n    },\n    serviceTargets() {\n      return this.filterByCurrentResourceNamespace(this.allServices)\n        .map((service) => ({\n          label: service.metadata.name,\n          value: service.metadata.name,\n          ports: service.spec.ports?.map((p) => p.port)\n        }));\n    },\n    firstTabLabel() {\n      return this.isView ? this.t('ingress.rulesAndCertificates.title') : this.t('ingress.rules.title');\n    },\n    certificates() {\n      return this.filterByCurrentResourceNamespace(this.allSecrets.filter((secret) => secret._type === TYPES.TLS)).map((secret) => {\n        const { id } = secret;\n\n        return id.slice(id.indexOf('/') + 1);\n      });\n    },\n    ingressClasses() {\n      return this.allIngressClasses.map((ingressClass) => ({\n        label: ingressClass.metadata.name,\n        value: ingressClass.metadata.name,\n      }));\n    },\n  },\n  created() {\n    this.$set(this.value, 'spec', this.value.spec || {});\n    this.$set(this.value.spec, 'rules', this.value.spec.rules || [{}]);\n    this.$set(this.value.spec, 'backend', this.value.spec.backend || {});\n\n    if (!this.value.spec.tls || Object.keys(this.value.spec.tls[0] || {}).length === 0) {\n      this.$set(this.value.spec, 'tls', []);\n    }\n\n    this.registerBeforeHook(this.willSave, 'willSave');\n  },\n  methods: {\n    filterByCurrentResourceNamespace(resources) {\n      // When configuring an Ingress, the options for Secrets and\n      // default backend Services are limited to the namespace of the Ingress.\n      return resources.filter((resource) => {\n        return resource.metadata.namespace === this.value.metadata.namespace;\n      });\n    },\n    willSave() {\n      const backend = get(this.value.spec, this.value.defaultBackendPath);\n      const serviceName = get(backend, this.value.serviceNamePath);\n      const servicePort = get(backend, this.value.servicePortPath);\n\n      if (backend && (!serviceName || !servicePort)) {\n        const path = this.value.defaultBackendPath;\n\n        set(this.value.spec, path, null);\n      }\n    },\n  }\n};\n</script>\n<template>\n  <CruResource\n    :done-route=\"doneRoute\"\n    :mode=\"mode\"\n    :resource=\"value\"\n    :subtypes=\"[]\"\n    :validation-passed=\"fvFormIsValid\"\n    :errors=\"fvUnreportedValidationErrors\"\n    :description=\"t('ingress.description')\"\n    @error=\"e=>errors = e\"\n    @finish=\"save\"\n    @cancel=\"done\"\n  >\n    <NameNsDescription\n      v-if=\"!isView\"\n      :value=\"value\"\n      :rules=\"{name: fvGetAndReportPathRules('metadata.name'), namespace: fvGetAndReportPathRules('metadata.namespace'), description: []}\"\n      :mode=\"mode\"\n      :register-before-hook=\"registerBeforeHook\"\n    />\n    <Error\n      :value=\"value.spec\"\n      :rules=\"fvGetAndReportPathRules('spec')\"\n      as-banner\n    />\n    <Tabbed :side-tabs=\"true\">\n      <Tab\n        :label=\"firstTabLabel\"\n        name=\"rules\"\n        :weight=\"4\"\n        :error=\"tabErrors.rules\"\n      >\n        <Rules\n          v-model=\"value\"\n          :mode=\"mode\"\n          :service-targets=\"serviceTargets\"\n          :certificates=\"certificates\"\n          :rules=\"rulesPathRules\"\n        />\n      </Tab>\n      <Tab\n        :label=\"t('ingress.defaultBackend.label')\"\n        name=\"default-backend\"\n        :weight=\"3\"\n        :error=\"tabErrors.defaultBackend\"\n      >\n        <DefaultBackend\n          v-model=\"value\"\n          :service-targets=\"serviceTargets\"\n          :mode=\"mode\"\n          :rules=\"defaultBackendPathRules\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"!isView\"\n        :label=\"t('ingress.certificates.label')\"\n        name=\"certificates\"\n        :weight=\"2\"\n      >\n        <Certificates\n          v-model=\"value\"\n          :mode=\"mode\"\n          :certificates=\"certificates\"\n          :rules=\"{host: fvGetAndReportPathRules('spec.tls.hosts')}\"\n        />\n      </Tab>\n      <Tab\n        :label=\"t('ingress.ingressClass.label')\"\n        name=\"ingress-class\"\n        :weight=\"1\"\n      >\n        <IngressClass\n          v-model=\"value\"\n          :mode=\"mode\"\n          :ingress-classes=\"ingressClasses\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"!isView\"\n        name=\"labels-and-annotations\"\n        label-key=\"generic.labelsAndAnnotations\"\n        :weight=\"0\"\n      >\n        <Labels\n          default-container-class=\"labels-and-annotations-container\"\n          :value=\"value\"\n          :mode=\"mode\"\n          :display-side-by-side=\"false\"\n        />\n      </Tab>\n    </Tabbed>\n  </CruResource>\n</template>\n"]}]}