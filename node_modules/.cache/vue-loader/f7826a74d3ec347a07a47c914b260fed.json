{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/SimpleSecretSelector.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/SimpleSecretSelector.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci8qKgogKiBJIGNyZWF0ZWQgdGhpcyBjb21wb25lbnQgYmVjYXVzZSB0aGUgcmVndWxhciBzZWNyZXQKICogc2VsZWN0b3IgYXNzdW1lcyBzZWNyZXRzIG5lZWQgdG8gYmUgaW4gdGhpcyBmb3JtYXQ6CiAqCiAqICB2YWx1ZUZyb206CiAgICAgIHNlY3JldEtleVJlZjoKICAgICAgICBuYW1lOiBleGFtcGxlLXNlY3JldC1uYW1lCiAgICAgICAga2V5OiBleGFtcGxlLXNlY3JldC1rZXkKCiAgIEJ1dCBmb3Igc2VjcmV0cyBmb3IgcmVjZWl2ZXJzIGluIEFsZXJ0bWFuYWdlckNvbmZpZ3MsCiAgIGl0IG5lZWRlZCB0byBiZSBpbiB0aGlzIGZvcm1hdDoKCiAgIG5hbWU6IGV4YW1wbGUtc2VjcmV0LW5hbWUKICAga2V5OiBleGFtcGxlLXNlY3JldC1rZXkKICovCmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IFNFQ1JFVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBfRURJVCwgX1ZJRVcgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmltcG9ydCB7IFRZUEVTIH0gZnJvbSAnQHNoZWxsL21vZGVscy9zZWNyZXQnOwppbXBvcnQgc29ydEJ5IGZyb20gJ2xvZGFzaC9zb3J0QnknOwoKY29uc3QgTk9ORSA9ICdfX1tbTk9ORV1dX18nOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgTGFiZWxlZFNlbGVjdCB9LAoKICBhc3luYyBmZXRjaCgpIHsKICAgIC8vIE1ha2Ugc3VyZSBzZWNyZXRzIGFyZSBpbiB0aGUgc3RvcmUgc28gdGhhdCB0aGUgc2VjcmV0CiAgICAvLyBzZWxlY3RvcnMgaW4gdGhlIHJlY2VpdmVyIGNvbmZpZyBmb3JtcyB3aWxsIGhhdmUgc2VjcmV0cwogICAgLy8gdG8gY2hvb3NlIGZyb20uCiAgICBjb25zdCBhbGxTZWNyZXRzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogU0VDUkVUIH0pOwoKICAgIGNvbnN0IGFsbFNlY3JldHNJbk5hbWVzcGFjZSA9IGFsbFNlY3JldHMuZmlsdGVyKChzZWNyZXQpID0+IHRoaXMudHlwZXMuaW5jbHVkZXMoc2VjcmV0Ll90eXBlKSAmJiBzZWNyZXQubmFtZXNwYWNlID09PSB0aGlzLm5hbWVzcGFjZSk7CgogICAgdGhpcy5zZWNyZXRzID0gYWxsU2VjcmV0c0luTmFtZXNwYWNlOwogIH0sCgogIHByb3BzOiB7CiAgICB0ZXN0OiAgICAgICAgeyB0eXBlOiBTdHJpbmcsIGRlZmF1bHQ6ICcnIH0sCiAgICBpbml0aWFsTmFtZTogewogICAgICB0eXBlOiAgICAgU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIGluaXRpYWxLZXk6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBuYW1lc3BhY2U6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICB0eXBlczogewogICAgICB0eXBlOiAgICBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gT2JqZWN0LnZhbHVlcyhUWVBFUykKICAgIH0sCiAgICBkaXNhYmxlZDogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIHNlY3JldE5hbWVMYWJlbDogewogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICdTZWNyZXQgTmFtZScKICAgIH0sCiAgICBrZXlOYW1lTGFiZWw6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAnS2V5JwogICAgfSwKICAgIG1vZGU6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiBfRURJVAogICAgfSwKICB9LAoKICBkYXRhKHByb3BzKSB7CiAgICByZXR1cm4gewogICAgICBzZWNyZXRzOiBbXSwKICAgICAgbmFtZTogICAgcHJvcHMuaW5pdGlhbE5hbWUsCiAgICAgIGtleTogICAgIHByb3BzLmluaXRpYWxLZXksCiAgICAgIG5vbmU6ICAgIE5PTkUKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHNlY3JldE5hbWVzKCkgewogICAgICBjb25zdCBtYXBwZWRTZWNyZXRzID0gdGhpcy5zZWNyZXRzLm1hcCgoc2VjcmV0KSA9PiAoewogICAgICAgIGxhYmVsOiBzZWNyZXQubmFtZSwKICAgICAgICB2YWx1ZTogc2VjcmV0Lm5hbWUKICAgICAgfSkpLnNvcnQoKTsKCiAgICAgIHJldHVybiBbeyBsYWJlbDogJ05vbmUnLCB2YWx1ZTogTk9ORSB9LCAuLi5zb3J0QnkobWFwcGVkU2VjcmV0cywgJ2xhYmVsJyldOwogICAgfSwKICAgIGtleXMoKSB7CiAgICAgIGNvbnN0IHNlY3JldCA9IHRoaXMuc2VjcmV0cy5maW5kKChzZWNyZXQpID0+IHNlY3JldC5uYW1lID09PSB0aGlzLm5hbWUpIHx8IHt9OwoKICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHNlY3JldC5kYXRhIHx8IHt9KS5tYXAoKGtleSkgPT4gKHsKICAgICAgICBsYWJlbDoga2V5LAogICAgICAgIHZhbHVlOiBrZXkKICAgICAgfSkpOwogICAgfSwKICAgIGlzVmlldygpIHsKICAgICAgcmV0dXJuIHRoaXMubW9kZSA9PT0gX1ZJRVc7CiAgICB9LAogICAgaXNLZXlEaXNhYmxlZCgpIHsKICAgICAgcmV0dXJuICF0aGlzLmlzVmlldyAmJiAoIXRoaXMubmFtZSB8fCB0aGlzLm5hbWUgPT09IE5PTkUgfHwgdGhpcy5kaXNhYmxlZCk7CiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgdXBkYXRlU2VjcmV0TmFtZShlKSB7CiAgICAgIGlmIChlLnZhbHVlID09PSB0aGlzLm5vbmUpIHsKICAgICAgICAvLyBUaGUga2V5IHNob3VsZCBhcHBlYXIgYmxhbmsgaWYgdGhlIHNlY3JldCBuYW1lIGlzIGNsZWFyZWQKICAgICAgICB0aGlzLmtleSA9ICcnOwogICAgICB9CiAgICAgIGlmIChlLnZhbHVlKSB7CiAgICAgICAgdGhpcy4kZW1pdCgndXBkYXRlU2VjcmV0TmFtZScsIGUudmFsdWUpOwogICAgICB9CiAgICB9LAogICAgdXBkYXRlU2VjcmV0S2V5KGUpIHsKICAgICAgaWYgKGUudmFsdWUpIHsKICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGVTZWNyZXRLZXknLCBlLnZhbHVlKTsKICAgICAgfQogICAgfQogIH0KfTsK"},{"version":3,"sources":["SimpleSecretSelector.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SimpleSecretSelector.vue","sourceRoot":"node_modules/@rancher/shell/components/form","sourcesContent":["<script>\n/**\n * I created this component because the regular secret\n * selector assumes secrets need to be in this format:\n *\n *  valueFrom:\n      secretKeyRef:\n        name: example-secret-name\n        key: example-secret-key\n\n   But for secrets for receivers in AlertmanagerConfigs,\n   it needed to be in this format:\n\n   name: example-secret-name\n   key: example-secret-key\n */\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { SECRET } from '@shell/config/types';\nimport { _EDIT, _VIEW } from '@shell/config/query-params';\nimport { TYPES } from '@shell/models/secret';\nimport sortBy from 'lodash/sortBy';\n\nconst NONE = '__[[NONE]]__';\n\nexport default {\n  components: { LabeledSelect },\n\n  async fetch() {\n    // Make sure secrets are in the store so that the secret\n    // selectors in the receiver config forms will have secrets\n    // to choose from.\n    const allSecrets = await this.$store.dispatch('cluster/findAll', { type: SECRET });\n\n    const allSecretsInNamespace = allSecrets.filter((secret) => this.types.includes(secret._type) && secret.namespace === this.namespace);\n\n    this.secrets = allSecretsInNamespace;\n  },\n\n  props: {\n    test:        { type: String, default: '' },\n    initialName: {\n      type:     String,\n      required: true\n    },\n    initialKey: {\n      type:     String,\n      required: true\n    },\n    namespace: {\n      type:     String,\n      required: true\n    },\n    types: {\n      type:    Array,\n      default: () => Object.values(TYPES)\n    },\n    disabled: {\n      type:    Boolean,\n      default: false\n    },\n    secretNameLabel: {\n      type:    String,\n      default: 'Secret Name'\n    },\n    keyNameLabel: {\n      type:    String,\n      default: 'Key'\n    },\n    mode: {\n      type:    String,\n      default: _EDIT\n    },\n  },\n\n  data(props) {\n    return {\n      secrets: [],\n      name:    props.initialName,\n      key:     props.initialKey,\n      none:    NONE\n    };\n  },\n\n  computed: {\n    secretNames() {\n      const mappedSecrets = this.secrets.map((secret) => ({\n        label: secret.name,\n        value: secret.name\n      })).sort();\n\n      return [{ label: 'None', value: NONE }, ...sortBy(mappedSecrets, 'label')];\n    },\n    keys() {\n      const secret = this.secrets.find((secret) => secret.name === this.name) || {};\n\n      return Object.keys(secret.data || {}).map((key) => ({\n        label: key,\n        value: key\n      }));\n    },\n    isView() {\n      return this.mode === _VIEW;\n    },\n    isKeyDisabled() {\n      return !this.isView && (!this.name || this.name === NONE || this.disabled);\n    }\n  },\n\n  methods: {\n    updateSecretName(e) {\n      if (e.value === this.none) {\n        // The key should appear blank if the secret name is cleared\n        this.key = '';\n      }\n      if (e.value) {\n        this.$emit('updateSecretName', e.value);\n      }\n    },\n    updateSecretKey(e) {\n      if (e.value) {\n        this.$emit('updateSecretKey', e.value);\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"secret-selector show-key-selector\">\n    <div class=\"input-container\">\n      <LabeledSelect\n        v-model=\"name\"\n        class=\"col span-6\"\n        :disabled=\"!isView && disabled\"\n        :options=\"secretNames\"\n        :label=\"secretNameLabel\"\n        :mode=\"mode\"\n        @selecting=\"updateSecretName\"\n      />\n      <LabeledSelect\n        v-model=\"key\"\n        class=\"col span-6\"\n        :disabled=\"isKeyDisabled\"\n        :options=\"keys\"\n        :label=\"keyNameLabel\"\n        :mode=\"mode\"\n        @selecting=\"updateSecretKey\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.secret-selector {\n  width: 100%;\n  label {\n    display: block;\n  }\n\n  & .labeled-select {\n    min-height: $input-height;\n  }\n\n  & .vs__selected-options {\n    padding: 8px 0 7px 0;\n  }\n\n  & label {\n    display: inline-block;\n  }\n\n  &.show-key-selector {\n    .input-container > * {\n      display: inline-block;\n      width: 50%;\n\n      &.labeled-select.focused {\n        z-index: 10;\n      }\n\n      &:first-child {\n        border-top-right-radius: 0;\n        border-bottom-right-radius: 0;\n        margin-right: 0;\n      }\n\n      &:last-child {\n        border-top-left-radius: 0;\n        border-bottom-left-radius: 0;\n        border-left: none;\n        float: right;\n      }\n    }\n  }\n}\n</style>\n"]}]}