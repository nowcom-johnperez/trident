{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/istio.vue?vue&type=style&index=0&id=2b156b6e&lang=scss","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/istio.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1716430467357},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/postcss-loader/src/index.js","mtime":1716430467882},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/sass-loader/dist/cjs.js","mtime":1716430453705},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiR5YW1sLWhlaWdodDogMjAwcHg7CgouY3VzdG9tLW92ZXJsYXkgewogICY+RElWewogICAgY29sb3I6IHZhcigtLWlucHV0LWxhYmVsKTsKICAgICY+KnsKICAgICAgcGFkZGluZzogM3B4OwogICAgfQogIH0KCiAgJiAueWFtbC1lZGl0b3J7CiAgICBmbGV4OiAxOwogICAgbWluLWhlaWdodDogJHlhbWwtaGVpZ2h0OwogICAgJiAuY29kZS1taXJyb3IgLkNvZGVNaXJyb3IgewogICAgICBwb3NpdGlvbjogaW5pdGlhbDsKICAgICAgaGVpZ2h0OiBhdXRvOwogICAgICBtaW4taGVpZ2h0OiAkeWFtbC1oZWlnaHQ7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["istio.vue"],"names":[],"mappings":";AAoSA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"istio.vue","sourceRoot":"node_modules/@rancher/shell/chart","sourcesContent":["<script>\nimport debounce from 'lodash/debounce';\nimport jsyaml from 'js-yaml';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport YamlEditor from '@shell/components/YamlEditor';\nimport { mapGetters } from 'vuex';\nimport FileSelector from '@shell/components/form/FileSelector';\nimport { Banner } from '@components/Banner';\nimport ChartPsp from '@shell/components/ChartPsp';\n\nconst defaultOverlayFile = `#apiVersion: install.istio.io/v1alpha1\n#kind: IstioOperator\n#spec:\n#  components:\n#    ingressGateways:\n#    - enabled: true\n#      name: istio-ingressgateway\n#    - enabled: true\n#      k8s:\n#        resources:\n#          requests:\n#            cpu: 200m\n#        service:\n#          ports:\n#          - name: tcp-citadel-grpc-tls\n#            port: 8060\n#            targetPort: 8060\n#          - name: tcp-dns\n#            port: 5353\n#        serviceAnnotations:\n#          cloud.google.com/load-balancer-type: internal\n#      name: ilb-gateway\n#      namespace: user-ingressgateway-ns\n#    - enabled: true\n#      k8s:\n#        resources:\n#          requests:\n#            cpu: 200m\n#        service:\n#          ports:\n#          - name: tcp-citadel-grpc-tls\n#            port: 8060\n#            targetPort: 8060\n#          - name: tcp-dns\n#            port: 5353\n#        serviceAnnotations:\n#          cloud.google.com/load-balancer-type: internal\n#      name: other-gateway\n#      namespace: istio-system\n`;\n\nexport default {\n  components: {\n    Checkbox,\n    FileSelector,\n    YamlEditor,\n    Banner,\n    ChartPsp\n  },\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  data() {\n    let overlayFile = this.value.overlayFile;\n\n    if (!overlayFile?.length) {\n      overlayFile = defaultOverlayFile;\n    }\n\n    return {\n      overlayFile,\n      showKialiBanner: this.value.kiali?.enabled\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster'], { t: 'i18n/t' }),\n    valuesYaml: {\n      get() {\n        try {\n          const yaml = jsyaml.dump(this.value);\n\n          return yaml;\n        } catch (e) {\n          return null;\n        }\n      },\n      set: debounce(function(neu) {\n        try {\n          const obj = jsyaml.load(neu);\n\n          Object.assign(this.value, obj);\n        } catch (e) {\n\n        }\n      }, 500)\n    },\n  },\n\n  methods: {\n    update() {\n      this.$emit('input', this.value);\n    },\n\n    valuesChanged(value) {\n      try {\n        jsyaml.load(value);\n        if (value === defaultOverlayFile) {\n          value = '';\n        } else {\n          this.overlayFile = value;\n        }\n        this.value.overlayFile = value;\n      } catch (e) {\n      }\n    },\n\n    onFileSelected(value) {\n      this.$refs['yaml-editor'].updateValue(value);\n    },\n\n    changeKiali(value) {\n      if (value && this.value.pilot) {\n        this.value.pilot.enabled = true;\n        this.showKialiBanner = true;\n      } else if (!value) {\n        this.showKialiBanner = false;\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <!-- Conditionally display PSP checkbox -->\n    <ChartPsp\n      :value=\"value\"\n      :title=\"t('catalog.chart.global')\"\n      :cluster=\"currentCluster\"\n    />\n\n    <h3>\n      {{ t('istio.titles.components') }}\n    </h3>\n    <div class=\"row mb-10\">\n      <div\n        v-if=\"value.cni\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.cni.enabled\"\n          :label=\"t('istio.cni')\"\n          @input=\"update\"\n        />\n      </div>\n      <div\n        v-if=\"value.ingressGateways\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.ingressGateways.enabled\"\n          :label=\"t('istio.ingressGateway')\"\n        />\n      </div>\n      <div\n        v-if=\"value.egressGateways\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.egressGateways.enabled\"\n          :label=\"t('istio.egressGateway')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mb-10\">\n      <div\n        v-if=\"value.pilot\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.pilot.enabled\"\n          :label=\"t('istio.pilot')\"\n          :disabled=\"value.kiali && value.kiali.enabled\"\n        />\n      </div>\n      <div\n        v-if=\"value.policy\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.policy.enabled\"\n          :label=\"t('istio.policy')\"\n        />\n      </div>\n      <div\n        v-if=\"value.telemetry\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.telemetry.enabled\"\n          :label=\"t('istio.telemetry')\"\n        />\n      </div>\n    </div>\n    <div class=\"row mb-20\">\n      <div\n        v-if=\"value.kiali\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.kiali.enabled\"\n          :label=\"t('istio.kiali')\"\n          @input=\"changeKiali\"\n        />\n      </div>\n      <div\n        v-if=\"value.tracing\"\n        class=\"col span-4\"\n      >\n        <Checkbox\n          v-model=\"value.tracing.enabled\"\n          :label=\"t('istio.tracing')\"\n        />\n      </div>\n      <div class=\"col span-4\" />\n    </div>\n    <div\n      v-if=\"showKialiBanner\"\n      class=\"row\"\n    >\n      <div class=\"col span-12\">\n        <Banner color=\"info\">\n          <span\n            v-clean-html=\"t('istio.pilotRequired', {}, true)\"\n          />\n        </Banner>\n      </div>\n    </div>\n\n    <h3>{{ t('istio.customOverlayFile.label') }}</h3>\n    <div class=\"custom-overlay\">\n      <Banner color=\"info\">\n        <span\n          v-clean-html=\"t('istio.customOverlayFile.tip', {}, true)\"\n        />\n      </Banner>\n      <YamlEditor\n        ref=\"yaml-editor\"\n        class=\"yaml-editor mb-10\"\n        :value=\"overlayFile\"\n        @onInput=\"valuesChanged\"\n      />\n      <FileSelector\n        class=\"role-primary  btn-sm\"\n        :label=\"t('generic.readFromFile')\"\n        @selected=\"onFileSelected\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang='scss'>\n  $yaml-height: 200px;\n\n  .custom-overlay {\n    &>DIV{\n      color: var(--input-label);\n      &>*{\n        padding: 3px;\n      }\n    }\n\n    & .yaml-editor{\n      flex: 1;\n      min-height: $yaml-height;\n      & .code-mirror .CodeMirror {\n        position: initial;\n        height: auto;\n        min-height: $yaml-height;\n      }\n    }\n  }\n</style>\n"]}]}