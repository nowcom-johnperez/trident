{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/Tolerations.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/Tolerations.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgTGFiZWxlZElucHV0IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9MYWJlbGVkSW5wdXQnOwppbXBvcnQgU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vU2VsZWN0JzsKaW1wb3J0IFVuaXRJbnB1dCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL1VuaXRJbnB1dCc7CmltcG9ydCB7IF9WSUVXIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9xdWVyeS1wYXJhbXMnOwppbXBvcnQgeyByYW5kb20zMiB9IGZyb20gJ0BzaGVsbC91dGlscy9zdHJpbmcnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIExhYmVsZWRJbnB1dCwKICAgIFNlbGVjdCwKICAgIC8vIFNvcnRhYmxlVGFibGUsCiAgICBVbml0SW5wdXQKICB9LAogIHByb3BzOiB7CiAgICAvLyBwb2QgdG9sZXJhdGlvbnMgYXJyYXkKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiBbXQogICAgfSwKCiAgICBtb2RlOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ2VkaXQnCiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIGNvbnN0IHJ1bGVzID0gW107CgogICAgLy8gb24gY3JlYXRpb24gaW4gYWdlbnQgY29uZmlndXJhdGlvbiwgdGhlIGJhY2tlbmQgImVhdHMiCiAgICAvLyB0aGUgZW1wdHkgImVmZmVjdCIgc3RyaW5nLCB3aGljaCBkb2Vzbid0IGhhcHBlbiBvbiBlZGl0CiAgICAvLyBqdXN0IHRvIG1ha2Ugc3VyZSB3ZSBwb3B1bGF0ZSBpdCBjb3JyZWN0eSwgbGV0J3MgY29uc2lkZXIKICAgIC8vIG5vIHByb3AgImVmZmVjdCIgYXMgYW4gZW1wdHkgc3RyaW5nIHdoaWNoIG1lYW5zIGFsbAogICAgLy8gaHR0cHM6Ly9rdWJlcm5ldGVzLmlvL2RvY3MvcmVmZXJlbmNlL2dlbmVyYXRlZC9rdWJlcm5ldGVzLWFwaS92MS4yNS8jdG9sZXJhdGlvbi12MS1jb3JlCiAgICBpZiAodGhpcy52YWx1ZS5sZW5ndGgpIHsKICAgICAgdGhpcy52YWx1ZS5mb3JFYWNoKCh2KSA9PiB7CiAgICAgICAgaWYgKCFPYmplY3Qua2V5cyh2KS5pbmNsdWRlcygnZWZmZWN0JykpIHsKICAgICAgICAgIHJ1bGVzLnB1c2goewogICAgICAgICAgICAuLi52LAogICAgICAgICAgICBlZmZlY3Q6ICcnCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcnVsZXMucHVzaCh2KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKICAgIHJldHVybiB7IHJ1bGVzIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHRhYmxlSGVhZGVycygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAgJ2tleScsCiAgICAgICAgICBsYWJlbDogdGhpcy50KCd3b3JrbG9hZC5zY2hlZHVsaW5nLnRvbGVyYXRpb25zLmxhYmVsS2V5JyksCiAgICAgICAgICB2YWx1ZTogJ2tleScKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAnb3BlcmF0b3InLAogICAgICAgICAgbGFiZWw6IHRoaXMudCgnd29ya2xvYWQuc2NoZWR1bGluZy50b2xlcmF0aW9ucy5vcGVyYXRvcicpLAogICAgICAgICAgdmFsdWU6ICdvcGVyYXRvcicsCiAgICAgICAgICB3aWR0aDogJzEwJScKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAndmFsdWUnLAogICAgICAgICAgbGFiZWw6IHRoaXMudCgnd29ya2xvYWQuc2NoZWR1bGluZy50b2xlcmF0aW9ucy52YWx1ZScpLAogICAgICAgICAgdmFsdWU6ICd2YWx1ZScKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAnZWZmZWN0JywKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ3dvcmtsb2FkLnNjaGVkdWxpbmcudG9sZXJhdGlvbnMuZWZmZWN0JyksCiAgICAgICAgICB2YWx1ZTogJ2VmZmVjdCcsCiAgICAgICAgICB3aWR0aDogJzIwJScKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIG5hbWU6ICAnc2Vjb25kcycsCiAgICAgICAgICBsYWJlbDogdGhpcy50KCd3b3JrbG9hZC5zY2hlZHVsaW5nLnRvbGVyYXRpb25zLnRvbGVyYXRpb25TZWNvbmRzJyksCiAgICAgICAgICB2YWx1ZTogJ3RvbGVyYXRpb25TZWNvbmRzJywKICAgICAgICAgIHdpZHRoOiAnMjAlJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogICdyZW1vdmUnLAogICAgICAgICAgd2lkdGg6ICc1MCcKICAgICAgICB9CiAgICAgIF07CiAgICB9LAogICAgb3BlcmF0b3JPcHRzKCkgewogICAgICByZXR1cm4gWwogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ3dvcmtsb2FkLnNjaGVkdWxpbmcudG9sZXJhdGlvbnMub3BlcmF0b3JPcHRpb25zLmV4aXN0cycpLAogICAgICAgICAgdmFsdWU6ICdFeGlzdHMnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCd3b3JrbG9hZC5zY2hlZHVsaW5nLnRvbGVyYXRpb25zLm9wZXJhdG9yT3B0aW9ucy5lcXVhbCcpLAogICAgICAgICAgdmFsdWU6ICdFcXVhbCcKICAgICAgICB9CiAgICAgIF07CiAgICB9LAogICAgZWZmZWN0T3B0cygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCd3b3JrbG9hZC5zY2hlZHVsaW5nLnRvbGVyYXRpb25zLmVmZmVjdE9wdGlvbnMuYWxsJyksCiAgICAgICAgICB2YWx1ZTogJycKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ3dvcmtsb2FkLnNjaGVkdWxpbmcudG9sZXJhdGlvbnMuZWZmZWN0T3B0aW9ucy5ub1NjaGVkdWxlJyksCiAgICAgICAgICB2YWx1ZTogJ05vU2NoZWR1bGUnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCd3b3JrbG9hZC5zY2hlZHVsaW5nLnRvbGVyYXRpb25zLmVmZmVjdE9wdGlvbnMucHJlZmVyTm9TY2hlZHVsZScpLAogICAgICAgICAgdmFsdWU6ICdQcmVmZXJOb1NjaGVkdWxlJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnd29ya2xvYWQuc2NoZWR1bGluZy50b2xlcmF0aW9ucy5lZmZlY3RPcHRpb25zLm5vRXhlY3V0ZScpLAogICAgICAgICAgdmFsdWU6ICdOb0V4ZWN1dGUnCiAgICAgICAgfQogICAgICBdOwogICAgfSwKCiAgICBpc1ZpZXcoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9WSUVXOwogICAgfSwKICAgIC4uLm1hcEdldHRlcnMoeyB0OiAnaTE4bi90JyB9KQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHJlbW92ZShyb3cpIHsKICAgICAgY29uc3QgaWR4ID0gdGhpcy5ydWxlcy5pbmRleE9mKHJvdyk7CgogICAgICB0aGlzLnJ1bGVzLnNwbGljZShpZHgsIDEpOwogICAgICB0aGlzLnVwZGF0ZSgpOwogICAgfSwKCiAgICB1cGRhdGUoKSB7CiAgICAgIC8vIGxldCdzIGRlbGV0ZSB0aGUgdktleSBwcm9wIGFzIGl0J3Mgb25seSBwb2x1dGluZyB0aGUgZGF0YQogICAgICBjb25zdCBydWxlcyA9IHRoaXMucnVsZXMubWFwKChydWxlKSA9PiB7CiAgICAgICAgY29uc3QgbmV3UnVsZSA9IHsgLi4ucnVsZSB9OwoKICAgICAgICAvLyBwcmV2ZW50IHZLZXkgZnJvbSBiZWluZyBzZW50IGFzIGRhdGEKICAgICAgICBpZiAobmV3UnVsZS52S2V5KSB7CiAgICAgICAgICBkZWxldGUgbmV3UnVsZS52S2V5OwogICAgICAgIH0KCiAgICAgICAgLy8gbGV0J3MgY2xlYXIgdGhlIHZhbHVlIGZpZWxkIGlmIG9wZXJhdG9yIGlzIEV4aXN0cwogICAgICAgIGlmIChuZXdSdWxlLm9wZXJhdG9yID09PSAnRXhpc3RzJyAmJiBuZXdSdWxlLnZhbHVlKSB7CiAgICAgICAgICBuZXdSdWxlLnZhbHVlID0gbnVsbDsKICAgICAgICB9CgogICAgICAgIC8vIHJlbW92ZSBlZmZlY3QgZnJvbSBwYXlsb2FkIHNlbnQgdXBzdHJlYW0sIGFzIGl0J3MgZW1wdHkKICAgICAgICAvLyBpdCBzaG91bGQgYmUgbnVsbCwgYnV0IHRoZSBTZWxlY3QgaW5wdXQgZG9lc24ndCBzZWVtIHRvIGxpa2UgaXQKICAgICAgICAvLyBzbyB3ZSBrZWVwIGl0IGFzICcnIGFuZCBzYW5pdGl6ZSBpdCBoZXJlCiAgICAgICAgaWYgKG5ld1J1bGUuZWZmZWN0ID09PSAnJykgewogICAgICAgICAgZGVsZXRlIG5ld1J1bGUuZWZmZWN0OwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG5ld1J1bGU7CiAgICAgIH0pOwoKICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBydWxlcyk7CiAgICB9LAoKICAgIGFkZFRvbGVyYXRpb24oKSB7CiAgICAgIHRoaXMucnVsZXMucHVzaCh7IHZLZXk6IHJhbmRvbTMyKCksIGVmZmVjdDogJycgfSk7CiAgICB9LAoKICAgIHVwZGF0ZUVmZmVjdChuZXUsIHJ1bGUpIHsKICAgICAgaWYgKG5ldSAhPT0gJ05vRXhlY3V0ZScgJiYgcnVsZS50b2xlcmF0aW9uU2Vjb25kcykgewogICAgICAgIGRlbGV0ZSBydWxlLnRvbGVyYXRpb25TZWNvbmRzOwogICAgICB9CgogICAgICB0aGlzLnVwZGF0ZSgpOwogICAgfQogIH0KCn07Cg=="},{"version":3,"sources":["Tolerations.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA","file":"Tolerations.vue","sourceRoot":"node_modules/@rancher/shell/components/form","sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport Select from '@shell/components/form/Select';\nimport UnitInput from '@shell/components/form/UnitInput';\nimport { _VIEW } from '@shell/config/query-params';\nimport { random32 } from '@shell/utils/string';\n\nexport default {\n  components: {\n    LabeledInput,\n    Select,\n    // SortableTable,\n    UnitInput\n  },\n  props: {\n    // pod tolerations array\n    value: {\n      type:    Array,\n      default: () => []\n    },\n\n    mode: {\n      type:    String,\n      default: 'edit'\n    }\n  },\n\n  data() {\n    const rules = [];\n\n    // on creation in agent configuration, the backend \"eats\"\n    // the empty \"effect\" string, which doesn't happen on edit\n    // just to make sure we populate it correcty, let's consider\n    // no prop \"effect\" as an empty string which means all\n    // https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.25/#toleration-v1-core\n    if (this.value.length) {\n      this.value.forEach((v) => {\n        if (!Object.keys(v).includes('effect')) {\n          rules.push({\n            ...v,\n            effect: ''\n          });\n        } else {\n          rules.push(v);\n        }\n      });\n    }\n\n    return { rules };\n  },\n\n  computed: {\n    tableHeaders() {\n      return [\n        {\n          name:  'key',\n          label: this.t('workload.scheduling.tolerations.labelKey'),\n          value: 'key'\n        },\n        {\n          name:  'operator',\n          label: this.t('workload.scheduling.tolerations.operator'),\n          value: 'operator',\n          width: '10%'\n        },\n        {\n          name:  'value',\n          label: this.t('workload.scheduling.tolerations.value'),\n          value: 'value'\n        },\n        {\n          name:  'effect',\n          label: this.t('workload.scheduling.tolerations.effect'),\n          value: 'effect',\n          width: '20%'\n        },\n        {\n          name:  'seconds',\n          label: this.t('workload.scheduling.tolerations.tolerationSeconds'),\n          value: 'tolerationSeconds',\n          width: '20%'\n        },\n        {\n          name:  'remove',\n          width: '50'\n        }\n      ];\n    },\n    operatorOpts() {\n      return [\n        {\n          label: this.t('workload.scheduling.tolerations.operatorOptions.exists'),\n          value: 'Exists'\n        },\n        {\n          label: this.t('workload.scheduling.tolerations.operatorOptions.equal'),\n          value: 'Equal'\n        }\n      ];\n    },\n    effectOpts() {\n      return [\n        {\n          label: this.t('workload.scheduling.tolerations.effectOptions.all'),\n          value: ''\n        },\n        {\n          label: this.t('workload.scheduling.tolerations.effectOptions.noSchedule'),\n          value: 'NoSchedule'\n        },\n        {\n          label: this.t('workload.scheduling.tolerations.effectOptions.preferNoSchedule'),\n          value: 'PreferNoSchedule'\n        },\n        {\n          label: this.t('workload.scheduling.tolerations.effectOptions.noExecute'),\n          value: 'NoExecute'\n        }\n      ];\n    },\n\n    isView() {\n      return this.mode === _VIEW;\n    },\n    ...mapGetters({ t: 'i18n/t' })\n  },\n\n  methods: {\n    remove(row) {\n      const idx = this.rules.indexOf(row);\n\n      this.rules.splice(idx, 1);\n      this.update();\n    },\n\n    update() {\n      // let's delete the vKey prop as it's only poluting the data\n      const rules = this.rules.map((rule) => {\n        const newRule = { ...rule };\n\n        // prevent vKey from being sent as data\n        if (newRule.vKey) {\n          delete newRule.vKey;\n        }\n\n        // let's clear the value field if operator is Exists\n        if (newRule.operator === 'Exists' && newRule.value) {\n          newRule.value = null;\n        }\n\n        // remove effect from payload sent upstream, as it's empty\n        // it should be null, but the Select input doesn't seem to like it\n        // so we keep it as '' and sanitize it here\n        if (newRule.effect === '') {\n          delete newRule.effect;\n        }\n\n        return newRule;\n      });\n\n      this.$emit('input', rules);\n    },\n\n    addToleration() {\n      this.rules.push({ vKey: random32(), effect: '' });\n    },\n\n    updateEffect(neu, rule) {\n      if (neu !== 'NoExecute' && rule.tolerationSeconds) {\n        delete rule.tolerationSeconds;\n      }\n\n      this.update();\n    }\n  }\n\n};\n</script>\n\n<template>\n  <div class=\"tolerations\">\n    <div\n      v-if=\"rules.length\"\n      class=\"toleration-headers\"\n    >\n      <span>{{ t('workload.scheduling.tolerations.labelKey') }}</span>\n      <span>{{ t('workload.scheduling.tolerations.operator') }}</span>\n      <span>{{ t('workload.scheduling.tolerations.value') }}</span>\n      <span>{{ t('workload.scheduling.tolerations.effect') }}</span>\n      <span>{{ t('workload.scheduling.tolerations.tolerationSeconds') }}</span>\n      <span />\n    </div>\n    <div\n      v-for=\"(rule, index) in rules\"\n      :key=\"rule.vKey\"\n      class=\"rule\"\n    >\n      <div class=\"col\">\n        <LabeledInput\n          v-model=\"rule.key\"\n          :mode=\"mode\"\n          :data-testid=\"`toleration-key-index${ index }`\"\n          class=\"height-adjust-input\"\n          @input=\"update\"\n        />\n      </div>\n      <div class=\"col\">\n        <Select\n          id=\"operator\"\n          v-model=\"rule.operator\"\n          :options=\"operatorOpts\"\n          :mode=\"mode\"\n          :data-testid=\"`toleration-operator-index${ index }`\"\n          @input=\"update\"\n        />\n      </div>\n      <template v-if=\"rule.operator==='Exists'\">\n        <div class=\"col\">\n          <LabeledInput\n            value=\"n/a\"\n            :mode=\"mode\"\n            disabled\n            class=\"height-adjust-input\"\n          />\n        </div>\n      </template>\n      <template v-else>\n        <div class=\"col\">\n          <LabeledInput\n            v-model=\"rule.value\"\n            :mode=\"mode\"\n            :data-testid=\"`toleration-value-index${ index }`\"\n            class=\"height-adjust-input\"\n            @input=\"update\"\n          />\n        </div>\n      </template>\n      <div class=\"col\">\n        <Select\n          v-model=\"rule.effect\"\n          :options=\"effectOpts\"\n          :mode=\"mode\"\n          :data-testid=\"`toleration-effect-index${ index }`\"\n          @input=\"e=>updateEffect(e, rule)\"\n        />\n      </div>\n      <div class=\"col\">\n        <UnitInput\n          v-model=\"rule.tolerationSeconds\"\n          :disabled=\"rule.effect !== 'NoExecute'\"\n          :mode=\"mode\"\n          suffix=\"Seconds\"\n          :data-testid=\"`toleration-seconds-index${ index }`\"\n          class=\"height-adjust-input\"\n          @input=\"update\"\n        />\n      </div>\n      <div class=\"col remove\">\n        <button\n          v-if=\"!isView\"\n          type=\"button\"\n          class=\"btn role-link\"\n          :disabled=\"mode==='view'\"\n          :data-testid=\"`toleration-remove-index${ index }`\"\n          @click=\"remove(rule)\"\n        >\n          <t k=\"generic.remove\" />\n        </button>\n      </div>\n    </div>\n    <button\n      v-if=\"!isView\"\n      type=\"button\"\n      class=\"btn role-tertiary\"\n      data-testid=\"add-toleration-btn\"\n      @click=\"addToleration\"\n    >\n      <t k=\"workload.scheduling.tolerations.addToleration\" />\n    </button>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n.tolerations{\n  width: 100%;\n}\n\n.rule, .toleration-headers{\n  display: grid;\n  grid-template-columns: 20% 10% 20% 15% 20% 15%;\n  grid-gap: 10px;\n  align-items: center;\n}\n\n.rule {\n  margin-bottom: 20px;\n  .col {\n    height: 100%;\n  }\n}\n\n.toleration-headers SPAN {\n  color: var(--input-label);\n  margin-bottom: 10px;\n}\n.remove BUTTON {\n  padding: 0px;\n}\n.height-adjust-input {\n  min-height: 42px;\n}\n</style>\n"]}]}