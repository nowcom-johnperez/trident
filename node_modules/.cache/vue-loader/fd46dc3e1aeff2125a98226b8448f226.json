{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/catalog.cattle.io.app.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/catalog.cattle.io.app.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBZYW1sRWRpdG9yIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1lhbWxFZGl0b3InOwppbXBvcnQgTG9hZGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Mb2FkaW5nJzsKaW1wb3J0IE1hcmtkb3duIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL01hcmtkb3duJzsKaW1wb3J0IFRhYmJlZCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgeyBCYW5uZXIgfSBmcm9tICdAY29tcG9uZW50cy9CYW5uZXInOwppbXBvcnQgUmVsYXRlZFJlc291cmNlcyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9SZWxhdGVkUmVzb3VyY2VzJzsKaW1wb3J0IGpzeWFtbCBmcm9tICdqcy15YW1sJzsKaW1wb3J0IG1lcmdlIGZyb20gJ2xvZGFzaC9tZXJnZSc7CmltcG9ydCB7IENBVEFMT0cgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnfnNoZWxsL3V0aWxzL3NvcnQnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEZXRhaWxSZWxlYXNlJywKCiAgY29tcG9uZW50czogewogICAgTWFya2Rvd24sIFRhYmJlZCwgVGFiLCBMb2FkaW5nLCBZYW1sRWRpdG9yLCBCYW5uZXIsIFJlbGF0ZWRSZXNvdXJjZXMKICB9LAoKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4geyBhbGxPcGVyYXRpb25zOiBbXSB9OwogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NhdGFsb2cvbG9hZCcsIHsgZm9yY2U6IHRydWUsIHJlc2V0OiB0cnVlIH0pOwoKICAgIHRoaXMuYWxsT3BlcmF0aW9ucyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmRBbGwnLCB7IHR5cGU6IENBVEFMT0cuT1BFUkFUSU9OIH0pOwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBoYXNOb3RlcygpIHsKICAgICAgcmV0dXJuICEhdGhpcy52YWx1ZT8uc3BlYz8uaW5mbz8ubm90ZXM7CiAgICB9LAoKICAgIGhhc1JlYWRtZSgpIHsKICAgICAgcmV0dXJuICEhdGhpcy52YWx1ZT8uc3BlYz8uaW5mbz8ucmVhZG1lOwogICAgfSwKCiAgICB2YWx1ZXNZYW1sKCkgewogICAgICBjb25zdCBjb21iaW5lZCA9IG1lcmdlKG1lcmdlKHt9LCB0aGlzLnZhbHVlPy5zcGVjPy5jaGFydD8udmFsdWVzIHx8IHt9KSwgdGhpcy52YWx1ZT8uc3BlYz8udmFsdWVzIHx8IHt9KTsKCiAgICAgIHJldHVybiBqc3lhbWwuZHVtcChjb21iaW5lZCk7CiAgICB9LAoKICAgIGlzQnVzeSgpIHsKICAgICAgaWYgKHRoaXMudmFsdWU/Lm1ldGFkYXRhPy5zdGF0ZT8udHJhbnNpdGlvbmluZyAmJiB0aGlzLnZhbHVlPy5tZXRhZGF0YT8uc3RhdGU/Lm5hbWUgPT09ICdwZW5kaW5nLWluc3RhbGwnKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCgogICAgZmlsdGVyZWRPcGVyYXRpb25zKCkgewogICAgICByZXR1cm4gdGhpcy5hbGxPcGVyYXRpb25zLmZpbHRlcigob3BlcmF0aW9uKSA9PiB7CiAgICAgICAgaWYgKG9wZXJhdGlvbi5zdGF0dXM/LnJlbGVhc2VOYW1lID09PSB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWUgJiYKICAgICAgICAgICAgb3BlcmF0aW9uLnN0YXR1cz8ubmFtZXNwYWNlID09PSB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWVzcGFjZSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgbGF0ZXN0T3BlcmF0aW9uKCkgewogICAgICBpZiAodGhpcy5maWx0ZXJlZE9wZXJhdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgIGNvbnN0IHNvcnRlZE9wZXJhdGlvbnMgPSBzb3J0QnkoT2JqZWN0LnZhbHVlcyh0aGlzLmZpbHRlcmVkT3BlcmF0aW9ucyksIFsnY3JlYXRlZEF0JywgJ2NyZWF0ZWQnLCAnbWV0YWRhdGEuY3JlYXRpb25UaW1lc3RhbXAnXSwgdHJ1ZSk7CgogICAgICAgIHJldHVybiBzb3J0ZWRPcGVyYXRpb25zWzBdOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAoKICB9LAoKICBtZXRob2RzOiB7CiAgICB0YWJDaGFuZ2VkKHsgdGFiIH0pIHsKICAgICAgd2luZG93LnNjcm9sbFRvcCA9IDA7CgogICAgICB0aGlzLnNlbGVjdGVkVGFiTmFtZSA9IHRhYi5uYW1lOwoKICAgICAgaWYgKCB0YWIubmFtZSA9PT0gJ3ZhbHVlcy15YW1sJyApIHsKICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICBpZiAoIHRoaXMuJHJlZnMueWFtbCApIHsKICAgICAgICAgICAgdGhpcy4kcmVmcy55YW1sLnJlZnJlc2goKTsKICAgICAgICAgICAgdGhpcy4kcmVmcy55YW1sLmZvY3VzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["catalog.cattle.io.app.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"catalog.cattle.io.app.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport YamlEditor from '@shell/components/YamlEditor';\nimport Loading from '@shell/components/Loading';\nimport Markdown from '@shell/components/Markdown';\nimport Tabbed from '@shell/components/Tabbed';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport { Banner } from '@components/Banner';\nimport RelatedResources from '@shell/components/RelatedResources';\nimport jsyaml from 'js-yaml';\nimport merge from 'lodash/merge';\nimport { CATALOG } from '@shell/config/types';\nimport { sortBy } from '~shell/utils/sort';\n\nexport default {\n  name: 'DetailRelease',\n\n  components: {\n    Markdown, Tabbed, Tab, Loading, YamlEditor, Banner, RelatedResources\n  },\n\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n\n  data() {\n    return { allOperations: [] };\n  },\n\n  async fetch() {\n    await this.$store.dispatch('catalog/load', { force: true, reset: true });\n\n    this.allOperations = await this.$store.dispatch('cluster/findAll', { type: CATALOG.OPERATION });\n  },\n\n  computed: {\n    hasNotes() {\n      return !!this.value?.spec?.info?.notes;\n    },\n\n    hasReadme() {\n      return !!this.value?.spec?.info?.readme;\n    },\n\n    valuesYaml() {\n      const combined = merge(merge({}, this.value?.spec?.chart?.values || {}), this.value?.spec?.values || {});\n\n      return jsyaml.dump(combined);\n    },\n\n    isBusy() {\n      if (this.value?.metadata?.state?.transitioning && this.value?.metadata?.state?.name === 'pending-install') {\n        return true;\n      }\n\n      return false;\n    },\n\n    filteredOperations() {\n      return this.allOperations.filter((operation) => {\n        if (operation.status?.releaseName === this.value.metadata.name &&\n            operation.status?.namespace === this.value.metadata.namespace) {\n          return true;\n        }\n      });\n    },\n\n    latestOperation() {\n      if (this.filteredOperations.length > 0) {\n        const sortedOperations = sortBy(Object.values(this.filteredOperations), ['createdAt', 'created', 'metadata.creationTimestamp'], true);\n\n        return sortedOperations[0];\n      }\n\n      return false;\n    },\n\n  },\n\n  methods: {\n    tabChanged({ tab }) {\n      window.scrollTop = 0;\n\n      this.selectedTabName = tab.name;\n\n      if ( tab.name === 'values-yaml' ) {\n        this.$nextTick(() => {\n          if ( this.$refs.yaml ) {\n            this.$refs.yaml.refresh();\n            this.$refs.yaml.focus();\n          }\n        });\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <span\n      v-if=\"latestOperation\"\n      class=\"latest-operation\"\n    >\n      {{ t('catalog.app.section.lastOperation') }}: ( {{ latestOperation.status.action }} ) - <a @click=\"latestOperation.openLogs()\">  {{ t('catalog.app.section.openLogs') }}</a>\n    </span>\n\n    <Tabbed\n      class=\"mt-20\"\n      default-tab=\"resources\"\n      @changed=\"tabChanged($event)\"\n    >\n      <Tab\n        name=\"resources\"\n        :label=\"t('catalog.app.section.resources.label')\"\n        :weight=\"4\"\n      >\n        <Banner\n          v-if=\"isBusy\"\n          color=\"info\"\n          :label=\"t('catalog.app.section.resources.busy', { app: value.metadata.name })\"\n        />\n        <RelatedResources\n          v-else\n          :value=\"value\"\n          rel=\"helmresource\"\n        />\n      </Tab>\n      <Tab\n        name=\"values-yaml\"\n        :label=\"t('catalog.app.section.values')\"\n        :weight=\"3\"\n      >\n        <YamlEditor\n          ref=\"yaml\"\n          :scrolling=\"false\"\n          :value=\"valuesYaml\"\n          editor-mode=\"VIEW_CODE\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"hasReadme\"\n        name=\"readme\"\n        :label=\"t('catalog.app.section.readme')\"\n        :weight=\"2\"\n      >\n        <Markdown v-model=\"value.spec.info.readme\" />\n      </Tab>\n      <Tab\n        v-if=\"hasNotes\"\n        name=\"notes\"\n        :label=\"t('catalog.app.section.notes')\"\n        :weight=\"1\"\n      >\n        <Markdown v-model=\"value.spec.info.notes\" />\n      </Tab>\n    </Tabbed>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.latest-operation a {\n  cursor: pointer;\n}\n</style>\n"]}]}