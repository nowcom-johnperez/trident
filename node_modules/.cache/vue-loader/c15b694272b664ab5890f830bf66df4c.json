{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/networking.k8s.io.ingress/RulePath.vue?vue&type=style&index=0&id=63513d70&lang=scss&scoped=true","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/networking.k8s.io.ingress/RulePath.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1716430467357},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/postcss-loader/src/index.js","mtime":1716430467882},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/sass-loader/dist/cjs.js","mtime":1716430453705},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiRyb3ctaGVpZ2h0OiA0MHB4OwoKLmxhYmVsZWQtaW5wdXQgOjp2LWRlZXAsIDo6di1kZWVwIC5sYWJlbGVkLWlucHV0IHsKICBwYWRkaW5nOiAwICFpbXBvcnRhbnQ7CiAgaGVpZ2h0OiAxMDAlOwogIGlucHV0Lm5vLWxhYmVsIHsKICAgIGhlaWdodDogY2FsYygkcm93LWhlaWdodCAtIDJweCk7CiAgICBwYWRkaW5nOiAxMHB4OwogIH0KfQoucnVsZS1wYXRoIDo6di1kZWVwIHsKICAuY29sLCBJTlBVVCB7CiAgICBoZWlnaHQ6ICRyb3ctaGVpZ2h0OwogIH0KCiAgLnVubGFiZWxlZC1zZWxlY3QgewogICAgaGVpZ2h0OiAxMDAlOwogIH0KCiAgLnBhdGgtdHlwZSB7CiAgICAudW5sYWJlbGVkLXNlbGVjdCB7CiAgICAgIG1pbi13aWR0aDogMjAwcHg7CiAgICB9CiAgfQoKICAmLCAuaW5wdXQtY29udGFpbmVyIHsKICAgIGhlaWdodDogJHJvdy1oZWlnaHQ7CiAgfQoKICAuaW5wdXQtY29udGFpbmVyIC5pbi1pbnB1dC51bmxhYmVsZWQtc2VsZWN0IHsKICAgIHdpZHRoOiBpbml0aWFsOwogIH0KCiAgYnV0dG9uIHsKICAgIGxpbmUtaGVpZ2h0OiAkcm93LWhlaWdodDsKICB9CgogIC52LXNlbGVjdCBJTlBVVCB7CiAgICBoZWlnaHQ6IDUwcHg7CiAgfQogIC5sYWJlbGVkLWlucHV0IHsKICAgIHBhZGRpbmctdG9wOiA2cHg7CiAgfQp9Cg=="},{"version":3,"sources":["RulePath.vue"],"names":[],"mappings":";AAsLA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RulePath.vue","sourceRoot":"node_modules/@rancher/shell/edit/networking.k8s.io.ingress","sourcesContent":["<script>\nimport InputWithSelect from '@shell/components/form/InputWithSelect';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport Select from '@shell/components/form/Select';\nimport { get, set } from '@shell/utils/object';\nimport debounce from 'lodash/debounce';\n\nexport default {\n  components: {\n    InputWithSelect, LabeledInput, Select\n  },\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    serviceTargets: {\n      type:    Array,\n      default: () => []\n    },\n    ingress: {\n      type:     Object,\n      required: true\n    },\n    rules: {\n      default: () => ({\n        path:   [],\n        port:   [],\n        target: []\n      }),\n      type: Object,\n    }\n  },\n  data() {\n    const pathTypes = [\n      'Prefix',\n      'Exact',\n      'ImplementationSpecific'\n    ];\n\n    set(this.value, 'backend', this.value.backend || {});\n    set(this.value, 'path', this.value.path || '');\n    set(this.value, 'pathType', this.value.pathType || pathTypes[0]);\n    set(this.value.backend, this.ingress.serviceNamePath, get(this.value.backend, this.ingress.serviceNamePath) || '');\n    set(this.value.backend, this.ingress.servicePortPath, get(this.value.backend, this.ingress.servicePortPath) || '');\n\n    const serviceName = get(this.value.backend, this.ingress.serviceNamePath);\n    const servicePort = get(this.value.backend, this.ingress.servicePortPath);\n\n    return {\n      pathTypes, serviceName, servicePort, pathType: this.value.pathType, path: this.value.path\n    };\n  },\n  computed: {\n    portOptions() {\n      const service = this.serviceTargets.find((s) => s.label === this.serviceName);\n\n      return service?.ports || [];\n    },\n    serviceTargetStatus() {\n      const serviceName = this.serviceName?.label || this.serviceName;\n      const isValueAnOption = !serviceName || this.serviceTargets.find((target) => serviceName === target.value);\n\n      return isValueAnOption ? null : 'warning';\n    },\n    serviceTargetTooltip() {\n      if (this.serviceTargetStatus === 'warning' ) {\n        return this.t('ingress.rules.target.doesntExist');\n      }\n\n      return this.t('ingress.rules.target.tooltip');\n    },\n  },\n  created() {\n    this.queueUpdate = debounce(this.update, 500);\n    this.queueUpdatePathTypeAndPath = debounce(this.updatePathTypeAndPath, 500);\n  },\n  methods: {\n    update() {\n      const servicePort = Number.parseInt(this.servicePort) || this.servicePort;\n      const serviceName = this.serviceName.label || this.serviceName;\n      const out = {\n        id: this.value.id, backend: {}, path: this.path, pathType: this.pathType\n      };\n\n      set(out.backend, this.ingress.servicePortPath, servicePort);\n      set(out.backend, this.ingress.serviceNamePath, serviceName);\n\n      this.$emit('input', out);\n    },\n    updatePathTypeAndPath(values) {\n      this.path = values.text;\n      this.pathType = values.selected;\n      this.update();\n    },\n    focus() {\n      this.$refs.first.focus();\n    },\n    remove(ev) {\n      ev.preventDefault();\n      this.$emit('remove');\n    }\n  }\n};\n</script>\n<template>\n  <div class=\"rule-path row\">\n    <div\n      v-if=\"ingress.showPathType\"\n      class=\"col span-6\"\n    >\n      <InputWithSelect\n        ref=\"first\"\n        class=\"path-type\"\n        :options=\"pathTypes\"\n        :placeholder=\"t('ingress.rules.path.placeholder', undefined, true)\"\n        :select-value=\"value.pathType\"\n        :text-value=\"value.path\"\n        :searchable=\"false\"\n        :text-rules=\"rules.path\"\n        @input=\"queueUpdatePathTypeAndPath\"\n      />\n    </div>\n    <div\n      v-else\n      class=\"col span-4\"\n    >\n      <input\n        ref=\"first\"\n        v-model=\"path\"\n        :placeholder=\"t('ingress.rules.path.placeholder', undefined, true)\"\n        @input=\"queueUpdate\"\n      >\n    </div>\n    <div\n      class=\"col\"\n      :class=\"{'span-3': ingress.showPathType, 'span-4': !ingress.showPathType}\"\n    >\n      <Select\n        v-model=\"serviceName\"\n        :options=\"serviceTargets\"\n        :status=\"serviceTargetStatus\"\n        :taggable=\"true\"\n        :searchable=\"true\"\n        :tooltip=\"serviceTargetTooltip\"\n        :hover-tooltip=\"true\"\n        @input=\"servicePort = ''; queueUpdate();\"\n      />\n    </div>\n    <div\n      class=\"col\"\n      :class=\"{'span-2': ingress.showPathType, 'span-3': !ingress.showPathType}\"\n      :style=\"{'margin-right': '0px'}\"\n    >\n      <LabeledInput\n        v-if=\"portOptions.length === 0\"\n        v-model=\"servicePort\"\n        class=\"fullHeightInput\"\n        :placeholder=\"t('ingress.rules.port.placeholder')\"\n        :rules=\"rules.port\"\n        @input=\"queueUpdate\"\n      />\n      <Select\n        v-else\n        v-model=\"servicePort\"\n        :options=\"portOptions\"\n        :placeholder=\"t('ingress.rules.port.placeholder')\"\n        :rules=\"rules.port\"\n        @input=\"queueUpdate\"\n      />\n    </div>\n    <button\n      class=\"btn btn-sm role-link col\"\n      @click=\"remove\"\n    >\n      {{ t('ingress.rules.removePath') }}\n    </button>\n  </div>\n</template>\n<style lang=\"scss\" scoped>\n$row-height: 40px;\n\n.labeled-input ::v-deep, ::v-deep .labeled-input {\n  padding: 0 !important;\n  height: 100%;\n  input.no-label {\n    height: calc($row-height - 2px);\n    padding: 10px;\n  }\n}\n.rule-path ::v-deep {\n  .col, INPUT {\n    height: $row-height;\n  }\n\n  .unlabeled-select {\n    height: 100%;\n  }\n\n  .path-type {\n    .unlabeled-select {\n      min-width: 200px;\n    }\n  }\n\n  &, .input-container {\n    height: $row-height;\n  }\n\n  .input-container .in-input.unlabeled-select {\n    width: initial;\n  }\n\n  button {\n    line-height: $row-height;\n  }\n\n  .v-select INPUT {\n    height: 50px;\n  }\n  .labeled-input {\n    padding-top: 6px;\n  }\n}\n</style>\n"]}]}