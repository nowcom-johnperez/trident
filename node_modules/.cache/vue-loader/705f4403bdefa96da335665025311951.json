{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBWdWUgZnJvbSAndnVlJzsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyBtYXBQcmVmLCBQTFVHSU5fREVWRUxPUEVSIH0gZnJvbSAnQHNoZWxsL3N0b3JlL3ByZWZzJzsKaW1wb3J0IHsgc29ydEJ5IH0gZnJvbSAnQHNoZWxsL3V0aWxzL3NvcnQnOwppbXBvcnQgeyBhbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOwppbXBvcnQgeyBDQVRBTE9HLCBVSV9QTFVHSU4sIFNFUlZJQ0UsIE1BTkFHRU1FTlQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgU0VUVElORyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2V0dGluZ3MnOwppbXBvcnQgeyBmZXRjaE9yQ3JlYXRlU2V0dGluZyB9IGZyb20gJ0BzaGVsbC91dGlscy9zZXR0aW5ncyc7CmltcG9ydCB7IGdldFZlcnNpb25EYXRhIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy92ZXJzaW9uJzsKaW1wb3J0IHsgQ0FUQUxPRyBhcyBDQVRBTE9HX0FOTk9UQVRJT05TIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBOQU1FIGFzIEFQUF9QUk9EVUNUIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9wcm9kdWN0L2FwcHMnOwppbXBvcnQgQWN0aW9uTWVudSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9BY3Rpb25NZW51JzsKaW1wb3J0IFRhYmJlZCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvaW5kZXgudnVlJzsKaW1wb3J0IFRhYiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvVGFiLnZ1ZSc7CmltcG9ydCBJY29uTWVzc2FnZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9JY29uTWVzc2FnZS52dWUnOwppbXBvcnQgTGF6eUltYWdlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xhenlJbWFnZSc7CmltcG9ydCB7IEJhZGdlU3RhdGUgfSBmcm9tICdAY29tcG9uZW50cy9CYWRnZVN0YXRlJzsKaW1wb3J0IFVuaW5zdGFsbERpYWxvZyBmcm9tICcuL1VuaW5zdGFsbERpYWxvZy52dWUnOwppbXBvcnQgSW5zdGFsbERpYWxvZyBmcm9tICcuL0luc3RhbGxEaWFsb2cudnVlJzsKaW1wb3J0IENhdGFsb2dMb2FkRGlhbG9nIGZyb20gJy4vQ2F0YWxvZ0xpc3QvQ2F0YWxvZ0xvYWREaWFsb2cudnVlJzsKaW1wb3J0IENhdGFsb2dVbmluc3RhbGxEaWFsb2cgZnJvbSAnLi9DYXRhbG9nTGlzdC9DYXRhbG9nVW5pbnN0YWxsRGlhbG9nLnZ1ZSc7CmltcG9ydCBEZXZlbG9wZXJJbnN0YWxsRGlhbG9nIGZyb20gJy4vRGV2ZWxvcGVySW5zdGFsbERpYWxvZy52dWUnOwppbXBvcnQgUGx1Z2luSW5mb1BhbmVsIGZyb20gJy4vUGx1Z2luSW5mb1BhbmVsLnZ1ZSc7CmltcG9ydCBTZXR1cFVJUGx1Z2lucyBmcm9tICcuL1NldHVwVUlQbHVnaW5zJzsKaW1wb3J0IFJlbW92ZVVJUGx1Z2lucyBmcm9tICcuL1JlbW92ZVVJUGx1Z2lucyc7CmltcG9ydCBBZGRFeHRlbnNpb25SZXBvcyBmcm9tICcuL0FkZEV4dGVuc2lvblJlcG9zJzsKaW1wb3J0IENhdGFsb2dMaXN0IGZyb20gJy4vQ2F0YWxvZ0xpc3QvaW5kZXgudnVlJzsKaW1wb3J0IEJhbm5lciBmcm9tICdAY29tcG9uZW50cy9CYW5uZXIvQmFubmVyLnZ1ZSc7CmltcG9ydCB7CiAgaXNVSVBsdWdpbiwKICB1aVBsdWdpbkFubm90YXRpb24sCiAgdWlQbHVnaW5IYXNBbm5vdGF0aW9uLAogIGlzU3VwcG9ydGVkQ2hhcnRWZXJzaW9uLAogIGlzQ2hhcnRWZXJzaW9uQXZhaWxhYmxlRm9ySW5zdGFsbCwKICBpc0NoYXJ0VmVyc2lvbkhpZ2hlciwKICBVSV9QTFVHSU5fTkFNRVNQQUNFLAogIFVJX1BMVUdJTl9DSEFSVF9BTk5PVEFUSU9OUywKICBVSV9QTFVHSU5TX1JFUE9fVVJMLAogIFVJX1BMVUdJTlNfUEFSVE5FUlNfUkVQT19VUkwKfSBmcm9tICdAc2hlbGwvY29uZmlnL3VpcGx1Z2lucyc7Cgpjb25zdCBNQVhfREVTQ1JJUFRJT05fTEVOR1RIID0gMjAwOwoKY29uc3QgVEFCU19WQUxVRVMgPSB7CiAgSU5TVEFMTEVEOiAnaW5zdGFsbGVkJywKICBVUERBVEVTOiAgICd1cGRhdGVzJywKICBBVkFJTEFCTEU6ICdhdmFpbGFibGUnLAogIEFMTDogICAgICAgJ2FsbCcKfTsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBBY3Rpb25NZW51LAogICAgQmFkZ2VTdGF0ZSwKICAgIERldmVsb3Blckluc3RhbGxEaWFsb2csCiAgICBJY29uTWVzc2FnZSwKICAgIENhdGFsb2dMaXN0LAogICAgQmFubmVyLAogICAgQ2F0YWxvZ0xvYWREaWFsb2csCiAgICBDYXRhbG9nVW5pbnN0YWxsRGlhbG9nLAogICAgSW5zdGFsbERpYWxvZywKICAgIExhenlJbWFnZSwKICAgIFBsdWdpbkluZm9QYW5lbCwKICAgIFRhYiwKICAgIFRhYmJlZCwKICAgIFVuaW5zdGFsbERpYWxvZywKICAgIFNldHVwVUlQbHVnaW5zLAogICAgUmVtb3ZlVUlQbHVnaW5zLAogICAgQWRkRXh0ZW5zaW9uUmVwb3MsCiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIFRBQlNfVkFMVUVTLAogICAgICBrdWJlVmVyc2lvbjogICAgICAgICAgICAgICAgICAgIG51bGwsCiAgICAgIHZpZXc6ICAgICAgICAgICAgICAgICAgICAgICAgICAgJycsCiAgICAgIGNoYXJ0czogICAgICAgICAgICAgICAgICAgICAgICAgW10sCiAgICAgIGluc3RhbGxpbmc6ICAgICAgICAgICAgICAgICAgICAge30sCiAgICAgIGVycm9yczogICAgICAgICAgICAgICAgICAgICAgICAge30sCiAgICAgIHBsdWdpbnM6ICAgICAgICAgICAgICAgICAgICAgICAgW10sIC8vIFRoZSBpbnN0YWxsZWQgcGx1Z2lucwogICAgICBoZWxtT3BzOiAgICAgICAgICAgICAgICAgICAgICAgIFtdLCAvLyBIZWxtIG9wZXJhdGlvbnMKICAgICAgYWRkRXh0ZW5zaW9uUmVwb3NCYW5uZXJTZXR0aW5nOiB1bmRlZmluZWQsCiAgICAgIGxvYWRpbmc6ICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSwKICAgICAgbWVudVRhcmdldEVsZW1lbnQ6ICAgICAgICAgICAgICBudWxsLAogICAgICBtZW51VGFyZ2V0RXZlbnQ6ICAgICAgICAgICAgICAgIG51bGwsCiAgICAgIG1lbnVPcGVuOiAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UsCiAgICAgIGhhc1NlcnZpY2U6ICAgICAgICAgICAgICAgICAgICAgZmFsc2UsCiAgICAgIGRlZmF1bHRJY29uOiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZSgnfnNoZWxsL2Fzc2V0cy9pbWFnZXMvZ2VuZXJpYy1wbHVnaW4uc3ZnJyksCiAgICAgIHJlbG9hZFJlcXVpcmVkOiAgICAgICAgICAgICAgICAgZmFsc2UsCiAgICAgIHJhbmNoZXJWZXJzaW9uOiAgICAgICAgICAgICAgICAgZ2V0VmVyc2lvbkRhdGEoKT8uVmVyc2lvbiwKICAgICAgc2hvd0NhdGFsb2dMaXN0OiAgICAgICAgICAgICAgICBmYWxzZQogICAgfTsKICB9LAoKICBsYXlvdXQ6ICdwbGFpbicsCgogIGFzeW5jIGZldGNoKCkgewogICAgY29uc3QgaGFzaCA9IHt9OwoKICAgIGNvbnN0IGlzU2V0dXAgPSBhd2FpdCB0aGlzLnVwZGF0ZUluc3RhbGxTdGF0dXModHJ1ZSk7CgogICAgaWYgKGlzU2V0dXApIHsKICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvc2NoZW1hRm9yJ10oVUlfUExVR0lOKSkgewogICAgICAgIGhhc2gucGx1Z2lucyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IFVJX1BMVUdJTiB9KTsKICAgICAgfQogICAgfQoKICAgIGhhc2gubG9hZCA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjYXRhbG9nL2xvYWQnLCB7IHJlc2V0OiB0cnVlIH0pOwoKICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L3NjaGVtYUZvciddKE1BTkFHRU1FTlQuQ0xVU1RFUikpIHsKICAgICAgaGFzaC5sb2NhbENsdXN0ZXIgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kJywgeyB0eXBlOiBNQU5BR0VNRU5ULkNMVVNURVIsIGlkOiAnbG9jYWwnIH0pOwogICAgfQoKICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L3NjaGVtYUZvciddKENBVEFMT0cuT1BFUkFUSU9OKSkgewogICAgICBoYXNoLmhlbG1PcHMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBDQVRBTE9HLk9QRVJBVElPTiB9KTsKICAgIH0KCiAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9zY2hlbWFGb3InXShDQVRBTE9HLkNMVVNURVJfUkVQTykpIHsKICAgICAgaGFzaC5yZXBvcyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IENBVEFMT0cuQ0xVU1RFUl9SRVBPIH0pOwogICAgfQoKICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFsbEhhc2goaGFzaCk7CgogICAgdGhpcy5wbHVnaW5zID0gcmVzLnBsdWdpbnMgfHwgW107CiAgICB0aGlzLnJlcG9zID0gcmVzLnJlcG9zIHx8IFtdOwogICAgdGhpcy5oZWxtT3BzID0gcmVzLmhlbG1PcHMgfHwgW107CiAgICB0aGlzLmt1YmVWZXJzaW9uID0gcmVzLmxvY2FsQ2x1c3Rlcj8ua3ViZXJuZXRlc1ZlcnNpb25CYXNlIHx8IFtdOwoKICAgIHRoaXMuYWRkRXh0ZW5zaW9uUmVwb3NCYW5uZXJTZXR0aW5nID0gYXdhaXQgZmV0Y2hPckNyZWF0ZVNldHRpbmcodGhpcy4kc3RvcmUsIFNFVFRJTkcuQUREX0VYVEVOU0lPTl9SRVBPU19CQU5ORVJfRElTUExBWSwgJ3RydWUnLCB0cnVlKSB8fCB7fTsKCiAgICBjb25zdCBjID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2F0YWxvZy9yYXdDaGFydHMnXTsKCiAgICB0aGlzLmNoYXJ0cyA9IE9iamVjdC52YWx1ZXMoYyk7CgogICAgLy8gSWYgdGhlcmUgYXJlIG5vIHBsdWdpbnMgaW5zdGFsbGVkLCBkZWZhdWx0IHRvIHRoZSBjYXRhbG9nIHZpZXcKICAgIGlmICh0aGlzLnBsdWdpbnMubGVuZ3RoID09PSAwKSB7CiAgICAgIHRoaXMuJHJlZnMudGFicz8uc2VsZWN0KFRBQlNfVkFMVUVTLkFWQUlMQUJMRSk7CiAgICB9CgogICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHBsdWdpbkRldmVsb3BlcjogbWFwUHJlZihQTFVHSU5fREVWRUxPUEVSKSwKCiAgICAuLi5tYXBHZXR0ZXJzKHsgdWlwbHVnaW5zOiAndWlwbHVnaW5zL3BsdWdpbnMnIH0pLAogICAgLi4ubWFwR2V0dGVycyh7IHVpRXJyb3JzOiAndWlwbHVnaW5zL2Vycm9ycycgfSksCiAgICAuLi5tYXBHZXR0ZXJzKHsgdGhlbWU6ICdwcmVmcy90aGVtZScgfSksCgogICAgc2hvd0FkZFJlcG9zQmFubmVyKCkgewogICAgICByZXR1cm4gdGhpcy5hZGRFeHRlbnNpb25SZXBvc0Jhbm5lclNldHRpbmc/LnZhbHVlID09PSAndHJ1ZScgJiYgKCF0aGlzLnJlcG9zLmZpbmQoKHIpID0+IHIudXJsRGlzcGxheSA9PT0gVUlfUExVR0lOU19SRVBPX1VSTCkgfHwgIXRoaXMucmVwb3MuZmluZCgocikgPT4gci51cmxEaXNwbGF5ID09PSBVSV9QTFVHSU5TX1BBUlRORVJTX1JFUE9fVVJMKSk7CiAgICB9LAoKICAgIGFwcGx5RGFya01vZGVCZygpIHsKICAgICAgaWYgKHRoaXMudGhlbWUgPT09ICdkYXJrJykgewogICAgICAgIHJldHVybiB7ICdkYXJrLW1vZGUnOiB0cnVlIH07CiAgICAgIH0KCiAgICAgIHJldHVybiB7fTsKICAgIH0sCgogICAgbWVudUFjdGlvbnMoKSB7CiAgICAgIGNvbnN0IG1lbnVBY3Rpb25zID0gW107CgogICAgICAvLyBBZGQgbGluayB0byBnbyB0byB0aGUgUmVwb3MgdmlldyBvZiB0aGUgbG9jYWwgY2x1c3RlcgogICAgICBtZW51QWN0aW9ucy5wdXNoKHsKICAgICAgICBhY3Rpb246ICAnbWFuYWdlUmVwb3MnLAogICAgICAgIGxhYmVsOiAgIHRoaXMudCgncGx1Z2lucy5tYW5hZ2VSZXBvcycpLAogICAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgfSk7CgogICAgICAvLyBBZGQgbGluayB0byBhZGQgZXh0ZW5zaW9ucyByZXBvc2l0b3JpZXMgKE9mZmljaWFsLCBQYXJ0bmVycywgZXRjKQogICAgICBtZW51QWN0aW9ucy5wdXNoKHsKICAgICAgICBhY3Rpb246ICAnYWRkUmFuY2hlclJlcG9zJywKICAgICAgICBsYWJlbDogICB0aGlzLnQoJ3BsdWdpbnMuYWRkUmFuY2hlclJlcG9zJyksCiAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICB9KTsKCiAgICAgIC8vIE9ubHkgc2hvdyBNYW5hZ2UgRXh0ZW5zaW9uIENhdGFsb2dzIHdoZW4gb24gbWFpbiBjaGFydHMgdmlldwogICAgICBpZiAoIXRoaXMuc2hvd0NhdGFsb2dMaXN0KSB7CiAgICAgICAgbWVudUFjdGlvbnMucHVzaCh7CiAgICAgICAgICBhY3Rpb246ICAnbWFuYWdlRXh0ZW5zaW9uVmlldycsCiAgICAgICAgICBsYWJlbDogICB0aGlzLnQoJ3BsdWdpbnMubWFuYWdlQ2F0YWxvZy5sYWJlbCcpLAogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICAvLyBPbmx5IHNob3cgRGV2ZWxvcGVyIExvYWQgYWN0aW9uIGlmIHRoZSB1c2VyIGhhcyB0aGlzIGVuYWJsZWQgaW4gcHJlZmVyZW5jZXMKICAgICAgaWYgKHRoaXMucGx1Z2luRGV2ZWxvcGVyKSB7CiAgICAgICAgbWVudUFjdGlvbnMucHVzaCggeyBkaXZpZGVyOiB0cnVlIH0pOwogICAgICAgIG1lbnVBY3Rpb25zLnB1c2goewogICAgICAgICAgYWN0aW9uOiAgJ2RldkxvYWQnLAogICAgICAgICAgbGFiZWw6ICAgdGhpcy50KCdwbHVnaW5zLmRldmVsb3Blci5sYWJlbCcpLAogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICBpZiAodGhpcy5oYXNTZXJ2aWNlKSB7CiAgICAgICAgbWVudUFjdGlvbnMucHVzaCggeyBkaXZpZGVyOiB0cnVlIH0pOwogICAgICAgIG1lbnVBY3Rpb25zLnB1c2goewogICAgICAgICAgYWN0aW9uOiAgJ3JlbW92ZVBsdWdpblN1cHBvcnQnLAogICAgICAgICAgbGFiZWw6ICAgdGhpcy50KCdwbHVnaW5zLnNldHVwLnJlbW92ZS5sYWJlbCcpLAogICAgICAgICAgZW5hYmxlZDogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gbWVudUFjdGlvbnM7CiAgICB9LAoKICAgIGxpc3QoKSB7CiAgICAgIGNvbnN0IGFsbCA9IHRoaXMuYXZhaWxhYmxlOwoKICAgICAgc3dpdGNoICh0aGlzLnZpZXcpIHsKICAgICAgY2FzZSBUQUJTX1ZBTFVFUy5JTlNUQUxMRUQ6CiAgICAgICAgcmV0dXJuIGFsbC5maWx0ZXIoKHApID0+ICEhcC5pbnN0YWxsZWQgfHwgISFwLmluc3RhbGxpbmcpOwogICAgICBjYXNlIFRBQlNfVkFMVUVTLlVQREFURVM6CiAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlczsKICAgICAgY2FzZSBUQUJTX1ZBTFVFUy5BVkFJTEFCTEU6CiAgICAgICAgcmV0dXJuIGFsbC5maWx0ZXIoKHApID0+ICFwLmluc3RhbGxlZCk7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgcmV0dXJuIGFsbDsKICAgICAgfQogICAgfSwKCiAgICBoYXNNZW51QWN0aW9ucygpIHsKICAgICAgcmV0dXJuIHRoaXMubWVudUFjdGlvbnM/Lmxlbmd0aCA+IDA7CiAgICB9LAoKICAgIC8vIE1lc3NhZ2UgdG8gZGlzcGxheSB3aGVuIHRoZSB0YWIgdmlldyBpcyBlbXB0eSAoZGVwZW5kcyBvbiB0aGUgdGFiKQogICAgZW1wdHlNZXNzYWdlKCkgewogICAgICByZXR1cm4gdGhpcy50KGBwbHVnaW5zLmVtcHR5LiR7IHRoaXMudmlldyB9YCk7CiAgICB9LAoKICAgIHVwZGF0ZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLmF2YWlsYWJsZS5maWx0ZXIoKHBsdWdpbikgPT4gISFwbHVnaW4udXBncmFkZSk7CiAgICB9LAoKICAgIGF2YWlsYWJsZSgpIHsKICAgICAgbGV0IGFsbCA9IHRoaXMuY2hhcnRzLmZpbHRlcigoYykgPT4gaXNVSVBsdWdpbihjKSk7CgogICAgICAvLyBGaWx0ZXIgb3V0IGhpZGRlbiBjaGFydHMKICAgICAgYWxsID0gYWxsLmZpbHRlcigoYykgPT4gIXVpUGx1Z2luSGFzQW5ub3RhdGlvbihjLCBDQVRBTE9HX0FOTk9UQVRJT05TLkhJRERFTiwgJ3RydWUnKSk7CgogICAgICBhbGwgPSBhbGwubWFwKChjaGFydCkgPT4gewogICAgICAgIC8vIExhYmVsIGNhbiBiZSBvdmVycmlkZGVuIGJ5IGNoYXJ0IGFubm90YXRpb24KICAgICAgICBjb25zdCBsYWJlbCA9IHVpUGx1Z2luQW5ub3RhdGlvbihjaGFydCwgVUlfUExVR0lOX0NIQVJUX0FOTk9UQVRJT05TLkRJU1BMQVlfTkFNRSkgfHwgY2hhcnQuY2hhcnROYW1lRGlzcGxheTsKICAgICAgICBjb25zdCBpdGVtID0gewogICAgICAgICAgbmFtZTogICAgICAgICBjaGFydC5jaGFydE5hbWUsCiAgICAgICAgICBsYWJlbCwKICAgICAgICAgIGRlc2NyaXB0aW9uOiAgY2hhcnQuY2hhcnREZXNjcmlwdGlvbiwKICAgICAgICAgIGlkOiAgICAgICAgICAgY2hhcnQuaWQsCiAgICAgICAgICB2ZXJzaW9uczogICAgIFtdLAogICAgICAgICAgaW5zdGFsbGVkOiAgICBmYWxzZSwKICAgICAgICAgIGJ1aWx0aW46ICAgICAgZmFsc2UsCiAgICAgICAgICBleHBlcmltZW50YWw6IHVpUGx1Z2luSGFzQW5ub3RhdGlvbihjaGFydCwgQ0FUQUxPR19BTk5PVEFUSU9OUy5FWFBFUklNRU5UQUwsICd0cnVlJyksCiAgICAgICAgICBjZXJ0aWZpZWQ6ICAgIHVpUGx1Z2luSGFzQW5ub3RhdGlvbihjaGFydCwgQ0FUQUxPR19BTk5PVEFUSU9OUy5DRVJUSUZJRUQsIENBVEFMT0dfQU5OT1RBVElPTlMuX1JBTkNIRVIpCiAgICAgICAgfTsKCiAgICAgICAgaXRlbS52ZXJzaW9ucyA9IFsuLi5jaGFydC52ZXJzaW9uc107CiAgICAgICAgaXRlbS5jaGFydCA9IGNoYXJ0OwoKICAgICAgICAvLyBGaWx0ZXIgdGhlIHZlcnNpb25zIGF2YWlsYWJsZSB0byBpbnN0YWxsIChwbHVnaW5zLWFwaSB2ZXJzaW9uIGFuZCBjdXJyZW50IGRhc2hib2FyZCB2ZXJzaW9uKQogICAgICAgIGl0ZW0uaW5zdGFsbGFibGVWZXJzaW9ucyA9IGl0ZW0udmVyc2lvbnMuZmlsdGVyKCh2ZXJzaW9uKSA9PiBpc1N1cHBvcnRlZENoYXJ0VmVyc2lvbih7IHZlcnNpb24sIGt1YmVWZXJzaW9uOiB0aGlzLmt1YmVWZXJzaW9uIH0pICYmIGlzQ2hhcnRWZXJzaW9uQXZhaWxhYmxlRm9ySW5zdGFsbCh7CiAgICAgICAgICB2ZXJzaW9uLCByYW5jaGVyVmVyc2lvbjogdGhpcy5yYW5jaGVyVmVyc2lvbiwga3ViZVZlcnNpb246IHRoaXMua3ViZVZlcnNpb24KICAgICAgICB9KSk7CgogICAgICAgIC8vIGFkZCBwcm9wIHRvIHZlcnNpb24gb2JqZWN0IGlmIHZlcnNpb24gaXMgY29tcGF0aWJsZSB3aXRoIHRoZSBjdXJyZW50IGRhc2hib2FyZCB2ZXJzaW9uCiAgICAgICAgaXRlbS52ZXJzaW9ucyA9IGl0ZW0udmVyc2lvbnMubWFwKCh2ZXJzaW9uKSA9PiBpc0NoYXJ0VmVyc2lvbkF2YWlsYWJsZUZvckluc3RhbGwoewogICAgICAgICAgdmVyc2lvbiwgcmFuY2hlclZlcnNpb246IHRoaXMucmFuY2hlclZlcnNpb24sIGt1YmVWZXJzaW9uOiB0aGlzLmt1YmVWZXJzaW9uCiAgICAgICAgfSwgdHJ1ZSkpOwoKICAgICAgICBjb25zdCBsYXRlc3RDb21wYXRpYmxlID0gaXRlbS5pbnN0YWxsYWJsZVZlcnNpb25zPy5bMF07CiAgICAgICAgY29uc3QgbGF0ZXN0Tm90Q29tcGF0aWJsZSA9IGl0ZW0udmVyc2lvbnMuZmluZCgodmVyc2lvbikgPT4gIXZlcnNpb24uaXNDb21wYXRpYmxlV2l0aFVpIHx8ICF2ZXJzaW9uLmlzQ29tcGF0aWJsZVdpdGhLdWJlVmVyc2lvbik7CgogICAgICAgIGlmIChsYXRlc3RDb21wYXRpYmxlKSB7CiAgICAgICAgICBpdGVtLmRpc3BsYXlWZXJzaW9uID0gbGF0ZXN0Q29tcGF0aWJsZS52ZXJzaW9uOwogICAgICAgICAgaXRlbS5pY29uID0gbGF0ZXN0Q29tcGF0aWJsZS5pY29uOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpdGVtLmRpc3BsYXlWZXJzaW9uID0gaXRlbS52ZXJzaW9ucz8uWzBdPy52ZXJzaW9uOwogICAgICAgICAgaXRlbS5pY29uID0gY2hhcnQuaWNvbiB8fCBsYXRlc3RDb21wYXRpYmxlPy5hbm5vdGF0aW9ucz8uWydjYXRhbG9nLmNhdHRsZS5pby91aS1pY29uJ107CiAgICAgICAgfQoKICAgICAgICBpZiAobGF0ZXN0Tm90Q29tcGF0aWJsZSAmJiBpdGVtLmluc3RhbGxhYmxlVmVyc2lvbnMubGVuZ3RoICYmIGlzQ2hhcnRWZXJzaW9uSGlnaGVyKGxhdGVzdE5vdENvbXBhdGlibGUudmVyc2lvbiwgaXRlbS5pbnN0YWxsYWJsZVZlcnNpb25zPy5bMF0udmVyc2lvbikpIHsKICAgICAgICAgIGlmICghaXRlbS5pc0NvbXBhdGlibGVXaXRoVWkpIHsKICAgICAgICAgICAgaXRlbS5pbmNvbXBhdGlibGVSYW5jaGVyVmVyc2lvbiA9IHRoaXMudCgncGx1Z2lucy5pbmNvbXBhdGlibGVSYW5jaGVyVmVyc2lvbicsIHsgdmVyc2lvbjogbGF0ZXN0Tm90Q29tcGF0aWJsZS52ZXJzaW9uLCByYW5jaGVyVmVyc2lvbjogbGF0ZXN0Tm90Q29tcGF0aWJsZS5yZXF1aXJlZFVpVmVyc2lvbiB9LCB0cnVlKTsKICAgICAgICAgIH0gZWxzZSBpZiAoIWl0ZW0uaXNDb21wYXRpYmxlV2l0aEt1YmVWZXJzaW9uKSB7CiAgICAgICAgICAgIGl0ZW0uaW5jb21wYXRpYmxlS3ViZVZlcnNpb24gPSB0aGlzLnQoJ3BsdWdpbnMuaW5jb21wYXRpYmxlS3ViZVZlcnNpb24nLCB7IHZlcnNpb246IGxhdGVzdE5vdENvbXBhdGlibGUudmVyc2lvbiwga3ViZVZlcnNpb246IGxhdGVzdE5vdENvbXBhdGlibGUucmVxdWlyZWRLdWJlVmVyc2lvbiB9LCB0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLmluc3RhbGxpbmdbaXRlbS5uYW1lXSkgewogICAgICAgICAgaXRlbS5pbnN0YWxsaW5nID0gdGhpcy5pbnN0YWxsaW5nW2l0ZW0ubmFtZV07CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CgogICAgICAvLyBSZW1vdmUgY2hhcnRzIHdpdGggbm8gaW5zdGFsbGFibGUgdmVyc2lvbnMKICAgICAgYWxsID0gYWxsLmZpbHRlcigoYykgPT4gYy52ZXJzaW9ucy5sZW5ndGggPiAwKTsKCiAgICAgIC8vIENoZWNrIHRoYXQgYWxsIG9mIHRoZSBsb2FkZWQgcGx1Z2lucyBhcmUgcmVwcmVzZW50ZWQKICAgICAgdGhpcy51aXBsdWdpbnMuZm9yRWFjaCgocCkgPT4gewogICAgICAgIGNvbnN0IGNoYXJ0ID0gYWxsLmZpbmQoKGMpID0+IGMubmFtZSA9PT0gcC5uYW1lKTsKCiAgICAgICAgaWYgKCFjaGFydCkgewogICAgICAgICAgLy8gQSBwbHVnaW4gaXMgbG9hZGVkLCBidXQgdGhlcmUgaXMgbm8gY2hhcnQsIHNvIGFkZCBhbiBpdGVtIHNvIHRoYXQgaXQgc2hvd3MgdXAKICAgICAgICAgIGNvbnN0IHJhbmNoZXIgPSB0eXBlb2YgcC5tZXRhZGF0YT8ucmFuY2hlciA9PT0gJ29iamVjdCcgPyBwLm1ldGFkYXRhLnJhbmNoZXIgOiB7fTsKICAgICAgICAgIGNvbnN0IGxhYmVsID0gcmFuY2hlci5hbm5vdGF0aW9ucz8uW1VJX1BMVUdJTl9DSEFSVF9BTk5PVEFUSU9OUy5ESVNQTEFZX05BTUVdIHx8IHAubmFtZTsKICAgICAgICAgIGNvbnN0IGl0ZW0gPSB7CiAgICAgICAgICAgIG5hbWU6ICAgICAgICAgICBwLm5hbWUsCiAgICAgICAgICAgIGxhYmVsLAogICAgICAgICAgICBkZXNjcmlwdGlvbjogICAgcC5tZXRhZGF0YT8uZGVzY3JpcHRpb24sCiAgICAgICAgICAgIGljb246ICAgICAgICAgICBwLm1ldGFkYXRhPy5pY29uLAogICAgICAgICAgICBpZDogICAgICAgICAgICAgcC5pZCwKICAgICAgICAgICAgdmVyc2lvbnM6ICAgICAgIFtdLAogICAgICAgICAgICBkaXNwbGF5VmVyc2lvbjogcC5tZXRhZGF0YT8udmVyc2lvbiB8fCAnLScsCiAgICAgICAgICAgIGluc3RhbGxlZDogICAgICB0cnVlLAogICAgICAgICAgICBidWlsdGluOiAgICAgICAgISFwLmJ1aWx0aW4sCiAgICAgICAgICB9OwoKICAgICAgICAgIC8vIEJ1aWx0LWluIHBsdWdpbnMgY2FuIGNob3NlIHRvIGJlIGhpZGRlbiAtIHVzZWQgd2hlcmUgd2UgaW1wbGVtZW50IGFzIGV4dGVuc2lvbnMKICAgICAgICAgIC8vIGJ1dCBkb24ndCB3YW50IHRvIHNob3dzIHRoZW0gaW5kaXZpZHVhbGx5IG9uIHRoZSBleHRlbnNpb25zIHBhZ2UKICAgICAgICAgIGlmICghKGl0ZW0uYnVpbHRpbiAmJiByYW5jaGVyW1VJX1BMVUdJTl9DSEFSVF9BTk5PVEFUSU9OUy5ISURERU5fQlVJTFRJTl0pKSB7CiAgICAgICAgICAgIGFsbC5wdXNoKGl0ZW0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CgogICAgICAvLyBHbyB0aHJvdWdoIHRoZSBDUnMgZm9yIHRoZSBwbHVnaW5zIGFuZCB3aXJlIHRoZW0gaW50byB0aGUgY2F0YWxvZwogICAgICB0aGlzLnBsdWdpbnMuZm9yRWFjaCgocCkgPT4gewogICAgICAgIGNvbnN0IGNoYXJ0ID0gYWxsLmZpbmQoKGMpID0+IGMubmFtZSA9PT0gcC5uYW1lKTsKCiAgICAgICAgaWYgKGNoYXJ0KSB7CiAgICAgICAgICBjaGFydC5pbnN0YWxsZWQgPSB0cnVlOwogICAgICAgICAgY2hhcnQudWlwbHVnaW4gPSBwOwogICAgICAgICAgY2hhcnQuZGlzcGxheVZlcnNpb24gPSBwLnZlcnNpb247CgogICAgICAgICAgLy8gQ2FuJ3QgZG8gdGhpcyBoZXJlCiAgICAgICAgICBjaGFydC5pbnN0YWxsaW5nID0gdGhpcy5pbnN0YWxsaW5nW2NoYXJ0Lm5hbWVdOwoKICAgICAgICAgIC8vIENoZWNrIGZvciB1cGdyYWRlCiAgICAgICAgICBpZiAoY2hhcnQuaW5zdGFsbGFibGVWZXJzaW9ucz8ubGVuZ3RoICYmIHAudmVyc2lvbiAhPT0gY2hhcnQuaW5zdGFsbGFibGVWZXJzaW9ucz8uWzBdPy52ZXJzaW9uKSB7CiAgICAgICAgICAgIGNoYXJ0LnVwZ3JhZGUgPSBjaGFydC5pbnN0YWxsYWJsZVZlcnNpb25zWzBdLnZlcnNpb247CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIE5vIGNoYXJ0LCBzbyBhZGQgYSBjYXJkIGZvciB0aGUgcGx1Z2luIGJhc2VkIG9uIGl0cyBDdXN0b20gcmVzb3VyY2UgYmVpbmcgcHJlc2VudAogICAgICAgICAgY29uc3QgaXRlbSA9IHsKICAgICAgICAgICAgbmFtZTogICAgICAgICAgIHAubmFtZSwKICAgICAgICAgICAgbGFiZWw6ICAgICAgICAgIHAubmFtZSwKICAgICAgICAgICAgZGVzY3JpcHRpb246ICAgIHAuZGVzY3JpcHRpb24gfHwgJy0nLAogICAgICAgICAgICBpZDogICAgICAgICAgICAgYCR7IHAubmFtZSB9LSR7IHAudmVyc2lvbiB9YCwKICAgICAgICAgICAgdmVyc2lvbnM6ICAgICAgIFtdLAogICAgICAgICAgICBkaXNwbGF5VmVyc2lvbjogcC52ZXJzaW9uIHx8ICctJywKICAgICAgICAgICAgaW5zdGFsbGVkOiAgICAgIHRydWUsCiAgICAgICAgICAgIGluc3RhbGxpbmc6ICAgICBmYWxzZSwKICAgICAgICAgICAgYnVpbHRpbjogICAgICAgIGZhbHNlLAogICAgICAgICAgICB1aXBsdWdpbjogICAgICAgcCwKICAgICAgICAgIH07CgogICAgICAgICAgYWxsLnB1c2goaXRlbSk7CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIE1lcmdlIGluIHRoZSBwbHVnaW4gbG9hZCBlcnJvcnMKICAgICAgT2JqZWN0LmtleXModGhpcy51aUVycm9ycykuZm9yRWFjaCgoZSkgPT4gewogICAgICAgIGNvbnN0IGNoYXJ0ID0gYWxsLmZpbmQoKGMpID0+IGMubmFtZSA9PT0gZSk7CgogICAgICAgIGlmIChjaGFydCkgewogICAgICAgICAgY29uc3QgZXJyb3IgPSB0aGlzLnVpRXJyb3JzW2VdOwoKICAgICAgICAgIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIGNoYXJ0LmVycm9yID0gdGhpcy50KHRoaXMudWlFcnJvcnNbZV0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY2hhcnQuZXJyb3IgPSBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8gTWVyZ2UgaW4gdGhlIHBsdWdpbiBsb2FkIGVycm9ycyBmcm9tIGhlbHAgb3BzCiAgICAgIE9iamVjdC5rZXlzKHRoaXMuZXJyb3JzKS5mb3JFYWNoKChlKSA9PiB7CiAgICAgICAgY29uc3QgY2hhcnQgPSBhbGwuZmluZCgoYykgPT4gYy5uYW1lID09PSBlKTsKCiAgICAgICAgaWYgKGNoYXJ0KSB7CiAgICAgICAgICBjaGFydC5oZWxtRXJyb3IgPSAhIXRoaXMuZXJyb3JzW2VdOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBhbGwuZm9yRWFjaCgocGx1Z2luKSA9PiB7CiAgICAgICAgLy8gQ2xhbXAgdGhlIGxlbmd0aHMgb2YgdGhlIGRlc2NyaXB0aW9ucwogICAgICAgIGlmIChwbHVnaW4uZGVzY3JpcHRpb24gJiYgcGx1Z2luLmRlc2NyaXB0aW9uLmxlbmd0aCA+IE1BWF9ERVNDUklQVElPTl9MRU5HVEgpIHsKICAgICAgICAgIHBsdWdpbi5kZXNjcmlwdGlvbiA9IGAkeyBwbHVnaW4uZGVzY3JpcHRpb24uc3Vic3RyKDAsIE1BWF9ERVNDUklQVElPTl9MRU5HVEgpIH0gLi4uYDsKICAgICAgICB9CgogICAgICAgIC8vIGNoZWNrIGlmIGt1YmUgdmVyc2lvbiBjb21wYXRpYmlsaXR5IGlzIG1ldCBmb3IgaW5zdGFsbGVkIGV4dGVuc2lvbgogICAgICAgIGlmIChwbHVnaW4udWlwbHVnaW4pIHsKICAgICAgICAgIGNvbnN0IHZlcnNpb25JbnN0YWxsZWQgPSBwbHVnaW4udWlwbHVnaW4uc3BlYz8ucGx1Z2luPy52ZXJzaW9uOwogICAgICAgICAgY29uc3QgdmVyc2lvbkluc3RhbGxlZERhdGEgPSBwbHVnaW4udmVyc2lvbnMuZmluZCgodikgPT4gdi52ZXJzaW9uID09PSB2ZXJzaW9uSW5zdGFsbGVkKTsKCiAgICAgICAgICBpZiAodmVyc2lvbkluc3RhbGxlZERhdGEpIHsKICAgICAgICAgICAgY29uc3Qga3ViZVZlcnNpb25Ub0NoZWNrID0gdmVyc2lvbkluc3RhbGxlZERhdGEuYW5ub3RhdGlvbnM/LltVSV9QTFVHSU5fQ0hBUlRfQU5OT1RBVElPTlMuS1VCRV9WRVJTSU9OXTsKCiAgICAgICAgICAgIGlmICh0aGlzLmt1YmVWZXJzaW9uICYmICFpc1N1cHBvcnRlZENoYXJ0VmVyc2lvbih7IHZlcnNpb246IHZlcnNpb25JbnN0YWxsZWREYXRhLCBrdWJlVmVyc2lvbjogdGhpcy5rdWJlVmVyc2lvbiB9KSkgewogICAgICAgICAgICAgIHBsdWdpbi5pbnN0YWxsZWRFcnJvciA9IHRoaXMudCgncGx1Z2lucy5jdXJyZW50SW5zdGFsbGVkVmVyc2lvbkJsb2NrZWRCeUt1YmVWZXJzaW9uJywgeyBrdWJlVmVyc2lvbjogdGhpcy5rdWJlVmVyc2lvbiwga3ViZVZlcnNpb25Ub0NoZWNrIH0sIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKCiAgICAgIC8vIFNvcnQgYnkgbmFtZQogICAgICByZXR1cm4gc29ydEJ5KGFsbCwgJ25hbWUnLCBmYWxzZSk7CiAgICB9CiAgfSwKCiAgd2F0Y2g6IHsKICAgIGhlbG1PcHMobmV1KSB7CiAgICAgIC8vIEdldCBIZWxtIG9wZXJhdGlvbnMgZm9yIFVJIHBsdWdpbnMgYW5kIG9yZGVyIGJ5IGRhdGUKICAgICAgbGV0IHBsdWdpbk9wcyA9IG5ldS5maWx0ZXIoKG9wKSA9PiB7CiAgICAgICAgcmV0dXJuIG9wLm5hbWVzcGFjZSA9PT0gVUlfUExVR0lOX05BTUVTUEFDRTsKICAgICAgfSk7CgogICAgICBwbHVnaW5PcHMgPSBzb3J0QnkocGx1Z2luT3BzLCAnbWV0YWRhdGEuY3JlYXRpb25UaW1lc3RhbXAnLCB0cnVlKTsKCiAgICAgIC8vIEdvIHRocm91Z2ggdGhlIGluc3RhbGxlZCBwbHVnaW5zCiAgICAgICh0aGlzLmF2YWlsYWJsZSB8fCBbXSkuZm9yRWFjaCgocGx1Z2luKSA9PiB7CiAgICAgICAgY29uc3Qgb3AgPSBwbHVnaW5PcHMuZmluZCgobykgPT4gby5zdGF0dXM/LnJlbGVhc2VOYW1lID09PSBwbHVnaW4ubmFtZSk7CgogICAgICAgIGlmIChvcCkgewogICAgICAgICAgY29uc3QgYWN0aXZlID0gb3AubWV0YWRhdGEuc3RhdGU/LnRyYW5zaXRpb25pbmc7CiAgICAgICAgICBjb25zdCBlcnJvciA9IG9wLm1ldGFkYXRhLnN0YXRlPy5lcnJvcjsKCiAgICAgICAgICBWdWUuc2V0KHRoaXMuZXJyb3JzLCBwbHVnaW4ubmFtZSwgZXJyb3IpOwoKICAgICAgICAgIGlmIChhY3RpdmUpIHsKICAgICAgICAgICAgLy8gQ2FuIHVzZSB0aGUgc3RhdHVzIGRpcmVjdGx5LCBhcGFydCBmcm9tIHVwZ3JhZGUsIHdoaWNoIG1hcHMgdG8gaW5zdGFsbAogICAgICAgICAgICBjb25zdCBzdGF0dXMgPSBvcC5zdGF0dXMuYWN0aW9uID09PSAndXBncmFkZScgPyAnaW5zdGFsbCcgOiBvcC5zdGF0dXMuYWN0aW9uOwoKICAgICAgICAgICAgdGhpcy51cGRhdGVQbHVnaW5JbnN0YWxsU3RhdHVzKHBsdWdpbi5uYW1lLCBzdGF0dXMpOwogICAgICAgICAgfSBlbHNlIGlmIChvcC5zdGF0dXMuYWN0aW9uID09PSAndW5pbnN0YWxsJykgewogICAgICAgICAgICAvLyBVbmluc3RhbGwgaGFzIGZpbmlzaGVkCiAgICAgICAgICAgIHRoaXMudXBkYXRlUGx1Z2luSW5zdGFsbFN0YXR1cyhwbHVnaW4ubmFtZSwgZmFsc2UpOwogICAgICAgICAgfSBlbHNlIGlmIChlcnJvcikgewogICAgICAgICAgICB0aGlzLnVwZGF0ZVBsdWdpbkluc3RhbGxTdGF0dXMocGx1Z2luLm5hbWUsIGZhbHNlKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy51cGRhdGVQbHVnaW5JbnN0YWxsU3RhdHVzKHBsdWdpbi5uYW1lLCBmYWxzZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgcGx1Z2lucyhuZXUsIG9sZCkgewogICAgICBjb25zdCBpbnN0YWxsZWQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd1aXBsdWdpbnMvcGx1Z2lucyddOwogICAgICBjb25zdCBzaG91bGRIYXZlTG9hZGVkID0gKGluc3RhbGxlZCB8fCBbXSkuZmlsdGVyKChwKSA9PiAhdGhpcy51aUVycm9yc1twLm5hbWVdICYmICFwLmJ1aWx0aW4pOwogICAgICBsZXQgY2hhbmdlcyA9IDA7CgogICAgICAvLyBEaWQgdGhlIHVzZXIgcmVtb3ZlIGFuIGV4dGVuc2lvbgogICAgICBpZiAobmV1Py5sZW5ndGggPCBzaG91bGRIYXZlTG9hZGVkLmxlbmd0aCkgewogICAgICAgIGNoYW5nZXMrKzsKICAgICAgfQoKICAgICAgbmV1LmZvckVhY2goKHBsdWdpbikgPT4gewogICAgICAgIGNvbnN0IGV4aXN0aW5nID0gaW5zdGFsbGVkLmZpbmQoKHApID0+ICFwLnJlbW92ZWQgJiYgcC5uYW1lID09PSBwbHVnaW4ubmFtZSAmJiBwLnZlcnNpb24gPT09IHBsdWdpbi52ZXJzaW9uKTsKCiAgICAgICAgaWYgKCFleGlzdGluZyAmJiBwbHVnaW4uaXNDYWNoZWQpIHsKICAgICAgICAgIGlmICghdGhpcy51aUVycm9yc1twbHVnaW4ubmFtZV0pIHsKICAgICAgICAgICAgY2hhbmdlcysrOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMudXBkYXRlUGx1Z2luSW5zdGFsbFN0YXR1cyhwbHVnaW4ubmFtZSwgZmFsc2UpOwogICAgICAgIH0KICAgICAgfSk7CgogICAgICBpZiAoY2hhbmdlcyA+IDApIHsKICAgICAgICBWdWUuc2V0KHRoaXMsICdyZWxvYWRSZXF1aXJlZCcsIHRydWUpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLy8gRm9yZ2V0IHRoZSB0eXBlcyB3aGVuIHdlIGxlYXZlIHRoZSBwYWdlCiAgYmVmb3JlRGVzdHJveSgpIHsKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZvcmdldFR5cGUnLCBVSV9QTFVHSU4pOwogICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZm9yZ2V0VHlwZScsIENBVEFMT0cuT1BFUkFUSU9OKTsKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZvcmdldFR5cGUnLCBDQVRBTE9HLkFQUCk7CiAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9mb3JnZXRUeXBlJywgQ0FUQUxPRy5DTFVTVEVSX1JFUE8pOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHJlZnJlc2hDaGFydHMoZm9yY2VDaGFydHNVcGRhdGUgPSBmYWxzZSkgewogICAgICAvLyB3ZSBtaWdodCBuZWVkIHRvIGZvcmNlIHRoZSByZXF1ZXN0LCBzbyB0aGF0IHdlIGtub3cgYXQgYWxsIHRpbWVzIGlmIHdoYXQncyB0aGUgc3RhdHVzIG9mIHRoZSBvZmZpY2FsIGFuZCBwYXJ0bmVycyByZXBvcyAoaW5zdGFsbGVkIG9yIG5vdCkKICAgICAgLy8gdGllZCB0byB0aGUgU2V0dXBVSVBsdWdpbnMsIEFkZEV4dGVuc2lvblJlcG9zIGFuZCBSZW1vdmVVSVBsdWdpbnMgY2hlY2tib3hlcwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2F0YWxvZy9sb2FkJywgeyByZXNldDogdHJ1ZSwgZm9yY2U6IGZvcmNlQ2hhcnRzVXBkYXRlIH0pOwogICAgICBjb25zdCBjID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2F0YWxvZy9yYXdDaGFydHMnXTsKCiAgICAgIHRoaXMuY2hhcnRzID0gT2JqZWN0LnZhbHVlcyhjKTsKICAgIH0sCgogICAgYXN5bmMgdXBkYXRlSW5zdGFsbFN0YXR1cyhmb3JjZUNoYXJ0c1VwZGF0ZSA9IGZhbHNlKSB7CiAgICAgIGxldCBoYXNTZXJ2aWNlOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBzZXJ2aWNlID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZCcsIHsKICAgICAgICAgIHR5cGU6IFNFUlZJQ0UsCiAgICAgICAgICBpZDogICBgJHsgVUlfUExVR0lOX05BTUVTUEFDRSB9L3VpLXBsdWdpbi1vcGVyYXRvcmAsCiAgICAgICAgICBvcHQ6ICB7IGZvcmNlOiB0cnVlIH0sCiAgICAgICAgfSk7CgogICAgICAgIGhhc1NlcnZpY2UgPSAhIXNlcnZpY2U7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBoYXNTZXJ2aWNlID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChoYXNTZXJ2aWNlIHx8IGZvcmNlQ2hhcnRzVXBkYXRlKSB7CiAgICAgICAgdGhpcy5yZWZyZXNoQ2hhcnRzKGZvcmNlQ2hhcnRzVXBkYXRlKTsKICAgICAgfQoKICAgICAgVnVlLnNldCh0aGlzLCAnaGFzU2VydmljZScsIGhhc1NlcnZpY2UpOwoKICAgICAgcmV0dXJuIGhhc1NlcnZpY2U7CiAgICB9LAoKICAgIGZpbHRlckNoYW5nZWQoZikgewogICAgICB0aGlzLnZpZXcgPSBmLnNlbGVjdGVkTmFtZTsKICAgIH0sCgogICAgcmVtb3ZlUGx1Z2luU3VwcG9ydCgpIHsKICAgICAgdGhpcy5yZWZyZXNoQ2hhcnRzKHRydWUpOwogICAgICB0aGlzLiRyZWZzLnJlbW92ZVVJUGx1Z2lucy5zaG93RGlhbG9nKCk7CiAgICB9LAoKICAgIC8vIERldmVsb3BlciBMb2FkIGlzIGluIHRoZSBhY3Rpb24gbWVudQogICAgc2hvd0RldmVsb3BlckxvYWREaWFsb2coKSB7CiAgICAgIHRoaXMuJHJlZnMuZGV2ZWxvcGVySW5zdGFsbERpYWxvZy5zaG93RGlhbG9nKCk7CiAgICB9LAoKICAgIHNob3dBZGRFeHRlbnNpb25SZXBvc0RpYWxvZygpIHsKICAgICAgdGhpcy51cGRhdGVBZGRSZXBvc1NldHRpbmcoKTsKICAgICAgdGhpcy5yZWZyZXNoQ2hhcnRzKHRydWUpOwogICAgICB0aGlzLiRyZWZzLmFkZEV4dGVuc2lvblJlcG9zRGlhbG9nLnNob3dEaWFsb2coKTsKICAgIH0sCgogICAgc2hvd0NhdGFsb2dMb2FkRGlhbG9nKCkgewogICAgICB0aGlzLiRyZWZzLmNhdGFsb2dMb2FkRGlhbG9nLnNob3dEaWFsb2coKTsKICAgIH0sCgogICAgc2hvd0NhdGFsb2dVbmluc3RhbGxEaWFsb2coZXYpIHsKICAgICAgdGhpcy4kcmVmcy5jYXRhbG9nVW5pbnN0YWxsRGlhbG9nLnNob3dEaWFsb2coZXYpOwogICAgfSwKCiAgICBzaG93SW5zdGFsbERpYWxvZyhwbHVnaW4sIG1vZGUsIGV2KSB7CiAgICAgIGV2LnRhcmdldD8uYmx1cigpOwogICAgICBldi5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgIHRoaXMuJHJlZnMuaW5zdGFsbERpYWxvZy5zaG93RGlhbG9nKHBsdWdpbiwgbW9kZSk7CiAgICB9LAoKICAgIHNob3dVbmluc3RhbGxEaWFsb2cocGx1Z2luLCBldikgewogICAgICBldi50YXJnZXQ/LmJsdXIoKTsKICAgICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7CgogICAgICB0aGlzLiRyZWZzLnVuaW5zdGFsbERpYWxvZy5zaG93RGlhbG9nKHBsdWdpbik7CiAgICB9LAoKICAgIGRpZFVuaW5zdGFsbChwbHVnaW4pIHsKICAgICAgaWYgKHBsdWdpbikgewogICAgICAgIHRoaXMudXBkYXRlUGx1Z2luSW5zdGFsbFN0YXR1cyhwbHVnaW4ubmFtZSwgJ3VuaW5zdGFsbCcpOwoKICAgICAgICBpZiAocGx1Z2luLmNhdGFsb2cpIHsKICAgICAgICAgIHRoaXMucmVmcmVzaENoYXJ0cygpOwogICAgICAgIH0KCiAgICAgICAgLy8gQ2xlYXIgdGhlIGxvYWQgZXJyb3IsIGlmIHRoZXJlIHdhcyBvbmUKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndWlwbHVnaW5zL3NldEVycm9yJywgeyBuYW1lOiBwbHVnaW4ubmFtZSwgZXJyb3I6IGZhbHNlIH0pOwogICAgICB9CiAgICB9LAoKICAgIGRpZEluc3RhbGwocGx1Z2luKSB7CiAgICAgIGlmIChwbHVnaW4pIHsKICAgICAgICAvLyBDaGFuZ2UgdGhlIHZpZXcgdG8gaW5zdGFsbGVkIGlmIHdlIHN0YXJ0ZWQgaW5zdGFsbGluZyBhIHBsdWdpbgogICAgICAgIHRoaXMuJHJlZnMudGFicz8uc2VsZWN0KFRBQlNfVkFMVUVTLklOU1RBTExFRCk7CgogICAgICAgIC8vIENsZWFyIHRoZSBsb2FkIGVycm9yLCBpZiB0aGVyZSB3YXMgb25lIHByZXZpb3VzbHkKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndWlwbHVnaW5zL3NldEVycm9yJywgeyBuYW1lOiBwbHVnaW4ubmFtZSwgZXJyb3I6IGZhbHNlIH0pOwogICAgICB9CiAgICB9LAoKICAgIHNob3dQbHVnaW5EZXRhaWwocGx1Z2luKSB7CiAgICAgIHRoaXMuJHJlZnMuaW5mb1BhbmVsLnNob3cocGx1Z2luKTsKICAgIH0sCgogICAgdXBkYXRlUGx1Z2luSW5zdGFsbFN0YXR1cyhuYW1lLCBzdGF0dXMpIHsKICAgICAgVnVlLnNldCh0aGlzLmluc3RhbGxpbmcsIG5hbWUsIHN0YXR1cyk7CiAgICB9LAoKICAgIHNldE1lbnUoZXZlbnQpIHsKICAgICAgdGhpcy5tZW51T3BlbiA9ICEhZXZlbnQ7CgogICAgICBpZiAoZXZlbnQpIHsKICAgICAgICB0aGlzLm1lbnVUYXJnZXRFbGVtZW50ID0gdGhpcy4kcmVmcy5hY3Rpb25zOwogICAgICAgIHRoaXMubWVudVRhcmdldEV2ZW50ID0gZXZlbnQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5tZW51VGFyZ2V0RWxlbWVudCA9IHVuZGVmaW5lZDsKICAgICAgICB0aGlzLm1lbnVUYXJnZXRFdmVudCA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfSwKCiAgICByZWxvYWQoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5nbygpOwogICAgfSwKCiAgICBtYW5hZ2VSZXBvcygpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICAgJ2MtY2x1c3Rlci1wcm9kdWN0LXJlc291cmNlJywKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGNsdXN0ZXI6ICAnbG9jYWwnLAogICAgICAgICAgcHJvZHVjdDogIEFQUF9QUk9EVUNULAogICAgICAgICAgcmVzb3VyY2U6IENBVEFMT0cuQ0xVU1RFUl9SRVBPCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgbWFuYWdlRXh0ZW5zaW9uVmlldygpIHsKICAgICAgdGhpcy5zaG93Q2F0YWxvZ0xpc3QgPSAhdGhpcy5zaG93Q2F0YWxvZ0xpc3Q7CiAgICB9LAoKICAgIHVwZGF0ZUFkZFJlcG9zU2V0dGluZygpIHsKICAgICAgaWYgKHRoaXMuYWRkRXh0ZW5zaW9uUmVwb3NCYW5uZXJTZXR0aW5nPy52YWx1ZSA9PT0gJ3RydWUnKSB7CiAgICAgICAgdGhpcy5hZGRFeHRlbnNpb25SZXBvc0Jhbm5lclNldHRpbmcudmFsdWUgPSAnZmFsc2UnOwogICAgICAgIHRoaXMuYWRkRXh0ZW5zaW9uUmVwb3NCYW5uZXJTZXR0aW5nLnNhdmUoKTsKICAgICAgfQogICAgfQogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/uiplugins","sourcesContent":["<script>\nimport Vue from 'vue';\nimport { mapGetters } from 'vuex';\nimport { mapPref, PLUGIN_DEVELOPER } from '@shell/store/prefs';\nimport { sortBy } from '@shell/utils/sort';\nimport { allHash } from '@shell/utils/promise';\nimport { CATALOG, UI_PLUGIN, SERVICE, MANAGEMENT } from '@shell/config/types';\nimport { SETTING } from '@shell/config/settings';\nimport { fetchOrCreateSetting } from '@shell/utils/settings';\nimport { getVersionData } from '@shell/config/version';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { NAME as APP_PRODUCT } from '@shell/config/product/apps';\nimport ActionMenu from '@shell/components/ActionMenu';\nimport Tabbed from '@shell/components/Tabbed/index.vue';\nimport Tab from '@shell/components/Tabbed/Tab.vue';\nimport IconMessage from '@shell/components/IconMessage.vue';\nimport LazyImage from '@shell/components/LazyImage';\nimport { BadgeState } from '@components/BadgeState';\nimport UninstallDialog from './UninstallDialog.vue';\nimport InstallDialog from './InstallDialog.vue';\nimport CatalogLoadDialog from './CatalogList/CatalogLoadDialog.vue';\nimport CatalogUninstallDialog from './CatalogList/CatalogUninstallDialog.vue';\nimport DeveloperInstallDialog from './DeveloperInstallDialog.vue';\nimport PluginInfoPanel from './PluginInfoPanel.vue';\nimport SetupUIPlugins from './SetupUIPlugins';\nimport RemoveUIPlugins from './RemoveUIPlugins';\nimport AddExtensionRepos from './AddExtensionRepos';\nimport CatalogList from './CatalogList/index.vue';\nimport Banner from '@components/Banner/Banner.vue';\nimport {\n  isUIPlugin,\n  uiPluginAnnotation,\n  uiPluginHasAnnotation,\n  isSupportedChartVersion,\n  isChartVersionAvailableForInstall,\n  isChartVersionHigher,\n  UI_PLUGIN_NAMESPACE,\n  UI_PLUGIN_CHART_ANNOTATIONS,\n  UI_PLUGINS_REPO_URL,\n  UI_PLUGINS_PARTNERS_REPO_URL\n} from '@shell/config/uiplugins';\n\nconst MAX_DESCRIPTION_LENGTH = 200;\n\nconst TABS_VALUES = {\n  INSTALLED: 'installed',\n  UPDATES:   'updates',\n  AVAILABLE: 'available',\n  ALL:       'all'\n};\n\nexport default {\n  components: {\n    ActionMenu,\n    BadgeState,\n    DeveloperInstallDialog,\n    IconMessage,\n    CatalogList,\n    Banner,\n    CatalogLoadDialog,\n    CatalogUninstallDialog,\n    InstallDialog,\n    LazyImage,\n    PluginInfoPanel,\n    Tab,\n    Tabbed,\n    UninstallDialog,\n    SetupUIPlugins,\n    RemoveUIPlugins,\n    AddExtensionRepos,\n  },\n\n  data() {\n    return {\n      TABS_VALUES,\n      kubeVersion:                    null,\n      view:                           '',\n      charts:                         [],\n      installing:                     {},\n      errors:                         {},\n      plugins:                        [], // The installed plugins\n      helmOps:                        [], // Helm operations\n      addExtensionReposBannerSetting: undefined,\n      loading:                        true,\n      menuTargetElement:              null,\n      menuTargetEvent:                null,\n      menuOpen:                       false,\n      hasService:                     false,\n      defaultIcon:                    require('~shell/assets/images/generic-plugin.svg'),\n      reloadRequired:                 false,\n      rancherVersion:                 getVersionData()?.Version,\n      showCatalogList:                false\n    };\n  },\n\n  layout: 'plain',\n\n  async fetch() {\n    const hash = {};\n\n    const isSetup = await this.updateInstallStatus(true);\n\n    if (isSetup) {\n      if (this.$store.getters['management/schemaFor'](UI_PLUGIN)) {\n        hash.plugins = this.$store.dispatch('management/findAll', { type: UI_PLUGIN });\n      }\n    }\n\n    hash.load = await this.$store.dispatch('catalog/load', { reset: true });\n\n    if (this.$store.getters['management/schemaFor'](MANAGEMENT.CLUSTER)) {\n      hash.localCluster = await this.$store.dispatch('management/find', { type: MANAGEMENT.CLUSTER, id: 'local' });\n    }\n\n    if (this.$store.getters['management/schemaFor'](CATALOG.OPERATION)) {\n      hash.helmOps = await this.$store.dispatch('management/findAll', { type: CATALOG.OPERATION });\n    }\n\n    if (this.$store.getters['management/schemaFor'](CATALOG.CLUSTER_REPO)) {\n      hash.repos = await this.$store.dispatch('management/findAll', { type: CATALOG.CLUSTER_REPO });\n    }\n\n    const res = await allHash(hash);\n\n    this.plugins = res.plugins || [];\n    this.repos = res.repos || [];\n    this.helmOps = res.helmOps || [];\n    this.kubeVersion = res.localCluster?.kubernetesVersionBase || [];\n\n    this.addExtensionReposBannerSetting = await fetchOrCreateSetting(this.$store, SETTING.ADD_EXTENSION_REPOS_BANNER_DISPLAY, 'true', true) || {};\n\n    const c = this.$store.getters['catalog/rawCharts'];\n\n    this.charts = Object.values(c);\n\n    // If there are no plugins installed, default to the catalog view\n    if (this.plugins.length === 0) {\n      this.$refs.tabs?.select(TABS_VALUES.AVAILABLE);\n    }\n\n    this.loading = false;\n  },\n\n  computed: {\n    pluginDeveloper: mapPref(PLUGIN_DEVELOPER),\n\n    ...mapGetters({ uiplugins: 'uiplugins/plugins' }),\n    ...mapGetters({ uiErrors: 'uiplugins/errors' }),\n    ...mapGetters({ theme: 'prefs/theme' }),\n\n    showAddReposBanner() {\n      return this.addExtensionReposBannerSetting?.value === 'true' && (!this.repos.find((r) => r.urlDisplay === UI_PLUGINS_REPO_URL) || !this.repos.find((r) => r.urlDisplay === UI_PLUGINS_PARTNERS_REPO_URL));\n    },\n\n    applyDarkModeBg() {\n      if (this.theme === 'dark') {\n        return { 'dark-mode': true };\n      }\n\n      return {};\n    },\n\n    menuActions() {\n      const menuActions = [];\n\n      // Add link to go to the Repos view of the local cluster\n      menuActions.push({\n        action:  'manageRepos',\n        label:   this.t('plugins.manageRepos'),\n        enabled: true\n      });\n\n      // Add link to add extensions repositories (Official, Partners, etc)\n      menuActions.push({\n        action:  'addRancherRepos',\n        label:   this.t('plugins.addRancherRepos'),\n        enabled: true\n      });\n\n      // Only show Manage Extension Catalogs when on main charts view\n      if (!this.showCatalogList) {\n        menuActions.push({\n          action:  'manageExtensionView',\n          label:   this.t('plugins.manageCatalog.label'),\n          enabled: true\n        });\n      }\n\n      // Only show Developer Load action if the user has this enabled in preferences\n      if (this.pluginDeveloper) {\n        menuActions.push( { divider: true });\n        menuActions.push({\n          action:  'devLoad',\n          label:   this.t('plugins.developer.label'),\n          enabled: true\n        });\n      }\n\n      if (this.hasService) {\n        menuActions.push( { divider: true });\n        menuActions.push({\n          action:  'removePluginSupport',\n          label:   this.t('plugins.setup.remove.label'),\n          enabled: true\n        });\n      }\n\n      return menuActions;\n    },\n\n    list() {\n      const all = this.available;\n\n      switch (this.view) {\n      case TABS_VALUES.INSTALLED:\n        return all.filter((p) => !!p.installed || !!p.installing);\n      case TABS_VALUES.UPDATES:\n        return this.updates;\n      case TABS_VALUES.AVAILABLE:\n        return all.filter((p) => !p.installed);\n      default:\n        return all;\n      }\n    },\n\n    hasMenuActions() {\n      return this.menuActions?.length > 0;\n    },\n\n    // Message to display when the tab view is empty (depends on the tab)\n    emptyMessage() {\n      return this.t(`plugins.empty.${ this.view }`);\n    },\n\n    updates() {\n      return this.available.filter((plugin) => !!plugin.upgrade);\n    },\n\n    available() {\n      let all = this.charts.filter((c) => isUIPlugin(c));\n\n      // Filter out hidden charts\n      all = all.filter((c) => !uiPluginHasAnnotation(c, CATALOG_ANNOTATIONS.HIDDEN, 'true'));\n\n      all = all.map((chart) => {\n        // Label can be overridden by chart annotation\n        const label = uiPluginAnnotation(chart, UI_PLUGIN_CHART_ANNOTATIONS.DISPLAY_NAME) || chart.chartNameDisplay;\n        const item = {\n          name:         chart.chartName,\n          label,\n          description:  chart.chartDescription,\n          id:           chart.id,\n          versions:     [],\n          installed:    false,\n          builtin:      false,\n          experimental: uiPluginHasAnnotation(chart, CATALOG_ANNOTATIONS.EXPERIMENTAL, 'true'),\n          certified:    uiPluginHasAnnotation(chart, CATALOG_ANNOTATIONS.CERTIFIED, CATALOG_ANNOTATIONS._RANCHER)\n        };\n\n        item.versions = [...chart.versions];\n        item.chart = chart;\n\n        // Filter the versions available to install (plugins-api version and current dashboard version)\n        item.installableVersions = item.versions.filter((version) => isSupportedChartVersion({ version, kubeVersion: this.kubeVersion }) && isChartVersionAvailableForInstall({\n          version, rancherVersion: this.rancherVersion, kubeVersion: this.kubeVersion\n        }));\n\n        // add prop to version object if version is compatible with the current dashboard version\n        item.versions = item.versions.map((version) => isChartVersionAvailableForInstall({\n          version, rancherVersion: this.rancherVersion, kubeVersion: this.kubeVersion\n        }, true));\n\n        const latestCompatible = item.installableVersions?.[0];\n        const latestNotCompatible = item.versions.find((version) => !version.isCompatibleWithUi || !version.isCompatibleWithKubeVersion);\n\n        if (latestCompatible) {\n          item.displayVersion = latestCompatible.version;\n          item.icon = latestCompatible.icon;\n        } else {\n          item.displayVersion = item.versions?.[0]?.version;\n          item.icon = chart.icon || latestCompatible?.annotations?.['catalog.cattle.io/ui-icon'];\n        }\n\n        if (latestNotCompatible && item.installableVersions.length && isChartVersionHigher(latestNotCompatible.version, item.installableVersions?.[0].version)) {\n          if (!item.isCompatibleWithUi) {\n            item.incompatibleRancherVersion = this.t('plugins.incompatibleRancherVersion', { version: latestNotCompatible.version, rancherVersion: latestNotCompatible.requiredUiVersion }, true);\n          } else if (!item.isCompatibleWithKubeVersion) {\n            item.incompatibleKubeVersion = this.t('plugins.incompatibleKubeVersion', { version: latestNotCompatible.version, kubeVersion: latestNotCompatible.requiredKubeVersion }, true);\n          }\n        }\n\n        if (this.installing[item.name]) {\n          item.installing = this.installing[item.name];\n        }\n\n        return item;\n      });\n\n      // Remove charts with no installable versions\n      all = all.filter((c) => c.versions.length > 0);\n\n      // Check that all of the loaded plugins are represented\n      this.uiplugins.forEach((p) => {\n        const chart = all.find((c) => c.name === p.name);\n\n        if (!chart) {\n          // A plugin is loaded, but there is no chart, so add an item so that it shows up\n          const rancher = typeof p.metadata?.rancher === 'object' ? p.metadata.rancher : {};\n          const label = rancher.annotations?.[UI_PLUGIN_CHART_ANNOTATIONS.DISPLAY_NAME] || p.name;\n          const item = {\n            name:           p.name,\n            label,\n            description:    p.metadata?.description,\n            icon:           p.metadata?.icon,\n            id:             p.id,\n            versions:       [],\n            displayVersion: p.metadata?.version || '-',\n            installed:      true,\n            builtin:        !!p.builtin,\n          };\n\n          // Built-in plugins can chose to be hidden - used where we implement as extensions\n          // but don't want to shows them individually on the extensions page\n          if (!(item.builtin && rancher[UI_PLUGIN_CHART_ANNOTATIONS.HIDDEN_BUILTIN])) {\n            all.push(item);\n          }\n        }\n      });\n\n      // Go through the CRs for the plugins and wire them into the catalog\n      this.plugins.forEach((p) => {\n        const chart = all.find((c) => c.name === p.name);\n\n        if (chart) {\n          chart.installed = true;\n          chart.uiplugin = p;\n          chart.displayVersion = p.version;\n\n          // Can't do this here\n          chart.installing = this.installing[chart.name];\n\n          // Check for upgrade\n          if (chart.installableVersions?.length && p.version !== chart.installableVersions?.[0]?.version) {\n            chart.upgrade = chart.installableVersions[0].version;\n          }\n        } else {\n          // No chart, so add a card for the plugin based on its Custom resource being present\n          const item = {\n            name:           p.name,\n            label:          p.name,\n            description:    p.description || '-',\n            id:             `${ p.name }-${ p.version }`,\n            versions:       [],\n            displayVersion: p.version || '-',\n            installed:      true,\n            installing:     false,\n            builtin:        false,\n            uiplugin:       p,\n          };\n\n          all.push(item);\n        }\n      });\n\n      // Merge in the plugin load errors\n      Object.keys(this.uiErrors).forEach((e) => {\n        const chart = all.find((c) => c.name === e);\n\n        if (chart) {\n          const error = this.uiErrors[e];\n\n          if (error && typeof error === 'string') {\n            chart.error = this.t(this.uiErrors[e]);\n          } else {\n            chart.error = false;\n          }\n        }\n      });\n\n      // Merge in the plugin load errors from help ops\n      Object.keys(this.errors).forEach((e) => {\n        const chart = all.find((c) => c.name === e);\n\n        if (chart) {\n          chart.helmError = !!this.errors[e];\n        }\n      });\n\n      all.forEach((plugin) => {\n        // Clamp the lengths of the descriptions\n        if (plugin.description && plugin.description.length > MAX_DESCRIPTION_LENGTH) {\n          plugin.description = `${ plugin.description.substr(0, MAX_DESCRIPTION_LENGTH) } ...`;\n        }\n\n        // check if kube version compatibility is met for installed extension\n        if (plugin.uiplugin) {\n          const versionInstalled = plugin.uiplugin.spec?.plugin?.version;\n          const versionInstalledData = plugin.versions.find((v) => v.version === versionInstalled);\n\n          if (versionInstalledData) {\n            const kubeVersionToCheck = versionInstalledData.annotations?.[UI_PLUGIN_CHART_ANNOTATIONS.KUBE_VERSION];\n\n            if (this.kubeVersion && !isSupportedChartVersion({ version: versionInstalledData, kubeVersion: this.kubeVersion })) {\n              plugin.installedError = this.t('plugins.currentInstalledVersionBlockedByKubeVersion', { kubeVersion: this.kubeVersion, kubeVersionToCheck }, true);\n            }\n          }\n        }\n      });\n\n      // Sort by name\n      return sortBy(all, 'name', false);\n    }\n  },\n\n  watch: {\n    helmOps(neu) {\n      // Get Helm operations for UI plugins and order by date\n      let pluginOps = neu.filter((op) => {\n        return op.namespace === UI_PLUGIN_NAMESPACE;\n      });\n\n      pluginOps = sortBy(pluginOps, 'metadata.creationTimestamp', true);\n\n      // Go through the installed plugins\n      (this.available || []).forEach((plugin) => {\n        const op = pluginOps.find((o) => o.status?.releaseName === plugin.name);\n\n        if (op) {\n          const active = op.metadata.state?.transitioning;\n          const error = op.metadata.state?.error;\n\n          Vue.set(this.errors, plugin.name, error);\n\n          if (active) {\n            // Can use the status directly, apart from upgrade, which maps to install\n            const status = op.status.action === 'upgrade' ? 'install' : op.status.action;\n\n            this.updatePluginInstallStatus(plugin.name, status);\n          } else if (op.status.action === 'uninstall') {\n            // Uninstall has finished\n            this.updatePluginInstallStatus(plugin.name, false);\n          } else if (error) {\n            this.updatePluginInstallStatus(plugin.name, false);\n          }\n        } else {\n          this.updatePluginInstallStatus(plugin.name, false);\n        }\n      });\n    },\n\n    plugins(neu, old) {\n      const installed = this.$store.getters['uiplugins/plugins'];\n      const shouldHaveLoaded = (installed || []).filter((p) => !this.uiErrors[p.name] && !p.builtin);\n      let changes = 0;\n\n      // Did the user remove an extension\n      if (neu?.length < shouldHaveLoaded.length) {\n        changes++;\n      }\n\n      neu.forEach((plugin) => {\n        const existing = installed.find((p) => !p.removed && p.name === plugin.name && p.version === plugin.version);\n\n        if (!existing && plugin.isCached) {\n          if (!this.uiErrors[plugin.name]) {\n            changes++;\n          }\n\n          this.updatePluginInstallStatus(plugin.name, false);\n        }\n      });\n\n      if (changes > 0) {\n        Vue.set(this, 'reloadRequired', true);\n      }\n    }\n  },\n\n  // Forget the types when we leave the page\n  beforeDestroy() {\n    this.$store.dispatch('management/forgetType', UI_PLUGIN);\n    this.$store.dispatch('management/forgetType', CATALOG.OPERATION);\n    this.$store.dispatch('management/forgetType', CATALOG.APP);\n    this.$store.dispatch('management/forgetType', CATALOG.CLUSTER_REPO);\n  },\n\n  methods: {\n    async refreshCharts(forceChartsUpdate = false) {\n      // we might need to force the request, so that we know at all times if what's the status of the offical and partners repos (installed or not)\n      // tied to the SetupUIPlugins, AddExtensionRepos and RemoveUIPlugins checkboxes\n      await this.$store.dispatch('catalog/load', { reset: true, force: forceChartsUpdate });\n      const c = this.$store.getters['catalog/rawCharts'];\n\n      this.charts = Object.values(c);\n    },\n\n    async updateInstallStatus(forceChartsUpdate = false) {\n      let hasService;\n\n      try {\n        const service = await this.$store.dispatch('management/find', {\n          type: SERVICE,\n          id:   `${ UI_PLUGIN_NAMESPACE }/ui-plugin-operator`,\n          opt:  { force: true },\n        });\n\n        hasService = !!service;\n      } catch (e) {\n        hasService = false;\n      }\n\n      if (hasService || forceChartsUpdate) {\n        this.refreshCharts(forceChartsUpdate);\n      }\n\n      Vue.set(this, 'hasService', hasService);\n\n      return hasService;\n    },\n\n    filterChanged(f) {\n      this.view = f.selectedName;\n    },\n\n    removePluginSupport() {\n      this.refreshCharts(true);\n      this.$refs.removeUIPlugins.showDialog();\n    },\n\n    // Developer Load is in the action menu\n    showDeveloperLoadDialog() {\n      this.$refs.developerInstallDialog.showDialog();\n    },\n\n    showAddExtensionReposDialog() {\n      this.updateAddReposSetting();\n      this.refreshCharts(true);\n      this.$refs.addExtensionReposDialog.showDialog();\n    },\n\n    showCatalogLoadDialog() {\n      this.$refs.catalogLoadDialog.showDialog();\n    },\n\n    showCatalogUninstallDialog(ev) {\n      this.$refs.catalogUninstallDialog.showDialog(ev);\n    },\n\n    showInstallDialog(plugin, mode, ev) {\n      ev.target?.blur();\n      ev.preventDefault();\n      ev.stopPropagation();\n\n      this.$refs.installDialog.showDialog(plugin, mode);\n    },\n\n    showUninstallDialog(plugin, ev) {\n      ev.target?.blur();\n      ev.preventDefault();\n      ev.stopPropagation();\n\n      this.$refs.uninstallDialog.showDialog(plugin);\n    },\n\n    didUninstall(plugin) {\n      if (plugin) {\n        this.updatePluginInstallStatus(plugin.name, 'uninstall');\n\n        if (plugin.catalog) {\n          this.refreshCharts();\n        }\n\n        // Clear the load error, if there was one\n        this.$store.dispatch('uiplugins/setError', { name: plugin.name, error: false });\n      }\n    },\n\n    didInstall(plugin) {\n      if (plugin) {\n        // Change the view to installed if we started installing a plugin\n        this.$refs.tabs?.select(TABS_VALUES.INSTALLED);\n\n        // Clear the load error, if there was one previously\n        this.$store.dispatch('uiplugins/setError', { name: plugin.name, error: false });\n      }\n    },\n\n    showPluginDetail(plugin) {\n      this.$refs.infoPanel.show(plugin);\n    },\n\n    updatePluginInstallStatus(name, status) {\n      Vue.set(this.installing, name, status);\n    },\n\n    setMenu(event) {\n      this.menuOpen = !!event;\n\n      if (event) {\n        this.menuTargetElement = this.$refs.actions;\n        this.menuTargetEvent = event;\n      } else {\n        this.menuTargetElement = undefined;\n        this.menuTargetEvent = undefined;\n      }\n    },\n\n    reload() {\n      this.$router.go();\n    },\n\n    manageRepos() {\n      this.$router.push({\n        name:   'c-cluster-product-resource',\n        params: {\n          cluster:  'local',\n          product:  APP_PRODUCT,\n          resource: CATALOG.CLUSTER_REPO\n        }\n      });\n    },\n\n    manageExtensionView() {\n      this.showCatalogList = !this.showCatalogList;\n    },\n\n    updateAddReposSetting() {\n      if (this.addExtensionReposBannerSetting?.value === 'true') {\n        this.addExtensionReposBannerSetting.value = 'false';\n        this.addExtensionReposBannerSetting.save();\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"plugins\">\n    <div class=\"plugin-header\">\n      <template v-if=\"showCatalogList\">\n        <div class=\"catalog-title\">\n          <h2\n            class=\"mb-0 mr-10\"\n            data-testid=\"extensions-catalog-title\"\n          >\n            <a\n              class=\"link\"\n              @click=\"manageExtensionView()\"\n            >\n              {{ t('plugins.manageCatalog.title') }}:\n            </a>\n            <t k=\"plugins.manageCatalog.subtitle\" />\n          </h2>\n          <BadgeState\n            color=\"bg-warning\"\n            :label=\"t('generic.experimental')\"\n            class=\"badge\"\n          />\n        </div>\n      </template>\n      <template v-else>\n        <h2 data-testid=\"extensions-page-title\">\n          {{ t('plugins.title') }}\n        </h2>\n      </template>\n      <div class=\"actions-container\">\n        <div\n          v-if=\"reloadRequired\"\n          class=\"plugin-reload-banner mr-20\"\n          data-testid=\"extension-reload-banner\"\n        >\n          <i class=\"icon icon-checkmark mr-10\" />\n          <span>\n            {{ t('plugins.reload') }}\n          </span>\n          <button\n            class=\"ml-10 btn btn-sm role-primary\"\n            data-testid=\"extension-reload-banner-reload-btn\"\n            @click=\"reload()\"\n          >\n            {{ t('generic.reload') }}\n          </button>\n        </div>\n        <div v-if=\"hasService && hasMenuActions\">\n          <button\n            ref=\"actions\"\n            aria-haspopup=\"true\"\n            type=\"button\"\n            class=\"btn role-multi-action actions\"\n            data-testid=\"extensions-page-menu\"\n            @click=\"setMenu\"\n          >\n            <i class=\"icon icon-actions\" />\n          </button>\n          <ActionMenu\n            :custom-actions=\"menuActions\"\n            :open=\"menuOpen\"\n            :use-custom-target-element=\"true\"\n            :custom-target-element=\"menuTargetElement\"\n            :custom-target-event=\"menuTargetEvent\"\n            @close=\"setMenu(false)\"\n            @devLoad=\"showDeveloperLoadDialog\"\n            @removePluginSupport=\"removePluginSupport\"\n            @manageRepos=\"manageRepos\"\n            @addRancherRepos=\"showAddExtensionReposDialog\"\n            @manageExtensionView=\"manageExtensionView\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <PluginInfoPanel ref=\"infoPanel\" />\n\n    <div v-if=\"!hasService\">\n      <div\n        v-if=\"loading\"\n        class=\"data-loading\"\n      >\n        <i class=\"icon-spin icon icon-spinner\" />\n        <t\n          k=\"generic.loading\"\n          :raw=\"true\"\n        />\n      </div>\n      <SetupUIPlugins\n        v-else\n        class=\"setup-message\"\n        @done=\"updateInstallStatus(true)\"\n        @refreshCharts=\"refreshCharts(true)\"\n      />\n    </div>\n    <div v-else>\n      <template v-if=\"showCatalogList\">\n        <CatalogList\n          @showCatalogLoadDialog=\"showCatalogLoadDialog\"\n          @showCatalogUninstallDialog=\"showCatalogUninstallDialog($event)\"\n        />\n      </template>\n      <template v-else>\n        <Banner\n          v-if=\"showAddReposBanner\"\n          color=\"warning\"\n          class=\"add-repos-banner mb-20\"\n          data-testid=\"extensions-new-repos-banner\"\n        >\n          <span>{{ t('plugins.addRepos.banner', {}, true) }}</span>\n          <button\n            class=\"ml-10 btn btn-sm role-primary\"\n            data-testid=\"extensions-new-repos-banner-action-btn\"\n            @click=\"showAddExtensionReposDialog()\"\n          >\n            {{ t('plugins.addRepos.bannerBtn') }}\n          </button>\n        </Banner>\n\n        <Tabbed\n          ref=\"tabs\"\n          :tabs-only=\"true\"\n          data-testid=\"extension-tabs\"\n          @changed=\"filterChanged\"\n        >\n          <Tab\n            :name=\"TABS_VALUES.INSTALLED\"\n            data-testid=\"extension-tab-installed\"\n            label-key=\"plugins.tabs.installed\"\n            :weight=\"20\"\n          />\n          <Tab\n            :name=\"TABS_VALUES.AVAILABLE\"\n            data-testid=\"extension-tab-available\"\n            label-key=\"plugins.tabs.available\"\n            :weight=\"19\"\n          />\n          <Tab\n            :name=\"TABS_VALUES.UPDATES\"\n            label-key=\"plugins.tabs.updates\"\n            :weight=\"18\"\n            :badge=\"updates.length\"\n          />\n          <Tab\n            :name=\"TABS_VALUES.ALL\"\n            label-key=\"plugins.tabs.all\"\n            :weight=\"17\"\n          />\n        </Tabbed>\n        <template>\n          <div\n            v-if=\"loading\"\n            class=\"data-loading\"\n          >\n            <i class=\"icon-spin icon icon-spinner\" />\n            <t\n              k=\"generic.loading\"\n              :raw=\"true\"\n            />\n          </div>\n          <div\n            v-else\n            class=\"plugin-list\"\n            :class=\"{'v-margin': !list.length}\"\n          >\n            <IconMessage\n              v-if=\"list.length === 0\"\n              :vertical=\"true\"\n              :subtle=\"true\"\n              icon=\"icon-extension\"\n              :message=\"emptyMessage\"\n            />\n            <template v-else>\n              <div\n                v-for=\"(plugin, i) in list\"\n                :key=\"plugin.name + i\"\n                class=\"plugin\"\n                :data-testid=\"`extension-card-${plugin.name}`\"\n                @click=\"showPluginDetail(plugin)\"\n              >\n                <!-- plugin icon -->\n                <div\n                  class=\"plugin-icon\"\n                  :class=\"applyDarkModeBg\"\n                >\n                  <LazyImage\n                    v-if=\"plugin.icon\"\n                    :initial-src=\"defaultIcon\"\n                    :error-src=\"defaultIcon\"\n                    :src=\"plugin.icon\"\n                    class=\"icon plugin-icon-img\"\n                  />\n                  <img\n                    v-else\n                    :src=\"defaultIcon\"\n                    class=\"icon plugin-icon-img\"\n                  >\n                </div>\n                <!-- plugin card -->\n                <div class=\"plugin-metadata\">\n                  <!-- plugin basic info -->\n                  <div class=\"plugin-name\">\n                    {{ plugin.label }}\n                  </div>\n                  <div>{{ plugin.description }}</div>\n                  <div class=\"plugin-version\">\n                    <span\n                      v-if=\"plugin.installing\"\n                      class=\"plugin-installing\"\n                    >\n                      -\n                    </span>\n                    <span v-else>\n                      <span>{{ plugin.displayVersion }}</span>\n                      <span\n                        v-if=\"plugin.upgrade\"\n                        v-clean-tooltip=\"t('plugins.upgradeAvailable')\"\n                      > -> {{ plugin.upgrade }}</span>\n                      <p\n                        v-if=\"plugin.installedError\"\n                        class=\"incompatible\"\n                      >\n                        <i class=\"icon icon-warning icon-lg text-warning\" />\n                        <span>{{ plugin.installedError }}</span>\n                      </p>\n                      <p\n                        v-else-if=\"plugin.incompatibleRancherVersion\"\n                        class=\"incompatible\"\n                      >{{ plugin.incompatibleRancherVersion }}</p>\n                      <p\n                        v-else-if=\"plugin.incompatibleKubeVersion\"\n                        class=\"incompatible\"\n                      >{{ plugin.incompatibleKubeVersion }}</p>\n                    </span>\n                  </div>\n                  <!-- plugin badges -->\n                  <div\n                    v-if=\"plugin.builtin\"\n                    class=\"plugin-badges\"\n                  >\n                    <div class=\"plugin-builtin\">\n                      {{ t('plugins.labels.builtin') }}\n                    </div>\n                  </div>\n                  <div\n                    v-else\n                    class=\"plugin-badges\"\n                  >\n                    <div\n                      v-if=\"!plugin.certified\"\n                      v-clean-tooltip=\"t('plugins.descriptions.third-party')\"\n                    >\n                      {{ t('plugins.labels.third-party') }}\n                    </div>\n                    <div\n                      v-if=\"plugin.experimental\"\n                      v-clean-tooltip=\"t('plugins.descriptions.experimental')\"\n                    >\n                      {{ t('plugins.labels.experimental') }}\n                    </div>\n                  </div>\n                  <div class=\"plugin-spacer\" />\n                  <!-- plugin badges -->\n                  <div class=\"plugin-actions\">\n                    <template v-if=\"plugin.error\">\n                      <div\n                        v-clean-tooltip=\"plugin.error\"\n                        class=\"plugin-error\"\n                      >\n                        <i class=\"icon icon-warning\" />\n                      </div>\n                    </template>\n                    <!-- plugin status -->\n                    <div\n                      v-if=\"plugin.helmError\"\n                      v-clean-tooltip=\"t('plugins.helmError')\"\n                      class=\"plugin-error\"\n                    >\n                      <i class=\"icon icon-warning\" />\n                    </div>\n\n                    <div class=\"plugin-spacer\" />\n\n                    <div\n                      v-if=\"plugin.installing\"\n                      class=\"plugin-installing\"\n                    >\n                      <i class=\"version-busy icon icon-spin icon-spinner\" />\n                      <div v-if=\"plugin.installing ==='install'\">\n                        {{ t('plugins.labels.installing') }}\n                      </div>\n                      <div v-else>\n                        {{ t('plugins.labels.uninstalling') }}\n                      </div>\n                    </div>\n                    <!-- plugin buttons -->\n                    <div\n                      v-else-if=\"plugin.installed\"\n                      class=\"plugin-buttons\"\n                    >\n                      <button\n                        v-if=\"!plugin.builtin\"\n                        class=\"btn role-secondary\"\n                        :data-testid=\"`extension-card-uninstall-btn-${plugin.name}`\"\n                        @click=\"showUninstallDialog(plugin, $event)\"\n                      >\n                        {{ t('plugins.uninstall.label') }}\n                      </button>\n                      <button\n                        v-if=\"plugin.upgrade\"\n                        class=\"btn role-secondary\"\n                        :data-testid=\"`extension-card-update-btn-${plugin.name}`\"\n                        @click=\"showInstallDialog(plugin, 'update', $event)\"\n                      >\n                        {{ t('plugins.update.label') }}\n                      </button>\n                      <button\n                        v-if=\"!plugin.upgrade && plugin.installableVersions && plugin.installableVersions.length > 1\"\n                        class=\"btn role-secondary\"\n                        :data-testid=\"`extension-card-rollback-btn-${plugin.name}`\"\n                        @click=\"showInstallDialog(plugin, 'rollback', $event)\"\n                      >\n                        {{ t('plugins.rollback.label') }}\n                      </button>\n                    </div>\n                    <div\n                      v-else-if=\"plugin.installableVersions && plugin.installableVersions.length\"\n                      class=\"plugin-buttons\"\n                    >\n                      <button\n                        class=\"btn role-secondary\"\n                        :data-testid=\"`extension-card-install-btn-${plugin.name}`\"\n                        @click=\"showInstallDialog(plugin, 'install', $event)\"\n                      >\n                        {{ t('plugins.install.label') }}\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </template>\n          </div>\n        </template>\n      </template>\n    </div>\n\n    <InstallDialog\n      ref=\"installDialog\"\n      @closed=\"didInstall\"\n      @update=\"updatePluginInstallStatus\"\n    />\n    <UninstallDialog\n      ref=\"uninstallDialog\"\n      @closed=\"didUninstall\"\n      @update=\"updatePluginInstallStatus\"\n    />\n    <CatalogLoadDialog\n      ref=\"catalogLoadDialog\"\n      @closed=\"didInstall\"\n      @refresh=\"() => reloadRequired = true\"\n    />\n    <CatalogUninstallDialog\n      ref=\"catalogUninstallDialog\"\n      @closed=\"didUninstall\"\n      @refresh=\"() => reloadRequired = true\"\n    />\n    <DeveloperInstallDialog\n      ref=\"developerInstallDialog\"\n      @closed=\"didInstall\"\n    />\n    <RemoveUIPlugins\n      ref=\"removeUIPlugins\"\n      @done=\"updateInstallStatus\"\n    />\n    <AddExtensionRepos\n      ref=\"addExtensionReposDialog\"\n      @done=\"updateInstallStatus(true)\"\n    />\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n\n  .setup-message {\n    margin-top: 100px;\n  }\n\n  .data-loading {\n    align-items: center;\n    display: flex;\n    justify-content: center;\n\n    > I {\n      margin-right: 5px;\n    }\n  }\n\n  .plugin-reload-banner {\n    align-items: center;\n    background-color: var(--success-banner-bg);\n    display: flex;\n    padding: 0 10px;\n    border-radius: 5px;\n    min-height: 36px;\n\n    > i {\n      color: var(--success);\n      font-size: 14px;\n      font-weight: bold;\n    }\n\n    > button {\n      line-height: 30px;\n      min-height: 30px;\n    }\n  }\n\n  .plugin-complete {\n    font-size: 18px;\n  }\n\n  .plugin-list {\n    display: flex;\n    flex-wrap: wrap;\n\n    > .plugin:not(:last-child) {\n      margin-right: 20px;\n    }\n\n    &.v-margin {\n      margin-top: 40px;\n    }\n  }\n  .plugins {\n    display: inherit;\n  }\n\n  .plugin-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 10px;\n\n    .catalog-title {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n\n    > h2 {\n      flex: 1;\n      margin-bottom: 0;\n    }\n\n    .link {\n      cursor: pointer;\n    }\n\n    .actions-container {\n      display: flex;\n      flex-direction: row;\n      justify-content: flex-end;\n    }\n\n    .btn.actions {\n      line-height: 36px;\n      min-height: 36px;\n      padding: 0 10px;\n    }\n  }\n\n  .plugin {\n    display: flex;\n    border: 1px solid var(--border);\n    padding: 10px;\n    width: calc(33% - 20px);\n    max-width: 540px;\n    margin-bottom: 20px;\n    cursor: pointer;\n\n    .plugin-icon {\n      font-size: 40px;\n      margin-right:10px;\n      color: #888;\n      width: 44px;\n      height: 44px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n\n      &.dark-mode {\n        border-radius: calc(2 * var(--border-radius));\n        overflow: hidden;\n        background-color: white;\n      }\n\n      .plugin-icon-img {\n        height: 40px;\n        width: 40px;\n        -o-object-fit: contain;\n        object-fit: contain;\n        top: 2px;\n        left: 2px;\n      }\n    }\n\n    .plugin-spacer {\n      flex: 1;\n    }\n\n    .plugin-metadata {\n      display: flex;\n      flex: 1;\n      flex-direction: column;\n\n      .plugin-buttons {\n        > button:not(:first-child) {\n          margin-left: 5px;\n        }\n      }\n    }\n\n    .plugin-builtin {\n      color: var(--primary);\n      display: block;\n      padding: 2px 0;\n      text-transform: uppercase;\n    }\n\n    .plugin-name {\n      font-size: 16px;\n      font-weight: bold;\n      margin-bottom: 5px;\n      text-transform: capitalize;\n    }\n\n    .plugin-badges {\n      display: flex;\n\n      > div {\n        border: 1px solid var(--border);\n        border-radius: 4px;\n        padding: 2px 8px;\n        margin-right: 10px;\n        font-size: 12px;\n      }\n    }\n\n    .plugin-version {\n      align-items: center;\n      display: inline-flex;\n      font-size: 12px;\n      border-radius: 4px;\n      margin: 5px 0;\n\n      i.icon-spinner {\n        padding-right: 5px;\n        font-size: 16px;\n        height: 16px;\n        width: 16px;\n      }\n\n      .incompatible {\n        margin: 10px 0;\n        font-weight: bold;\n      }\n    }\n\n    .plugin-installing {\n      align-items: center;\n      display: flex;\n\n      > div {\n        font-size: 14px;\n        margin-left: 5px;\n      }\n    }\n\n    .plugin-actions {\n      align-items:center;\n      display: flex;\n\n      $error-icon-size: 22px;\n\n      .plugin-error {\n        display: inline;\n        cursor: help;\n\n        > i {\n          color: var(--error);\n          height: $error-icon-size;\n          font-size: $error-icon-size;\n          width: $error-icon-size;\n        }\n      }\n\n      .btn {\n        line-height: 20px;\n        min-height: 20px;\n        padding: 0 5px;\n      }\n    }\n  }\n  ::v-deep .checkbox-label {\n    font-weight: normal !important;\n  }\n\n  ::v-deep .add-repos-banner .banner__content {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  @media screen and (max-width: 1200px) {\n    .plugin-list {\n      .plugin {\n        width: calc(50% - 20px);\n      }\n    }\n  }\n\n  @media screen and (max-width: 960px) {\n    .plugin-list {\n      .plugin {\n        margin-right: 0 !important;\n        width: 100%;\n      }\n    }\n  }\n\n</style>\n"]}]}