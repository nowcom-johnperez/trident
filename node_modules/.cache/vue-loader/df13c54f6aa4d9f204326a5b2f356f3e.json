{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/logging.banzaicloud.io.output/index.vue?vue&type=style&index=0&id=4e53695c&lang=scss","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/logging.banzaicloud.io.output/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1716430467357},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/postcss-loader/src/index.js","mtime":1716430467882},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/sass-loader/dist/cjs.js","mtime":1716430453705},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgJGNoYXJ0OiAxMTBweDsKICAkc2lkZTogMTVweDsKICAkbWFyZ2luOiAxMHB4OwogICRsb2dvOiA2MHB4OwoKLm91dHB1dCB7CiAgZGlzcGxheTogZmxleDsKICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogIGZsZXgtZ3JvdzogMTsKCiAgLnNpZGUtdGFicyB7CiAgICBmbGV4OiAxOwogIH0KICAucHJvdmlkZXIgewogICAgaDEgewogICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICB9CiAgfQoKICAuYm94LWNvbnRhaW5lciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0OwogICAgZmxleC13cmFwOiB3cmFwOwogICAgbWFyZ2luOiAwIC0xKiRtYXJnaW47CgogICAgQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiBtYXAtZ2V0KCRicmVha3BvaW50cywgJy0tdmlld3BvcnQtNCcpKSB7CiAgICAgIC50b2dnbGUtZ3JhZGllbnQtYm94IHsKICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgfQogICAgfQogICAgQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiBtYXAtZ2V0KCRicmVha3BvaW50cywgJy0tdmlld3BvcnQtNycpKSB7CiAgICAgIC50b2dnbGUtZ3JhZGllbnQtYm94IHsKICAgICAgICB3aWR0aDogY2FsYyg1MCUgLSAyICogI3skbWFyZ2lufSk7CiAgICAgIH0KICAgIH0KICAgIEBtZWRpYSBvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogbWFwLWdldCgkYnJlYWtwb2ludHMsICctLXZpZXdwb3J0LTknKSkgewogICAgICAudG9nZ2xlLWdyYWRpZW50LWJveCB7CiAgICAgICAgd2lkdGg6IGNhbGMoMzMuMzMzMzMlIC0gMiAqICN7JG1hcmdpbn0pOwogICAgICB9CiAgICB9CiAgICBAbWVkaWEgb25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IG1hcC1nZXQoJGJyZWFrcG9pbnRzLCAnLS12aWV3cG9ydC0xMicpKSB7CiAgICAgIC50b2dnbGUtZ3JhZGllbnQtYm94IHsKICAgICAgICB3aWR0aDogY2FsYygyNSUgLSAyICogI3skbWFyZ2lufSk7CiAgICAgIH0KICAgIH0KCiAgICAudG9nZ2xlLWdyYWRpZW50LWJveCB7CiAgICAgIG1hcmdpbjogJG1hcmdpbjsKICAgICAgcGFkZGluZzogJG1hcmdpbjsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICBib3JkZXItcmFkaXVzOiBjYWxjKCAxLjUgKiB2YXIoLS1ib3JkZXItcmFkaXVzKSk7CgogICAgICAmOmhvdmVyIHsKICAgICAgICBib3gtc2hhZG93OiAwIDAgMzBweCB2YXIoLS1zaGFkb3cpOwogICAgICAgIHRyYW5zaXRpb246IGJveC1zaGFkb3cgMC4xcyBlYXNlLWluLW91dDsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIH0KCiAgICAgIC5zaWRlLWxhYmVsIHsKICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgxODBkZWcpOwogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICB0b3A6IDA7CiAgICAgICAgbGVmdDogMDsKICAgICAgICBib3R0b206IDA7CiAgICAgICAgbWluLXdpZHRoOiBjYWxjKDEuNSAqIHZhcigtLWJvcmRlci1yYWRpdXMpKTsKICAgICAgICB3aWR0aDogJHNpZGU7CiAgICAgICAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6IGNhbGMoIDEuNSAqIHZhcigtLWJvcmRlci1yYWRpdXMpKTsKICAgICAgICBib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1czogY2FsYyggMS41ICogdmFyKC0tYm9yZGVyLXJhZGl1cykpOwoKICAgICAgICBsYWJlbCB7CiAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICAgICAgICB3cml0aW5nLW1vZGU6IHRiOwogICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgICAgcGFkZGluZzogMCAycHg7CiAgICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgICAgIHdoaXRlLXNwYWNlOiBuby13cmFwOwogICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICAgICAgfQogICAgICB9CgogICAgICAubG9nbyB7CiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICAgIHdpZHRoOiAkbG9nbzsKICAgICAgICBoZWlnaHQ6ICRsb2dvOwogICAgICAgIGJvcmRlci1yYWRpdXM6IGNhbGMoMiAqIHZhcigtLWJvcmRlci1yYWRpdXMpKTsKICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlOwogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwoKICAgICAgICBpbWcgewogICAgICAgICAgd2lkdGg6ICRsb2dvIC0gNHB4OwogICAgICAgICAgaGVpZ2h0OiAkbG9nbyAtIDRweDsKICAgICAgICAgIG9iamVjdC1maXQ6IGNvbnRhaW47CiAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgICB0b3A6IDJweDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgICY6aG92ZXIgewogICAgICAgIGJhY2tncm91bmQtcG9zaXRpb246IHJpZ2h0IGNlbnRlcjsKICAgICAgfQoKICAgICAgLm5hbWUgewogICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpczsKICAgICAgICBtYXJnaW4tYm90dG9tOiAwOwogICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgICAgICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlOwogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA8PA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/edit/logging.banzaicloud.io.output","sourcesContent":["<script>\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport { SECRET, LOGGING, SCHEMA } from '@shell/config/types';\nimport Tabbed from '@shell/components/Tabbed';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport CruResource from '@shell/components/CruResource';\nimport NameNsDescription from '@shell/components/form/NameNsDescription';\nimport Labels from '@shell/components/form/Labels';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { Banner } from '@components/Banner';\nimport { PROVIDERS } from '@shell/models/logging.banzaicloud.io.output';\nimport { _VIEW } from '@shell/config/query-params';\nimport { clone, set } from '@shell/utils/object';\nimport isEqual from 'lodash/isEqual';\nimport isEmpty from 'lodash/isEmpty';\nimport jsyaml from 'js-yaml';\nimport { createYaml } from '@shell/utils/create-yaml';\nimport YamlEditor, { EDITOR_MODES } from '@shell/components/YamlEditor';\n\nexport default {\n  components: {\n    Banner, CruResource, Labels, LabeledSelect, NameNsDescription, Tab, Tabbed, YamlEditor\n  },\n\n  mixins: [CreateEditView],\n\n  async fetch() {\n    await this.$store.dispatch('cluster/findAll', { type: SECRET });\n  },\n\n  data() {\n    const schemas = this.$store.getters['cluster/all'](SCHEMA);\n\n    if (this.isCreate) {\n      this.value.metadata.namespace = 'default';\n    }\n\n    set(this.value, 'spec', this.value.spec || {});\n\n    const providers = PROVIDERS.map((provider) => ({\n      ...provider,\n      value: provider.name,\n      label: this.t(provider.labelKey)\n    }));\n\n    if (this.mode !== _VIEW) {\n      this.$set(this.value, 'spec', this.value.spec || {});\n\n      providers.forEach((provider) => {\n        this.$set(this.value.spec, provider.name, this.value.spec[provider.name] || clone(provider.default));\n      });\n    }\n\n    const selectedProviders = providers.filter((provider) => {\n      const specProvider = this.value.spec[provider.name];\n      const correctedSpecProvider = provider.name === 'forward' ? specProvider?.servers?.[0] || {} : specProvider;\n\n      return !isEmpty(correctedSpecProvider) && !isEqual(correctedSpecProvider, provider.default);\n    });\n\n    const selectedProvider = selectedProviders?.[0]?.value || providers[0].value;\n\n    let bufferYaml;\n\n    if ( !isEmpty(this.value.spec[selectedProvider]?.buffer) ) {\n      bufferYaml = jsyaml.dump(this.value.spec[selectedProvider].buffer);\n    } else {\n      bufferYaml = createYaml(schemas, `logging.banzaicloud.io.v1beta1.output.spec.${ selectedProvider }.buffer`, []);\n      // createYaml doesn't support passing reference types (array, map) as the first type. As such\n      // I'm manipulating the output since I'm not sure it's something we want to actually support\n      // seeing as it's really createResourceYaml and this here is a gray area between spoofed types\n      // and just a field within a spec.\n      bufferYaml = bufferYaml.substring(bufferYaml.indexOf('\\n') + 1).replace(/# {2}/g, '#');\n    }\n\n    return {\n      bufferYaml,\n      initialBufferYaml:            bufferYaml,\n      providers,\n      selectedProvider,\n      hasMultipleProvidersSelected: selectedProviders?.length > 1,\n      selectedProviders,\n      LOGGING\n    };\n  },\n\n  computed: {\n    EDITOR_MODES() {\n      return EDITOR_MODES;\n    },\n    enabledProviders() {\n      return this.providers.filter((p) => p.enabled);\n    },\n    isNamespaced() {\n      return this.value.type !== LOGGING?.CLUSTER_OUTPUT;\n    },\n    cruMode() {\n      if (this.hasMultipleProvidersSelected || !this.value.allProvidersSupported) {\n        return _VIEW;\n      }\n\n      return this.mode;\n    }\n  },\n\n  methods: {\n    getComponent(name) {\n      return require(`./providers/${ name }`).default;\n    },\n    launch(provider) {\n      this.$refs.tabbed.select(provider.name);\n    },\n    saveSettings(done) {\n      const t = this.$store.getters['i18n/t'];\n\n      if (this.selectedProvider === 'loki') {\n        const urlCheck = ['https://', 'http://'].some((checkValue) => this.value.spec['loki'].url.toLowerCase().startsWith(checkValue));\n        const isLokiHttps = this.value.spec['loki'].url ? urlCheck : undefined;\n\n        if (!isLokiHttps) {\n          this.errors = [t('logging.loki.urlInvalid')];\n\n          return done(false);\n        }\n      }\n\n      this.errors = [];\n\n      this.value.spec = { [this.selectedProvider]: this.value.spec[this.selectedProvider] };\n\n      const bufferJson = jsyaml.load(this.bufferYaml);\n\n      if (!isEmpty(bufferJson)) {\n        this.value.spec[this.selectedProvider].buffer = bufferJson;\n      } else {\n        this.$delete(this.value.spec[this.selectedProvider], 'buffer');\n      }\n      this.save(done);\n    },\n    tabChanged({ tab }) {\n      if ( tab.name === 'buffer' ) {\n        this.$nextTick(() => {\n          if ( this.$refs.yaml ) {\n            this.$refs.yaml.refresh();\n            this.$refs.yaml.focus();\n          }\n        });\n      }\n    },\n    onYamlEditorReady(cm) {\n      cm.getMode().fold = 'yamlcomments';\n      cm.execCommand('foldAll');\n      cm.execCommand('unfold');\n    },\n  }\n};\n</script>\n\n<template>\n  <div class=\"output\">\n    <CruResource\n      :done-route=\"doneRoute\"\n      :mode=\"cruMode\"\n      :resource=\"value\"\n      :subtypes=\"[]\"\n      :validation-passed=\"true\"\n      :errors=\"errors\"\n      :can-yaml=\"true\"\n      @error=\"e=>errors = e\"\n      @finish=\"saveSettings\"\n      @cancel=\"done\"\n    >\n      <NameNsDescription\n        v-if=\"!isView\"\n        :value=\"value\"\n        :mode=\"mode\"\n        label=\"generic.name\"\n        :register-before-hook=\"registerBeforeHook\"\n        :namespaced=\"isNamespaced\"\n      />\n      <Banner\n        v-if=\"hasMultipleProvidersSelected\"\n        color=\"info\"\n      >\n        This output is configured with multiple providers. We currently only support a single provider per output. You can view or edit the YAML.\n      </Banner>\n      <Banner\n        v-else-if=\"!value.allProvidersSupported\"\n        color=\"info\"\n      >\n        This output is configured with providers we don't support yet. You can view or edit the YAML.\n      </Banner>\n      <Tabbed\n        v-else\n        ref=\"tabbed\"\n        :side-tabs=\"true\"\n        @changed=\"tabChanged($event)\"\n      >\n        <Tab\n          name=\"Output\"\n          label=\"Output\"\n          :weight=\"2\"\n        >\n          <div class=\"row\">\n            <div class=\"col span-6\">\n              <LabeledSelect\n                v-model=\"selectedProvider\"\n                label=\"Output\"\n                :options=\"providers\"\n                :mode=\"mode\"\n              />\n            </div>\n          </div>\n          <div class=\"spacer\" />\n          <component\n            :is=\"getComponent(selectedProvider)\"\n            :value=\"value.spec[selectedProvider]\"\n            :namespace=\"value.namespace\"\n            :mode=\"mode\"\n          />\n        </Tab>\n        <Tab\n          name=\"buffer\"\n          :label=\"t('logging.output.buffer.label')\"\n          :weight=\"1\"\n        >\n          <YamlEditor\n            ref=\"yaml\"\n            v-model=\"bufferYaml\"\n            :scrolling=\"false\"\n            :initial-yaml-values=\"initialBufferYaml\"\n            :editor-mode=\"isView ? EDITOR_MODES.VIEW_CODE : EDITOR_MODES.EDIT_CODE\"\n            @onReady=\"onYamlEditorReady\"\n          />\n        </Tab>\n        <Tab\n          v-if=\"!isView\"\n          name=\"labels-and-annotations\"\n          label-key=\"generic.labelsAndAnnotations\"\n          :weight=\"0\"\n        >\n          <Labels\n            default-container-class=\"labels-and-annotations-container\"\n            :value=\"value\"\n            :mode=\"mode\"\n            :display-side-by-side=\"false\"\n          />\n        </Tab>\n      </Tabbed>\n    </CruResource>\n  </div>\n</template>\n\n<style lang=\"scss\">\n  $chart: 110px;\n  $side: 15px;\n  $margin: 10px;\n  $logo: 60px;\n\n.output {\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n\n  .side-tabs {\n    flex: 1;\n  }\n  .provider {\n    h1 {\n      display: inline-block;\n    }\n  }\n\n  .box-container {\n    display: flex;\n    justify-content: flex-start;\n    flex-wrap: wrap;\n    margin: 0 -1*$margin;\n\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-4')) {\n      .toggle-gradient-box {\n        width: 100%;\n      }\n    }\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-7')) {\n      .toggle-gradient-box {\n        width: calc(50% - 2 * #{$margin});\n      }\n    }\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-9')) {\n      .toggle-gradient-box {\n        width: calc(33.33333% - 2 * #{$margin});\n      }\n    }\n    @media only screen and (min-width: map-get($breakpoints, '--viewport-12')) {\n      .toggle-gradient-box {\n        width: calc(25% - 2 * #{$margin});\n      }\n    }\n\n    .toggle-gradient-box {\n      margin: $margin;\n      padding: $margin;\n      position: relative;\n      border-radius: calc( 1.5 * var(--border-radius));\n\n      &:hover {\n        box-shadow: 0 0 30px var(--shadow);\n        transition: box-shadow 0.1s ease-in-out;\n        cursor: pointer;\n      }\n\n      .side-label {\n        transform: rotate(180deg);\n        position: absolute;\n        top: 0;\n        left: 0;\n        bottom: 0;\n        min-width: calc(1.5 * var(--border-radius));\n        width: $side;\n        border-top-right-radius: calc( 1.5 * var(--border-radius));\n        border-bottom-right-radius: calc( 1.5 * var(--border-radius));\n\n        label {\n          text-align: center;\n          writing-mode: tb;\n          height: 100%;\n          padding: 0 2px;\n          display: block;\n          white-space: no-wrap;\n          text-overflow: ellipsis;\n        }\n      }\n\n      .logo {\n        text-align: center;\n        width: $logo;\n        height: $logo;\n        border-radius: calc(2 * var(--border-radius));\n        overflow: hidden;\n        background-color: white;\n        display: inline-block;\n        vertical-align: middle;\n\n        img {\n          width: $logo - 4px;\n          height: $logo - 4px;\n          object-fit: contain;\n          position: relative;\n          top: 2px;\n        }\n      }\n\n      &:hover {\n        background-position: right center;\n      }\n\n      .name {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n        margin-bottom: 0;\n        display: inline-block;\n        vertical-align: middle;\n      }\n    }\n  }\n}\n</style>\n"]}]}