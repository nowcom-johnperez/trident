{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/service.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/service.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBoYXMgZnJvbSAnbG9kYXNoL2hhcyc7CmltcG9ydCBpc0VtcHR5IGZyb20gJ2xvZGFzaC9pc0VtcHR5JzsKCmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgUmVzb3VyY2VUYWJsZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9SZXNvdXJjZVRhYmxlJzsKaW1wb3J0IFJlc291cmNlVGFicyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL1Jlc291cmNlVGFicyc7CmltcG9ydCBTb3J0YWJsZVRhYmxlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1NvcnRhYmxlVGFibGUnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwoKaW1wb3J0IHsgQ0FUVExFX1BVQkxJQ19FTkRQT0lOVFMgfSBmcm9tICdAc2hlbGwvY29uZmlnL2xhYmVscy1hbm5vdGF0aW9ucyc7CmltcG9ydCB7IEtFWSwgVkFMVUUgfSBmcm9tICdAc2hlbGwvY29uZmlnL3RhYmxlLWhlYWRlcnMnOwppbXBvcnQgeyBQT0QgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgZmluZEJ5IH0gZnJvbSAnQHNoZWxsL3V0aWxzL2FycmF5JzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBSZXNvdXJjZVRhYmxlLAogICAgUmVzb3VyY2VUYWJzLAogICAgU29ydGFibGVUYWJsZSwKICAgIFRhYiwKICB9LAoKICBtaXhpbnM6IFtDcmVhdGVFZGl0Vmlld10sCgogIHByb3BzOiB7CiAgICBtb2RlOiB7CiAgICAgIGRlZmF1bHQ6ICdjcmVhdGUnLAogICAgICB0eXBlOiAgICBTdHJpbmcsCiAgICB9LAogICAgdmFsdWU6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIHR5cGU6ICAgICBPYmplY3QsCiAgICB9LAogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgYXdhaXQgdGhpcy52YWx1ZS5mZXRjaFBvZHMoKTsKICB9LAoKICBkYXRhKCkgewogICAgY29uc3Qgc2VydmljZVBvcnRJbmZvSGVhZGVycyA9IFsKICAgICAgewogICAgICAgIG5hbWU6ICAnbmFtZScsCiAgICAgICAgbGFiZWw6IHRoaXMudCgndGFibGVIZWFkZXJzLm5hbWUnKSwKICAgICAgICB2YWx1ZTogJ25hbWUnLAogICAgICAgIHNvcnQ6ICAnbmFtZTpkZXNjJywKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICAncG9ydCcsCiAgICAgICAgbGFiZWw6IHRoaXMudCgndGFibGVIZWFkZXJzLnBvcnQnKSwKICAgICAgICB2YWx1ZTogJ3BvcnQnLAogICAgICAgIHNvcnQ6ICAncG9ydDpkZXNjJywKICAgICAgfSwKICAgICAgewogICAgICAgIG5hbWU6ICAncHJvdG9jb2wnLAogICAgICAgIGxhYmVsOiB0aGlzLnQoJ3RhYmxlSGVhZGVycy5wcm90b2NvbCcpLAogICAgICAgIHZhbHVlOiAncHJvdG9jb2wnLAogICAgICAgIHNvcnQ6ICAncHJvdG9jb2w6ZGVzYycsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAgJ3RhcmdldFBvcnQnLAogICAgICAgIGxhYmVsOiB0aGlzLnQoJ3RhYmxlSGVhZGVycy50YXJnZXRQb3J0JyksCiAgICAgICAgdmFsdWU6ICd0YXJnZXRQb3J0JywKICAgICAgICBzb3J0OiAgJ3RhcmdldFBvcnQ6ZGVzYycsCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBuYW1lOiAgJ25vZGVQb3J0JywKICAgICAgICBsYWJlbDogdGhpcy50KCd0YWJsZUhlYWRlcnMubm9kZVBvcnQnKSwKICAgICAgICB2YWx1ZTogJ25vZGVQb3J0JywKICAgICAgICBzb3J0OiAgJ25vZGVQb3J0OmRlc2MnLAogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogICAgICAncHVibGljUG9ydHMnLAogICAgICAgIGxhYmVsOiAgICAgdGhpcy50KCd0YWJsZUhlYWRlcnMucHVibGljUG9ydHMnKSwKICAgICAgICB2YWx1ZTogICAgICdwdWJsaWNQb3J0cycsCiAgICAgICAgZm9ybWF0dGVyOiAnRW5kcG9pbnRzJywKICAgICAgICBzb3J0OiAgICAgICdwdWJsaWNQb3J0czpkZXNjJywKICAgICAgfSwKICAgIF07CgogICAgcmV0dXJuIHsKICAgICAgc2VydmljZVBvcnRJbmZvSGVhZGVycywKICAgICAgcG9kczogICAgICAgICAgICBbXSwKICAgICAgcG9kVGFibGVIZWFkZXJzOiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9oZWFkZXJzRm9yJ10oCiAgICAgICAgdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2x1c3Rlci9zY2hlbWFGb3InXShQT0QpCiAgICAgICksCiAgICAgIHNlcnZpY2VTZWxlY3RvckluZm9IZWFkZXJzOiBbCiAgICAgICAgewogICAgICAgICAgLi4uS0VZLAogICAgICAgICAgd2lkdGg6IDIwMCwKICAgICAgICB9LAogICAgICAgIFZBTFVFLAogICAgICBdLAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgaGFzUHVibGljKCkgewogICAgICBjb25zdCB7IG1ldGFkYXRhOiB7IGFubm90YXRpb25zID0ge30gfSB9ID0gdGhpcy52YWx1ZTsKCiAgICAgIGlmICghaXNFbXB0eShhbm5vdGF0aW9ucykgJiYgaGFzKGFubm90YXRpb25zLCBDQVRUTEVfUFVCTElDX0VORFBPSU5UUykpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHBvcnRzKCkgewogICAgICBjb25zdCB7CiAgICAgICAgbWV0YWRhdGE6IHsgYW5ub3RhdGlvbnMgPSB7fSB9LAogICAgICAgIHNwZWMsCiAgICAgIH0gPSB0aGlzLnZhbHVlOwogICAgICBjb25zdCBwb3J0cyA9IHNwZWMucG9ydHM7CiAgICAgIGNvbnN0IHB1YmxpY1BvcnRzID0gdGhpcy5oYXNQdWJsaWMgPyBKU09OLnBhcnNlKGFubm90YXRpb25zW0NBVFRMRV9QVUJMSUNfRU5EUE9JTlRTXSkgOiBudWxsOwoKICAgICAgcmV0dXJuIHBvcnRzLm1hcCgocG9ydCkgPT4gewogICAgICAgIGNvbnN0IG91dCA9IHsKICAgICAgICAgIC4uLnBvcnQsCiAgICAgICAgICBwdWJsaWNQb3J0czogW10sCiAgICAgICAgfTsKCiAgICAgICAgY29uc3QgbWF0Y2hlZFB1YmxpYyA9IGZpbmRCeShwdWJsaWNQb3J0cywgJ3BvcnQnLCBwb3J0LnBvcnQpOwoKICAgICAgICBpZiAobWF0Y2hlZFB1YmxpYykgewogICAgICAgICAgb3V0LnB1YmxpY1BvcnRzID0gSlNPTi5zdHJpbmdpZnkoW21hdGNoZWRQdWJsaWNdKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBvdXQ7CiAgICAgIH0pOwogICAgfSwKICAgIHBvZFNjaGVtYSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvc2NoZW1hRm9yJ10oUE9EKTsKICAgIH0sCiAgICBzZWxlY3RvclRhYmxlUm93cygpIHsKICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMudmFsdWUuc3BlYz8uc2VsZWN0b3IgfHwge30pLm1hcCgoa2V5KSA9PiAoewogICAgICAgIGtleSwKICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZS5zcGVjLnNlbGVjdG9yW2tleV0sCiAgICAgIH0pKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["service.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"service.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport has from 'lodash/has';\nimport isEmpty from 'lodash/isEmpty';\n\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport ResourceTable from '@shell/components/ResourceTable';\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport SortableTable from '@shell/components/SortableTable';\nimport Tab from '@shell/components/Tabbed/Tab';\n\nimport { CATTLE_PUBLIC_ENDPOINTS } from '@shell/config/labels-annotations';\nimport { KEY, VALUE } from '@shell/config/table-headers';\nimport { POD } from '@shell/config/types';\nimport { findBy } from '@shell/utils/array';\n\nexport default {\n  components: {\n    ResourceTable,\n    ResourceTabs,\n    SortableTable,\n    Tab,\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    mode: {\n      default: 'create',\n      type:    String,\n    },\n    value: {\n      required: true,\n      type:     Object,\n    },\n  },\n\n  async fetch() {\n    await this.value.fetchPods();\n  },\n\n  data() {\n    const servicePortInfoHeaders = [\n      {\n        name:  'name',\n        label: this.t('tableHeaders.name'),\n        value: 'name',\n        sort:  'name:desc',\n      },\n      {\n        name:  'port',\n        label: this.t('tableHeaders.port'),\n        value: 'port',\n        sort:  'port:desc',\n      },\n      {\n        name:  'protocol',\n        label: this.t('tableHeaders.protocol'),\n        value: 'protocol',\n        sort:  'protocol:desc',\n      },\n      {\n        name:  'targetPort',\n        label: this.t('tableHeaders.targetPort'),\n        value: 'targetPort',\n        sort:  'targetPort:desc',\n      },\n      {\n        name:  'nodePort',\n        label: this.t('tableHeaders.nodePort'),\n        value: 'nodePort',\n        sort:  'nodePort:desc',\n      },\n      {\n        name:      'publicPorts',\n        label:     this.t('tableHeaders.publicPorts'),\n        value:     'publicPorts',\n        formatter: 'Endpoints',\n        sort:      'publicPorts:desc',\n      },\n    ];\n\n    return {\n      servicePortInfoHeaders,\n      pods:            [],\n      podTableHeaders: this.$store.getters['type-map/headersFor'](\n        this.$store.getters['cluster/schemaFor'](POD)\n      ),\n      serviceSelectorInfoHeaders: [\n        {\n          ...KEY,\n          width: 200,\n        },\n        VALUE,\n      ],\n    };\n  },\n\n  computed: {\n    hasPublic() {\n      const { metadata: { annotations = {} } } = this.value;\n\n      if (!isEmpty(annotations) && has(annotations, CATTLE_PUBLIC_ENDPOINTS)) {\n        return true;\n      }\n\n      return false;\n    },\n    ports() {\n      const {\n        metadata: { annotations = {} },\n        spec,\n      } = this.value;\n      const ports = spec.ports;\n      const publicPorts = this.hasPublic ? JSON.parse(annotations[CATTLE_PUBLIC_ENDPOINTS]) : null;\n\n      return ports.map((port) => {\n        const out = {\n          ...port,\n          publicPorts: [],\n        };\n\n        const matchedPublic = findBy(publicPorts, 'port', port.port);\n\n        if (matchedPublic) {\n          out.publicPorts = JSON.stringify([matchedPublic]);\n        }\n\n        return out;\n      });\n    },\n    podSchema() {\n      return this.$store.getters['cluster/schemaFor'](POD);\n    },\n    selectorTableRows() {\n      return Object.keys(this.value.spec?.selector || {}).map((key) => ({\n        key,\n        value: this.value.spec.selector[key],\n      }));\n    },\n  },\n};\n</script>\n\n<template>\n  <ResourceTabs\n    v-model=\"value\"\n    :mode=\"mode\"\n  >\n    <Tab\n      name=\"pods\"\n      :label=\"t('servicesPage.pods.label')\"\n      :weight=\"4\"\n    >\n      <ResourceTable\n        :rows=\"value.pods\"\n        :headers=\"podTableHeaders\"\n        key-field=\"id\"\n        :table-actions=\"false\"\n        :schema=\"podSchema\"\n        :groupable=\"false\"\n        :search=\"false\"\n      />\n    </Tab>\n    <Tab\n      name=\"ports\"\n      :label=\"t('servicesPage.ports.label')\"\n      class=\"bordered-table\"\n      :weight=\"3\"\n    >\n      <SortableTable\n        key-field=\"_key\"\n        :headers=\"servicePortInfoHeaders\"\n        :rows=\"ports\"\n        :row-actions=\"false\"\n        :table-actions=\"false\"\n        :search=\"false\"\n      />\n    </Tab>\n    <Tab\n      name=\"selector\"\n      :label=\"t('servicesPage.selectors.label')\"\n      class=\"bordered-table\"\n      :weight=\"2\"\n    >\n      <SortableTable\n        key-field=\"_key\"\n        :headers=\"serviceSelectorInfoHeaders\"\n        :rows=\"selectorTableRows\"\n        :row-actions=\"false\"\n        :table-actions=\"false\"\n        :show-headers=\"true\"\n        :search=\"false\"\n      />\n    </Tab>\n  </ResourceTabs>\n</template>\n\n<style lang=\"scss\" scoped>\n</style>\n"]}]}