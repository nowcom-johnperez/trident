{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/SecretSelector.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/SecretSelector.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IFNFQ1JFVCB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBfRURJVCwgX1ZJRVcgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmltcG9ydCB7IFNFQ1JFVF9UWVBFUyBhcyBUWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2VjcmV0JzsKaW1wb3J0IHNvcnRCeSBmcm9tICdsb2Rhc2gvc29ydEJ5JzsKCmNvbnN0IE5PTkUgPSAnX19bW05PTkVdXV9fJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IExhYmVsZWRTZWxlY3QgfSwKCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgICBbU3RyaW5nLCBPYmplY3RdLAogICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgIGRlZmF1bHQ6ICB1bmRlZmluZWQKICAgIH0sCiAgICBuYW1lc3BhY2U6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICB0eXBlczogewogICAgICB0eXBlOiAgICBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gT2JqZWN0LnZhbHVlcyhUWVBFUykKICAgIH0sCiAgICBkaXNhYmxlZDogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfSwKICAgIG1vdW50S2V5OiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ3ZhbHVlRnJvbScKICAgIH0sCiAgICBuYW1lS2V5OiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ25hbWUnCiAgICB9LAogICAga2V5S2V5OiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ2tleScKICAgIH0sCiAgICBzaG93S2V5U2VsZWN0b3I6IHsKICAgICAgdHlwZTogICAgQm9vbGVhbiwKICAgICAgZGVmYXVsdDogZmFsc2UKICAgIH0sCiAgICBzZWNyZXROYW1lTGFiZWw6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAnU2VjcmV0IE5hbWUnCiAgICB9LAogICAga2V5TmFtZUxhYmVsOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ0tleScKICAgIH0sCiAgICBtb2RlOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogX0VESVQKICAgIH0sCiAgICBpblN0b3JlOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogJ2NsdXN0ZXInLAogICAgfQogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBuYW1lOiB7CiAgICAgIGdldCgpIHsKICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5zaG93S2V5U2VsZWN0b3IgPyB0aGlzLnZhbHVlPy5bdGhpcy5tb3VudEtleV0/LnNlY3JldEtleVJlZj8uW3RoaXMubmFtZUtleV0gOiB0aGlzLnZhbHVlOwoKICAgICAgICByZXR1cm4gbmFtZSB8fCBOT05FOwogICAgICB9LAogICAgICBzZXQobmFtZSkgewogICAgICAgIGNvbnN0IGlzTm9uZSA9IG5hbWUgPT09IE5PTkU7CiAgICAgICAgY29uc3QgY29ycmVjdGVkTmFtZSA9IGlzTm9uZSA/IHVuZGVmaW5lZCA6IG5hbWU7CgogICAgICAgIGlmICh0aGlzLnNob3dLZXlTZWxlY3RvcikgewogICAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCB7IFt0aGlzLm1vdW50S2V5XTogeyBzZWNyZXRLZXlSZWY6IHsgW3RoaXMubmFtZUtleV06IGNvcnJlY3RlZE5hbWUsIFt0aGlzLmtleUtleV06ICcnIH0gfSB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBjb3JyZWN0ZWROYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAga2V5OiB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy52YWx1ZT8uW3RoaXMubW91bnRLZXldPy5zZWNyZXRLZXlSZWY/Llt0aGlzLmtleUtleV0gfHwgJyc7CiAgICAgIH0sCiAgICAgIHNldChrZXkpIHsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHsgW3RoaXMubW91bnRLZXldOiB7IHNlY3JldEtleVJlZjogeyBbdGhpcy5uYW1lS2V5XTogdGhpcy5uYW1lLCBbdGhpcy5rZXlLZXldOiBrZXkgfSB9IH0pOwogICAgICB9CiAgICB9LAogICAgc2VjcmV0cygpIHsKICAgICAgY29uc3QgYWxsU2VjcmV0cyA9IHRoaXMuJHN0b3JlLmdldHRlcnNbYCR7IHRoaXMuaW5TdG9yZSB9L2FsbGBdKFNFQ1JFVCk7CgogICAgICByZXR1cm4gYWxsU2VjcmV0cwogICAgICAgIC5maWx0ZXIoKHNlY3JldCkgPT4gdGhpcy50eXBlcy5pbmNsdWRlcyhzZWNyZXQuX3R5cGUpICYmIHNlY3JldC5uYW1lc3BhY2UgPT09IHRoaXMubmFtZXNwYWNlKTsKICAgIH0sCiAgICBzZWNyZXROYW1lcygpIHsKICAgICAgY29uc3QgbWFwcGVkU2VjcmV0cyA9IHRoaXMuc2VjcmV0cy5tYXAoKHNlY3JldCkgPT4gKHsKICAgICAgICBsYWJlbDogc2VjcmV0Lm5hbWUsCiAgICAgICAgdmFsdWU6IHNlY3JldC5uYW1lCiAgICAgIH0pKS5zb3J0KCk7CgogICAgICByZXR1cm4gW3sgbGFiZWw6ICdOb25lJywgdmFsdWU6IE5PTkUgfSwgLi4uc29ydEJ5KG1hcHBlZFNlY3JldHMsICdsYWJlbCcpXTsKICAgIH0sCiAgICBrZXlzKCkgewogICAgICBjb25zdCBzZWNyZXQgPSB0aGlzLnNlY3JldHMuZmluZCgoc2VjcmV0KSA9PiBzZWNyZXQubmFtZSA9PT0gdGhpcy5uYW1lKSB8fCB7fTsKCiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzZWNyZXQuZGF0YSB8fCB7fSkubWFwKChrZXkpID0+ICh7CiAgICAgICAgbGFiZWw6IGtleSwKICAgICAgICB2YWx1ZToga2V5CiAgICAgIH0pKTsKICAgIH0sCiAgICBpc1ZpZXcoKSB7CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9WSUVXOwogICAgfSwKICAgIGlzS2V5RGlzYWJsZWQoKSB7CiAgICAgIHJldHVybiAhdGhpcy5pc1ZpZXcgJiYgKCF0aGlzLm5hbWUgfHwgdGhpcy5uYW1lID09PSBOT05FIHx8IHRoaXMuZGlzYWJsZWQpOwogICAgfQogIH0sCgp9Owo="},{"version":3,"sources":["SecretSelector.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"SecretSelector.vue","sourceRoot":"node_modules/@rancher/shell/components/form","sourcesContent":["<script>\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { SECRET } from '@shell/config/types';\nimport { _EDIT, _VIEW } from '@shell/config/query-params';\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\nimport sortBy from 'lodash/sortBy';\n\nconst NONE = '__[[NONE]]__';\n\nexport default {\n  components: { LabeledSelect },\n\n  props: {\n    value: {\n      type:     [String, Object],\n      required: false,\n      default:  undefined\n    },\n    namespace: {\n      type:     String,\n      required: true\n    },\n    types: {\n      type:    Array,\n      default: () => Object.values(TYPES)\n    },\n    disabled: {\n      type:    Boolean,\n      default: false\n    },\n    mountKey: {\n      type:    String,\n      default: 'valueFrom'\n    },\n    nameKey: {\n      type:    String,\n      default: 'name'\n    },\n    keyKey: {\n      type:    String,\n      default: 'key'\n    },\n    showKeySelector: {\n      type:    Boolean,\n      default: false\n    },\n    secretNameLabel: {\n      type:    String,\n      default: 'Secret Name'\n    },\n    keyNameLabel: {\n      type:    String,\n      default: 'Key'\n    },\n    mode: {\n      type:    String,\n      default: _EDIT\n    },\n    inStore: {\n      type:    String,\n      default: 'cluster',\n    }\n  },\n\n  computed: {\n    name: {\n      get() {\n        const name = this.showKeySelector ? this.value?.[this.mountKey]?.secretKeyRef?.[this.nameKey] : this.value;\n\n        return name || NONE;\n      },\n      set(name) {\n        const isNone = name === NONE;\n        const correctedName = isNone ? undefined : name;\n\n        if (this.showKeySelector) {\n          this.$emit('input', { [this.mountKey]: { secretKeyRef: { [this.nameKey]: correctedName, [this.keyKey]: '' } } });\n        } else {\n          this.$emit('input', correctedName);\n        }\n      }\n    },\n\n    key: {\n      get() {\n        return this.value?.[this.mountKey]?.secretKeyRef?.[this.keyKey] || '';\n      },\n      set(key) {\n        this.$emit('input', { [this.mountKey]: { secretKeyRef: { [this.nameKey]: this.name, [this.keyKey]: key } } });\n      }\n    },\n    secrets() {\n      const allSecrets = this.$store.getters[`${ this.inStore }/all`](SECRET);\n\n      return allSecrets\n        .filter((secret) => this.types.includes(secret._type) && secret.namespace === this.namespace);\n    },\n    secretNames() {\n      const mappedSecrets = this.secrets.map((secret) => ({\n        label: secret.name,\n        value: secret.name\n      })).sort();\n\n      return [{ label: 'None', value: NONE }, ...sortBy(mappedSecrets, 'label')];\n    },\n    keys() {\n      const secret = this.secrets.find((secret) => secret.name === this.name) || {};\n\n      return Object.keys(secret.data || {}).map((key) => ({\n        label: key,\n        value: key\n      }));\n    },\n    isView() {\n      return this.mode === _VIEW;\n    },\n    isKeyDisabled() {\n      return !this.isView && (!this.name || this.name === NONE || this.disabled);\n    }\n  },\n\n};\n</script>\n\n<template>\n  <div\n    class=\"secret-selector\"\n    :class=\"{'show-key-selector': showKeySelector}\"\n  >\n    <div class=\"input-container\">\n      <LabeledSelect\n        v-model=\"name\"\n        :disabled=\"!isView && disabled\"\n        :options=\"secretNames\"\n        :label=\"secretNameLabel\"\n        :mode=\"mode\"\n      />\n      <LabeledSelect\n        v-if=\"showKeySelector\"\n        v-model=\"key\"\n        class=\"col span-6\"\n        :disabled=\"isKeyDisabled\"\n        :options=\"keys\"\n        :label=\"keyNameLabel\"\n        :mode=\"mode\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.secret-selector {\n  width: 100%;\n  label {\n    display: block;\n  }\n\n  & .labeled-select {\n    min-height: $input-height;\n  }\n\n  & .vs__selected-options {\n    padding: 8px 0 7px 0;\n  }\n\n  & label {\n    display: inline-block;\n  }\n\n  &.show-key-selector {\n    .input-container > * {\n      display: inline-block;\n      width: 50%;\n\n      &.labeled-select.focused {\n        z-index: 10;\n      }\n\n      &:first-child {\n        border-top-right-radius: 0;\n        border-bottom-right-radius: 0;\n        margin-right: 0;\n      }\n\n      &:last-child {\n        border-top-left-radius: 0;\n        border-bottom-left-radius: 0;\n        border-left: none;\n        float: right;\n      }\n    }\n  }\n}\n</style>\n"]}]}