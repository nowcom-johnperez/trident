{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/cloudcredential.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/cloudcredential.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFNFQ1JFVF9UWVBFUyBhcyBUWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2VjcmV0JzsKaW1wb3J0IHsgTUFOQUdFTUVOVCwgTk9STUFOLCBTQ0hFTUEsIERFRkFVTFRfV09SS1NQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgTmFtZU5zRGVzY3JpcHRpb24gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvZm9ybS9OYW1lTnNEZXNjcmlwdGlvbic7CmltcG9ydCBDcnVSZXNvdXJjZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9DcnVSZXNvdXJjZSc7CmltcG9ydCB7IF9DUkVBVEUgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgTGFiZWxzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxzJzsKaW1wb3J0IHsgSElERV9TRU5TSVRJVkUgfSBmcm9tICdAc2hlbGwvc3RvcmUvcHJlZnMnOwppbXBvcnQgeyBDQVBJIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBjbGVhciwgdW5pcSB9IGZyb20gJ0BzaGVsbC91dGlscy9hcnJheSc7CmltcG9ydCBTZWxlY3RJY29uR3JpZCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9TZWxlY3RJY29uR3JpZCc7CmltcG9ydCB7IHNvcnRCeSB9IGZyb20gJ0BzaGVsbC91dGlscy9zb3J0JzsKaW1wb3J0IHsgdWNGaXJzdCB9IGZyb20gJ0BzaGVsbC91dGlscy9zdHJpbmcnOwppbXBvcnQgeyBzZXQgfSBmcm9tICdAc2hlbGwvdXRpbHMvb2JqZWN0JzsKaW1wb3J0IHsgbWFwRmVhdHVyZSwgUktFMiBhcyBSS0UyX0ZFQVRVUkUgfSBmcm9tICdAc2hlbGwvc3RvcmUvZmVhdHVyZXMnOwppbXBvcnQgeyBya2UxU3VwcG9ydHMgfSBmcm9tICdAc2hlbGwvc3RvcmUvcGx1Z2lucyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0NydUNsb3VkQ3JlZGVudGlhbCcsCgogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmcsCiAgICBOYW1lTnNEZXNjcmlwdGlvbiwKICAgIENydVJlc291cmNlLAogICAgTGFiZWxzLAogICAgU2VsZWN0SWNvbkdyaWQKICB9LAoKICBtaXhpbnM6IFtDcmVhdGVFZGl0Vmlld10sCgogIGFzeW5jIGZldGNoKCkgewogICAgdGhpcy5ub2RlRHJpdmVycyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuTk9ERV9EUklWRVIgfSk7CiAgICB0aGlzLmtvbnRhaW5lckRyaXZlcnMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULktPTlRBSU5FUl9EUklWRVIgfSk7CgogICAgLy8gRm9yY2UgcmVsb2FkIHRoZSBjbG91ZCBjcmVkIHNjaGVtYSBhbmQgYW55IG1pc3Npbmcgc3VidHlwZXMgYmVjYXVzZSB0aGVyZSBhcmVuJ3QgY2hhbmdlIGV2ZW50cyBzZW50IHdoZW4gZHJpdmVycyBjb21lL2dvCiAgICB0cnkgewogICAgICBjb25zdCBzY2hlbWEgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9maW5kJywgewogICAgICAgIHR5cGU6IFNDSEVNQSwKICAgICAgICBpZDogICBOT1JNQU4uQ0xPVURfQ1JFREVOVElBTCwKICAgICAgICBvcHQ6ICB7CiAgICAgICAgICBmb3JjZTogdHJ1ZSwKICAgICAgICAgIHVybDogICBgc2NoZW1hcy8keyBOT1JNQU4uQ0xPVURfQ1JFREVOVElBTCB9YCwKICAgICAgICB9LAogICAgICB9KTsKCiAgICAgIGZvciAoIGNvbnN0IGsgaW4gc2NoZW1hLnJlc291cmNlRmllbGRzICkgewogICAgICAgIGlmICggIWsuZW5kc1dpdGgoJ0NvbmZpZycpICkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBpZCA9IHNjaGVtYS5yZXNvdXJjZUZpZWxkc1trXS50eXBlOwoKICAgICAgICBpZiAoICF0aGlzLiRzdG9yZS5nZXR0ZXJzWydyYW5jaGVyL3NjaGVtYUZvciddKGlkKSApIHsKICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdyYW5jaGVyL2ZpbmQnLCB7CiAgICAgICAgICAgIHR5cGU6IFNDSEVNQSwKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIG9wdDogIHsKICAgICAgICAgICAgICBmb3JjZTogdHJ1ZSwKICAgICAgICAgICAgICB1cmw6ICAgYHNjaGVtYXMvJHsgaWQgfWAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGUpIHsKICAgIH0KCiAgICBpZiAoICF0aGlzLnZhbHVlLl9uYW1lICkgewogICAgICBzZXQodGhpcy52YWx1ZSwgJ19uYW1lJywgJycpOwogICAgfQoKICAgIGlmICggdGhpcy52YWx1ZS5wcm92aWRlciApIHsKICAgICAgdGhpcy5zZWxlY3RUeXBlKHRoaXMudmFsdWUucHJvdmlkZXIpOwogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBub2RlRHJpdmVyczogICAgICBudWxsLAogICAgICBrb250YWluZXJEcml2ZXJzOiBudWxsCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBya2UyRW5hYmxlZDogbWFwRmVhdHVyZShSS0UyX0ZFQVRVUkUpLAoKICAgIHN0b3JlT3ZlcnJpZGUoKSB7CiAgICAgIHJldHVybiAncmFuY2hlcic7CiAgICB9LAoKICAgIGRyaXZlck5hbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLnZhbHVlPy5wcm92aWRlcjsKICAgIH0sCgogICAgY2xvdWRDb21wb25lbnQoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9oYXNDdXN0b21DbG91ZENyZWRlbnRpYWxDb21wb25lbnQnXSh0aGlzLmRyaXZlck5hbWUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3R5cGUtbWFwL2ltcG9ydENsb3VkQ3JlZGVudGlhbCddKHRoaXMuZHJpdmVyTmFtZSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWyd0eXBlLW1hcC9pbXBvcnRDbG91ZENyZWRlbnRpYWwnXSgnZ2VuZXJpYycpOwogICAgfSwKCiAgICAvLyBhcnJheSBvZiBpZCwgbGFiZWwsIGRlc2NyaXB0aW9uLCBpbml0aWFscyBmb3IgdHlwZSBzZWxlY3Rpb24gc3RlcAogICAgc2VjcmV0U3ViVHlwZXMoKSB7CiAgICAgIGNvbnN0IG91dCA9IFtdOwoKICAgICAgY29uc3QgZHJpdmVycyA9IFsuLi50aGlzLm5vZGVEcml2ZXJzLCAuLi50aGlzLmtvbnRhaW5lckRyaXZlcnNdCiAgICAgICAgLmZpbHRlcigoeCkgPT4geC5zcGVjLmFjdGl2ZSAmJiB4LmlkICE9PSAncmFuY2hlcmt1YmVybmV0ZXNlbmdpbmUnKQogICAgICAgIC5tYXAoKHgpID0+IHguc3BlYy5kaXNwbGF5TmFtZSB8fCB4LmlkKTsKCiAgICAgIGxldCB0eXBlcyA9IHVuaXEoZHJpdmVycy5tYXAoKHgpID0+IHRoaXMuJHN0b3JlLmdldHRlcnNbJ3BsdWdpbnMvY3JlZGVudGlhbERyaXZlckZvciddKHgpKSk7CgogICAgICBpZiAoICF0aGlzLnJrZTJFbmFibGVkICkgewogICAgICAgIHR5cGVzID0gdHlwZXMuZmlsdGVyKCh4KSA9PiBya2UxU3VwcG9ydHMuaW5jbHVkZXMoeCkpOwogICAgICB9CgogICAgICBjb25zdCBzY2hlbWEgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydyYW5jaGVyL3NjaGVtYUZvciddKE5PUk1BTi5DTE9VRF9DUkVERU5USUFMKTsKCiAgICAgIHR5cGVzID0gdHlwZXMuZmlsdGVyKChuYW1lKSA9PiB7CiAgICAgICAgY29uc3Qga2V5ID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1sncGx1Z2lucy9jcmVkZW50aWFsRmllbGRGb3JEcml2ZXInXShuYW1lKTsKICAgICAgICBjb25zdCBzdWJTY2hlbWFOYW1lID0gc2NoZW1hLnJlc291cmNlRmllbGRzW2AkeyBrZXkgfWNyZWRlbnRpYWxDb25maWdgXT8udHlwZTsKCiAgICAgICAgaWYgKCAhc3ViU2NoZW1hTmFtZSApIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHN1YlNjaGVtYSA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ3JhbmNoZXIvc2NoZW1hRm9yJ10oc3ViU2NoZW1hTmFtZSk7CgogICAgICAgIGlmICggIXN1YlNjaGVtYSApIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IGZpZWxkcyA9IHN1YlNjaGVtYS5yZXNvdXJjZUZpZWxkczsKCiAgICAgICAgcmV0dXJuIGZpZWxkcyAmJiBPYmplY3Qua2V5cyhmaWVsZHMpLmxlbmd0aCA+IDA7CiAgICAgIH0pOwoKICAgICAgaWYgKCBzY2hlbWEucmVzb3VyY2VGaWVsZHNbJ3MzY3JlZGVudGlhbENvbmZpZyddICkgewogICAgICAgIHR5cGVzLnB1c2goJ3MzJyk7CiAgICAgIH0KCiAgICAgIGZvciAoIGNvbnN0IGlkIG9mIHR5cGVzICkgewogICAgICAgIGxldCBiYW5uZXJJbWFnZSwgYmFubmVyQWJicnY7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBiYW5uZXJJbWFnZSA9IHJlcXVpcmUoYH5zaGVsbC9hc3NldHMvaW1hZ2VzL3Byb3ZpZGVycy8keyBpZCB9LnN2Z2ApOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGJhbm5lckltYWdlID0gbnVsbDsKICAgICAgICAgIGJhbm5lckFiYnJ2ID0gdGhpcy5pbml0aWFsRGlzcGxheUZvcihpZCk7CiAgICAgICAgfQoKICAgICAgICBvdXQucHVzaCh7CiAgICAgICAgICBpZCwKICAgICAgICAgIGxhYmVsOiB0aGlzLnR5cGVEaXNwbGF5KENBUEkuQ1JFREVOVElBTF9EUklWRVIsIGlkKSwKICAgICAgICAgIGJhbm5lckltYWdlLAogICAgICAgICAgYmFubmVyQWJicnYKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNvcnRCeShvdXQsICdsYWJlbCcpOwogICAgfSwKCiAgICBoaWRlU2Vuc2l0aXZlRGF0YSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3ByZWZzL2dldCddKEhJREVfU0VOU0lUSVZFKTsKICAgIH0sCgogICAgZG9uZVJvdXRlKCkgewogICAgICByZXR1cm4gJ2MtY2x1c3Rlci1tYW5hZ2VyLWNsb3VkQ3JlZGVudGlhbCc7CiAgICB9LAogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNhdmVDcmVkZW50aWFsKGJ0bkNiKSB7CiAgICAgIGlmICggdGhpcy5lcnJvcnMgKSB7CiAgICAgICAgY2xlYXIodGhpcy5lcnJvcnMpOwogICAgICB9CgogICAgICBpZiAoIHR5cGVvZiB0aGlzLiRyZWZzLmNsb3VkQ29tcG9uZW50Py50ZXN0ID09PSAnZnVuY3Rpb24nICkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCB0aGlzLiRyZWZzLmNsb3VkQ29tcG9uZW50LnRlc3QoKTsKCiAgICAgICAgICBpZiAoICFyZXMgfHwgcmVzPy5lcnJvcnMpIHsKICAgICAgICAgICAgaWYgKHJlcz8uZXJyb3JzKSB7CiAgICAgICAgICAgICAgdGhpcy5lcnJvcnMgPSByZXMuZXJyb3JzOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gWydBdXRoZW50aWNhdGlvbiB0ZXN0IGZhaWxlZCwgcGxlYXNlIGNoZWNrIHlvdXIgY3JlZGVudGlhbHMnXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBidG5DYihmYWxzZSk7CgogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgdGhpcy5lcnJvcnMgPSBbZV07CiAgICAgICAgICBidG5DYihmYWxzZSk7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuc2F2ZShidG5DYik7CiAgICB9LAoKICAgIHNlbGVjdFR5cGUodHlwZSkgewogICAgICBsZXQgZHJpdmVyOwoKICAgICAgaWYgKCB0eXBlID09PSBUWVBFUy5DTE9VRF9DUkVERU5USUFMICkgewogICAgICAgIC8vIENsb25lIGdvZXMgdGhyb3VnaCBoZXJlCiAgICAgICAgZHJpdmVyID0gdGhpcy5kcml2ZXJOYW1lOwogICAgICB9IGVsc2UgewogICAgICAgIGRyaXZlciA9IHR5cGU7CiAgICAgICAgdHlwZSA9IFRZUEVTLkNMT1VEX0NSRURFTlRJQUw7CiAgICAgIH0KCiAgICAgIGlmICggdGhpcy5tb2RlID09PSBfQ1JFQVRFICkgewogICAgICAgIHRoaXMudmFsdWUuc2V0QW5ub3RhdGlvbihDQVBJLkNSRURFTlRJQUxfRFJJVkVSLCBkcml2ZXIpOwogICAgICAgIHRoaXMudmFsdWUubWV0YWRhdGEuZ2VuZXJhdGVOYW1lID0gJ2NjLSc7CiAgICAgICAgdGhpcy52YWx1ZS5tZXRhZGF0YS5uYW1lc3BhY2UgPSBERUZBVUxUX1dPUktTUEFDRTsKCiAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwbHVnaW5zL2NyZWRlbnRpYWxGaWVsZEZvckRyaXZlciddKGRyaXZlcik7CgogICAgICAgIHNldCh0aGlzLnZhbHVlLCBgJHsgZmllbGQgfWNyZWRlbnRpYWxDb25maWdgLCB7fSk7CiAgICAgIH0KCiAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLCAnX3R5cGUnLCB0eXBlKTsKICAgICAgdGhpcy4kZW1pdCgnc2V0LXN1YnR5cGUnLCB0aGlzLnR5cGVEaXNwbGF5KHR5cGUsIGRyaXZlcikpOwogICAgfSwKCiAgICB0eXBlRGlzcGxheSh0eXBlLCBkcml2ZXIpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ2kxOG4vd2l0aEZhbGxiYWNrJ10oYGNsdXN0ZXIucHJvdmlkZXIuIiR7IGRyaXZlciB9ImAsIG51bGwsIGRyaXZlcik7CiAgICB9LAoKICAgIGluaXRpYWxEaXNwbGF5Rm9yKHR5cGUpIHsKICAgICAgY29uc3QgZmFsbGJhY2sgPSAodWNGaXJzdCh0aGlzLnR5cGVEaXNwbGF5KHR5cGUpIHx8ICcnKS5yZXBsYWNlKC9bXkEtWl0vZywgJycpIHx8IHR5cGUpLnN1YnN0cigwLCAzKTsKCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydpMThuL3dpdGhGYWxsYmFjayddKGBzZWNyZXQuaW5pdGlhbHMuIiR7IHR5cGUgfSJgLCBudWxsLCBmYWxsYmFjayk7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["cloudcredential.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"cloudcredential.vue","sourceRoot":"node_modules/@rancher/shell/edit","sourcesContent":["<script>\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\nimport { MANAGEMENT, NORMAN, SCHEMA, DEFAULT_WORKSPACE } from '@shell/config/types';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport NameNsDescription from '@shell/components/form/NameNsDescription';\nimport CruResource from '@shell/components/CruResource';\nimport { _CREATE } from '@shell/config/query-params';\nimport Loading from '@shell/components/Loading';\nimport Labels from '@shell/components/form/Labels';\nimport { HIDE_SENSITIVE } from '@shell/store/prefs';\nimport { CAPI } from '@shell/config/labels-annotations';\nimport { clear, uniq } from '@shell/utils/array';\nimport SelectIconGrid from '@shell/components/SelectIconGrid';\nimport { sortBy } from '@shell/utils/sort';\nimport { ucFirst } from '@shell/utils/string';\nimport { set } from '@shell/utils/object';\nimport { mapFeature, RKE2 as RKE2_FEATURE } from '@shell/store/features';\nimport { rke1Supports } from '@shell/store/plugins';\n\nexport default {\n  name: 'CruCloudCredential',\n\n  components: {\n    Loading,\n    NameNsDescription,\n    CruResource,\n    Labels,\n    SelectIconGrid\n  },\n\n  mixins: [CreateEditView],\n\n  async fetch() {\n    this.nodeDrivers = await this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_DRIVER });\n    this.kontainerDrivers = await this.$store.dispatch('management/findAll', { type: MANAGEMENT.KONTAINER_DRIVER });\n\n    // Force reload the cloud cred schema and any missing subtypes because there aren't change events sent when drivers come/go\n    try {\n      const schema = await this.$store.dispatch('rancher/find', {\n        type: SCHEMA,\n        id:   NORMAN.CLOUD_CREDENTIAL,\n        opt:  {\n          force: true,\n          url:   `schemas/${ NORMAN.CLOUD_CREDENTIAL }`,\n        },\n      });\n\n      for ( const k in schema.resourceFields ) {\n        if ( !k.endsWith('Config') ) {\n          continue;\n        }\n\n        const id = schema.resourceFields[k].type;\n\n        if ( !this.$store.getters['rancher/schemaFor'](id) ) {\n          await this.$store.dispatch('rancher/find', {\n            type: SCHEMA,\n            id,\n            opt:  {\n              force: true,\n              url:   `schemas/${ id }`,\n            },\n          });\n        }\n      }\n    } catch (e) {\n    }\n\n    if ( !this.value._name ) {\n      set(this.value, '_name', '');\n    }\n\n    if ( this.value.provider ) {\n      this.selectType(this.value.provider);\n    }\n  },\n\n  data() {\n    return {\n      nodeDrivers:      null,\n      kontainerDrivers: null\n    };\n  },\n\n  computed: {\n    rke2Enabled: mapFeature(RKE2_FEATURE),\n\n    storeOverride() {\n      return 'rancher';\n    },\n\n    driverName() {\n      return this.value?.provider;\n    },\n\n    cloudComponent() {\n      if (this.$store.getters['type-map/hasCustomCloudCredentialComponent'](this.driverName)) {\n        return this.$store.getters['type-map/importCloudCredential'](this.driverName);\n      }\n\n      return this.$store.getters['type-map/importCloudCredential']('generic');\n    },\n\n    // array of id, label, description, initials for type selection step\n    secretSubTypes() {\n      const out = [];\n\n      const drivers = [...this.nodeDrivers, ...this.kontainerDrivers]\n        .filter((x) => x.spec.active && x.id !== 'rancherkubernetesengine')\n        .map((x) => x.spec.displayName || x.id);\n\n      let types = uniq(drivers.map((x) => this.$store.getters['plugins/credentialDriverFor'](x)));\n\n      if ( !this.rke2Enabled ) {\n        types = types.filter((x) => rke1Supports.includes(x));\n      }\n\n      const schema = this.$store.getters['rancher/schemaFor'](NORMAN.CLOUD_CREDENTIAL);\n\n      types = types.filter((name) => {\n        const key = this.$store.getters['plugins/credentialFieldForDriver'](name);\n        const subSchemaName = schema.resourceFields[`${ key }credentialConfig`]?.type;\n\n        if ( !subSchemaName ) {\n          return;\n        }\n\n        const subSchema = this.$store.getters['rancher/schemaFor'](subSchemaName);\n\n        if ( !subSchema ) {\n          return false;\n        }\n\n        const fields = subSchema.resourceFields;\n\n        return fields && Object.keys(fields).length > 0;\n      });\n\n      if ( schema.resourceFields['s3credentialConfig'] ) {\n        types.push('s3');\n      }\n\n      for ( const id of types ) {\n        let bannerImage, bannerAbbrv;\n\n        try {\n          bannerImage = require(`~shell/assets/images/providers/${ id }.svg`);\n        } catch (e) {\n          bannerImage = null;\n          bannerAbbrv = this.initialDisplayFor(id);\n        }\n\n        out.push({\n          id,\n          label: this.typeDisplay(CAPI.CREDENTIAL_DRIVER, id),\n          bannerImage,\n          bannerAbbrv\n        });\n      }\n\n      return sortBy(out, 'label');\n    },\n\n    hideSensitiveData() {\n      return this.$store.getters['prefs/get'](HIDE_SENSITIVE);\n    },\n\n    doneRoute() {\n      return 'c-cluster-manager-cloudCredential';\n    },\n  },\n\n  methods: {\n    async saveCredential(btnCb) {\n      if ( this.errors ) {\n        clear(this.errors);\n      }\n\n      if ( typeof this.$refs.cloudComponent?.test === 'function' ) {\n        try {\n          const res = await this.$refs.cloudComponent.test();\n\n          if ( !res || res?.errors) {\n            if (res?.errors) {\n              this.errors = res.errors;\n            } else {\n              this.errors = ['Authentication test failed, please check your credentials'];\n            }\n            btnCb(false);\n\n            return;\n          }\n        } catch (e) {\n          this.errors = [e];\n          btnCb(false);\n\n          return;\n        }\n      }\n\n      return this.save(btnCb);\n    },\n\n    selectType(type) {\n      let driver;\n\n      if ( type === TYPES.CLOUD_CREDENTIAL ) {\n        // Clone goes through here\n        driver = this.driverName;\n      } else {\n        driver = type;\n        type = TYPES.CLOUD_CREDENTIAL;\n      }\n\n      if ( this.mode === _CREATE ) {\n        this.value.setAnnotation(CAPI.CREDENTIAL_DRIVER, driver);\n        this.value.metadata.generateName = 'cc-';\n        this.value.metadata.namespace = DEFAULT_WORKSPACE;\n\n        const field = this.$store.getters['plugins/credentialFieldForDriver'](driver);\n\n        set(this.value, `${ field }credentialConfig`, {});\n      }\n\n      this.$set(this.value, '_type', type);\n      this.$emit('set-subtype', this.typeDisplay(type, driver));\n    },\n\n    typeDisplay(type, driver) {\n      return this.$store.getters['i18n/withFallback'](`cluster.provider.\"${ driver }\"`, null, driver);\n    },\n\n    initialDisplayFor(type) {\n      const fallback = (ucFirst(this.typeDisplay(type) || '').replace(/[^A-Z]/g, '') || type).substr(0, 3);\n\n      return this.$store.getters['i18n/withFallback'](`secret.initials.\"${ type }\"`, null, fallback);\n    },\n  },\n};\n</script>\n\n<template>\n  <form class=\"filled-height\">\n    <Loading v-if=\"$fetchState.pending\" />\n    <CruResource\n      v-else\n      :mode=\"mode\"\n      :validation-passed=\"true\"\n      :selected-subtype=\"value._type\"\n      :resource=\"value\"\n      :errors=\"errors\"\n      :done-route=\"doneRoute\"\n      :subtypes=\"secretSubTypes\"\n      :can-yaml=\"false\"\n      @finish=\"saveCredential\"\n      @select-type=\"selectType\"\n      @error=\"e=>errors = e\"\n    >\n      <NameNsDescription\n        v-model=\"value\"\n        name-key=\"_name\"\n        description-key=\"description\"\n        :mode=\"mode\"\n        :namespaced=\"false\"\n      />\n      <keep-alive>\n        <component\n          :is=\"cloudComponent\"\n          ref=\"cloudComponent\"\n          :driver-name=\"driverName\"\n          :value=\"value\"\n          :mode=\"mode\"\n          :hide-sensitive-data=\"hideSensitiveData\"\n        />\n      </keep-alive>\n    </CruResource>\n  </form>\n</template>\n\n<style lang='scss'>\n</style>\n"]}]}