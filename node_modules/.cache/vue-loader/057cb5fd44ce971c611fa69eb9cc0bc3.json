{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgTG9hZGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Mb2FkaW5nJzsKaW1wb3J0IENydVJlc291cmNlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NydVJlc291cmNlJzsKaW1wb3J0IFNlbGVjdEljb25HcmlkIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1NlbGVjdEljb25HcmlkJzsKaW1wb3J0IEVtYmVyUGFnZSBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9FbWJlclBhZ2UnOwppbXBvcnQgeyBUb2dnbGVTd2l0Y2ggfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL1RvZ2dsZVN3aXRjaCc7CmltcG9ydCB7CiAgQ0hBUlQsIEZST01fQ0xVU1RFUiwgU1VCX1RZUEUsIF9FRElULCBfSU1QT1JULCBfQ09ORklHLCBfVklFVwp9IGZyb20gJ0BzaGVsbC9jb25maWcvcXVlcnktcGFyYW1zJzsKaW1wb3J0IHsgbWFwR2V0dGVycyB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyBzb3J0QnkgfSBmcm9tICdAc2hlbGwvdXRpbHMvc29ydCc7CmltcG9ydCB7IHNldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwppbXBvcnQgeyBtYXBQcmVmLCBQUk9WSVNJT05FUiwgX1JLRTEsIF9SS0UyIH0gZnJvbSAnQHNoZWxsL3N0b3JlL3ByZWZzJzsKaW1wb3J0IHsgZmlsdGVyQW5kQXJyYW5nZUNoYXJ0cyB9IGZyb20gJ0BzaGVsbC9zdG9yZS9jYXRhbG9nJzsKaW1wb3J0IHsgQ0FUQUxPRyB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsKaW1wb3J0IHsgQ0FQSSwgTUFOQUdFTUVOVCwgREVGQVVMVF9XT1JLU1BBQ0UgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgbWFwRmVhdHVyZSwgUktFMiBhcyBSS0UyX0ZFQVRVUkUgfSBmcm9tICdAc2hlbGwvc3RvcmUvZmVhdHVyZXMnOwppbXBvcnQgeyBhbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOwppbXBvcnQgeyBCTEFOS19DTFVTVEVSIH0gZnJvbSAnQHNoZWxsL3N0b3JlL3N0b3JlLXR5cGVzLmpzJzsKaW1wb3J0IHsgRUxFTUVOVEFMX1BST0RVQ1RfTkFNRSwgRUxFTUVOVEFMX0NMVVNURVJfUFJPVklERVIgfSBmcm9tICcuLi8uLi9jb25maWcvZWxlbWVudGFsLXR5cGVzJzsKaW1wb3J0IFJrZTJDb25maWcgZnJvbSAnLi9ya2UyJzsKaW1wb3J0IEltcG9ydCBmcm9tICcuL2ltcG9ydCc7Cgpjb25zdCBTT1JUX0dST1VQUyA9IHsKICB0ZW1wbGF0ZTogIDEsCiAga29udGFpbmVyOiAyLAogIHJrZTE6ICAgICAgMywKICBya2UyOiAgICAgIDMsCiAgcmVnaXN0ZXI6ICA0LAogIGN1c3RvbTogICAgNSwKICBjdXN0b20xOiAgIDUsCiAgY3VzdG9tMjogICA1LAp9OwoKLy8gdVNlZCB0byBwcm94eSBzdHlsZXNoZWV0cyBmb3IgY3VzdG9tIGRyaXZlcnMgdGhhdCBwcm92aWRlIGN1c3RvbSBVSSAoUktFMSkKY29uc3QgUFJPWFlfRU5EUE9JTlQgPSAnL21ldGEvcHJveHknOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDcnVDbHVzdGVyJywKCiAgY29tcG9uZW50czogewogICAgQ3J1UmVzb3VyY2UsCiAgICBFbWJlclBhZ2UsCiAgICBJbXBvcnQsCiAgICBMb2FkaW5nLAogICAgUmtlMkNvbmZpZywKICAgIFNlbGVjdEljb25HcmlkLAogICAgVG9nZ2xlU3dpdGNoCiAgfSwKCiAgbWl4aW5zOiBbQ3JlYXRlRWRpdFZpZXddLAoKICBwcm9wczogewogICAgcmVhbE1vZGU6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIG1vZGU6IHsKICAgICAgdHlwZTogICAgIFN0cmluZywKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogbnVsbCwKICAgIH0sCgogICAgLyoqCiAgICAgKiBJbmhlcml0ZWQgZ2xvYmFsIGlkZW50aWZpZXIgcHJlZml4IGZvciB0ZXN0cwogICAgICogRGVmaW5lIGEgdGVybSBiYXNlZCBvbiB0aGUgcGFyZW50IGNvbXBvbmVudCB0byBhdm9pZCBjb25mbGljdHMgb24gbXVsdGlwbGUgY29tcG9uZW50cwogICAgICovCiAgICBjb21wb25lbnRUZXN0aWQ6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAnY2x1c3Rlci1tYW5hZ2VyLWNyZWF0ZScKICAgIH0KICB9LAoKICBhc3luYyBmZXRjaCgpIHsKICAgIGNvbnN0IGhhc2ggPSB7CiAgICAgIC8vIFRoZXNlIGFyZW4ndCBleHBsaWNpdGx5IHVzZWQsIGJ1dCBuZWVkIHRvIGJlIGxpc3RlbmluZyBmb3IgY2hhbmdlIGV2ZW50cwogICAgICBtZ210Q2x1c3RlcnM6IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuQ0xVU1RFUiB9KSwKICAgICAgcHJvdkNsdXN0ZXJzOiB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBDQVBJLlJBTkNIRVJfQ0xVU1RFUiB9KSwKCiAgICAgIGNhdGFsb2c6IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdjYXRhbG9nL2xvYWQnKSwKICAgIH07CgogICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnNbYG1hbmFnZW1lbnQvY2FuTGlzdGBdKE1BTkFHRU1FTlQuTk9ERV9EUklWRVIpKSB7CiAgICAgIGhhc2gubm9kZURyaXZlcnMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULk5PREVfRFJJVkVSIH0pOwogICAgfQoKICAgIGlmICh0aGlzLiRzdG9yZS5nZXR0ZXJzW2BtYW5hZ2VtZW50L2Nhbkxpc3RgXShNQU5BR0VNRU5ULktPTlRBSU5FUl9EUklWRVIpKSB7CiAgICAgIGhhc2gua29udGFpbmVyRHJpdmVycyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuS09OVEFJTkVSX0RSSVZFUiB9KTsKICAgIH0KCiAgICBpZiAoIHRoaXMudmFsdWUuaWQgJiYgIXRoaXMudmFsdWUuaXNSa2UyICkgewogICAgICAvLyBUaGVzZSBhcmUgbmVlZGVkIHRvIHJlc29sdmUgcmVmZXJlbmNlcyBpbiB0aGUgbWdtdCBjbHVzdGVyIC0+IG5vZGUgcG9vbCAtPiBub2RlIHRlbXBsYXRlIHRvIGZpZ3VyZSBvdXQgd2hhdCBwcm92aWRlciB0aGUgY2x1c3RlciBpcyB1c2luZwogICAgICAvLyBzbyB0aGF0IHRoZSBlZGl0IGlmcmFtZSBmb3IgZW1iZXIgcGFnZXMgY2FuIGdvIHRvIHRoZSByaWdodCBwbGFjZS4KICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnNbYG1hbmFnZW1lbnQvY2FuTGlzdGBdKE1BTkFHRU1FTlQuTk9ERV9QT09MKSkgewogICAgICAgIGhhc2gucmtlMU5vZGVQb29scyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuTk9ERV9QT09MIH0pOwogICAgICB9CgogICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVyc1tgbWFuYWdlbWVudC9jYW5MaXN0YF0oTUFOQUdFTUVOVC5OT0RFX1RFTVBMQVRFKSkgewogICAgICAgIGhhc2gucmtlMU5vZGVUZW1wbGF0ZXMgPSB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULk5PREVfVEVNUExBVEUgfSk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCByZXMgPSBhd2FpdCBhbGxIYXNoKGhhc2gpOwoKICAgIHRoaXMubm9kZURyaXZlcnMgPSByZXMubm9kZURyaXZlcnMgfHwgW107CiAgICB0aGlzLmtvbnRhaW5lckRyaXZlcnMgPSByZXMua29udGFpbmVyRHJpdmVycyB8fCBbXTsKCiAgICBpZiAoICF0aGlzLnZhbHVlLnNwZWMgKSB7CiAgICAgIHNldCh0aGlzLnZhbHVlLCAnc3BlYycsIHt9KTsKICAgIH0KCiAgICBpZiAoICF0aGlzLnZhbHVlLmlkICkgewogICAgICBpZiAoICF0aGlzLnZhbHVlLm1ldGFkYXRhICkgewogICAgICAgIHNldCh0aGlzLnZhbHVlLCAnbWV0YWRhdGEnLCB7fSk7CiAgICAgIH0KCiAgICAgIHNldCh0aGlzLnZhbHVlLm1ldGFkYXRhLCAnbmFtZXNwYWNlJywgREVGQVVMVF9XT1JLU1BBQ0UpOwogICAgfQoKICAgIC8vIEZvciB0aGUgbm9kZSBkcml2ZXJzLCBsb29rIGZvciBjdXN0b20gVUkgdGhhdCB3ZSBjYW4gdXNlIHRvIHNob3cgYW4gaWNvbiAoaWYgbm90IGJ1aWx0LWluKQogICAgdGhpcy5ub2RlRHJpdmVycy5mb3JFYWNoKChkcml2ZXIpID0+IHsKICAgICAgaWYgKCFkcml2ZXIuc3BlYz8uYnVpbHRpbiAmJiBkcml2ZXIuc3BlYz8udWlVcmwgJiYgZHJpdmVyLnNwZWM/LmFjdGl2ZSkgewogICAgICAgIGNvbnN0IG5hbWUgPSBkcml2ZXIuc3BlYz8uZGlzcGxheU5hbWUgfHwgZHJpdmVyLmlkOwogICAgICAgIGxldCBjc3NVcmwgPSBkcml2ZXIuc3BlYy51aVVybC5yZXBsYWNlKC9cLmpzJC8sICcuY3NzJyk7CgogICAgICAgIGlmIChjc3NVcmwuc3RhcnRzV2l0aCgnaHR0cDovLycpIHx8IGNzc1VybC5zdGFydHNXaXRoKCdodHRwczovLycpKSB7CiAgICAgICAgICBjc3NVcmwgPSBgJHsgUFJPWFlfRU5EUE9JTlQgfS8keyBjc3NVcmwgfWA7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmxvYWRTdHlsZXNoZWV0KGNzc1VybCwgYGRyaXZlci11aS1jc3MtJHsgZHJpdmVyLmlkIH1gKTsKCiAgICAgICAgdGhpcy5pY29uQ2xhc3Nlc1tuYW1lXSA9IGBtYWNoaW5lLWRyaXZlciAkeyBuYW1lIH1gOwogICAgICB9CiAgICB9KTsKCiAgICAvLyBDdXN0b20gUHJvdmlkZXJzIGZyb20gZXh0ZW5zaW9ucyAtIGluaXRpYWxpemUgZWFjaCB3aXRoIHRoZSBzdG9yZSBhbmQgdGhlIGkxOG4gc2VydmljZQogICAgLy8gV3JhcCBpbiB0cnkgLi4uIGNhdGNoLCB0byBwcmV2ZW50IGVycm9ycyBpbiBhbiBleHRlbnNpb24gYnJlYWtpbmcgdGhlIHBhZ2UKICAgIHRyeSB7CiAgICAgIGNvbnN0IGV4dGVuc2lvbkNsYXNzZXMgPSB0aGlzLiRwbHVnaW4ubGlzdER5bmFtaWMoJ3Byb3Zpc2lvbmVyJykubWFwKChuYW1lKSA9PiB0aGlzLiRwbHVnaW4uZ2V0RHluYW1pYygncHJvdmlzaW9uZXInLCBuYW1lKSk7CgogICAgICAvLyBXZSBjYW4ndCBwYXNzIGluIHRoaXMuJHN0b3JlIGFzIHRoaXMgbGVhZHMgdG8gYSBjaXJjdWxhci1yZWZlcmVuY2UgdGhhdCBjYXVzZXMgVnVlIHRvIGZyZWV6ZSwKICAgICAgLy8gc28gcGFzcyBpbiBzcGVjaWZpYyBzZXJ2aWNlcyB0aGF0IHRoZSBwcm92aXNpb25lciBleHRlbnNpb24gbWF5IG5lZWQKICAgICAgdGhpcy5leHRlbnNpb25zID0gZXh0ZW5zaW9uQ2xhc3Nlcy5tYXAoKGMpID0+IG5ldyBjKHsKICAgICAgICBkaXNwYXRjaDogdGhpcy4kc3RvcmUuZGlzcGF0Y2gsCiAgICAgICAgZ2V0dGVyczogIHRoaXMuJHN0b3JlLmdldHRlcnMsCiAgICAgICAgYXhpb3M6ICAgIHRoaXMuJHN0b3JlLiRheGlvcywKICAgICAgICAkcGx1Z2luOiAgdGhpcy4kc3RvcmUuYXBwLiRwbHVnaW4sCiAgICAgICAgdDogICAgICAgICguLi5hcmdzKSA9PiB0aGlzLnQuYXBwbHkodGhpcywgYXJncyksCiAgICAgICAgaXNDcmVhdGU6IHRoaXMuaXNDcmVhdGUsCiAgICAgICAgaXNFZGl0OiAgIHRoaXMuaXNFZGl0LAogICAgICAgIGlzVmlldzogICB0aGlzLmlzVmlldywKICAgICAgfSkpOwogICAgfSBjYXRjaCAoZSkgewogICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIHByb3Zpc2lvbmVyKHMpIGZyb20gZXh0ZW5zaW9ucycsIGUpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGUKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgY29uc3Qgc3ViVHlwZSA9IHRoaXMuJHJvdXRlLnF1ZXJ5W1NVQl9UWVBFXSB8fCBudWxsOwogICAgY29uc3QgY2hhcnQgPSB0aGlzLiRyb3V0ZS5xdWVyeVtDSEFSVF0gfHwgbnVsbDsKICAgIGNvbnN0IGlzSW1wb3J0ID0gdGhpcy5yZWFsTW9kZSA9PT0gX0lNUE9SVDsKCiAgICByZXR1cm4gewogICAgICBub2RlRHJpdmVyczogICAgICBbXSwKICAgICAga29udGFpbmVyRHJpdmVyczogW10sCiAgICAgIGV4dGVuc2lvbnM6ICAgICAgIFtdLAogICAgICBzdWJUeXBlLAogICAgICBjaGFydCwKICAgICAgaXNJbXBvcnQsCiAgICAgIHByb3ZpZGVyQ2x1c3RlcjogIG51bGwsCiAgICAgIGljb25DbGFzc2VzOiAgICAgIHt9LAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyh7IGFsbENoYXJ0czogJ2NhdGFsb2cvY2hhcnRzJyB9KSwKICAgIC4uLm1hcEdldHRlcnMoJ3R5cGUtbWFwJywgWydhY3RpdmVQcm9kdWN0cyddKSwKICAgIHByZWZlcnJlZFByb3Zpc2lvbmVyOiBtYXBQcmVmKFBST1ZJU0lPTkVSKSwKICAgIF9SS0UxOiAgICAgICAgICAgICAgICAoKSA9PiBfUktFMSwKICAgIF9SS0UyOiAgICAgICAgICAgICAgICAoKSA9PiBfUktFMiwKCiAgICBlbWJlckxpbmsoKSB7CiAgICAgIGlmICh0aGlzLnZhbHVlKSB7CiAgICAgICAgLy8gRm9yIGN1c3RvbSBSS0UyIGNsdXN0ZXJzLCBkb24ndCBsb2FkIGFuIEVtYmVyIHBhZ2UuCiAgICAgICAgLy8gSXQgc2hvdWxkIGJlIHRoZSBkYXNoYm9hcmQuCiAgICAgICAgaWYgKCB0aGlzLnZhbHVlLmlzUmtlMiAmJiAoKHRoaXMudmFsdWUuaXNDdXN0b20gJiYgdGhpcy5tb2RlID09PSBfRURJVCkgfHwgKHRoaXMudmFsdWUuaXNDdXN0b20gJiYgdGhpcy5hcyA9PT0gX0NPTkZJRyAmJiB0aGlzLm1vZGUgPT09IF9WSUVXKSB8fCAodGhpcy5zdWJUeXBlIHx8ICcnKS50b0xvd2VyQ2FzZSgpID09PSAnY3VzdG9tJykpIHsKICAgICAgICAgIC8vIEZvciBhZG1pbnMsIHRoaXMudmFsdWUuaXNDdXN0b20gaXMgdXNlZCB0byBjaGVjayBpZiBpdCBpcyBhIGN1c3RvbSBjbHVzdGVyLgogICAgICAgICAgLy8gRm9yIGNsdXN0ZXIgb3duZXJzLCB0aGlzLnN1YnR5cGUgaXMgdXNlZC4KICAgICAgICAgIHRoaXMuc2VsZWN0VHlwZSgnY3VzdG9tJywgZmFsc2UpOwoKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9CiAgICAgICAgLy8gRm9yIFJLRTIvSzNzIGNsdXN0ZXJzIHByb3Zpc2lvbmVkIGluIFJhbmNoZXIgd2l0aCBub2RlIHBvb2xzLAogICAgICAgIC8vIGRvIG5vdCB1c2UgYW4gaUZyYW1lZCBFbWJlciBwYWdlLgogICAgICAgIGlmICggdGhpcy52YWx1ZS5pc1JrZTIgJiYgdGhpcy52YWx1ZS5tYWNoaW5lUHJvdmlkZXIgKSB7CiAgICAgICAgICAvLyBFZGl0IGV4aXN0aW5nIFJLRTIKICAgICAgICAgIHRoaXMuc2VsZWN0VHlwZSh0aGlzLnZhbHVlLm1hY2hpbmVQcm92aWRlciwgZmFsc2UpOwoKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9CiAgICAgICAgaWYgKCB0aGlzLnN1YlR5cGUgKSB7CiAgICAgICAgICAvLyBGb3IgUktFMSBhbmQgaG9zdGVkIEt1YmVybmV0ZXMgQ2x1c3RlcnMsIHNldCB0aGUgZW1iZXIgbGluawogICAgICAgICAgLy8gc28gdGhhdCB3ZSBsb2FkIHRoZSBwYWdlIHJhdGhlciB0aGFuIHVzaW5nIFJLRTIgY3JlYXRlCiAgICAgICAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMuc3ViVHlwZXMuZmluZCgocykgPT4gcy5pZCA9PT0gdGhpcy5zdWJUeXBlKTsKCiAgICAgICAgICBpZiAoc2VsZWN0ZWQ/LmxpbmspIHsKICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkLmxpbms7CiAgICAgICAgICB9CgogICAgICAgICAgdGhpcy5zZWxlY3RUeXBlKHRoaXMuc3ViVHlwZSwgZmFsc2UpOwoKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9CgogICAgICAgIGlmICggdGhpcy52YWx1ZS5tZ210Py5lbWJlckVkaXRQYXRoICkgewogICAgICAgICAgLy8gSWZyYW1lIGFuIG9sZCBwYWdlCiAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5tZ210LmVtYmVyRWRpdFBhdGg7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gJyc7CiAgICB9LAoKICAgIHJrZTJFbmFibGVkOiBtYXBGZWF0dXJlKFJLRTJfRkVBVFVSRSksCgogICAgcHJvdmlzaW9uZXI6IHsKICAgICAgZ2V0KCkgewogICAgICAgIC8vIFRoaXMgY2FuIGluY29ycmVjdGx5IHJldHVybiBya2UxIGluc3RlYWQKICAgICAgICAvLyBvZiBya2UyIGZvciBjbHVzdGVyIG93bmVycy4KICAgICAgICBpZiAoICF0aGlzLnJrZTJFbmFibGVkICkgewogICAgICAgICAgcmV0dXJuIF9SS0UxOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRoaXMucHJlZmVycmVkUHJvdmlzaW9uZXI7CiAgICAgIH0sCgogICAgICBzZXQobmV1KSB7CiAgICAgICAgdGhpcy5wcmVmZXJyZWRQcm92aXNpb25lciA9IG5ldTsKICAgICAgfSwKICAgIH0sCgogICAgaXNSa2UxKCkgewogICAgICByZXR1cm4gdGhpcy5wcm92aXNpb25lciA9PT0gX1JLRTE7CiAgICB9LAoKICAgIGlzUmtlMigpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWUuaXNSa2UyOwogICAgfSwKCiAgICB0ZW1wbGF0ZU9wdGlvbnMoKSB7CiAgICAgIGlmICggIXRoaXMucmtlMkVuYWJsZWQgKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9CgogICAgICBjb25zdCBvdXQgPSBmaWx0ZXJBbmRBcnJhbmdlQ2hhcnRzKHRoaXMuYWxsQ2hhcnRzLCB7IHNob3dUeXBlczogQ0FUQUxPRy5fQ0xVU1RFUl9UUEwgfSk7CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKCiAgICBzdWJUeXBlcygpIHsKICAgICAgY29uc3QgZ2V0dGVycyA9IHRoaXMuJHN0b3JlLmdldHRlcnM7CiAgICAgIGNvbnN0IGlzSW1wb3J0ID0gdGhpcy5pc0ltcG9ydDsKICAgICAgY29uc3QgaXNFbGVtZW50YWxBY3RpdmUgPSAhIXRoaXMuYWN0aXZlUHJvZHVjdHMuZmluZCgoaXRlbSkgPT4gaXRlbS5uYW1lID09PSBFTEVNRU5UQUxfUFJPRFVDVF9OQU1FKTsKCiAgICAgIGNvbnN0IG91dCA9IFtdOwoKICAgICAgY29uc3QgdGVtcGxhdGVzID0gdGhpcy50ZW1wbGF0ZU9wdGlvbnM7CiAgICAgIGNvbnN0IHZ1ZUtvbnRhaW5lclR5cGVzID0gZ2V0dGVyc1sncGx1Z2lucy9jbHVzdGVyRHJpdmVycyddOwogICAgICBjb25zdCBtYWNoaW5lVHlwZXMgPSB0aGlzLm5vZGVEcml2ZXJzLmZpbHRlcigoeCkgPT4geC5zcGVjLmFjdGl2ZSAmJiB4LnN0YXRlID09PSAnYWN0aXZlJykubWFwKCh4KSA9PiB4LnNwZWMuZGlzcGxheU5hbWUgfHwgeC5pZCk7CgogICAgICB0aGlzLmtvbnRhaW5lckRyaXZlcnMuZmlsdGVyKCh4KSA9PiAoaXNJbXBvcnQgPyB4LnNob3dJbXBvcnQgOiB4LnNob3dDcmVhdGUpKS5mb3JFYWNoKChvYmopID0+IHsKICAgICAgICBpZiAoIHZ1ZUtvbnRhaW5lclR5cGVzLmluY2x1ZGVzKG9iai5kcml2ZXJOYW1lKSApIHsKICAgICAgICAgIGFkZFR5cGUob2JqLmRyaXZlck5hbWUsICdrb250YWluZXInLCBmYWxzZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGFkZFR5cGUob2JqLmRyaXZlck5hbWUsICdrb250YWluZXInLCBmYWxzZSwgKGlzSW1wb3J0ID8gb2JqLmVtYmVySW1wb3J0UGF0aCA6IG9iai5lbWJlckNyZWF0ZVBhdGgpKTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKCBpc0ltcG9ydCApIHsKICAgICAgICBhZGRUeXBlKCdpbXBvcnQnLCAnY3VzdG9tJywgZmFsc2UpOwogICAgICB9IGVsc2UgewogICAgICAgIHRlbXBsYXRlcy5mb3JFYWNoKChjaGFydCkgPT4gewogICAgICAgICAgb3V0LnB1c2goewogICAgICAgICAgICBpZDogICAgICAgICAgYGNoYXJ0OiR7IGNoYXJ0LmlkIH1gLAogICAgICAgICAgICBsYWJlbDogICAgICAgY2hhcnQuY2hhcnROYW1lRGlzcGxheSwKICAgICAgICAgICAgZGVzY3JpcHRpb246IGNoYXJ0LmNoYXJ0RGVzY3JpcHRpb24sCiAgICAgICAgICAgIGljb246ICAgICAgICBjaGFydC5pY29uIHx8IHJlcXVpcmUoJ35zaGVsbC9hc3NldHMvaW1hZ2VzL2dlbmVyaWMtY2F0YWxvZy5zdmcnKSwKICAgICAgICAgICAgZ3JvdXA6ICAgICAgICd0ZW1wbGF0ZScsCiAgICAgICAgICAgIHRhZzogICAgICAgICBnZXR0ZXJzWydpMThuL3QnXSgnZ2VuZXJpYy50ZWNoUHJldmlldycpCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHRoaXMuaXNSa2UxICkgewogICAgICAgICAgbWFjaGluZVR5cGVzLmZvckVhY2goKGlkKSA9PiB7CiAgICAgICAgICAgIGFkZFR5cGUoaWQsICdya2UxJywgZmFsc2UsIGAvZy9jbHVzdGVycy9hZGQvbGF1bmNoLyR7IGlkIH1gLCB0aGlzLmljb25DbGFzc2VzW2lkXSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBhZGRUeXBlKCdjdXN0b20nLCAnY3VzdG9tMScsIGZhbHNlLCAnL2cvY2x1c3RlcnMvYWRkL2xhdW5jaC9jdXN0b20nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWFjaGluZVR5cGVzLmZvckVhY2goKGlkKSA9PiB7CiAgICAgICAgICAgIGFkZFR5cGUoaWQsICdya2UyJywgZmFsc2UpOwogICAgICAgICAgfSk7CgogICAgICAgICAgLy8gQWRkIGZyb20gZXh0ZW5zaW9ucwogICAgICAgICAgdGhpcy5leHRlbnNpb25zLmZvckVhY2goKGV4dCkgPT4gewogICAgICAgICAgICBhZGRFeHRlbnNpb25UeXBlKGV4dCwgZ2V0dGVycyk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBhZGRUeXBlKCdjdXN0b20nLCAnY3VzdG9tMicsIGZhbHNlKTsKCiAgICAgICAgICBpZiAoaXNFbGVtZW50YWxBY3RpdmUpIHsKICAgICAgICAgICAgYWRkVHlwZShFTEVNRU5UQUxfQ0xVU1RFUl9QUk9WSURFUiwgJ2N1c3RvbTInLCBmYWxzZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gb3V0OwoKICAgICAgZnVuY3Rpb24gYWRkRXh0ZW5zaW9uVHlwZShleHQsIGdldHRlcnMpIHsKICAgICAgICBsZXQgaWNvbkNsYXNzID0gZXh0Lmljb25DbGFzczsKICAgICAgICBsZXQgaWNvbiA9IGV4dC5pY29uOwoKICAgICAgICBpZiAoaWNvbikgewogICAgICAgICAgaWNvbkNsYXNzID0gdW5kZWZpbmVkOwogICAgICAgIH0gZWxzZSBpZiAoIWljb25DbGFzcykgewogICAgICAgICAgaWNvbiA9IHJlcXVpcmUoJ35zaGVsbC9hc3NldHMvaW1hZ2VzL2dlbmVyaWMtZHJpdmVyLnN2ZycpOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgc3VidHlwZSA9IHsKICAgICAgICAgIGlkOiAgICAgICAgICBleHQuaWQsCiAgICAgICAgICBsYWJlbDogICAgICAgZXh0LmxhYmVsIHx8IGdldHRlcnNbJ2kxOG4vdCddKGBjbHVzdGVyLnByb3ZpZGVyLiR7IGV4dC5pZCB9YCksCiAgICAgICAgICBkZXNjcmlwdGlvbjogZXh0LmRlc2NyaXB0aW9uLAogICAgICAgICAgaWNvbiwKICAgICAgICAgIGljb25DbGFzcywKICAgICAgICAgIGdyb3VwOiAgICAgICBleHQuZ3JvdXAgfHwgJ3JrZTInLAogICAgICAgICAgZGlzYWJsZWQ6ICAgIGV4dC5kaXNhYmxlZCB8fCBmYWxzZSwKICAgICAgICAgIGxpbms6ICAgICAgICBleHQubGluaywKICAgICAgICAgIHRhZzogICAgICAgICBleHQudGFnCiAgICAgICAgfTsKCiAgICAgICAgb3V0LnB1c2goc3VidHlwZSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGFkZFR5cGUoaWQsIGdyb3VwLCBkaXNhYmxlZCA9IGZhbHNlLCBsaW5rID0gbnVsbCwgaWNvbkNsYXNzID0gdW5kZWZpbmVkKSB7CiAgICAgICAgY29uc3QgbGFiZWwgPSBnZXR0ZXJzWydpMThuL3dpdGhGYWxsYmFjayddKGBjbHVzdGVyLnByb3ZpZGVyLiIkeyBpZCB9ImAsIG51bGwsIGlkKTsKICAgICAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGdldHRlcnNbJ2kxOG4vd2l0aEZhbGxiYWNrJ10oYGNsdXN0ZXIucHJvdmlkZXJEZXNjcmlwdGlvbi4iJHsgaWQgfSJgLCBudWxsLCAnJyk7CiAgICAgICAgY29uc3QgdGFnID0gJyc7CgogICAgICAgIGxldCBpY29uOwoKICAgICAgICB0cnkgewogICAgICAgICAgaWNvbiA9IHJlcXVpcmUoYH5zaGVsbC9hc3NldHMvaW1hZ2VzL3Byb3ZpZGVycy8keyBpZCB9LnN2Z2ApOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CgogICAgICAgIGlmIChpY29uKSB7CiAgICAgICAgICBpY29uQ2xhc3MgPSB1bmRlZmluZWQ7CiAgICAgICAgfSBlbHNlIGlmICghaWNvbkNsYXNzKSB7CiAgICAgICAgICBpY29uID0gcmVxdWlyZSgnfnNoZWxsL2Fzc2V0cy9pbWFnZXMvZ2VuZXJpYy1kcml2ZXIuc3ZnJyk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCBzdWJ0eXBlID0gewogICAgICAgICAgaWQsCiAgICAgICAgICBsYWJlbCwKICAgICAgICAgIGRlc2NyaXB0aW9uLAogICAgICAgICAgaWNvbiwKICAgICAgICAgIGljb25DbGFzcywKICAgICAgICAgIGdyb3VwLAogICAgICAgICAgZGlzYWJsZWQsCiAgICAgICAgICBsaW5rLAogICAgICAgICAgdGFnCiAgICAgICAgfTsKCiAgICAgICAgb3V0LnB1c2goc3VidHlwZSk7CiAgICAgIH0KICAgIH0sCgogICAgZ3JvdXBlZFN1YlR5cGVzKCkgewogICAgICBjb25zdCBvdXQgPSB7fTsKCiAgICAgIGZvciAoIGNvbnN0IHJvdyBvZiB0aGlzLnN1YlR5cGVzICkgewogICAgICAgIGNvbnN0IG5hbWUgPSByb3cuZ3JvdXA7CiAgICAgICAgbGV0IGVudHJ5ID0gb3V0W25hbWVdOwoKICAgICAgICBpZiAoICFlbnRyeSApIHsKICAgICAgICAgIGVudHJ5ID0gewogICAgICAgICAgICBuYW1lLAogICAgICAgICAgICBsYWJlbDogdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi93aXRoRmFsbGJhY2snXShgY2x1c3Rlci5wcm92aWRlckdyb3VwLiIkeyB0aGlzLmlzSW1wb3J0ID8gJ3JlZ2lzdGVyLScgOiAnY3JlYXRlLScgfSR7IG5hbWUgfSJgLCBudWxsLCBuYW1lKSwKICAgICAgICAgICAgdHlwZXM6IFtdLAogICAgICAgICAgICBzb3J0OiAgU09SVF9HUk9VUFNbbmFtZV0sCiAgICAgICAgICB9OwoKICAgICAgICAgIG91dFtuYW1lXSA9IGVudHJ5OwogICAgICAgIH0KCiAgICAgICAgZW50cnkudHlwZXMucHVzaChyb3cpOwogICAgICB9CgogICAgICBmb3IgKCBjb25zdCBrIGluIG91dCApIHsKICAgICAgICBvdXRba10udHlwZXMgPSBzb3J0Qnkob3V0W2tdLnR5cGVzLCAnbGFiZWwnKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNvcnRCeShPYmplY3QudmFsdWVzKG91dCksICdzb3J0Jyk7CiAgICB9LAoKICAgIGZpcnN0Tm9kZURyaXZlckl0ZW0oKSB7CiAgICAgIHJldHVybiB0aGlzLmdyb3VwZWRTdWJUeXBlcy5maW5kSW5kZXgoKG9iaikgPT4gW19SS0UxLCBfUktFMl0uaW5jbHVkZXMob2JqLm5hbWUpKTsKICAgIH0sCgogICAgZmlyc3RDdXN0b21DbHVzdGVySXRlbSgpIHsKICAgICAgcmV0dXJuIHRoaXMuZ3JvdXBlZFN1YlR5cGVzLmZpbmRJbmRleCgob2JqKSA9PiBbJ2N1c3RvbScsICdjdXN0b20xJywgJ2N1c3RvbTInXS5pbmNsdWRlcyhvYmoubmFtZSkpOwogICAgfSwKICB9LAoKICBtZXRob2RzOiB7CiAgICBzaG93UmtlVG9nZ2xlKGkpIHsKICAgICAgaWYgKHRoaXMuaXNJbXBvcnQgfHwgIXRoaXMucmtlMkVuYWJsZWQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmZpcnN0Tm9kZURyaXZlckl0ZW0gPj0gMCkgewogICAgICAgIHJldHVybiBpID09PSB0aGlzLmZpcnN0Tm9kZURyaXZlckl0ZW07CiAgICAgIH0KCiAgICAgIHJldHVybiBpID09PSB0aGlzLmZpcnN0Q3VzdG9tQ2x1c3Rlckl0ZW07CiAgICB9LAoKICAgIGxvYWRTdHlsZXNoZWV0KHVybCwgaWQpIHsKICAgICAgaWYgKCAhaWQgKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignbG9hZFN0eWxlc2hlZXQgY2FsbGVkIHdpdGhvdXQgYW4gaWQnKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gQ2hlY2sgaWYgdGhlIHN0eWxlc2hlZXQgaGFzIGFscmVhZHkgYmVlbiBsb2FkZWQKICAgICAgaWYgKCAkKGAjJHtpZH1gKS5sZW5ndGggPiAwICkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGluaycpOwoKICAgICAgbGluay5vbmVycm9yID0gKCkgPT4gewogICAgICAgIGxpbmsucmVtb3ZlKCk7CiAgICAgIH07CiAgICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnOwogICAgICBsaW5rLnNyYyA9IHVybDsKICAgICAgbGluay5ocmVmID0gdXJsOwogICAgICBsaW5rLmlkID0gaWQ7CiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdIRUFEJylbMF0uYXBwZW5kQ2hpbGQobGluayk7CiAgICB9LAoKICAgIGNhbmNlbCgpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgIG5hbWU6ICAgJ2MtY2x1c3Rlci1wcm9kdWN0LXJlc291cmNlJywKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIGNsdXN0ZXI6ICB0aGlzLiRyb3V0ZS5wYXJhbXMuY2x1c3RlciwKICAgICAgICAgIHByb2R1Y3Q6ICB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwcm9kdWN0SWQnXSwKICAgICAgICAgIHJlc291cmNlOiBDQVBJLlJBTkNIRVJfQ0xVU1RFUiwKICAgICAgICB9LAogICAgICB9KTsKICAgIH0sCgogICAgY29sb3JGb3Iob2JqKSB7CiAgICAgIHJldHVybiBgY29sb3IkeyBTT1JUX0dST1VQU1tvYmouZ3JvdXBdIHx8IDEgfWA7CiAgICB9LAoKICAgIGNsaWNrZWRUeXBlKG9iaikgewogICAgICBjb25zdCBpZCA9IG9iai5pZDsKICAgICAgY29uc3QgcGFydHMgPSBpZC5zcGxpdCgnOicsIDIpOwoKICAgICAgaWYgKCBwYXJ0c1swXSA9PT0gJ2NoYXJ0JyApIHsKICAgICAgICBjb25zdCBjaGFydCA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NhdGFsb2cvY2hhcnQnXSh7IGtleTogcGFydHNbMV0gfSk7CiAgICAgICAgbGV0IGxvY2FsQ2x1c3RlcjsKCiAgICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnNbYG1hbmFnZW1lbnQvY2FuTGlzdGBdKE1BTkFHRU1FTlQuQ0xVU1RFUikpIHsKICAgICAgICAgIGxvY2FsQ2x1c3RlciA9IHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvYWxsJ10oTUFOQUdFTUVOVC5DTFVTVEVSKS5maW5kKCh4KSA9PiB4LmlzTG9jYWwpOwogICAgICAgIH0KCiAgICAgICAgY2hhcnQuZ29Ub0luc3RhbGwoRlJPTV9DTFVTVEVSLCBsb2NhbENsdXN0ZXI/LmlkIHx8IEJMQU5LX0NMVVNURVIsIHRydWUpOwoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuJHJvdXRlci5hcHBseVF1ZXJ5KHsgW1NVQl9UWVBFXTogaWQgfSk7CiAgICAgIHRoaXMuc2VsZWN0VHlwZShpZCk7CiAgICB9LAoKICAgIHNlbGVjdFR5cGUodHlwZSwgZmV0Y2ggPSB0cnVlKSB7CiAgICAgIGNvbnN0IHBhcnRzID0gdHlwZS5zcGxpdCgnOicsIDIpOwoKICAgICAgaWYgKCBwYXJ0c1swXSA9PT0gJ2NoYXJ0JyApIHsKICAgICAgICB0aGlzLnN1YlR5cGUgPSAnY2hhcnQnOwogICAgICAgIHRoaXMuJGVtaXQoJ3NldC1zdWJ0eXBlJywgdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi93aXRoRmFsbGJhY2snXShgY2x1c3Rlci5wcm92aWRlci5jaGFydGApKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnN1YlR5cGUgPSB0eXBlOwogICAgICAgIHRoaXMuJGVtaXQoJ3NldC1zdWJ0eXBlJywgdGhpcy4kc3RvcmUuZ2V0dGVyc1snaTE4bi93aXRoRmFsbGJhY2snXShgY2x1c3Rlci5wcm92aWRlci4iJHsgdHlwZSB9ImAsIG51bGwsIHR5cGUpKTsKICAgICAgfQoKICAgICAgaWYgKCBmZXRjaCApIHsKICAgICAgICB0aGlzLiRmZXRjaCgpOwogICAgICB9CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster","sourcesContent":["<script>\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport Loading from '@shell/components/Loading';\nimport CruResource from '@shell/components/CruResource';\nimport SelectIconGrid from '@shell/components/SelectIconGrid';\nimport EmberPage from '@shell/components/EmberPage';\nimport { ToggleSwitch } from '@components/Form/ToggleSwitch';\nimport {\n  CHART, FROM_CLUSTER, SUB_TYPE, _EDIT, _IMPORT, _CONFIG, _VIEW\n} from '@shell/config/query-params';\nimport { mapGetters } from 'vuex';\nimport { sortBy } from '@shell/utils/sort';\nimport { set } from '@shell/utils/object';\nimport { mapPref, PROVISIONER, _RKE1, _RKE2 } from '@shell/store/prefs';\nimport { filterAndArrangeCharts } from '@shell/store/catalog';\nimport { CATALOG } from '@shell/config/labels-annotations';\nimport { CAPI, MANAGEMENT, DEFAULT_WORKSPACE } from '@shell/config/types';\nimport { mapFeature, RKE2 as RKE2_FEATURE } from '@shell/store/features';\nimport { allHash } from '@shell/utils/promise';\nimport { BLANK_CLUSTER } from '@shell/store/store-types.js';\nimport { ELEMENTAL_PRODUCT_NAME, ELEMENTAL_CLUSTER_PROVIDER } from '../../config/elemental-types';\nimport Rke2Config from './rke2';\nimport Import from './import';\n\nconst SORT_GROUPS = {\n  template:  1,\n  kontainer: 2,\n  rke1:      3,\n  rke2:      3,\n  register:  4,\n  custom:    5,\n  custom1:   5,\n  custom2:   5,\n};\n\n// uSed to proxy stylesheets for custom drivers that provide custom UI (RKE1)\nconst PROXY_ENDPOINT = '/meta/proxy';\n\nexport default {\n  name: 'CruCluster',\n\n  components: {\n    CruResource,\n    EmberPage,\n    Import,\n    Loading,\n    Rke2Config,\n    SelectIconGrid,\n    ToggleSwitch\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    realMode: {\n      type:     String,\n      required: true,\n    },\n\n    mode: {\n      type:     String,\n      required: true,\n    },\n\n    value: {\n      type:    Object,\n      default: null,\n    },\n\n    /**\n     * Inherited global identifier prefix for tests\n     * Define a term based on the parent component to avoid conflicts on multiple components\n     */\n    componentTestid: {\n      type:    String,\n      default: 'cluster-manager-create'\n    }\n  },\n\n  async fetch() {\n    const hash = {\n      // These aren't explicitly used, but need to be listening for change events\n      mgmtClusters: this.$store.dispatch('management/findAll', { type: MANAGEMENT.CLUSTER }),\n      provClusters: this.$store.dispatch('management/findAll', { type: CAPI.RANCHER_CLUSTER }),\n\n      catalog: this.$store.dispatch('catalog/load'),\n    };\n\n    if (this.$store.getters[`management/canList`](MANAGEMENT.NODE_DRIVER)) {\n      hash.nodeDrivers = this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_DRIVER });\n    }\n\n    if (this.$store.getters[`management/canList`](MANAGEMENT.KONTAINER_DRIVER)) {\n      hash.kontainerDrivers = this.$store.dispatch('management/findAll', { type: MANAGEMENT.KONTAINER_DRIVER });\n    }\n\n    if ( this.value.id && !this.value.isRke2 ) {\n      // These are needed to resolve references in the mgmt cluster -> node pool -> node template to figure out what provider the cluster is using\n      // so that the edit iframe for ember pages can go to the right place.\n      if (this.$store.getters[`management/canList`](MANAGEMENT.NODE_POOL)) {\n        hash.rke1NodePools = this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_POOL });\n      }\n\n      if (this.$store.getters[`management/canList`](MANAGEMENT.NODE_TEMPLATE)) {\n        hash.rke1NodeTemplates = this.$store.dispatch('management/findAll', { type: MANAGEMENT.NODE_TEMPLATE });\n      }\n    }\n\n    const res = await allHash(hash);\n\n    this.nodeDrivers = res.nodeDrivers || [];\n    this.kontainerDrivers = res.kontainerDrivers || [];\n\n    if ( !this.value.spec ) {\n      set(this.value, 'spec', {});\n    }\n\n    if ( !this.value.id ) {\n      if ( !this.value.metadata ) {\n        set(this.value, 'metadata', {});\n      }\n\n      set(this.value.metadata, 'namespace', DEFAULT_WORKSPACE);\n    }\n\n    // For the node drivers, look for custom UI that we can use to show an icon (if not built-in)\n    this.nodeDrivers.forEach((driver) => {\n      if (!driver.spec?.builtin && driver.spec?.uiUrl && driver.spec?.active) {\n        const name = driver.spec?.displayName || driver.id;\n        let cssUrl = driver.spec.uiUrl.replace(/\\.js$/, '.css');\n\n        if (cssUrl.startsWith('http://') || cssUrl.startsWith('https://')) {\n          cssUrl = `${ PROXY_ENDPOINT }/${ cssUrl }`;\n        }\n\n        this.loadStylesheet(cssUrl, `driver-ui-css-${ driver.id }`);\n\n        this.iconClasses[name] = `machine-driver ${ name }`;\n      }\n    });\n\n    // Custom Providers from extensions - initialize each with the store and the i18n service\n    // Wrap in try ... catch, to prevent errors in an extension breaking the page\n    try {\n      const extensionClasses = this.$plugin.listDynamic('provisioner').map((name) => this.$plugin.getDynamic('provisioner', name));\n\n      // We can't pass in this.$store as this leads to a circular-reference that causes Vue to freeze,\n      // so pass in specific services that the provisioner extension may need\n      this.extensions = extensionClasses.map((c) => new c({\n        dispatch: this.$store.dispatch,\n        getters:  this.$store.getters,\n        axios:    this.$store.$axios,\n        $plugin:  this.$store.app.$plugin,\n        t:        (...args) => this.t.apply(this, args),\n        isCreate: this.isCreate,\n        isEdit:   this.isEdit,\n        isView:   this.isView,\n      }));\n    } catch (e) {\n      console.error('Error loading provisioner(s) from extensions', e); // eslint-disable-line no-console\n    }\n  },\n\n  data() {\n    const subType = this.$route.query[SUB_TYPE] || null;\n    const chart = this.$route.query[CHART] || null;\n    const isImport = this.realMode === _IMPORT;\n\n    return {\n      nodeDrivers:      [],\n      kontainerDrivers: [],\n      extensions:       [],\n      subType,\n      chart,\n      isImport,\n      providerCluster:  null,\n      iconClasses:      {},\n    };\n  },\n\n  computed: {\n    ...mapGetters({ allCharts: 'catalog/charts' }),\n    ...mapGetters('type-map', ['activeProducts']),\n    preferredProvisioner: mapPref(PROVISIONER),\n    _RKE1:                () => _RKE1,\n    _RKE2:                () => _RKE2,\n\n    emberLink() {\n      if (this.value) {\n        // For custom RKE2 clusters, don't load an Ember page.\n        // It should be the dashboard.\n        if ( this.value.isRke2 && ((this.value.isCustom && this.mode === _EDIT) || (this.value.isCustom && this.as === _CONFIG && this.mode === _VIEW) || (this.subType || '').toLowerCase() === 'custom')) {\n          // For admins, this.value.isCustom is used to check if it is a custom cluster.\n          // For cluster owners, this.subtype is used.\n          this.selectType('custom', false);\n\n          return '';\n        }\n        // For RKE2/K3s clusters provisioned in Rancher with node pools,\n        // do not use an iFramed Ember page.\n        if ( this.value.isRke2 && this.value.machineProvider ) {\n          // Edit existing RKE2\n          this.selectType(this.value.machineProvider, false);\n\n          return '';\n        }\n        if ( this.subType ) {\n          // For RKE1 and hosted Kubernetes Clusters, set the ember link\n          // so that we load the page rather than using RKE2 create\n          const selected = this.subTypes.find((s) => s.id === this.subType);\n\n          if (selected?.link) {\n            return selected.link;\n          }\n\n          this.selectType(this.subType, false);\n\n          return '';\n        }\n\n        if ( this.value.mgmt?.emberEditPath ) {\n          // Iframe an old page\n          return this.value.mgmt.emberEditPath;\n        }\n      }\n\n      return '';\n    },\n\n    rke2Enabled: mapFeature(RKE2_FEATURE),\n\n    provisioner: {\n      get() {\n        // This can incorrectly return rke1 instead\n        // of rke2 for cluster owners.\n        if ( !this.rke2Enabled ) {\n          return _RKE1;\n        }\n\n        return this.preferredProvisioner;\n      },\n\n      set(neu) {\n        this.preferredProvisioner = neu;\n      },\n    },\n\n    isRke1() {\n      return this.provisioner === _RKE1;\n    },\n\n    isRke2() {\n      return this.value.isRke2;\n    },\n\n    templateOptions() {\n      if ( !this.rke2Enabled ) {\n        return [];\n      }\n\n      const out = filterAndArrangeCharts(this.allCharts, { showTypes: CATALOG._CLUSTER_TPL });\n\n      return out;\n    },\n\n    subTypes() {\n      const getters = this.$store.getters;\n      const isImport = this.isImport;\n      const isElementalActive = !!this.activeProducts.find((item) => item.name === ELEMENTAL_PRODUCT_NAME);\n\n      const out = [];\n\n      const templates = this.templateOptions;\n      const vueKontainerTypes = getters['plugins/clusterDrivers'];\n      const machineTypes = this.nodeDrivers.filter((x) => x.spec.active && x.state === 'active').map((x) => x.spec.displayName || x.id);\n\n      this.kontainerDrivers.filter((x) => (isImport ? x.showImport : x.showCreate)).forEach((obj) => {\n        if ( vueKontainerTypes.includes(obj.driverName) ) {\n          addType(obj.driverName, 'kontainer', false);\n        } else {\n          addType(obj.driverName, 'kontainer', false, (isImport ? obj.emberImportPath : obj.emberCreatePath));\n        }\n      });\n\n      if ( isImport ) {\n        addType('import', 'custom', false);\n      } else {\n        templates.forEach((chart) => {\n          out.push({\n            id:          `chart:${ chart.id }`,\n            label:       chart.chartNameDisplay,\n            description: chart.chartDescription,\n            icon:        chart.icon || require('~shell/assets/images/generic-catalog.svg'),\n            group:       'template',\n            tag:         getters['i18n/t']('generic.techPreview')\n          });\n        });\n\n        if (this.isRke1 ) {\n          machineTypes.forEach((id) => {\n            addType(id, 'rke1', false, `/g/clusters/add/launch/${ id }`, this.iconClasses[id]);\n          });\n\n          addType('custom', 'custom1', false, '/g/clusters/add/launch/custom');\n        } else {\n          machineTypes.forEach((id) => {\n            addType(id, 'rke2', false);\n          });\n\n          // Add from extensions\n          this.extensions.forEach((ext) => {\n            addExtensionType(ext, getters);\n          });\n\n          addType('custom', 'custom2', false);\n\n          if (isElementalActive) {\n            addType(ELEMENTAL_CLUSTER_PROVIDER, 'custom2', false);\n          }\n        }\n      }\n\n      return out;\n\n      function addExtensionType(ext, getters) {\n        let iconClass = ext.iconClass;\n        let icon = ext.icon;\n\n        if (icon) {\n          iconClass = undefined;\n        } else if (!iconClass) {\n          icon = require('~shell/assets/images/generic-driver.svg');\n        }\n\n        const subtype = {\n          id:          ext.id,\n          label:       ext.label || getters['i18n/t'](`cluster.provider.${ ext.id }`),\n          description: ext.description,\n          icon,\n          iconClass,\n          group:       ext.group || 'rke2',\n          disabled:    ext.disabled || false,\n          link:        ext.link,\n          tag:         ext.tag\n        };\n\n        out.push(subtype);\n      }\n\n      function addType(id, group, disabled = false, link = null, iconClass = undefined) {\n        const label = getters['i18n/withFallback'](`cluster.provider.\"${ id }\"`, null, id);\n        const description = getters['i18n/withFallback'](`cluster.providerDescription.\"${ id }\"`, null, '');\n        const tag = '';\n\n        let icon;\n\n        try {\n          icon = require(`~shell/assets/images/providers/${ id }.svg`);\n        } catch (e) {}\n\n        if (icon) {\n          iconClass = undefined;\n        } else if (!iconClass) {\n          icon = require('~shell/assets/images/generic-driver.svg');\n        }\n\n        const subtype = {\n          id,\n          label,\n          description,\n          icon,\n          iconClass,\n          group,\n          disabled,\n          link,\n          tag\n        };\n\n        out.push(subtype);\n      }\n    },\n\n    groupedSubTypes() {\n      const out = {};\n\n      for ( const row of this.subTypes ) {\n        const name = row.group;\n        let entry = out[name];\n\n        if ( !entry ) {\n          entry = {\n            name,\n            label: this.$store.getters['i18n/withFallback'](`cluster.providerGroup.\"${ this.isImport ? 'register-' : 'create-' }${ name }\"`, null, name),\n            types: [],\n            sort:  SORT_GROUPS[name],\n          };\n\n          out[name] = entry;\n        }\n\n        entry.types.push(row);\n      }\n\n      for ( const k in out ) {\n        out[k].types = sortBy(out[k].types, 'label');\n      }\n\n      return sortBy(Object.values(out), 'sort');\n    },\n\n    firstNodeDriverItem() {\n      return this.groupedSubTypes.findIndex((obj) => [_RKE1, _RKE2].includes(obj.name));\n    },\n\n    firstCustomClusterItem() {\n      return this.groupedSubTypes.findIndex((obj) => ['custom', 'custom1', 'custom2'].includes(obj.name));\n    },\n  },\n\n  methods: {\n    showRkeToggle(i) {\n      if (this.isImport || !this.rke2Enabled) {\n        return false;\n      }\n\n      if (this.firstNodeDriverItem >= 0) {\n        return i === this.firstNodeDriverItem;\n      }\n\n      return i === this.firstCustomClusterItem;\n    },\n\n    loadStylesheet(url, id) {\n      if ( !id ) {\n        console.error('loadStylesheet called without an id'); // eslint-disable-line no-console\n\n        return;\n      }\n\n      // Check if the stylesheet has already been loaded\n      if ( $(`#${id}`).length > 0 ) { // eslint-disable-line\n        return;\n      }\n\n      const link = document.createElement('link');\n\n      link.onerror = () => {\n        link.remove();\n      };\n      link.rel = 'stylesheet';\n      link.src = url;\n      link.href = url;\n      link.id = id;\n      document.getElementsByTagName('HEAD')[0].appendChild(link);\n    },\n\n    cancel() {\n      this.$router.push({\n        name:   'c-cluster-product-resource',\n        params: {\n          cluster:  this.$route.params.cluster,\n          product:  this.$store.getters['productId'],\n          resource: CAPI.RANCHER_CLUSTER,\n        },\n      });\n    },\n\n    colorFor(obj) {\n      return `color${ SORT_GROUPS[obj.group] || 1 }`;\n    },\n\n    clickedType(obj) {\n      const id = obj.id;\n      const parts = id.split(':', 2);\n\n      if ( parts[0] === 'chart' ) {\n        const chart = this.$store.getters['catalog/chart']({ key: parts[1] });\n        let localCluster;\n\n        if (this.$store.getters[`management/canList`](MANAGEMENT.CLUSTER)) {\n          localCluster = this.$store.getters['management/all'](MANAGEMENT.CLUSTER).find((x) => x.isLocal);\n        }\n\n        chart.goToInstall(FROM_CLUSTER, localCluster?.id || BLANK_CLUSTER, true);\n\n        return;\n      }\n\n      this.$router.applyQuery({ [SUB_TYPE]: id });\n      this.selectType(id);\n    },\n\n    selectType(type, fetch = true) {\n      const parts = type.split(':', 2);\n\n      if ( parts[0] === 'chart' ) {\n        this.subType = 'chart';\n        this.$emit('set-subtype', this.$store.getters['i18n/withFallback'](`cluster.provider.chart`));\n      } else {\n        this.subType = type;\n        this.$emit('set-subtype', this.$store.getters['i18n/withFallback'](`cluster.provider.\"${ type }\"`, null, type));\n      }\n\n      if ( fetch ) {\n        this.$fetch();\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div\n    v-else-if=\"emberLink\"\n    class=\"embed\"\n  >\n    <EmberPage\n      :force-new=\"true\"\n      :src=\"emberLink\"\n    />\n  </div>\n  <CruResource\n    v-else\n    :mode=\"mode\"\n    :validation-passed=\"true\"\n    :selected-subtype=\"subType\"\n    :resource=\"value\"\n    :errors=\"errors\"\n    :subtypes=\"subTypes\"\n    :cancel-event=\"true\"\n    :prevent-enter-submit=\"true\"\n    class=\"create-cluster\"\n    @finish=\"save\"\n    @cancel=\"cancel\"\n    @select-type=\"selectType\"\n    @error=\"e=>errors = e\"\n  >\n    <template #subtypes>\n      <div\n        v-for=\"(obj, i) in groupedSubTypes\"\n        :key=\"obj.id\"\n        class=\"mb-20\"\n        style=\"width: 100%;\"\n      >\n        <h4>\n          <div\n            v-if=\"showRkeToggle(i)\"\n            class=\"grouped-type\"\n          >\n            <ToggleSwitch\n              v-model=\"provisioner\"\n              data-testid=\"cluster-manager-create-rke-switch\"\n              class=\"rke-switch\"\n              off-value=\"rke1\"\n              :off-label=\"t('cluster.toggle.v1')\"\n              on-value=\"rke2\"\n              :on-label=\"t('cluster.toggle.v2')\"\n            />\n          </div>\n          {{ obj.label }}\n        </h4>\n        <SelectIconGrid\n          :rows=\"obj.types\"\n          key-field=\"id\"\n          name-field=\"label\"\n          side-label-field=\"tag\"\n          :color-for=\"colorFor\"\n          :component-testid=\"'cluster-manager-create-grid-' + i\"\n          @clicked=\"clickedType\"\n        />\n      </div>\n    </template>\n\n    <Import\n      v-if=\"isImport\"\n      v-model=\"value\"\n      :mode=\"mode\"\n      :provider=\"subType\"\n    />\n    <Rke2Config\n      v-else-if=\"subType\"\n      v-model=\"value\"\n      :initial-value=\"initialValue\"\n      :live-value=\"liveValue\"\n      :mode=\"mode\"\n      :provider=\"subType\"\n    />\n\n    <template\n      v-if=\"subType\"\n      #form-footer\n    >\n      <div><!-- Hide the outer footer --></div>\n    </template>\n  </CruResource>\n</template>\n\n<style lang='scss'>\n  .grouped-type {\n    position: relative;\n  }\n\n  .rke-switch {\n    margin-top: -10px;\n    position: absolute;\n    right: 0;\n  }\n</style>\n"]}]}