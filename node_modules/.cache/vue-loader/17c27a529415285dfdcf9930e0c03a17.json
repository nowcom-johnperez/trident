{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/auth/azuread.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/auth/azuread.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgaXNFcXVhbCBmcm9tICdsb2Rhc2gvaXNFcXVhbCc7DQppbXBvcnQgTG9hZGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Mb2FkaW5nJzsNCmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOw0KaW1wb3J0IENydVJlc291cmNlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NydVJlc291cmNlJzsNCmltcG9ydCBJbmZvQm94IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0luZm9Cb3gnOw0KaW1wb3J0IHsgUmFkaW9Hcm91cCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vUmFkaW8nOw0KaW1wb3J0IHsgTGFiZWxlZElucHV0IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9MYWJlbGVkSW5wdXQnOw0KaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyJzsNCmltcG9ydCBBdXRoQmFubmVyIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2F1dGgvQXV0aEJhbm5lcic7DQppbXBvcnQgQ29weVRvQ2xpcGJvYXJkVGV4dCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Db3B5VG9DbGlwYm9hcmRUZXh0LnZ1ZSc7DQppbXBvcnQgQWxsb3dlZFByaW5jaXBhbHMgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvYXV0aC9BbGxvd2VkUHJpbmNpcGFscyc7DQppbXBvcnQgQXV0aENvbmZpZyBmcm9tICdAc2hlbGwvbWl4aW5zL2F1dGgtY29uZmlnJzsNCmltcG9ydCB7IEFaVVJFX01JR1JBVEVEIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOw0KaW1wb3J0IHsgZ2V0IH0gZnJvbSAnQHNoZWxsL3V0aWxzL29iamVjdCc7DQoNCmNvbnN0IFRFTkFOVF9JRF9UT0tFTiA9ICdfX1tbVEVOQU5UX0lEXV1fXyc7DQoNCi8vIEF6dXJlIEFEIEdyYXBoIHdpbGwgYmUgZGVwcmVjYXRlZCBlbmQgb2YgMjAyMiwgc2VlOiBodHRwczovL2RvY3MubWljcm9zb2Z0LmNvbS9lbi11cy9ncmFwaC9taWdyYXRlLWF6dXJlLWFkLWdyYXBoLW92ZXJ2aWV3DQpleHBvcnQgY29uc3QgT0xEX0VORFBPSU5UUyA9IHsNCiAgc3RhbmRhcmQ6IHsNCiAgICBncmFwaEVuZHBvaW50OiAnaHR0cHM6Ly9ncmFwaC53aW5kb3dzLm5ldC8nLA0KICAgIHRva2VuRW5kcG9pbnQ6IGBodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vJHsgVEVOQU5UX0lEX1RPS0VOIH0vb2F1dGgyL3Rva2VuYCwNCiAgICBhdXRoRW5kcG9pbnQ6ICBgaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tLyR7IFRFTkFOVF9JRF9UT0tFTiB9L29hdXRoMi9hdXRob3JpemVgDQogIH0sDQogIGNoaW5hOiB7DQogICAgZ3JhcGhFbmRwb2ludDogJ2h0dHBzOi8vZ3JhcGguY2hpbmFjbG91ZGFwaS5jbi8nLA0KICAgIHRva2VuRW5kcG9pbnQ6IGBodHRwczovL2xvZ2luLmNoaW5hY2xvdWRhcGkuY24vJHsgVEVOQU5UX0lEX1RPS0VOIH0vb2F1dGgyL3Rva2VuYCwNCiAgICBhdXRoRW5kcG9pbnQ6ICBgaHR0cHM6Ly9sb2dpbi5jaGluYWNsb3VkYXBpLmNuLyR7IFRFTkFOVF9JRF9UT0tFTiB9L29hdXRoMi9hdXRob3JpemVgDQogIH0NCn07DQoNCmNvbnN0IEVORFBPSU5UX01BUFBJTkcgPSB7DQogIHN0YW5kYXJkOiB7DQogICAgZW5kcG9pbnQ6ICAgICAgJ2h0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS8nLA0KICAgIGdyYXBoRW5kcG9pbnQ6ICdodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20nLA0KICAgIHRva2VuRW5kcG9pbnQ6IGBodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vJHsgVEVOQU5UX0lEX1RPS0VOIH0vb2F1dGgyL3YyLjAvdG9rZW5gLA0KICAgIGF1dGhFbmRwb2ludDogIGBodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vJHsgVEVOQU5UX0lEX1RPS0VOIH0vb2F1dGgyL3YyLjAvYXV0aG9yaXplYA0KICB9LA0KICBjaGluYTogew0KICAgIGVuZHBvaW50OiAgICAgICdodHRwczovL2xvZ2luLnBhcnRuZXIubWljcm9zb2Z0b25saW5lLmNuLycsDQogICAgZ3JhcGhFbmRwb2ludDogJ2h0dHBzOi8vbWljcm9zb2Z0Z3JhcGguY2hpbmFjbG91ZGFwaS5jbicsDQogICAgdG9rZW5FbmRwb2ludDogYGh0dHBzOi8vbG9naW4ucGFydG5lci5taWNyb3NvZnRvbmxpbmUuY24vJHsgVEVOQU5UX0lEX1RPS0VOIH0vb2F1dGgyL3YyLjAvdG9rZW5gLA0KICAgIGF1dGhFbmRwb2ludDogIGBodHRwczovL2xvZ2luLnBhcnRuZXIubWljcm9zb2Z0b25saW5lLmNuLyR7IFRFTkFOVF9JRF9UT0tFTiB9L29hdXRoMi92Mi4wL2F1dGhvcml6ZWANCiAgfSwNCiAgY3VzdG9tOiB7DQogICAgZW5kcG9pbnQ6ICAgICAgJ2h0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS8nLA0KICAgIGdyYXBoRW5kcG9pbnQ6ICcnLA0KICAgIHRva2VuRW5kcG9pbnQ6ICcnLA0KICAgIGF1dGhFbmRwb2ludDogICcnDQogIH0NCn07DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgIExvYWRpbmcsDQogICAgQ3J1UmVzb3VyY2UsDQogICAgSW5mb0JveCwNCiAgICBSYWRpb0dyb3VwLA0KICAgIExhYmVsZWRJbnB1dCwNCiAgICBCYW5uZXIsDQogICAgQ29weVRvQ2xpcGJvYXJkVGV4dCwNCiAgICBBbGxvd2VkUHJpbmNpcGFscywNCiAgICBBdXRoQmFubmVyDQogIH0sDQoNCiAgbWl4aW5zOiBbQ3JlYXRlRWRpdFZpZXcsIEF1dGhDb25maWddLA0KDQogIGFzeW5jIGZldGNoKCkgew0KICAgIGF3YWl0IHRoaXMucmVsb2FkTW9kZWwoKTsNCg0KICAgIGlmICggdGhpcy52YWx1ZT8uZ3JhcGhFbmRwb2ludCApIHsNCiAgICAgIHRoaXMuc2V0SW5pdGlhbEVuZHBvaW50KHRoaXMudmFsdWUuZ3JhcGhFbmRwb2ludCk7DQogICAgfQ0KICB9LA0KDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGVuZHBvaW50OiAgICAnc3RhbmRhcmQnLA0KICAgICAgb2xkRW5kcG9pbnQ6IGZhbHNlLA0KDQogICAgICAvLyBTdG9yaW5nIHRoZSBhcHBsaWNhdGlvblNlY3JldCBpcyBuZWNlc3NhcnkgYmVjYXVzZSBub3JtYW4gZG9lc24ndCBzdXBwb3J0IHJldHVybmluZyBzZWNyZXRzIGFuZCB3aGVuIHdlDQogICAgICAvLyBvdmVycmlkZSB0aGUgc3RldmUgYXV0aGNvbmZpZyB3aXRoIGEgbm9ybWFuIGNvbmZpZyB0aGUgYXBwbGljYXRpb25TZWNyZXQgaXMgbG9zdA0KICAgICAgYXBwbGljYXRpb25TZWNyZXQ6IHRoaXMudmFsdWUuYXBwbGljYXRpb25TZWNyZXQNCiAgICB9Ow0KICB9LA0KDQogIGNvbXB1dGVkOiB7DQogICAgdEFyZ3MoKSB7DQogICAgICByZXR1cm4gew0KICAgICAgICBiYXNlVXJsOiAgdGhpcy5iYXNlVXJsLA0KICAgICAgICBwcm92aWRlcjogdGhpcy5kaXNwbGF5TmFtZSwNCiAgICAgICAgdXNlcm5hbWU6IHRoaXMucHJpbmNpcGFsLmxvZ2luTmFtZSB8fCB0aGlzLnByaW5jaXBhbC5uYW1lDQogICAgICB9Ow0KICAgIH0sDQoNCiAgICByZXBseVVybCgpIHsNCiAgICAgIHJldHVybiBgJHsgdGhpcy5zZXJ2ZXJVcmwgfS92ZXJpZnktYXV0aC1henVyZWA7DQogICAgfSwNCg0KICAgIHRlbmFudElkKCkgew0KICAgICAgcmV0dXJuIHRoaXMubW9kZWw/LnRlbmFudElkOw0KICAgIH0sDQoNCiAgICB0b1NhdmUoKSB7DQogICAgICBjb25zdCBhcHBsaWNhdGlvblNlY3JldCA9IHRoaXMuZ2V0TmV3QXBwbGljYXRpb25TZWNyZXQoKTsNCg0KICAgICAgaWYgKGFwcGxpY2F0aW9uU2VjcmV0KSB7DQogICAgICAgIHRoaXMuJHNldCh0aGlzLm1vZGVsLCAnYXBwbGljYXRpb25TZWNyZXQnLCBhcHBsaWNhdGlvblNlY3JldCk7DQogICAgICB9DQoNCiAgICAgIHJldHVybiB7DQogICAgICAgIGNvbmZpZzogew0KICAgICAgICAgIC4uLnRoaXMubW9kZWwsDQogICAgICAgICAgZW5hYmxlZDogICAgIHRydWUsDQogICAgICAgICAgZGVzY3JpcHRpb246ICdFbmFibGUgQXp1cmVBRCcNCiAgICAgICAgfQ0KICAgICAgfTsNCiAgICB9LA0KDQogICAgbmVlZHNVcGRhdGUoKSB7DQogICAgICByZXR1cm4gKA0KICAgICAgICBnZXQodGhpcy5tb2RlbCwgYGFubm90YXRpb25zLiIkeyBBWlVSRV9NSUdSQVRFRCB9ImApICE9PSAndHJ1ZScNCiAgICAgICk7DQogICAgfSwNCg0KICAgIG1vZGFsQ29uZmlnKCkgew0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgYXBwbHlBY3Rpb246IHRoaXMudXBkYXRlRW5kcG9pbnQsDQogICAgICAgIGFwcGx5TW9kZTogICAndXBkYXRlJywNCiAgICAgICAgdGl0bGU6ICAgICAgIHRoaXMudCgnYXV0aENvbmZpZy5henVyZWFkLnVwZGF0ZUVuZHBvaW50Lm1vZGFsLnRpdGxlJyksDQogICAgICAgIGJvZHk6ICAgICAgICB0aGlzLnQoJ2F1dGhDb25maWcuYXp1cmVhZC51cGRhdGVFbmRwb2ludC5tb2RhbC5ib2R5JywgbnVsbCwgeyByYXc6IHRydWUgfSkNCiAgICAgIH07DQogICAgfQ0KICB9LA0KDQogIHdhdGNoOiB7DQogICAgZW5kcG9pbnQodmFsdWUpIHsNCiAgICAgIHRoaXMuc2V0RW5kcG9pbnRzKHZhbHVlKTsNCiAgICB9LA0KDQogICAgdGVuYW50SWQoKSB7DQogICAgICBpZiAodGhpcy5lbmRwb2ludCAhPT0gJ2N1c3RvbScpIHsNCiAgICAgICAgdGhpcy5zZXRFbmRwb2ludHModGhpcy5lbmRwb2ludCk7DQogICAgICB9DQogICAgfSwNCg0KICAgIG1vZGVsOiB7DQogICAgICBkZWVwOiB0cnVlLA0KICAgICAgaGFuZGxlcigpIHsNCiAgICAgICAgdGhpcy5tb2RlbC5hY2Nlc3NNb2RlID0gdGhpcy5tb2RlbC5hY2Nlc3NNb2RlIHx8ICd1bnJlc3RyaWN0ZWQnOw0KICAgICAgICB0aGlzLm1vZGVsLnJhbmNoZXJVcmwgPSB0aGlzLm1vZGVsLnJhbmNoZXJVcmwgfHwgdGhpcy5yZXBseVVybDsNCg0KICAgICAgICBpZiAodGhpcy5tb2RlbC5hcHBsaWNhdGlvblNlY3JldCkgew0KICAgICAgICAgIHRoaXMuJHNldCh0aGlzLCAnYXBwbGljYXRpb25TZWNyZXQnLCB0aGlzLm1vZGVsLmFwcGxpY2F0aW9uU2VjcmV0KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgc2V0RW5kcG9pbnRzKGVuZHBvaW50KSB7DQogICAgICBpZiAodGhpcy5lZGl0Q29uZmlnIHx8ICF0aGlzLm1vZGVsLmVuYWJsZWQpIHsNCiAgICAgICAgY29uc3QgZW5kcG9pbnRUeXBlID0gdGhpcy5vbGRFbmRwb2ludCAmJiBlbmRwb2ludCAhPT0gJ2N1c3RvbScgPyBPTERfRU5EUE9JTlRTIDogRU5EUE9JTlRfTUFQUElORzsNCg0KICAgICAgICBPYmplY3Qua2V5cyhlbmRwb2ludFR5cGVbZW5kcG9pbnRdKS5mb3JFYWNoKChrZXkpID0+IHsNCiAgICAgICAgICB0aGlzLiRzZXQoDQogICAgICAgICAgICB0aGlzLm1vZGVsLA0KICAgICAgICAgICAga2V5LA0KICAgICAgICAgICAgZW5kcG9pbnRUeXBlW2VuZHBvaW50XVtrZXldLnJlcGxhY2UoDQogICAgICAgICAgICAgIFRFTkFOVF9JRF9UT0tFTiwNCiAgICAgICAgICAgICAgdGhpcy5tb2RlbC50ZW5hbnRJZA0KICAgICAgICAgICAgKQ0KICAgICAgICAgICk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBzZXRJbml0aWFsRW5kcG9pbnQoZW5kcG9pbnQpIHsNCiAgICAgIGNvbnN0IG5ld0VuZHBvaW50S2V5ID0gdGhpcy5kZXRlcm1pbmVFbmRwb2ludEtleVR5cGUoRU5EUE9JTlRfTUFQUElORyk7DQogICAgICBjb25zdCBvbGRFbmRwb2ludEtleSA9IE9iamVjdC5rZXlzKE9MRF9FTkRQT0lOVFMpLmZpbmQoKGtleSkgPT4gT0xEX0VORFBPSU5UU1trZXldLmdyYXBoRW5kcG9pbnQgPT09IGVuZHBvaW50KTsNCg0KICAgICAgaWYgKCBvbGRFbmRwb2ludEtleSApIHsNCiAgICAgICAgdGhpcy5lbmRwb2ludCA9IHRoaXMuZGV0ZXJtaW5lRW5kcG9pbnRLZXlUeXBlKE9MRF9FTkRQT0lOVFMpOw0KICAgICAgICB0aGlzLm9sZEVuZHBvaW50ID0gdHJ1ZTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZW5kcG9pbnQgPSBuZXdFbmRwb2ludEtleTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgZGV0ZXJtaW5lRW5kcG9pbnRLZXlUeXBlKGVuZHBvaW50VHlwZXMpIHsNCiAgICAgIGxldCBvdXQgPSAnY3VzdG9tJzsNCg0KICAgICAgZm9yICggY29uc3QgW2VuZHBvaW50S2V5LCBlbmRwb2ludEtleVZhbHVlc10gb2YgT2JqZWN0LmVudHJpZXMoZW5kcG9pbnRUeXBlcykgKSB7DQogICAgICAgIGNvbnN0IG1hcHBlZFZhbHVlcyA9IE9iamVjdC52YWx1ZXMoZW5kcG9pbnRLZXlWYWx1ZXMpLm1hcCgoZW5kcG9pbnQpID0+IGVuZHBvaW50LnJlcGxhY2UoVEVOQU5UX0lEX1RPS0VOLCB0aGlzLm1vZGVsPy50ZW5hbnRJZCkpOw0KICAgICAgICBjb25zdCB2YWx1ZXNUb0NoZWNrID0gT2JqZWN0LmtleXMoZW5kcG9pbnRLZXlWYWx1ZXMpLm1hcCgoa2V5KSA9PiB0aGlzLnZhbHVlW2tleV0pOw0KDQogICAgICAgIGlmICggaXNFcXVhbChtYXBwZWRWYWx1ZXMsIHZhbHVlc1RvQ2hlY2spICkgew0KICAgICAgICAgIG91dCA9IGVuZHBvaW50S2V5Ow0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIHJldHVybiBvdXQ7DQogICAgfSwNCg0KICAgIGdldE5ld0FwcGxpY2F0aW9uU2VjcmV0KCkgew0KICAgICAgY29uc3QgYXBwbGljYXRpb25TZWNyZXRPcklkID0NCiAgICAgICAgdGhpcy5tb2RlbC5hcHBsaWNhdGlvblNlY3JldCB8fCB0aGlzLmFwcGxpY2F0aW9uU2VjcmV0Ow0KDQogICAgICAvLyBUaGUgYXBwbGljYXRpb24gc2VjcmV0IGNvbWVzIGJhY2sgYXMgYW4gSUQgZnJvbSBzdGV2ZSBBUEkgYW5kIHRoaXMgaW5kaWNhdGVzDQogICAgICAvLyB0aGF0IHRoZSBjdXJyZW50IGFwcGxpY2F0aW9uIHNlY3JldCBpc24ndCBuZXcNCiAgICAgIGlmIChhcHBsaWNhdGlvblNlY3JldE9ySWQuaW5jbHVkZXMoJ2NhdHRsZS1nbG9iYWwtZGF0YScpKSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gYXBwbGljYXRpb25TZWNyZXRPcklkOw0KICAgIH0sDQoNCiAgICBwcm9tcHRVcGRhdGUoKSB7DQogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9wcm9tcHRNb2RhbCcsIHsNCiAgICAgICAgY29tcG9uZW50OiAgICAgICdHZW5lcmljUHJvbXB0JywNCiAgICAgICAgY29tcG9uZW50UHJvcHM6IHRoaXMubW9kYWxDb25maWcNCiAgICAgIH0pOw0KICAgIH0sDQoNCiAgICAvLyB1cGRhdGUgdGhlIGF1dGhjb25maWcgdG8gY2hhbmdlIHRoZSBhenVyZSBhZCBncmFwaCBlbmRwb2ludCB0byB0aGUgbWljcm9zb2Z0IGdyYXBoIGVuZHBvaW50DQogICAgLy8gb25seSByZWxldmFudCBmb3Igc2V0dXBzIHVwZ3JhZGluZyB0byAyLjYuNiB3aXRoIGF6dXJlYWQgYXV0aCBhbHJlYWR5IGVuYWJsZWQNCiAgICB1cGRhdGVFbmRwb2ludChidG5DQikgew0KICAgICAgaWYgKHRoaXMubmVlZHNVcGRhdGUpIHsNCiAgICAgICAgdGhpcy5tb2RlbA0KICAgICAgICAgIC5kb0FjdGlvbigndXBncmFkZScpDQogICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5yZWxvYWRNb2RlbCgpOw0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyb3dsL3N1Y2Nlc3MnLCB7IG1lc3NhZ2U6ICdHcmFwaCBlbmRwb2ludCB1cGRhdGVkIHN1Y2Nlc3NmdWxseS4nIH0pOw0KICAgICAgICAgICAgYnRuQ0IodHJ1ZSk7DQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKGVycikgPT4gew0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyb3dsL2Zyb21FcnJvcicsIHsNCiAgICAgICAgICAgICAgdGl0bGU6ICdFcnJvciB1cGRhdGluZyBncmFwaCBlbmRwb2ludCcsDQogICAgICAgICAgICAgIGVycg0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBidG5DQihmYWxzZSk7DQogICAgICAgICAgfSk7DQogICAgICB9DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["azuread.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"azuread.vue","sourceRoot":"node_modules/@rancher/shell/edit/auth","sourcesContent":["<script>\r\nimport isEqual from 'lodash/isEqual';\r\nimport Loading from '@shell/components/Loading';\r\nimport CreateEditView from '@shell/mixins/create-edit-view';\r\nimport CruResource from '@shell/components/CruResource';\r\nimport InfoBox from '@shell/components/InfoBox';\r\nimport { RadioGroup } from '@components/Form/Radio';\r\nimport { LabeledInput } from '@components/Form/LabeledInput';\r\nimport { Banner } from '@components/Banner';\r\nimport AuthBanner from '@shell/components/auth/AuthBanner';\r\nimport CopyToClipboardText from '@shell/components/CopyToClipboardText.vue';\r\nimport AllowedPrincipals from '@shell/components/auth/AllowedPrincipals';\r\nimport AuthConfig from '@shell/mixins/auth-config';\r\nimport { AZURE_MIGRATED } from '@shell/config/labels-annotations';\r\nimport { get } from '@shell/utils/object';\r\n\r\nconst TENANT_ID_TOKEN = '__[[TENANT_ID]]__';\r\n\r\n// Azure AD Graph will be deprecated end of 2022, see: https://docs.microsoft.com/en-us/graph/migrate-azure-ad-graph-overview\r\nexport const OLD_ENDPOINTS = {\r\n  standard: {\r\n    graphEndpoint: 'https://graph.windows.net/',\r\n    tokenEndpoint: `https://login.microsoftonline.com/${ TENANT_ID_TOKEN }/oauth2/token`,\r\n    authEndpoint:  `https://login.microsoftonline.com/${ TENANT_ID_TOKEN }/oauth2/authorize`\r\n  },\r\n  china: {\r\n    graphEndpoint: 'https://graph.chinacloudapi.cn/',\r\n    tokenEndpoint: `https://login.chinacloudapi.cn/${ TENANT_ID_TOKEN }/oauth2/token`,\r\n    authEndpoint:  `https://login.chinacloudapi.cn/${ TENANT_ID_TOKEN }/oauth2/authorize`\r\n  }\r\n};\r\n\r\nconst ENDPOINT_MAPPING = {\r\n  standard: {\r\n    endpoint:      'https://login.microsoftonline.com/',\r\n    graphEndpoint: 'https://graph.microsoft.com',\r\n    tokenEndpoint: `https://login.microsoftonline.com/${ TENANT_ID_TOKEN }/oauth2/v2.0/token`,\r\n    authEndpoint:  `https://login.microsoftonline.com/${ TENANT_ID_TOKEN }/oauth2/v2.0/authorize`\r\n  },\r\n  china: {\r\n    endpoint:      'https://login.partner.microsoftonline.cn/',\r\n    graphEndpoint: 'https://microsoftgraph.chinacloudapi.cn',\r\n    tokenEndpoint: `https://login.partner.microsoftonline.cn/${ TENANT_ID_TOKEN }/oauth2/v2.0/token`,\r\n    authEndpoint:  `https://login.partner.microsoftonline.cn/${ TENANT_ID_TOKEN }/oauth2/v2.0/authorize`\r\n  },\r\n  custom: {\r\n    endpoint:      'https://login.microsoftonline.com/',\r\n    graphEndpoint: '',\r\n    tokenEndpoint: '',\r\n    authEndpoint:  ''\r\n  }\r\n};\r\n\r\nexport default {\r\n  components: {\r\n    Loading,\r\n    CruResource,\r\n    InfoBox,\r\n    RadioGroup,\r\n    LabeledInput,\r\n    Banner,\r\n    CopyToClipboardText,\r\n    AllowedPrincipals,\r\n    AuthBanner\r\n  },\r\n\r\n  mixins: [CreateEditView, AuthConfig],\r\n\r\n  async fetch() {\r\n    await this.reloadModel();\r\n\r\n    if ( this.value?.graphEndpoint ) {\r\n      this.setInitialEndpoint(this.value.graphEndpoint);\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      endpoint:    'standard',\r\n      oldEndpoint: false,\r\n\r\n      // Storing the applicationSecret is necessary because norman doesn't support returning secrets and when we\r\n      // override the steve authconfig with a norman config the applicationSecret is lost\r\n      applicationSecret: this.value.applicationSecret\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    tArgs() {\r\n      return {\r\n        baseUrl:  this.baseUrl,\r\n        provider: this.displayName,\r\n        username: this.principal.loginName || this.principal.name\r\n      };\r\n    },\r\n\r\n    replyUrl() {\r\n      return `${ this.serverUrl }/verify-auth-azure`;\r\n    },\r\n\r\n    tenantId() {\r\n      return this.model?.tenantId;\r\n    },\r\n\r\n    toSave() {\r\n      const applicationSecret = this.getNewApplicationSecret();\r\n\r\n      if (applicationSecret) {\r\n        this.$set(this.model, 'applicationSecret', applicationSecret);\r\n      }\r\n\r\n      return {\r\n        config: {\r\n          ...this.model,\r\n          enabled:     true,\r\n          description: 'Enable AzureAD'\r\n        }\r\n      };\r\n    },\r\n\r\n    needsUpdate() {\r\n      return (\r\n        get(this.model, `annotations.\"${ AZURE_MIGRATED }\"`) !== 'true'\r\n      );\r\n    },\r\n\r\n    modalConfig() {\r\n      return {\r\n        applyAction: this.updateEndpoint,\r\n        applyMode:   'update',\r\n        title:       this.t('authConfig.azuread.updateEndpoint.modal.title'),\r\n        body:        this.t('authConfig.azuread.updateEndpoint.modal.body', null, { raw: true })\r\n      };\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    endpoint(value) {\r\n      this.setEndpoints(value);\r\n    },\r\n\r\n    tenantId() {\r\n      if (this.endpoint !== 'custom') {\r\n        this.setEndpoints(this.endpoint);\r\n      }\r\n    },\r\n\r\n    model: {\r\n      deep: true,\r\n      handler() {\r\n        this.model.accessMode = this.model.accessMode || 'unrestricted';\r\n        this.model.rancherUrl = this.model.rancherUrl || this.replyUrl;\r\n\r\n        if (this.model.applicationSecret) {\r\n          this.$set(this, 'applicationSecret', this.model.applicationSecret);\r\n        }\r\n      }\r\n    },\r\n\r\n  },\r\n\r\n  methods: {\r\n    setEndpoints(endpoint) {\r\n      if (this.editConfig || !this.model.enabled) {\r\n        const endpointType = this.oldEndpoint && endpoint !== 'custom' ? OLD_ENDPOINTS : ENDPOINT_MAPPING;\r\n\r\n        Object.keys(endpointType[endpoint]).forEach((key) => {\r\n          this.$set(\r\n            this.model,\r\n            key,\r\n            endpointType[endpoint][key].replace(\r\n              TENANT_ID_TOKEN,\r\n              this.model.tenantId\r\n            )\r\n          );\r\n        });\r\n      }\r\n    },\r\n\r\n    setInitialEndpoint(endpoint) {\r\n      const newEndpointKey = this.determineEndpointKeyType(ENDPOINT_MAPPING);\r\n      const oldEndpointKey = Object.keys(OLD_ENDPOINTS).find((key) => OLD_ENDPOINTS[key].graphEndpoint === endpoint);\r\n\r\n      if ( oldEndpointKey ) {\r\n        this.endpoint = this.determineEndpointKeyType(OLD_ENDPOINTS);\r\n        this.oldEndpoint = true;\r\n      } else {\r\n        this.endpoint = newEndpointKey;\r\n      }\r\n    },\r\n\r\n    determineEndpointKeyType(endpointTypes) {\r\n      let out = 'custom';\r\n\r\n      for ( const [endpointKey, endpointKeyValues] of Object.entries(endpointTypes) ) {\r\n        const mappedValues = Object.values(endpointKeyValues).map((endpoint) => endpoint.replace(TENANT_ID_TOKEN, this.model?.tenantId));\r\n        const valuesToCheck = Object.keys(endpointKeyValues).map((key) => this.value[key]);\r\n\r\n        if ( isEqual(mappedValues, valuesToCheck) ) {\r\n          out = endpointKey;\r\n        }\r\n      }\r\n\r\n      return out;\r\n    },\r\n\r\n    getNewApplicationSecret() {\r\n      const applicationSecretOrId =\r\n        this.model.applicationSecret || this.applicationSecret;\r\n\r\n      // The application secret comes back as an ID from steve API and this indicates\r\n      // that the current application secret isn't new\r\n      if (applicationSecretOrId.includes('cattle-global-data')) {\r\n        return null;\r\n      }\r\n\r\n      return applicationSecretOrId;\r\n    },\r\n\r\n    promptUpdate() {\r\n      this.$store.dispatch('management/promptModal', {\r\n        component:      'GenericPrompt',\r\n        componentProps: this.modalConfig\r\n      });\r\n    },\r\n\r\n    // update the authconfig to change the azure ad graph endpoint to the microsoft graph endpoint\r\n    // only relevant for setups upgrading to 2.6.6 with azuread auth already enabled\r\n    updateEndpoint(btnCB) {\r\n      if (this.needsUpdate) {\r\n        this.model\r\n          .doAction('upgrade')\r\n          .then(() => {\r\n            this.reloadModel();\r\n            this.$store.dispatch('growl/success', { message: 'Graph endpoint updated successfully.' });\r\n            btnCB(true);\r\n          })\r\n          .catch((err) => {\r\n            this.$store.dispatch('growl/fromError', {\r\n              title: 'Error updating graph endpoint',\r\n              err\r\n            });\r\n            btnCB(false);\r\n          });\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <Loading v-if=\"$fetchState.pending\" />\r\n  <div v-else>\r\n    <CruResource\r\n      :done-route=\"doneRoute\"\r\n      :mode=\"mode\"\r\n      :resource=\"model\"\r\n      :subtypes=\"[]\"\r\n      :validation-passed=\"true\"\r\n      :finish-button-mode=\"model && model.enabled ? 'edit' : 'enable'\"\r\n      :can-yaml=\"false\"\r\n      :errors=\"errors\"\r\n      :show-cancel=\"showCancel\"\r\n      :cancel-event=\"true\"\r\n      @error=\"e => (errors = e)\"\r\n      @finish=\"save\"\r\n      @cancel=\"cancel\"\r\n    >\r\n      <template v-if=\"model.enabled && !isEnabling && !editConfig\">\r\n        <AuthBanner\r\n          :t-args=\"tArgs\"\r\n          :disable=\"disable\"\r\n          :edit=\"goToEdit\"\r\n        >\r\n          <template slot=\"rows\">\r\n            <tr>\r\n              <td>{{ t(`authConfig.azuread.tenantId`) }}:</td>\r\n              <td>{{ model.tenantId }}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{{ t(`authConfig.azuread.applicationId`) }}:</td>\r\n              <td>{{ model.applicationId }}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{{ t(`authConfig.azuread.endpoint`) }}:</td>\r\n              <td>{{ model.endpoint }}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{{ t(`authConfig.azuread.graphEndpoint`) }}:</td>\r\n              <td>{{ model.graphEndpoint }}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{{ t(`authConfig.azuread.tokenEndpoint`) }}:</td>\r\n              <td>{{ model.tokenEndpoint }}</td>\r\n            </tr>\r\n            <tr>\r\n              <td>{{ t(`authConfig.azuread.authEndpoint`) }}:</td>\r\n              <td>{{ model.authEndpoint }}</td>\r\n            </tr>\r\n          </template>\r\n          <template\r\n            v-if=\"needsUpdate\"\r\n            slot=\"actions\"\r\n          >\r\n            <button\r\n              type=\"button\"\r\n              class=\"btn btn-sm role-secondary mr-10 update\"\r\n              @click=\"promptUpdate\"\r\n            >\r\n              {{ t('authConfig.azuread.updateEndpoint.button') }}\r\n            </button>\r\n          </template>\r\n        </AuthBanner>\r\n\r\n        <hr>\r\n\r\n        <AllowedPrincipals\r\n          provider=\"azuread\"\r\n          :auth-config=\"model\"\r\n          :mode=\"mode\"\r\n        />\r\n      </template>\r\n\r\n      <template v-else>\r\n        <Banner\r\n          v-if=\"!model.enabled\"\r\n          :label=\"t('authConfig.stateBanner.disabled', tArgs)\"\r\n          color=\"warning\"\r\n        />\r\n\r\n        <InfoBox\r\n          v-if=\"!model.enabled\"\r\n          id=\"reply-info\"\r\n          class=\"mt-20 mb-20 p-10\"\r\n        >\r\n          {{ t('authConfig.azuread.reply.info') }}\r\n          <br>\r\n          <label class=\"reply-url\">{{ t('authConfig.azuread.reply.label') }} </label>\r\n          <CopyToClipboardText\r\n            :plain=\"true\"\r\n            :text=\"replyUrl\"\r\n          />\r\n        </InfoBox>\r\n\r\n        <div class=\"row mb-20\">\r\n          <div class=\"col span-6\">\r\n            <LabeledInput\r\n              id=\"tenant-id\"\r\n              v-model=\"model.tenantId\"\r\n              label=\"Tenant ID\"\r\n              :mode=\"mode\"\r\n              :required=\"true\"\r\n              tooltip=\"From the Azure AD portal\"\r\n              placeholder=\"A long UUID string\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <div class=\"row mb-20\">\r\n          <div class=\"col span-6\">\r\n            <LabeledInput\r\n              id=\"application-id\"\r\n              v-model=\"model.applicationId\"\r\n              label=\"Application ID\"\r\n              :mode=\"mode\"\r\n              :required=\"true\"\r\n              placeholder=\"A long UUID string\"\r\n            />\r\n          </div>\r\n          <div class=\"col span-6\">\r\n            <LabeledInput\r\n              id=\"application-secret\"\r\n              v-model=\"model.applicationSecret\"\r\n              type=\"password\"\r\n              label=\"Application Secret\"\r\n              :required=\"true\"\r\n              :mode=\"mode\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <RadioGroup\r\n          v-model=\"endpoint\"\r\n          class=\"mb-20\"\r\n          :required=\"true\"\r\n          label=\"Endpoints\"\r\n          name=\"endpoints\"\r\n          :options=\"['standard', 'china', 'custom']\"\r\n          :mode=\"mode\"\r\n          :labels=\"['Standard', 'China', 'Custom']\"\r\n        />\r\n        <div v-if=\"endpoint === 'custom'\">\r\n          <div class=\"row mb-20\">\r\n            <div class=\"col span-6\">\r\n              <LabeledInput\r\n                v-model=\"model.endpoint\"\r\n                label=\"Endpoint\"\r\n                :mode=\"mode\"\r\n                :required=\"true\"\r\n              />\r\n            </div>\r\n            <div class=\"col span-6\">\r\n              <LabeledInput\r\n                v-model=\"model.graphEndpoint\"\r\n                label=\"Graph Endpoint\"\r\n                :required=\"true\"\r\n                :mode=\"mode\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"row mb-20\">\r\n            <div class=\"col span-6\">\r\n              <LabeledInput\r\n                v-model=\"model.tokenEndpoint\"\r\n                label=\"Token Endpoint\"\r\n                :mode=\"mode\"\r\n                :required=\"true\"\r\n              />\r\n            </div>\r\n            <div class=\"col span-6\">\r\n              <LabeledInput\r\n                v-model=\"model.authEndpoint\"\r\n                label=\"Auth Endpoint\"\r\n                :required=\"true\"\r\n                :mode=\"mode\"\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </CruResource>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\">\r\n#reply-info {\r\n  flex-grow: 0;\r\n}\r\n\r\n.reply-url {\r\n  color: inherit;\r\n  font-weight: 700;\r\n}\r\n</style>\r\n"]}]}