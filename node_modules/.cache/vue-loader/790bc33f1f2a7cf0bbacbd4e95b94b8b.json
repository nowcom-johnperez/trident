{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFNFRU5fV0hBVFNfTkVXIH0gZnJvbSAnQHNoZWxsL3N0b3JlL3ByZWZzJzsKaW1wb3J0IHsgZ2V0VmVyc2lvbkluZm8gfSBmcm9tICdAc2hlbGwvdXRpbHMvdmVyc2lvbic7Cgpjb25zdCB2YWxpZFJvdXRlID0gKHJvdXRlLCByb3V0ZXIpID0+IHsKICByZXR1cm4gISFyb3V0ZSAmJiAhIXJvdXRlci5yZXNvbHZlKHJvdXRlKT8ucmVzb2x2ZWQ/Lm1hdGNoZWQ/Lmxlbmd0aDsKfTsKCmV4cG9ydCBkZWZhdWx0IHsKICBtaWRkbGV3YXJlKHsKICAgIHJlZGlyZWN0LCBzdG9yZSwgYXBwLCByb3V0ZQogIH0gKSB7CiAgICBjb25zdCBzZWVuV2hhdHNOZXcgPSBzdG9yZS5nZXR0ZXJzWydwcmVmcy9nZXQnXShTRUVOX1dIQVRTX05FVyk7CiAgICBjb25zdCB2ZXJzaW9uSW5mbyA9IGdldFZlcnNpb25JbmZvKHN0b3JlKTsKICAgIGNvbnN0IGlzU2luZ2xlUHJvZHVjdCA9IHN0b3JlLmdldHRlcnNbJ2lzU2luZ2xlUHJvZHVjdCddOwogICAgY29uc3QgZGFzaGJvYXJkSG9tZSA9IHsgbmFtZTogJ2hvbWUnIH07CgogICAgLy8gSWYgdGhpcyBpcyBhIG5ldyB2ZXJzaW9uLCB0aGVuIHRha2UgdGhlIHVzZXIgdG8gdGhlIGhvbWUgcGFnZSB0byB2aWV3IHRoZSByZWxlYXNlIG5vdGVzCiAgICBpZiAodmVyc2lvbkluZm8uZnVsbFZlcnNpb24gIT09IHNlZW5XaGF0c05ldyAmJiAhaXNTaW5nbGVQcm9kdWN0KSB7CiAgICAgIHJldHVybiByZWRpcmVjdChkYXNoYm9hcmRIb21lKTsKICAgIH0KCiAgICBjb25zdCBhZnRlckxvZ2luUm91dGVPYmplY3QgPSBzdG9yZS5nZXR0ZXJzWydwcmVmcy9hZnRlckxvZ2luUm91dGUnXTsKICAgIGNvbnN0IHRhcmdldFJvdXRlID0gYXBwLnJvdXRlci5yZXNvbHZlKGFmdGVyTG9naW5Sb3V0ZU9iamVjdCk7CgogICAgLy8gSWYgdGFyZ2V0IHJvdXRlIGlzIC8sIHRoZW4gd2Ugd2lsbCBsb29wIHdpdGggZW5kbGVzcyByZWRpcmVjdCAtIHNvIGRldGVjdCB0aGF0IGhlcmUgYW5kCiAgICAvLyByZWRpcmVjdCB0byAvaG9tZSwgd2hpY2ggaXMgd2hhdCB3ZSB3b3VsZCBkbyBiZWxvdywgaWYgdGhlcmUgd2FzIG5vIGBhZnRlckxvZ2luUm91dGVPYmplY3RgCiAgICBpZiAodGFyZ2V0Um91dGU/LnJvdXRlPy5mdWxsUGF0aCA9PT0gJy8nKSB7CiAgICAgIHJldHVybiByZWRpcmVjdChkYXNoYm9hcmRIb21lKTsKICAgIH0KCiAgICAvLyBDb25maXJtIHRoaXMgaXMgYSB2YWxpZCByb3V0ZSAoaXQgY291bGQgaGF2ZSBjb21lIGZyb20gYW4gdW5pbnN0YWxsZWQgcGx1Z2luKQogICAgaWYgKHZhbGlkUm91dGUoYWZ0ZXJMb2dpblJvdXRlT2JqZWN0LCBhcHAucm91dGVyKSkgewogICAgICAvLyBUYWtlIHRoZSB1c2VyIHRvIHRoZSBjb25maWd1cmVkIGxvZ2luIHJvdXRlCiAgICAgIHJldHVybiByZWRpcmVjdChhZnRlckxvZ2luUm91dGVPYmplY3QpOwogICAgfQoKICAgIGlmICh2YWxpZFJvdXRlKGlzU2luZ2xlUHJvZHVjdD8uYWZ0ZXJMb2dpblJvdXRlLCBhcHAucm91dGVyKSkgewogICAgICByZXR1cm4gcmVkaXJlY3QoaXNTaW5nbGVQcm9kdWN0LmFmdGVyTG9naW5Sb3V0ZSk7CiAgICB9CgogICAgcmV0dXJuIHJlZGlyZWN0KGRhc2hib2FyZEhvbWUpOwogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/pages","sourcesContent":["<script>\nimport { SEEN_WHATS_NEW } from '@shell/store/prefs';\nimport { getVersionInfo } from '@shell/utils/version';\n\nconst validRoute = (route, router) => {\n  return !!route && !!router.resolve(route)?.resolved?.matched?.length;\n};\n\nexport default {\n  middleware({\n    redirect, store, app, route\n  } ) {\n    const seenWhatsNew = store.getters['prefs/get'](SEEN_WHATS_NEW);\n    const versionInfo = getVersionInfo(store);\n    const isSingleProduct = store.getters['isSingleProduct'];\n    const dashboardHome = { name: 'home' };\n\n    // If this is a new version, then take the user to the home page to view the release notes\n    if (versionInfo.fullVersion !== seenWhatsNew && !isSingleProduct) {\n      return redirect(dashboardHome);\n    }\n\n    const afterLoginRouteObject = store.getters['prefs/afterLoginRoute'];\n    const targetRoute = app.router.resolve(afterLoginRouteObject);\n\n    // If target route is /, then we will loop with endless redirect - so detect that here and\n    // redirect to /home, which is what we would do below, if there was no `afterLoginRouteObject`\n    if (targetRoute?.route?.fullPath === '/') {\n      return redirect(dashboardHome);\n    }\n\n    // Confirm this is a valid route (it could have come from an uninstalled plugin)\n    if (validRoute(afterLoginRouteObject, app.router)) {\n      // Take the user to the configured login route\n      return redirect(afterLoginRouteObject);\n    }\n\n    if (validRoute(isSingleProduct?.afterLoginRoute, app.router)) {\n      return redirect(isSingleProduct.afterLoginRoute);\n    }\n\n    return redirect(dashboardHome);\n  }\n};\n</script>\n"]}]}