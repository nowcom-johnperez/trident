{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/monitoring/index.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/chart/monitoring/index.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBpc0VtcHR5IGZyb20gJ2xvZGFzaC9pc0VtcHR5JzsKaW1wb3J0IG1lcmdlIGZyb20gJ2xvZGFzaC9tZXJnZSc7CgppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7CgppbXBvcnQgQWxlcnRpbmcgZnJvbSAnQHNoZWxsL2NoYXJ0L21vbml0b3JpbmcvYWxlcnRpbmcnOwppbXBvcnQgeyBDaGVja2JveCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vQ2hlY2tib3gnOwppbXBvcnQgQ2x1c3RlclNlbGVjdG9yIGZyb20gJ0BzaGVsbC9jaGFydC9tb25pdG9yaW5nL0NsdXN0ZXJTZWxlY3Rvcic7CmltcG9ydCBHcmFmYW5hIGZyb20gJ0BzaGVsbC9jaGFydC9tb25pdG9yaW5nL2dyYWZhbmEnOwppbXBvcnQgeyBMYWJlbGVkSW5wdXQgfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0xhYmVsZWRJbnB1dCc7CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgUHJvbWV0aGV1cyBmcm9tICdAc2hlbGwvY2hhcnQvbW9uaXRvcmluZy9wcm9tZXRoZXVzJzsKaW1wb3J0IFRhYiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvVGFiJzsKaW1wb3J0IENoYXJ0UHNwIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NoYXJ0UHNwJzsKCmltcG9ydCB7IGFsbEhhc2ggfSBmcm9tICdAc2hlbGwvdXRpbHMvcHJvbWlzZSc7CmltcG9ydCB7IFNUT1JBR0VfQ0xBU1MsIFBWQywgU0VDUkVULCBXT1JLTE9BRF9UWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEFsZXJ0aW5nLAogICAgQ2hlY2tib3gsCiAgICBDbHVzdGVyU2VsZWN0b3IsCiAgICBHcmFmYW5hLAogICAgTGFiZWxlZElucHV0LAogICAgTG9hZGluZywKICAgIFByb21ldGhldXMsCiAgICBUYWIsCiAgICBDaGFydFBzcAogIH0sCgogIGhhc1RhYnM6IHRydWUsCgogIHByb3BzOiB7CiAgICBjaGFydDogewogICAgICB0eXBlOiAgICBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+ICh7fSksCiAgICB9LAoKICAgIG1vZGU6IHsKICAgICAgdHlwZTogICAgU3RyaW5nLAogICAgICBkZWZhdWx0OiAnY3JlYXRlJywKICAgIH0sCgogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgT2JqZWN0LAogICAgICBkZWZhdWx0OiAoKSA9PiB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9LAogICAgfSwKICB9LAoKICBhc3luYyBmZXRjaCgpIHsKICAgIGNvbnN0IHsgJHN0b3JlIH0gPSB0aGlzOwoKICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBhbGxIYXNoKHsKICAgICAgbmFtZXNwYWNlczogICAgICRzdG9yZS5nZXR0ZXJzWyduYW1lc3BhY2VzJ10oKSwKICAgICAgcHZjczogICAgICAgICAgICRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9maW5kQWxsJywgeyB0eXBlOiBQVkMgfSksCiAgICAgIHNlY3JldHM6ICAgICAgICAkc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogU0VDUkVUIH0pLAogICAgICBzdG9yYWdlQ2xhc3NlczogJHN0b3JlLmRpc3BhdGNoKCdjbHVzdGVyL2ZpbmRBbGwnLCB7IHR5cGU6IFNUT1JBR0VfQ0xBU1MgfSksCiAgICB9KTsKCiAgICBhd2FpdCBQcm9taXNlLmFsbCgKICAgICAgT2JqZWN0LnZhbHVlcyhXT1JLTE9BRF9UWVBFUykubWFwKCh0eXBlKSA9PiB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnY2x1c3Rlci9maW5kQWxsJywgeyB0eXBlIH0pCiAgICAgICkKICAgICk7CgogICAgdGhpcy50YXJnZXROYW1lc3BhY2UgPSBoYXNoLm5hbWVzcGFjZXNbdGhpcy5jaGFydC50YXJnZXROYW1lc3BhY2VdIHx8IGZhbHNlOwoKICAgIGlmICghaXNFbXB0eShoYXNoLnN0b3JhZ2VDbGFzc2VzKSkgewogICAgICB0aGlzLnN0b3JhZ2VDbGFzc2VzID0gaGFzaC5zdG9yYWdlQ2xhc3NlczsKICAgIH0KCiAgICBpZiAoIWlzRW1wdHkoaGFzaC5wdmNzKSkgewogICAgICB0aGlzLnB2Y3MgPSBoYXNoLnB2Y3M7CiAgICB9CgogICAgaWYgKCFpc0VtcHR5KGhhc2guc2VjcmV0cykpIHsKICAgICAgdGhpcy5zZWNyZXRzID0gaGFzaC5zZWNyZXRzOwogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY2Nlc3NNb2RlczogWwogICAgICAgIHsKICAgICAgICAgIGlkOiAgICAnUmVhZFdyaXRlT25jZScsCiAgICAgICAgICBsYWJlbDogJ21vbml0b3JpbmcuYWNjZXNzTW9kZXMub25jZScsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBpZDogICAgJ1JlYWRPbmx5TWFueScsCiAgICAgICAgICBsYWJlbDogJ21vbml0b3JpbmcuYWNjZXNzTW9kZXMucmVhZE9ubHlNYW55JywKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGlkOiAgICAnUmVhZFdyaXRlTWFueScsCiAgICAgICAgICBsYWJlbDogJ21vbml0b3JpbmcuYWNjZXNzTW9kZXMubWFueScsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgY2x1c3RlclR5cGU6ICAgICAgICAgICB7fSwKICAgICAgZGlzYWJsZUFnZ3JlZ2F0ZVJvbGVzOiBmYWxzZSwKICAgICAgcHJvbWV0aGV1c1Jlc291cmNlczogICBbXSwKICAgICAgcHZjczogICAgICAgICAgICAgICAgICBbXSwKICAgICAgc2VjcmV0czogICAgICAgICAgICAgICBbXSwKICAgICAgc3RvcmFnZUNsYXNzZXM6ICAgICAgICBbXSwKICAgICAgdGFyZ2V0TmFtZXNwYWNlOiAgICAgICBudWxsLAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10pLAogICAgcHJvdmlkZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDbHVzdGVyLnN0YXR1cy5wcm92aWRlci50b0xvd2VyQ2FzZSgpOwogICAgfSwKICAgIHdvcmtsb2FkcygpIHsKICAgICAgcmV0dXJuIE9iamVjdC52YWx1ZXMoV09SS0xPQURfVFlQRVMpLmZsYXRNYXAoKHR5cGUpID0+IHRoaXMuJHN0b3JlLmdldHRlcnNbJ2NsdXN0ZXIvYWxsJ10odHlwZSkKICAgICAgKTsKICAgIH0sCiAgfSwKCiAgd2F0Y2g6IHsKICAgICd2YWx1ZS5nbG9iYWwucmJhYy51c2VyUm9sZXMuY3JlYXRlJyhjcmVhdGVVc2VyUm9sZXMpIHsKICAgICAgaWYgKGNyZWF0ZVVzZXJSb2xlcykgewogICAgICAgIHRoaXMuZGlzYWJsZUFnZ3JlZ2F0ZVJvbGVzID0gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy52YWx1ZS5nbG9iYWwucmJhYy51c2VyUm9sZXMuYWdncmVnYXRlVG9EZWZhdWx0Um9sZXMgPSBmYWxzZTsKICAgICAgICB0aGlzLmRpc2FibGVBZ2dyZWdhdGVSb2xlcyA9IHRydWU7CiAgICAgIH0KICAgIH0sCiAgfSwKCiAgY3JlYXRlZCgpIHsKICAgIGlmICh0aGlzLm1vZGUgPT09ICdjcmVhdGUnKSB7CiAgICAgIC8vIG1lcmdlIGhlcmUgZG9lc24ndCB3b3JrIChleGlzdGluZyB2YWx1ZXMgYXJlIGxvc3Qgd2hlbiBnb2luZyBmcm9tIGZvcm0gdG8geWFtbCBhbmQgYmFjayBhZ2Fpbikgc28gaW5zdGVhZCBzdXBwbHkgc29tZSBiZXR0ZXIgZGVmYXVsdCB2YWx1ZXMKICAgICAgLy8gYW55IGNoYW5nZXMgaGVyZSBuZWVkIHRvIHJlc3BlY3QgdGhlIG9yZGVyIG9mIHByb3BlcnRpZXMgKHJlZmxlY3RlZCBpbiB0aGUgeWFtbCBkaWZmKQogICAgICBjb25zdCBleHRlbmRlZERlZmF1bHRzID0gewogICAgICAgIGdsb2JhbDogewogICAgICAgICAgcmJhYzogewogICAgICAgICAgICB1c2VyUm9sZXM6IHsKICAgICAgICAgICAgICBjcmVhdGU6ICAgICAgICAgICAgICAgICAgdGhpcy5tZXJnZVZhbHVlKHRoaXMudmFsdWU/Lmdsb2JhbD8ucmJhYz8udXNlclJvbGVzPy5jcmVhdGUsIHRydWUpLAogICAgICAgICAgICAgIGFnZ3JlZ2F0ZVRvRGVmYXVsdFJvbGVzOiB0aGlzLm1lcmdlVmFsdWUodGhpcy52YWx1ZT8uZ2xvYmFsPy5yYmFjPy51c2VyUm9sZXM/LmFnZ3JlZ2F0ZVRvRGVmYXVsdFJvbGVzLCB0cnVlKSwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgICAgICBwcm9tZXRoZXVzOiB7CiAgICAgICAgICBwcm9tZXRoZXVzU3BlYzogewogICAgICAgICAgICBzY3JhcGVJbnRlcnZhbDogICAgIHRoaXMubWVyZ2VWYWx1ZSh0aGlzLnZhbHVlPy5wcm9tZXRoZXVzPy5wcm9tZXRoZXVzU3BlYz8uc2NyYXBlSW50ZXJ2YWwsICcxbScpLAogICAgICAgICAgICBldmFsdWF0aW9uSW50ZXJ2YWw6IHRoaXMubWVyZ2VWYWx1ZSh0aGlzLnZhbHVlPy5wcm9tZXRoZXVzPy5wcm9tZXRoZXVzU3BlYz8uZXZhbHVhdGlvbkludGVydmFsLCAnMW0nKSwKICAgICAgICAgICAgcmV0ZW50aW9uOiAgICAgICAgICB0aGlzLm1lcmdlVmFsdWUodGhpcy52YWx1ZT8ucHJvbWV0aGV1cz8ucHJvbWV0aGV1c1NwZWM/LnJldGVudGlvbiwgJzEwZCcpLAogICAgICAgICAgICByZXRlbnRpb25TaXplOiAgICAgIHRoaXMubWVyZ2VWYWx1ZSh0aGlzLnZhbHVlPy5wcm9tZXRoZXVzPy5wcm9tZXRoZXVzU3BlYz8ucmV0ZW50aW9uU2l6ZSwgJzUwR2lCJyksCiAgICAgICAgICAgIGVuYWJsZUFkbWluQVBJOiAgICAgdGhpcy5tZXJnZVZhbHVlKHRoaXMudmFsdWU/LnByb21ldGhldXM/LnByb21ldGhldXNTcGVjPy5lbmFibGVBZG1pbkFQSSwgZmFsc2UpLAogICAgICAgICAgfSwKICAgICAgICB9LAogICAgICB9OwoKICAgICAgbWVyZ2UodGhpcy52YWx1ZSwgZXh0ZW5kZWREZWZhdWx0cyk7CgogICAgICBpZiAodGhpcy5wcm92aWRlci5zdGFydHNXaXRoKCdya2UyJykpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZS5ya2UySW5ncmVzc05naW54LCAnZW5hYmxlZCcsIHRydWUpOwogICAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLnJrZTJFdGNkLCAnZW5hYmxlZCcsIHRydWUpOwogICAgICAgIHRoaXMuJHNldCh0aGlzLnZhbHVlLnJrZUV0Y2QsICdlbmFibGVkJywgZmFsc2UpOwogICAgICB9IGVsc2UgaWYgKHRoaXMucHJvdmlkZXIuc3RhcnRzV2l0aCgncmtlJykpIHsKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZSwgJ2luZ3Jlc3NOZ2lueCcsIHRoaXMudmFsdWUuaW5ncmVzc05naW54IHx8IHt9KTsKICAgICAgICB0aGlzLiRzZXQodGhpcy52YWx1ZS5pbmdyZXNzTmdpbngsICdlbmFibGVkJywgdHJ1ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUucmtlRXRjZCwgJ2VuYWJsZWQnLCBmYWxzZSk7CiAgICAgIH0KICAgIH0KCiAgICB0aGlzLiRlbWl0KCdyZWdpc3Rlci1iZWZvcmUtaG9vaycsIHRoaXMud2lsbFNhdmUsICd3aWxsU2F2ZScpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIHdpbGxTYXZlKCkgewogICAgICBjb25zdCB7IHByb21ldGhldXNTcGVjIH0gPSB0aGlzLnZhbHVlLnByb21ldGhldXM7CiAgICAgIGNvbnN0IHNlbGVjdG9yID0KICAgICAgICBwcm9tZXRoZXVzU3BlYz8uc3RvcmFnZVNwZWM/LnZvbHVtZUNsYWltVGVtcGxhdGU/LnNwZWM/LnNlbGVjdG9yOwoKICAgICAgLy8gVGhpcyB3b3JrcyBmb3IgVUkgZWRpdG9yIGluc3RhbGxhdGlvbgogICAgICAvLyBIb3dldmVyLCBpdCBkb2Vzbid0IHdvcmsgZm9yIHlhbWwgZWRpdG9yIGluc3RhbGxhdGlvbgogICAgICAvLyBHbG9iYWwgdmFsdWVzIGxhdGVyIG1lcmdlZCBhZ2FpbiBpbiBjaGFydHMvaW5zdGFsbC52dWUgYWRkR2xvYmFsVmFsdWVzVG8oKQogICAgICAvLyBXZSBzdGlsbCBuZWVkIHRvIHJlbW92ZSB0aGUgZ2xvYmFsIHZhbHVlcyBmcm9tIGNoYXJ0cy9pbnN0YWxsLnZ1ZSBhZGRHbG9iYWxWYWx1ZXNUbygpCiAgICAgIGlmICgKICAgICAgICBzZWxlY3RvciAmJgogICAgICAgIGlzRW1wdHkoc2VsZWN0b3IubWF0Y2hFeHByZXNzaW9ucykgJiYKICAgICAgICBpc0VtcHR5KHNlbGVjdG9yLm1hdGNoTGFiZWxzKQogICAgICApIHsKICAgICAgICBkZWxldGUgdGhpcy52YWx1ZS5wcm9tZXRoZXVzLnByb21ldGhldXNTcGVjLnN0b3JhZ2VTcGVjCiAgICAgICAgICAudm9sdW1lQ2xhaW1UZW1wbGF0ZS5zcGVjLnNlbGVjdG9yOwogICAgICB9CiAgICB9LAoKICAgIG1lcmdlVmFsdWUodmFsdWUsIGRlZmF1bHRWYWx1ZSkgewogICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCB8fCAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiAhdmFsdWUubGVuZ3RoKSA/IGRlZmF1bHRWYWx1ZSA6IHZhbHVlOwogICAgfQogIH0sCn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/@rancher/shell/chart/monitoring","sourcesContent":["<script>\nimport isEmpty from 'lodash/isEmpty';\nimport merge from 'lodash/merge';\n\nimport { mapGetters } from 'vuex';\n\nimport Alerting from '@shell/chart/monitoring/alerting';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport ClusterSelector from '@shell/chart/monitoring/ClusterSelector';\nimport Grafana from '@shell/chart/monitoring/grafana';\nimport { LabeledInput } from '@components/Form/LabeledInput';\nimport Loading from '@shell/components/Loading';\nimport Prometheus from '@shell/chart/monitoring/prometheus';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport ChartPsp from '@shell/components/ChartPsp';\n\nimport { allHash } from '@shell/utils/promise';\nimport { STORAGE_CLASS, PVC, SECRET, WORKLOAD_TYPES } from '@shell/config/types';\n\nexport default {\n  components: {\n    Alerting,\n    Checkbox,\n    ClusterSelector,\n    Grafana,\n    LabeledInput,\n    Loading,\n    Prometheus,\n    Tab,\n    ChartPsp\n  },\n\n  hasTabs: true,\n\n  props: {\n    chart: {\n      type:    Object,\n      default: () => ({}),\n    },\n\n    mode: {\n      type:    String,\n      default: 'create',\n    },\n\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      },\n    },\n  },\n\n  async fetch() {\n    const { $store } = this;\n\n    const hash = await allHash({\n      namespaces:     $store.getters['namespaces'](),\n      pvcs:           $store.dispatch('cluster/findAll', { type: PVC }),\n      secrets:        $store.dispatch('cluster/findAll', { type: SECRET }),\n      storageClasses: $store.dispatch('cluster/findAll', { type: STORAGE_CLASS }),\n    });\n\n    await Promise.all(\n      Object.values(WORKLOAD_TYPES).map((type) => this.$store.dispatch('cluster/findAll', { type })\n      )\n    );\n\n    this.targetNamespace = hash.namespaces[this.chart.targetNamespace] || false;\n\n    if (!isEmpty(hash.storageClasses)) {\n      this.storageClasses = hash.storageClasses;\n    }\n\n    if (!isEmpty(hash.pvcs)) {\n      this.pvcs = hash.pvcs;\n    }\n\n    if (!isEmpty(hash.secrets)) {\n      this.secrets = hash.secrets;\n    }\n  },\n\n  data() {\n    return {\n      accessModes: [\n        {\n          id:    'ReadWriteOnce',\n          label: 'monitoring.accessModes.once',\n        },\n        {\n          id:    'ReadOnlyMany',\n          label: 'monitoring.accessModes.readOnlyMany',\n        },\n        {\n          id:    'ReadWriteMany',\n          label: 'monitoring.accessModes.many',\n        },\n      ],\n      clusterType:           {},\n      disableAggregateRoles: false,\n      prometheusResources:   [],\n      pvcs:                  [],\n      secrets:               [],\n      storageClasses:        [],\n      targetNamespace:       null,\n    };\n  },\n\n  computed: {\n    ...mapGetters(['currentCluster']),\n    provider() {\n      return this.currentCluster.status.provider.toLowerCase();\n    },\n    workloads() {\n      return Object.values(WORKLOAD_TYPES).flatMap((type) => this.$store.getters['cluster/all'](type)\n      );\n    },\n  },\n\n  watch: {\n    'value.global.rbac.userRoles.create'(createUserRoles) {\n      if (createUserRoles) {\n        this.disableAggregateRoles = false;\n      } else {\n        this.value.global.rbac.userRoles.aggregateToDefaultRoles = false;\n        this.disableAggregateRoles = true;\n      }\n    },\n  },\n\n  created() {\n    if (this.mode === 'create') {\n      // merge here doesn't work (existing values are lost when going from form to yaml and back again) so instead supply some better default values\n      // any changes here need to respect the order of properties (reflected in the yaml diff)\n      const extendedDefaults = {\n        global: {\n          rbac: {\n            userRoles: {\n              create:                  this.mergeValue(this.value?.global?.rbac?.userRoles?.create, true),\n              aggregateToDefaultRoles: this.mergeValue(this.value?.global?.rbac?.userRoles?.aggregateToDefaultRoles, true),\n            },\n          },\n        },\n        prometheus: {\n          prometheusSpec: {\n            scrapeInterval:     this.mergeValue(this.value?.prometheus?.prometheusSpec?.scrapeInterval, '1m'),\n            evaluationInterval: this.mergeValue(this.value?.prometheus?.prometheusSpec?.evaluationInterval, '1m'),\n            retention:          this.mergeValue(this.value?.prometheus?.prometheusSpec?.retention, '10d'),\n            retentionSize:      this.mergeValue(this.value?.prometheus?.prometheusSpec?.retentionSize, '50GiB'),\n            enableAdminAPI:     this.mergeValue(this.value?.prometheus?.prometheusSpec?.enableAdminAPI, false),\n          },\n        },\n      };\n\n      merge(this.value, extendedDefaults);\n\n      if (this.provider.startsWith('rke2')) {\n        this.$set(this.value.rke2IngressNginx, 'enabled', true);\n        this.$set(this.value.rke2Etcd, 'enabled', true);\n        this.$set(this.value.rkeEtcd, 'enabled', false);\n      } else if (this.provider.startsWith('rke')) {\n        this.$set(this.value, 'ingressNginx', this.value.ingressNginx || {});\n        this.$set(this.value.ingressNginx, 'enabled', true);\n      } else {\n        this.$set(this.value.rkeEtcd, 'enabled', false);\n      }\n    }\n\n    this.$emit('register-before-hook', this.willSave, 'willSave');\n  },\n\n  methods: {\n    willSave() {\n      const { prometheusSpec } = this.value.prometheus;\n      const selector =\n        prometheusSpec?.storageSpec?.volumeClaimTemplate?.spec?.selector;\n\n      // This works for UI editor installation\n      // However, it doesn't work for yaml editor installation\n      // Global values later merged again in charts/install.vue addGlobalValuesTo()\n      // We still need to remove the global values from charts/install.vue addGlobalValuesTo()\n      if (\n        selector &&\n        isEmpty(selector.matchExpressions) &&\n        isEmpty(selector.matchLabels)\n      ) {\n        delete this.value.prometheus.prometheusSpec.storageSpec\n          .volumeClaimTemplate.spec.selector;\n      }\n    },\n\n    mergeValue(value, defaultValue) {\n      return value === undefined || (typeof value === 'string' && !value.length) ? defaultValue : value;\n    }\n  },\n};\n</script>\n\n<template>\n  <Loading\n    v-if=\"$fetchState.pending\"\n    mode=\"relative\"\n  />\n  <div\n    v-else\n    class=\"config-monitoring-container\"\n  >\n    <Tab\n      name=\"general\"\n      :label=\"t('monitoring.tabs.general')\"\n      :weight=\"99\"\n    >\n      <div>\n        <div class=\"row mb-20\">\n          <div class=\"col span-6\">\n            <ClusterSelector\n              :value=\"value\"\n              :mode=\"mode\"\n              @onClusterTypeChanged=\"clusterType = $event\"\n            />\n          </div>\n        </div>\n        <div\n          v-if=\"clusterType.group === 'managed'\"\n          class=\"row mb-20\"\n        >\n          <Checkbox\n            v-model=\"value.prometheusOperator.hostNetwork\"\n            label-key=\"monitoring.hostNetwork.label\"\n            :tooltip=\"t('monitoring.hostNetwork.tip', {}, true)\"\n          />\n        </div>\n        <div class=\"row\">\n          <div class=\"col span-6\">\n            <Checkbox\n              v-model=\"value.global.rbac.userRoles.create\"\n              label-key=\"monitoring.createDefaultRoles.label\"\n              :tooltip=\"t('monitoring.createDefaultRoles.tip', {}, true)\"\n            />\n          </div>\n          <div class=\"col span-6\">\n            <Checkbox\n              v-model=\"value.global.rbac.userRoles.aggregateToDefaultRoles\"\n              label-key=\"monitoring.aggregateDefaultRoles.label\"\n              :tooltip=\"{\n                content: t('monitoring.aggregateDefaultRoles.tip', {}, true),\n                autoHide: false,\n              }\"\n              :disabled=\"disableAggregateRoles\"\n            />\n          </div>\n        </div>\n        <div\n          v-if=\"provider === 'rke' && value.rkeEtcd\"\n          class=\"row mt-20\"\n        >\n          <div class=\"col span-6\">\n            <LabeledInput\n              v-model=\"value.rkeEtcd.clients.https.certDir\"\n              :label=\"t('monitoring.etcdNodeDirectory.label')\"\n              :tooltip=\"t('monitoring.etcdNodeDirectory.tooltip', {}, true)\"\n              :hover-tooltip=\"true\"\n              :mode=\"mode\"\n            />\n          </div>\n        </div>\n\n        <!-- Conditionally display PSP checkbox -->\n        <ChartPsp\n          :value=\"value\"\n          :cluster=\"currentCluster\"\n        />\n      </div>\n    </Tab>\n    <Tab\n      name=\"prometheus\"\n      :label=\"t('monitoring.tabs.prometheus')\"\n      :weight=\"98\"\n    >\n      <div>\n        <Prometheus\n          v-model=\"value\"\n          v-bind=\"$attrs\"\n          :access-modes=\"accessModes\"\n          :mode=\"mode\"\n          :storage-classes=\"storageClasses\"\n          :prometheus-pods=\"prometheusResources\"\n          :workloads=\"workloads\"\n        />\n      </div>\n    </Tab>\n    <Tab\n      name=\"alerting\"\n      :label=\"t('monitoring.tabs.alerting')\"\n      :weight=\"97\"\n    >\n      <div>\n        <Alerting\n          v-model=\"value\"\n          :mode=\"mode\"\n          :secrets=\"secrets\"\n        />\n      </div>\n    </Tab>\n    <Tab\n      name=\"grafana\"\n      :label=\"t('monitoring.tabs.grafana')\"\n      :weight=\"96\"\n    >\n      <div>\n        <Grafana\n          v-model=\"value\"\n          :access-modes=\"accessModes\"\n          :mode=\"mode\"\n          :pvcs=\"pvcs\"\n          :storage-classes=\"storageClasses\"\n        />\n      </div>\n    </Tab>\n  </div>\n</template>\n"]}]}