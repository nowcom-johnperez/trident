{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/cis.cattle.io.clusterscan.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/cis.cattle.io.clusterscan.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBEYXRlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm1hdHRlci9EYXRlJzsKaW1wb3J0IFNvcnRhYmxlVGFibGUgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvU29ydGFibGVUYWJsZSc7CmltcG9ydCB7IEJhbm5lciB9IGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lcic7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCBMb2FkaW5nIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0xvYWRpbmcnOwppbXBvcnQgZGF5IGZyb20gJ2RheWpzJzsKaW1wb3J0IHsgREFURV9GT1JNQVQsIFRJTUVfRk9STUFUIH0gZnJvbSAnQHNoZWxsL3N0b3JlL3ByZWZzJzsKaW1wb3J0IHsgZXNjYXBlSHRtbCwgcmFuZG9tU3RyIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IENJUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBTVEFURSB9IGZyb20gJ0BzaGVsbC9jb25maWcvdGFibGUtaGVhZGVycyc7CmltcG9ydCB7IGdldCB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIERhdGUsCiAgICBTb3J0YWJsZVRhYmxlLAogICAgQmFubmVyLAogICAgTGFiZWxlZFNlbGVjdCwKICAgIExvYWRpbmcsCiAgfSwKCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfQogIH0sCgogIGFzeW5jIGZldGNoKCkgewogICAgdGhpcy5jbHVzdGVyUmVwb3J0cyA9IGF3YWl0IHRoaXMudmFsdWUuZ2V0UmVwb3J0cygpOwogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4geyBjbHVzdGVyUmVwb3J0czogW10sIGNsdXN0ZXJSZXBvcnQ6IG51bGwgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgcGFyc2VkUmVwb3J0KCkgewogICAgICByZXR1cm4gdGhpcy5jbHVzdGVyUmVwb3J0Py5wYXJzZWRSZXBvcnQgfHwgbnVsbDsKICAgIH0sCgogICAgY2FuQmVTY2hlZHVsZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNhbkJlU2NoZWR1bGVkKCk7CiAgICB9LAoKICAgIHJlcG9ydE5vZGVzKCkgewogICAgICByZXR1cm4gdGhpcy5jbHVzdGVyUmVwb3J0Py5ub2RlcyB8fCBudWxsOwogICAgfSwKCiAgICByZXN1bHRzKCkgewogICAgICBpZiAoIXRoaXMuY2x1c3RlclJlcG9ydCB8fCAhdGhpcy5jbHVzdGVyUmVwb3J0LmFnZ3JlZ2F0ZWRUZXN0cykgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRoaXMuY2x1c3RlclJlcG9ydC5hZ2dyZWdhdGVkVGVzdHMubWFwKChjaGVjaykgPT4gewogICAgICAgIGNoZWNrLnRlc3RTdGF0ZVNvcnQgPSB0aGlzLnRlc3RTdGF0ZVNvcnQoY2hlY2suc3RhdGUpOwogICAgICAgIGNoZWNrLnRlc3RJZFNvcnQgPSB0aGlzLnRlc3RJZFNvcnQoY2hlY2spOwogICAgICAgIGlmICghIWNoZWNrLm5vZGVfdHlwZSkgewogICAgICAgICAgY29uc3Qgbm9kZVJvd3MgPSBjaGVjay5ub2RlX3R5cGUucmVkdWNlKChub2RlcywgdHlwZSkgPT4gewogICAgICAgICAgICBpZiAodGhpcy5yZXBvcnROb2Rlc1t0eXBlXSkgewogICAgICAgICAgICAgIHRoaXMucmVwb3J0Tm9kZXNbdHlwZV0uZm9yRWFjaCgobmFtZSkgPT4gbm9kZXMucHVzaCh7CiAgICAgICAgICAgICAgICB0eXBlLCBuYW1lLCBpZDogcmFuZG9tU3RyKDQpLCBzdGF0ZTogdGhpcy5ub2RlU3RhdGUoY2hlY2ssIG5hbWUsIGNoZWNrLm5vZGVzKSwgdGVzdFN0YXRlU29ydDogdGhpcy50ZXN0U3RhdGVTb3J0KHRoaXMubm9kZVN0YXRlKGNoZWNrLCBuYW1lLCBjaGVjay5ub2RlcykpCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gbm9kZXM7CiAgICAgICAgICB9LCBbXSk7CgogICAgICAgICAgY2hlY2subm9kZVJvd3MgPSBub2RlUm93czsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjaGVjazsKICAgICAgfSk7CiAgICB9LAoKICAgIGRldGFpbHMoKSB7CiAgICAgIGlmICghdGhpcy5wYXJzZWRSZXBvcnQpIHsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0KCiAgICAgIGNvbnN0IG91dCA9IFsKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdjaXMucHJvZmlsZScpLAogICAgICAgICAgdmFsdWU6IHRoaXMudmFsdWUuc3RhdHVzLmxhc3RSdW5TY2FuUHJvZmlsZU5hbWUsCiAgICAgICAgICB0bzogICAgewogICAgICAgICAgICBuYW1lOiAgICdjLWNsdXN0ZXItcHJvZHVjdC1yZXNvdXJjZS1pZCcsCiAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgIC4uLnRoaXMuJHJvdXRlLnBhcmFtcywKICAgICAgICAgICAgICByZXNvdXJjZTogQ0lTLkNMVVNURVJfU0NBTl9QUk9GSUxFLAogICAgICAgICAgICAgIGlkOiAgICAgICB0aGlzLnZhbHVlLnN0YXR1cy5sYXN0UnVuU2NhblByb2ZpbGVOYW1lCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ2Npcy5zY2FuLnRvdGFsJyksCiAgICAgICAgICB2YWx1ZTogdGhpcy5wYXJzZWRSZXBvcnQudG90YWwKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ2Npcy5zY2FuLnBhc3MnKSwKICAgICAgICAgIHZhbHVlOiB0aGlzLnBhcnNlZFJlcG9ydC5wYXNzCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdjaXMuc2Nhbi53YXJuJyksCiAgICAgICAgICB2YWx1ZTogdGhpcy5wYXJzZWRSZXBvcnQud2FybgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6IHRoaXMudCgnY2lzLnNjYW4uc2tpcCcpLAogICAgICAgICAgdmFsdWU6IHRoaXMucGFyc2VkUmVwb3J0LnNraXAKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ2Npcy5zY2FuLmZhaWwnKSwKICAgICAgICAgIHZhbHVlOiB0aGlzLnBhcnNlZFJlcG9ydC5mYWlsCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBsYWJlbDogdGhpcy50KCdjaXMuc2Nhbi5ub3RBcHBsaWNhYmxlJyksCiAgICAgICAgICB2YWx1ZTogdGhpcy5wYXJzZWRSZXBvcnQubm90QXBwbGljYWJsZQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6ICAgICB0aGlzLmNhbkJlU2NoZWR1bGVkID8gdGhpcy50KCdjaXMuc2Nhbi5sYXN0U2NhblRpbWUnKSA6IHRoaXMudCgnY2lzLnNjYW4uc2NhbkRhdGUnKSwKICAgICAgICAgIHZhbHVlOiAgICAgdGhpcy52YWx1ZS5zdGF0dXMubGFzdFJ1blRpbWVzdGFtcCwKICAgICAgICAgIGNvbXBvbmVudDogJ0RhdGUnCiAgICAgICAgfSwKICAgICAgXTsKCiAgICAgIGlmICghdGhpcy5jYW5CZVNjaGVkdWxlZCkgewogICAgICAgIHJldHVybiBvdXQuZmlsdGVyKChlYWNoKSA9PiBlYWNoLmxhYmVsICE9PSB0aGlzLnQoJ2Npcy5zY2FuLndhcm4nKSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBvdXQ7CiAgICB9LAoKICAgIHJlcG9ydENoZWNrSGVhZGVycygpIHsKICAgICAgcmV0dXJuIFsKICAgICAgICB7CiAgICAgICAgICAuLi5TVEFURSwKICAgICAgICAgIHZhbHVlOiAgICAgICAgICdzdGF0ZScsCiAgICAgICAgICBmb3JtYXR0ZXJPcHRzOiB7IGFyYml0cmFyeTogdHJ1ZSB9LAogICAgICAgICAgc29ydDogICAgICAgICAgWyd0ZXN0U3RhdGVTb3J0JywgJ3Rlc3RJZFNvcnQnXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogICdudW1iZXInLAogICAgICAgICAgbGFiZWw6IHRoaXMudCgnY2lzLnNjYW4ubnVtYmVyJyksCiAgICAgICAgICB2YWx1ZTogJ2lkJywKICAgICAgICAgIHNvcnQ6ICAndGVzdElkU29ydCcsCiAgICAgICAgICB3aWR0aDogMTAwCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICBuYW1lOiAgJ2Rlc2NyaXB0aW9uJywKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ2Npcy5zY2FuLmRlc2NyaXB0aW9uJyksCiAgICAgICAgICB2YWx1ZTogJ2Rlc2NyaXB0aW9uJywKICAgICAgICB9CiAgICAgIF07CiAgICB9LAoKICAgIG5vZGVUYWJsZUhlYWRlcnMoKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgewogICAgICAgICAgLi4uU1RBVEUsCiAgICAgICAgICB2YWx1ZTogICAgICAgICAnc3RhdGUnLAogICAgICAgICAgZm9ybWF0dGVyT3B0czogeyBhcmJpdHJhcnk6IHRydWUgfSwKICAgICAgICAgIHNvcnQ6ICAgICAgICAgICd0ZXN0U3RhdGVTb3J0JwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogICdub2RlJywKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ3RhYmxlSGVhZGVycy5uYW1lJyksCiAgICAgICAgICB2YWx1ZTogJ25hbWUnLAogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbmFtZTogICd0eXBlJywKICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ3RhYmxlSGVhZGVycy50eXBlJyksCiAgICAgICAgICB2YWx1ZTogJ3R5cGUnLAogICAgICAgIH0sCiAgICAgIF07CiAgICB9LAogIH0sCgogIHdhdGNoOiB7CiAgICB2YWx1ZShuZXUpIHsKICAgICAgdHJ5IHsKICAgICAgICBuZXUuZ2V0UmVwb3J0cygpLnRoZW4oKHJlcG9ydHMpID0+IHsKICAgICAgICAgIHRoaXMuY2x1c3RlclJlcG9ydHMgPSByZXBvcnRzOwogICAgICAgIH0pOwogICAgICB9IGNhdGNoIHt9CiAgICB9LAoKICAgIGNsdXN0ZXJSZXBvcnRzKG5ldSkgewogICAgICBpZiAoIXRoaXMuY2x1c3RlclJlcG9ydCkgewogICAgICAgIHRoaXMuY2x1c3RlclJlcG9ydCA9IG5ldVswXTsKICAgICAgfQogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHJlcG9ydExhYmVsKHJlcG9ydCA9IHt9KSB7CiAgICAgIGNvbnN0IHsgY3JlYXRpb25UaW1lc3RhbXAgfSA9IHJlcG9ydC5tZXRhZGF0YTsKICAgICAgY29uc3QgZGF0ZUZvcm1hdCA9IGVzY2FwZUh0bWwoIHRoaXMuJHN0b3JlLmdldHRlcnNbJ3ByZWZzL2dldCddKERBVEVfRk9STUFUKSk7CiAgICAgIGNvbnN0IHRpbWVGb3JtYXQgPSBlc2NhcGVIdG1sKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydwcmVmcy9nZXQnXShUSU1FX0ZPUk1BVCkpOwoKICAgICAgY29uc3QgbmFtZSA9IHJlcG9ydC5pZC5yZXBsYWNlKC9ec2Nhbi1yZXBvcnQtLywgJycpOwoKICAgICAgcmV0dXJuIGAkeyBuYW1lIH0gJHsgZGF5KGNyZWF0aW9uVGltZXN0YW1wKS5mb3JtYXQoYCR7IGRhdGVGb3JtYXQgfSAkeyB0aW1lRm9ybWF0IH1gKSB9YDsKICAgIH0sCgogICAgbm9kZVN0YXRlKGNoZWNrLCBub2RlLCBub2RlcyA9IFtdKSB7CiAgICAgIGlmIChjaGVjay5zdGF0ZSA9PT0gJ21peGVkJykgewogICAgICAgIHJldHVybiBub2Rlcy5pbmNsdWRlcyhub2RlKSA/ICdmYWlsJyA6ICdwYXNzJzsKICAgICAgfQoKICAgICAgcmV0dXJuIGNoZWNrLnN0YXRlOwogICAgfSwKCiAgICB0ZXN0U3RhdGVTb3J0KHN0YXRlKSB7CiAgICAgIGNvbnN0IFNPUlRfT1JERVIgPSB7CiAgICAgICAgb3RoZXI6ICAgICAgICAgNywKICAgICAgICBub3RBcHBsaWNhYmxlOiA2LAogICAgICAgIHNraXA6ICAgICAgICAgIDUsCiAgICAgICAgcGFzczogICAgICAgICAgNCwKICAgICAgICB3YXJuOiAgICAgICAgICAzLAogICAgICAgIG1peGVkOiAgICAgICAgIDIsCiAgICAgICAgZmFpbDogICAgICAgICAgMSwKICAgICAgfTsKCiAgICAgIHJldHVybiBgJHsgU09SVF9PUkRFUltzdGF0ZV0gfHwgU09SVF9PUkRFUlsnb3RoZXInXSB9ICR7IHN0YXRlIH1gOwogICAgfSwKCiAgICB0ZXN0SWRTb3J0KHRlc3QpIHsKICAgICAgY29uc3QgeyBpZCA9ICcnIH0gPSB0ZXN0OwoKICAgICAgcmV0dXJuIGlkLnNwbGl0KCcuJykubWFwKChuKSA9PiArbiArIDEwMDApLmpvaW4oJy4nKTsKICAgIH0sCgogICAgcmVtZWRpYXRpb25EaXNwbGF5KHJvdykgewogICAgICBjb25zdCB7IHJlbWVkaWF0aW9uIH0gPSByb3c7CgogICAgICBpZiAoIXJlbWVkaWF0aW9uKSB7CgogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBgJHsgdGhpcy50KCdjaXMuc2Nhbi5yZW1lZGlhdGlvbicpIH06ICR7IHJlbWVkaWF0aW9uIH1gOwogICAgICB9CiAgICB9LAogICAgZ2V0CiAgfQp9Owo="},{"version":3,"sources":["cis.cattle.io.clusterscan.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"cis.cattle.io.clusterscan.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport Date from '@shell/components/formatter/Date';\nimport SortableTable from '@shell/components/SortableTable';\nimport { Banner } from '@components/Banner';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport Loading from '@shell/components/Loading';\nimport day from 'dayjs';\nimport { DATE_FORMAT, TIME_FORMAT } from '@shell/store/prefs';\nimport { escapeHtml, randomStr } from '@shell/utils/string';\nimport { CIS } from '@shell/config/types';\nimport { STATE } from '@shell/config/table-headers';\nimport { get } from '@shell/utils/object';\n\nexport default {\n  components: {\n    Date,\n    SortableTable,\n    Banner,\n    LabeledSelect,\n    Loading,\n  },\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  async fetch() {\n    this.clusterReports = await this.value.getReports();\n  },\n\n  data() {\n    return { clusterReports: [], clusterReport: null };\n  },\n\n  computed: {\n    parsedReport() {\n      return this.clusterReport?.parsedReport || null;\n    },\n\n    canBeScheduled() {\n      return this.value.canBeScheduled();\n    },\n\n    reportNodes() {\n      return this.clusterReport?.nodes || null;\n    },\n\n    results() {\n      if (!this.clusterReport || !this.clusterReport.aggregatedTests) {\n        return [];\n      }\n\n      return this.clusterReport.aggregatedTests.map((check) => {\n        check.testStateSort = this.testStateSort(check.state);\n        check.testIdSort = this.testIdSort(check);\n        if (!!check.node_type) {\n          const nodeRows = check.node_type.reduce((nodes, type) => {\n            if (this.reportNodes[type]) {\n              this.reportNodes[type].forEach((name) => nodes.push({\n                type, name, id: randomStr(4), state: this.nodeState(check, name, check.nodes), testStateSort: this.testStateSort(this.nodeState(check, name, check.nodes))\n              })\n              );\n            }\n\n            return nodes;\n          }, []);\n\n          check.nodeRows = nodeRows;\n        }\n\n        return check;\n      });\n    },\n\n    details() {\n      if (!this.parsedReport) {\n        return [];\n      }\n\n      const out = [\n        {\n          label: this.t('cis.profile'),\n          value: this.value.status.lastRunScanProfileName,\n          to:    {\n            name:   'c-cluster-product-resource-id',\n            params: {\n              ...this.$route.params,\n              resource: CIS.CLUSTER_SCAN_PROFILE,\n              id:       this.value.status.lastRunScanProfileName\n            }\n          }\n        },\n        {\n          label: this.t('cis.scan.total'),\n          value: this.parsedReport.total\n        },\n        {\n          label: this.t('cis.scan.pass'),\n          value: this.parsedReport.pass\n        },\n        {\n          label: this.t('cis.scan.warn'),\n          value: this.parsedReport.warn\n        },\n        {\n          label: this.t('cis.scan.skip'),\n          value: this.parsedReport.skip\n        },\n        {\n          label: this.t('cis.scan.fail'),\n          value: this.parsedReport.fail\n        },\n        {\n          label: this.t('cis.scan.notApplicable'),\n          value: this.parsedReport.notApplicable\n        },\n        {\n          label:     this.canBeScheduled ? this.t('cis.scan.lastScanTime') : this.t('cis.scan.scanDate'),\n          value:     this.value.status.lastRunTimestamp,\n          component: 'Date'\n        },\n      ];\n\n      if (!this.canBeScheduled) {\n        return out.filter((each) => each.label !== this.t('cis.scan.warn'));\n      }\n\n      return out;\n    },\n\n    reportCheckHeaders() {\n      return [\n        {\n          ...STATE,\n          value:         'state',\n          formatterOpts: { arbitrary: true },\n          sort:          ['testStateSort', 'testIdSort']\n        },\n        {\n          name:  'number',\n          label: this.t('cis.scan.number'),\n          value: 'id',\n          sort:  'testIdSort',\n          width: 100\n        },\n        {\n          name:  'description',\n          label: this.t('cis.scan.description'),\n          value: 'description',\n        }\n      ];\n    },\n\n    nodeTableHeaders() {\n      return [\n        {\n          ...STATE,\n          value:         'state',\n          formatterOpts: { arbitrary: true },\n          sort:          'testStateSort'\n        },\n        {\n          name:  'node',\n          label: this.t('tableHeaders.name'),\n          value: 'name',\n        },\n        {\n          name:  'type',\n          label: this.t('tableHeaders.type'),\n          value: 'type',\n        },\n      ];\n    },\n  },\n\n  watch: {\n    value(neu) {\n      try {\n        neu.getReports().then((reports) => {\n          this.clusterReports = reports;\n        });\n      } catch {}\n    },\n\n    clusterReports(neu) {\n      if (!this.clusterReport) {\n        this.clusterReport = neu[0];\n      }\n    }\n  },\n\n  methods: {\n    reportLabel(report = {}) {\n      const { creationTimestamp } = report.metadata;\n      const dateFormat = escapeHtml( this.$store.getters['prefs/get'](DATE_FORMAT));\n      const timeFormat = escapeHtml( this.$store.getters['prefs/get'](TIME_FORMAT));\n\n      const name = report.id.replace(/^scan-report-/, '');\n\n      return `${ name } ${ day(creationTimestamp).format(`${ dateFormat } ${ timeFormat }`) }`;\n    },\n\n    nodeState(check, node, nodes = []) {\n      if (check.state === 'mixed') {\n        return nodes.includes(node) ? 'fail' : 'pass';\n      }\n\n      return check.state;\n    },\n\n    testStateSort(state) {\n      const SORT_ORDER = {\n        other:         7,\n        notApplicable: 6,\n        skip:          5,\n        pass:          4,\n        warn:          3,\n        mixed:         2,\n        fail:          1,\n      };\n\n      return `${ SORT_ORDER[state] || SORT_ORDER['other'] } ${ state }`;\n    },\n\n    testIdSort(test) {\n      const { id = '' } = test;\n\n      return id.split('.').map((n) => +n + 1000).join('.');\n    },\n\n    remediationDisplay(row) {\n      const { remediation } = row;\n\n      if (!remediation) {\n\n      } else {\n        return `${ this.t('cis.scan.remediation') }: ${ remediation }`;\n      }\n    },\n    get\n  }\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <div class=\"detail mb-20\">\n      <div\n        v-for=\"item in details\"\n        :key=\"item.label\"\n      >\n        <span class=\"text-label\">{{ item.label }}</span>:\n        <component\n          :is=\"item.component\"\n          v-if=\"item.component\"\n          :value=\"item.value\"\n        />\n        <nuxt-link\n          v-else-if=\"item.to\"\n          :to=\"item.to\"\n        >\n          {{ item.value }}\n        </nuxt-link>\n        <span v-else>{{ item.value }}</span>\n      </div>\n    </div>\n    <div\n      v-if=\"clusterReports.length > 1\"\n      class=\"table-header row mb-20\"\n    >\n      <div class=\"col span-8\">\n        <h3>\n          {{ t('cis.scan.scanReport') }}\n        </h3>\n      </div>\n      <div class=\"col span-4\">\n        <LabeledSelect\n          v-model=\"clusterReport\"\n          :label=\"t('cis.reports')\"\n          :options=\"clusterReports\"\n          :get-option-label=\"reportLabel\"\n          :get-option-key=\"report=>report.id\"\n        />\n      </div>\n    </div>\n    <div v-if=\"results && !!get(value, 'status.summary')\">\n      <SortableTable\n        no-rows-key=\"cis.noReportFound\"\n        default-sort-by=\"state\"\n        :search=\"false\"\n        :row-actions=\"false\"\n        :table-actions=\"false\"\n        :rows=\"results\"\n        :sub-rows=\"true\"\n        :sub-expandable=\"true\"\n        :sub-expand-column=\"true\"\n        :headers=\"reportCheckHeaders\"\n        key-field=\"id\"\n      >\n        <template #sub-row=\"{row, fullColspan, onRowMouseEnter, onRowMouseLeave}\">\n          <tr\n            class=\"sub-row\"\n            @mouseenter=\"onRowMouseEnter\"\n            @mouseleave=\"onRowMouseLeave\"\n          >\n            <td :colspan=\"fullColspan\">\n              <Banner\n                v-if=\"(row.state==='fail' || row.state==='warn')&& row.remediation\"\n                class=\"sub-banner\"\n                :label=\"remediationDisplay(row)\"\n                color=\"warning\"\n              />\n              <SortableTable\n                class=\"sub-table\"\n                :rows=\"row.nodeRows\"\n                :headers=\"nodeTableHeaders\"\n                :search=\"false\"\n                :row-actions=\"false\"\n                :table-actions=\"false\"\n                key-field=\"id\"\n              />\n            </td>\n          </tr>\n        </template>\n      </SortableTable>\n    </div>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n.detail {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 10px;\n    border-bottom: 1px solid var(--border);\n\n    & .div {\n        padding: 0px 10px 0px 10px;\n    }\n}\n\n.sub-table {\n  padding: 0px 40px 0px 40px;\n}\n\n.sub-banner{\n  margin: 0px 40px 0px 40px;\n  width: auto;\n}\n\n.table-header {\n  align-items: flex-end;\n}\n</style>\n"]}]}