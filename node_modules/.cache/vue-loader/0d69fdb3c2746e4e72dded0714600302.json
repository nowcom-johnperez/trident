{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/ResourceQuota/NamespaceRow.vue?vue&type=style&index=0&id=2b81bebc&lang=scss&scoped=true","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/ResourceQuota/NamespaceRow.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1716430467357},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/postcss-loader/src/index.js","mtime":1716430467882},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/sass-loader/dist/cjs.js","mtime":1716430453705},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5yZXNvdXJjZS1hdmFpbGFiaWxpdHkgewogIGFsaWduLXNlbGY6IGNlbnRlcjsKfQoucm93IHsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiByb3c7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1ldmVubHk7CgogICYgPiAqIHsKICAgIHdpZHRoOiAxMDAlOwogIH0KfQo="},{"version":3,"sources":["NamespaceRow.vue"],"names":[],"mappings":";AA2NA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"NamespaceRow.vue","sourceRoot":"node_modules/@rancher/shell/components/form/ResourceQuota","sourcesContent":["<script>\nimport Select from '@shell/components/form/Select';\nimport UnitInput from '@shell/components/form/UnitInput';\nimport PercentageBar from '@shell/components/PercentageBar';\nimport { formatSi, parseSi } from '@shell/utils/units';\nimport { ROW_COMPUTED } from './shared';\n\nexport default {\n  components: {\n    Select, PercentageBar, UnitInput\n  },\n\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n    types: {\n      type:    Array,\n      default: () => []\n    },\n    type: {\n      type:     String,\n      required: true\n    },\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    namespace: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    projectResourceQuotaLimits: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    },\n    namespaceResourceQuotaLimits: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    defaultResourceQuotaLimits: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  mounted() {\n    // We want to update the value first so that the value will be rounded to the project limit.\n    // This is relevant when switching projects. If the value is 1200 and the project that it was\n    // switched to only has capacity for 800 more this will force the value to be set to 800.\n    if (this.value?.limit?.[this.type]) {\n      this.update(this.value.limit[this.type]);\n    }\n\n    if (!this.value?.limit?.[this.type]) {\n      this.update(this.defaultResourceQuotaLimits[this.type]);\n    }\n  },\n\n  computed: {\n    ...ROW_COMPUTED,\n    limitValue() {\n      return parseSi(this.projectResourceQuotaLimits[this.type]);\n    },\n    siOptions() {\n      return {\n        maxExponent: this.typeOption.inputExponent,\n        minExponent: this.typeOption.inputExponent,\n        increment:   this.typeOption.increment,\n        suffix:      this.typeOption.increment === 1024 ? 'i' : ''\n      };\n    },\n    namespaceLimits() {\n      return this.namespaceResourceQuotaLimits\n        .filter((resourceQuota) => resourceQuota[this.type] && resourceQuota.id !== this.namespace.id)\n        .map((resourceQuota) => parseSi(resourceQuota[this.type], this.siOptions));\n    },\n    namespaceContribution() {\n      return this.namespaceLimits.reduce((sum, limit) => sum + limit, 0);\n    },\n    totalContribution() {\n      return this.namespaceContribution + parseSi(this.value.limit[this.type] || '0', this.siOptions);\n    },\n    percentageUsed() {\n      return Math.min(this.totalContribution * 100 / this.projectLimit, 100);\n    },\n    projectLimit() {\n      return parseSi(this.projectResourceQuotaLimits[this.type] || 0, this.siOptions);\n    },\n    max() {\n      return this.projectLimit - this.namespaceContribution;\n    },\n    availableResourceQuotas() {\n      return formatSi(this.projectLimit - this.totalContribution, { ...this.siOptions, addSuffixSpace: false });\n    },\n    slices() {\n      const out = [];\n\n      this.namespaceLimits.forEach((limit, i) => {\n        const lastValue = i > 0 ? this.namespaceLimits[i - 1] : 0;\n        const sliceTotal = lastValue + limit;\n\n        out.push(sliceTotal * 100 / this.projectLimit);\n      });\n\n      return out;\n    },\n    tooltip() {\n      const t = this.$store.getters['i18n/t'];\n      const out = [\n        {\n          label: t('resourceQuota.tooltip.reserved'),\n          value: formatSi(this.namespaceContribution, { ...this.siOptions, addSuffixSpace: false }),\n        },\n        {\n          label: t('resourceQuota.tooltip.namespace'),\n          value: this.value.limit[this.type]\n        },\n        {\n          label: t('resourceQuota.tooltip.available'),\n          value: this.availableResourceQuotas\n        },\n        {\n          label: t('resourceQuota.tooltip.max'),\n          value: this.projectResourceQuotaLimits[this.type]\n        }\n      ];\n\n      let formattedTooltip = '<div class=\"quota-percentage-tooltip\">';\n\n      (out || []).forEach((v) => {\n        formattedTooltip += `\n        <div style='margin-top: 5px; display: flex; justify-content: space-between;'>\n          ${ v.label }\n          <span style='margin-left: 20px;'>${ v.value }</span>\n        </div>`;\n      });\n      formattedTooltip += '</div>';\n\n      return formattedTooltip;\n    },\n\n  },\n\n  methods: {\n    update(newValue) {\n      const parsedNewValue = parseSi(newValue, this.siOptions) || 0;\n      const min = Math.max(parsedNewValue, 0);\n      const max = Math.min(min, this.max);\n      const value = formatSi(max, {\n        ...this.siOptions,\n        addSuffixSpace: false\n      });\n\n      this.$emit('input', this.type, value);\n    }\n  }\n};\n</script>\n<template>\n  <div\n    v-if=\"typeOption\"\n    class=\"row\"\n  >\n    <Select\n      class=\"mr-10\"\n      :mode=\"mode\"\n      :value=\"type\"\n      :disabled=\"true\"\n      :options=\"types\"\n    />\n    <div class=\"resource-availability mr-10\">\n      <PercentageBar\n        v-clean-tooltip=\"tooltip\"\n        class=\"percentage-bar\"\n        :value=\"percentageUsed\"\n        :slices=\"slices\"\n        :color-stops=\"{'100': '--primary'}\"\n      />\n    </div>\n    <UnitInput\n      :value=\"value.limit[type]\"\n      :mode=\"mode\"\n      :placeholder=\"typeOption.placeholder\"\n      :increment=\"typeOption.increment\"\n      :input-exponent=\"typeOption.inputExponent\"\n      :base-unit=\"typeOption.baseUnit\"\n      :output-modifier=\"true\"\n      @input=\"update\"\n    />\n  </div>\n</template>\n\n<style lang='scss' scoped>\n  .resource-availability {\n    align-self: center;\n  }\n  .row {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-evenly;\n\n    & > * {\n      width: 100%;\n    }\n  }\n</style>\n"]}]}