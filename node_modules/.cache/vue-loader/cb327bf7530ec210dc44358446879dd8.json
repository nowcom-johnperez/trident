{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/formatter/Endpoints.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/formatter/Endpoints.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IE5PREUgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgW0FycmF5LCBTdHJpbmddLAogICAgICBkZWZhdWx0OiBudWxsLAogICAgfSwKICAgIHJvdzogewogICAgICB0eXBlOiAgICAgT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIGNvbDogewogICAgICB0eXBlOiAgICAgT2JqZWN0LAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICB9LAoKICBjb21wdXRlZDogewogICAgbm9kZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzWydjbHVzdGVyL2FsbCddKE5PREUpOwogICAgfSwKICAgIC8vIHZhbHVlIG1heSBiZSBKU09OIGZyb20gImZpZWxkLmNhdHRsZS5pby9wdWJsaWNFbmRwb2ludHMiIGxhYmVsCiAgICBwYXJzZWQoKSB7CiAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5ub2RlczsKICAgICAgY29uc3Qgbm9kZVdpdGhFeHRlcm5hbCA9IG5vZGVzLmZpbmQoKG5vZGUpID0+ICEhbm9kZS5leHRlcm5hbElwKSB8fCB7fTsKICAgICAgY29uc3QgZXh0ZXJuYWxJcCA9IG5vZGVXaXRoRXh0ZXJuYWwuZXh0ZXJuYWxJcDsKCiAgICAgIGlmICggdGhpcy52YWx1ZSAmJiB0aGlzLnZhbHVlLmxlbmd0aCApIHsKICAgICAgICBsZXQgb3V0IDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIG91dCA9IEpTT04ucGFyc2UodGhpcy52YWx1ZSk7CiAgICAgICAgICBvdXQuZm9yRWFjaCgoZW5kcG9pbnQpID0+IHsKICAgICAgICAgICAgbGV0IHByb3RvY29sID0gJ2h0dHAnOwoKICAgICAgICAgICAgaWYgKGVuZHBvaW50LnBvcnQgPT09IDQ0MykgewogICAgICAgICAgICAgIHByb3RvY29sID0gJ2h0dHBzJzsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGVuZHBvaW50LmFkZHJlc3NlcykgewogICAgICAgICAgICAgIGVuZHBvaW50LmxpbmsgPSBgJHsgcHJvdG9jb2wgfTovLyR7IGVuZHBvaW50LmFkZHJlc3Nlc1swXSB9OiR7IGVuZHBvaW50LnBvcnQgfWA7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXh0ZXJuYWxJcCkgewogICAgICAgICAgICAgIGVuZHBvaW50LmxpbmsgPSBgJHsgcHJvdG9jb2wgfTovLyR7IGV4dGVybmFsSXAgfTokeyBlbmRwb2ludC5wb3J0IH1gOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVuZHBvaW50LmRpc3BsYXkgPSBgWyR7IHRoaXMudCgnc2VydmljZXNQYWdlLmFueU5vZGUnKSB9XTokeyBlbmRwb2ludC5wb3J0IH1gOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm4gb3V0OwogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVbMF07CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCgogICAgcHJvdG9jb2woKSB7CiAgICAgIGNvbnN0IHsgcGFyc2VkIH0gPSB0aGlzOwoKICAgICAgaWYgKCBwYXJzZWQpIHsKICAgICAgICBpZiAodGhpcy5wYXJzZWRbMF0ucHJvdG9jb2wpIHsKICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFswXS5wcm90b2NvbDsKICAgICAgICB9CgogICAgICAgIGNvbnN0IG1hdGNoID0gcGFyc2VkLm1hdGNoKC9eKFteOl0rKTpcL1wvLyk7CgogICAgICAgIGlmICggbWF0Y2ggKSB7CiAgICAgICAgICByZXR1cm4gbWF0Y2hbMV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiAnbGluayc7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9LAp9Owo="},{"version":3,"sources":["Endpoints.vue"],"names":[],"mappings":";AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Endpoints.vue","sourceRoot":"node_modules/@rancher/shell/components/formatter","sourcesContent":["<script>\nimport { NODE } from '@shell/config/types';\n\nexport default {\n  props: {\n    value: {\n      type:    [Array, String],\n      default: null,\n    },\n    row: {\n      type:     Object,\n      required: true\n    },\n    col: {\n      type:     Object,\n      required: true\n    },\n  },\n\n  computed: {\n    nodes() {\n      return this.$store.getters['cluster/all'](NODE);\n    },\n    // value may be JSON from \"field.cattle.io/publicEndpoints\" label\n    parsed() {\n      const nodes = this.nodes;\n      const nodeWithExternal = nodes.find((node) => !!node.externalIp) || {};\n      const externalIp = nodeWithExternal.externalIp;\n\n      if ( this.value && this.value.length ) {\n        let out ;\n\n        try {\n          out = JSON.parse(this.value);\n          out.forEach((endpoint) => {\n            let protocol = 'http';\n\n            if (endpoint.port === 443) {\n              protocol = 'https';\n            }\n\n            if (endpoint.addresses) {\n              endpoint.link = `${ protocol }://${ endpoint.addresses[0] }:${ endpoint.port }`;\n            } else if (externalIp) {\n              endpoint.link = `${ protocol }://${ externalIp }:${ endpoint.port }`;\n            } else {\n              endpoint.display = `[${ this.t('servicesPage.anyNode') }]:${ endpoint.port }`;\n            }\n          });\n\n          return out;\n        } catch (err) {\n          return this.value[0];\n        }\n      }\n\n      return null;\n    },\n\n    protocol() {\n      const { parsed } = this;\n\n      if ( parsed) {\n        if (this.parsed[0].protocol) {\n          return this.parsed[0].protocol;\n        }\n\n        const match = parsed.match(/^([^:]+):\\/\\//);\n\n        if ( match ) {\n          return match[1];\n        } else {\n          return 'link';\n        }\n      }\n\n      return null;\n    }\n  },\n};\n</script>\n\n<template>\n  <span>\n    <template v-for=\"(endpoint, index) in parsed\">\n      <span\n        v-if=\"endpoint.display\"\n        :key=\"endpoint.display\"\n        class=\"block\"\n      >{{ endpoint.display }}</span>\n      <a\n        v-else\n        :key=\"index + endpoint.link\"\n        class=\"block\"\n        :href=\"endpoint.link\"\n        target=\"_blank\"\n        rel=\"nofollow noopener noreferrer\"\n      >\n        <span v-if=\"endpoint.port\">{{ endpoint.port }}/</span>{{ endpoint.protocol }}\n      </a>\n    </template>\n  </span>\n</template>\n"]}]}