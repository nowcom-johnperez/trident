{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/Members/ClusterPermissionsEditor.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/Members/ClusterPermissionsEditor.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgQ3JlYXRlRWRpdFZpZXcgZnJvbSAnQHNoZWxsL21peGlucy9jcmVhdGUtZWRpdC12aWV3JzsNCmltcG9ydCBTZWxlY3RQcmluY2lwYWwgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvYXV0aC9TZWxlY3RQcmluY2lwYWwnOw0KaW1wb3J0IHsgTUFOQUdFTUVOVCwgTk9STUFOIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy90eXBlcyc7DQppbXBvcnQgeyBSYWRpb0dyb3VwIH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9SYWRpbyc7DQppbXBvcnQgeyBDYXJkIH0gZnJvbSAnQGNvbXBvbmVudHMvQ2FyZCc7DQppbXBvcnQgTG9hZGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Mb2FkaW5nJzsNCmltcG9ydCB7IENoZWNrYm94IH0gZnJvbSAnQGNvbXBvbmVudHMvRm9ybS9DaGVja2JveCc7DQppbXBvcnQgeyBERVNDUklQVElPTiB9IGZyb20gJ0BzaGVsbC9jb25maWcvbGFiZWxzLWFubm90YXRpb25zJzsNCg0KZXhwb3J0IGZ1bmN0aW9uIGNhblZpZXdDbHVzdGVyUGVybWlzc2lvbnNFZGl0b3Ioc3RvcmUpIHsNCiAgcmV0dXJuICEhc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9zY2hlbWFGb3InXShNQU5BR0VNRU5ULkNMVVNURVJfUk9MRV9URU1QTEFURV9CSU5ESU5HKSAmJg0KICAgICEhc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9zY2hlbWFGb3InXShNQU5BR0VNRU5ULlJPTEVfVEVNUExBVEUpICYmDQogICAgISFzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L3NjaGVtYUZvciddKE1BTkFHRU1FTlQuVVNFUik7DQp9DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgY29tcG9uZW50czogew0KICAgIENhcmQsDQogICAgQ2hlY2tib3gsDQogICAgTG9hZGluZywNCiAgICBSYWRpb0dyb3VwLA0KICAgIFNlbGVjdFByaW5jaXBhbA0KICB9LA0KDQogIG1peGluczogW0NyZWF0ZUVkaXRWaWV3XSwNCg0KICBwcm9wczogew0KICAgIHZhbHVlOiB7DQogICAgICB0eXBlOiAgICAgQXJyYXksDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0sDQoNCiAgICB1c2VUd29Db2x1bW5zRm9yQ3VzdG9tOiB7DQogICAgICB0eXBlOiAgICBCb29sZWFuLA0KICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICB9LA0KDQogICAgY2x1c3Rlck5hbWU6IHsNCiAgICAgIHR5cGU6ICAgIFN0cmluZywNCiAgICAgIGRlZmF1bHQ6IG51bGwNCiAgICB9DQogIH0sDQogIGFzeW5jIGZldGNoKCkgew0KICAgIGNvbnN0IFssIHJvbGVUZW1wbGF0ZXNdID0gYXdhaXQgUHJvbWlzZS5hbGwoWw0KICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsgdHlwZTogTUFOQUdFTUVOVC5VU0VSIH0pLA0KICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsgdHlwZTogTUFOQUdFTUVOVC5ST0xFX1RFTVBMQVRFIH0pDQogICAgXSk7DQoNCiAgICB0aGlzLnJvbGVUZW1wbGF0ZXMgPSByb2xlVGVtcGxhdGVzOw0KICB9LA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBjdXN0b21QZXJtaXNzaW9uczogWw0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbWVtYmVycy5jbHVzdGVyUGVybWlzc2lvbnMuY3JlYXRlUHJvamVjdHMnKSwNCiAgICAgICAgICBrZXk6ICAgJ3Byb2plY3RzLWNyZWF0ZScsDQogICAgICAgICAgdmFsdWU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy5tYW5hZ2VDbHVzdGVyQmFja3VwcycpLA0KICAgICAgICAgIGtleTogICAnYmFja3Vwcy1tYW5hZ2UnLA0KICAgICAgICAgIHZhbHVlOiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbWVtYmVycy5jbHVzdGVyUGVybWlzc2lvbnMubWFuYWdlQ2x1c3RlckNhdGFsb2dzJyksDQogICAgICAgICAga2V5OiAgICdjbHVzdGVyY2F0YWxvZ3MtbWFuYWdlJywNCiAgICAgICAgICB2YWx1ZTogZmFsc2UNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLm1hbmFnZUNsdXN0ZXJNZW1iZXJzJyksDQogICAgICAgICAga2V5OiAgICdjbHVzdGVycm9sZXRlbXBsYXRlYmluZGluZ3MtbWFuYWdlJywNCiAgICAgICAgICB2YWx1ZTogZmFsc2UNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLm1hbmFnZU5hdmxpbmtzJyksDQogICAgICAgICAga2V5OiAgICduYXZsaW5rcy1tYW5hZ2UnLA0KICAgICAgICAgIHZhbHVlOiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbWVtYmVycy5jbHVzdGVyUGVybWlzc2lvbnMubWFuYWdlTm9kZXMnKSwNCiAgICAgICAgICBrZXk6ICAgJ25vZGVzLW1hbmFnZScsDQogICAgICAgICAgdmFsdWU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy5tYW5hZ2VTdG9yYWdlJyksDQogICAgICAgICAga2V5OiAgICdzdG9yYWdlLW1hbmFnZScsDQogICAgICAgICAgdmFsdWU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy52aWV3QWxsUHJvamVjdHMnKSwNCiAgICAgICAgICBrZXk6ICAgJ3Byb2plY3RzLXZpZXcnLA0KICAgICAgICAgIHZhbHVlOiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbWVtYmVycy5jbHVzdGVyUGVybWlzc2lvbnMudmlld0NsdXN0ZXJDYXRhbG9ncycpLA0KICAgICAgICAgIGtleTogICAnY2x1c3RlcmNhdGFsb2dzLXZpZXcnLA0KICAgICAgICAgIHZhbHVlOiBmYWxzZQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6IHRoaXMudCgnbWVtYmVycy5jbHVzdGVyUGVybWlzc2lvbnMudmlld0NsdXN0ZXJNZW1iZXJzJyksDQogICAgICAgICAga2V5OiAgICdjbHVzdGVycm9sZXRlbXBsYXRlYmluZGluZ3MtdmlldycsDQogICAgICAgICAgdmFsdWU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy52aWV3Tm9kZXMnKSwNCiAgICAgICAgICBrZXk6ICAgJ25vZGVzLXZpZXcnLA0KICAgICAgICAgIHZhbHVlOiBmYWxzZQ0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgcGVybWlzc2lvbkdyb3VwOiAnbWVtYmVyJywNCiAgICAgIGN1c3RvbTogICAgICAgICAge30sDQogICAgICByb2xlVGVtcGxhdGVzOiAgIFtdLA0KICAgICAgcHJpbmNpcGFsSWQ6ICAgICAnJywNCiAgICAgIGJpbmRpbmdzOiAgICAgICAgW10NCiAgICB9Ow0KICB9LA0KICBjb21wdXRlZDogew0KICAgIGN1c3RvbVJvbGVzKCkgew0KICAgICAgcmV0dXJuIHRoaXMucm9sZVRlbXBsYXRlcw0KICAgICAgICAuZmlsdGVyKChyb2xlKSA9PiB7DQogICAgICAgICAgcmV0dXJuICFyb2xlLmJ1aWx0aW4gJiYgIXJvbGUuZXh0ZXJuYWwgJiYgIXJvbGUuaGlkZGVuICYmIHJvbGUuY29udGV4dCA9PT0gJ2NsdXN0ZXInOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIHJvbGVUZW1wbGF0ZUlkcygpIHsNCiAgICAgIGlmICh0aGlzLnBlcm1pc3Npb25Hcm91cCA9PT0gJ293bmVyJykgew0KICAgICAgICByZXR1cm4gWydjbHVzdGVyLW93bmVyJ107DQogICAgICB9DQoNCiAgICAgIGlmICh0aGlzLnBlcm1pc3Npb25Hcm91cCA9PT0gJ21lbWJlcicpIHsNCiAgICAgICAgcmV0dXJuIFsnY2x1c3Rlci1tZW1iZXInXTsNCiAgICAgIH0NCg0KICAgICAgaWYgKHRoaXMucGVybWlzc2lvbkdyb3VwID09PSAnY3VzdG9tJykgew0KICAgICAgICByZXR1cm4gdGhpcy5jdXN0b21QZXJtaXNzaW9ucw0KICAgICAgICAgIC5maWx0ZXIoKHBlcm1pc3Npb24pID0+IHBlcm1pc3Npb24udmFsdWUpDQogICAgICAgICAgLm1hcCgocGVybWlzc2lvbikgPT4gcGVybWlzc2lvbi5rZXkpOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gW3RoaXMucGVybWlzc2lvbkdyb3VwXTsNCiAgICB9LA0KICAgIG9wdGlvbnMoKSB7DQogICAgICBjb25zdCBjdXN0b21Sb2xlcyA9IHRoaXMuY3VzdG9tUm9sZXMubWFwKChyb2xlKSA9PiAoew0KICAgICAgICBsYWJlbDogICAgICAgcm9sZS5uYW1lRGlzcGxheSwNCiAgICAgICAgZGVzY3JpcHRpb246IHJvbGUuZGVzY3JpcHRpb24gfHwgcm9sZS5tZXRhZGF0YT8uYW5ub3RhdGlvbnM/LltERVNDUklQVElPTl0gfHwgdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy5ub0Rlc2NyaXB0aW9uJyksDQogICAgICAgIHZhbHVlOiAgICAgICByb2xlLmlkDQogICAgICB9KSk7DQoNCiAgICAgIHJldHVybiBbDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogICAgICAgdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy5vd25lci5sYWJlbCcpLA0KICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLm93bmVyLmRlc2NyaXB0aW9uJyksDQogICAgICAgICAgdmFsdWU6ICAgICAgICdvd25lcicNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiAgICAgICB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLm1lbWJlci5sYWJlbCcpLA0KICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLm1lbWJlci5kZXNjcmlwdGlvbicpLA0KICAgICAgICAgIHZhbHVlOiAgICAgICAnbWVtYmVyJw0KICAgICAgICB9LA0KICAgICAgICAuLi5jdXN0b21Sb2xlcywNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiAgICAgICB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLmN1c3RvbS5sYWJlbCcpLA0KICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLnQoJ21lbWJlcnMuY2x1c3RlclBlcm1pc3Npb25zLmN1c3RvbS5kZXNjcmlwdGlvbicpLA0KICAgICAgICAgIHZhbHVlOiAgICAgICAnY3VzdG9tJw0KICAgICAgICB9DQogICAgICBdOw0KICAgIH0sDQogICAgcHJpbmNpcGFsKCkgew0KICAgICAgY29uc3QgcHJpbmNpcGFsSWQgPSB0aGlzLnByaW5jaXBhbElkLnJlcGxhY2UoL1wvL2csICclMkYnKTsNCg0KICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdyYW5jaGVyL2ZpbmQnLCB7DQogICAgICAgIHR5cGU6IE5PUk1BTi5QUklOQ0lQQUwsDQogICAgICAgIGlkOiAgIHRoaXMucHJpbmNpcGFsSWQsDQogICAgICAgIG9wdDogIHsgdXJsOiBgL3YzL3ByaW5jaXBhbHMvJHsgcHJpbmNpcGFsSWQgfWAgfQ0KICAgICAgfSwgeyByb290OiB0cnVlIH0pOw0KICAgIH0sDQogICAgY3VzdG9tUGVybWlzc2lvbnNVcGRhdGUoKSB7DQogICAgICByZXR1cm4gdGhpcy5jdXN0b21QZXJtaXNzaW9ucy5yZWR1Y2UoKGFjYywgY3VzdG9tUGVybWlzc2lvbnNJdGVtKSA9PiB7DQogICAgICAgIGNvbnN0IGxvY2tlZEV4aXN0ID0gdGhpcy5yb2xlVGVtcGxhdGVzLmZpbmQoKHJvbGVUZW1wbGF0ZUl0ZW0pID0+IHJvbGVUZW1wbGF0ZUl0ZW0uZGlzcGxheU5hbWUgPT09IGN1c3RvbVBlcm1pc3Npb25zSXRlbS5sYWJlbCk7DQoNCiAgICAgICAgaWYgKGxvY2tlZEV4aXN0LmxvY2tlZCkgew0KICAgICAgICAgIGN1c3RvbVBlcm1pc3Npb25zSXRlbVsnbG9ja2VkJ10gPSB0cnVlOw0KICAgICAgICAgIGN1c3RvbVBlcm1pc3Npb25zSXRlbVsndG9vbHRpcCddID0gdGhpcy50KCdtZW1iZXJzLmNsdXN0ZXJQZXJtaXNzaW9ucy5jdXN0b20ubG9ja2VkUm9sZScpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuIFsuLi5hY2MsIGN1c3RvbVBlcm1pc3Npb25zSXRlbV07DQogICAgICB9LCBbXSk7DQogICAgfQ0KICB9LA0KDQogIHdhdGNoOiB7DQogICAgcm9sZVRlbXBsYXRlSWRzKCkgew0KICAgICAgdGhpcy51cGRhdGVCaW5kaW5ncygpOw0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGFzeW5jIHByaW5jaXBhbFByb3BlcnR5KCkgew0KICAgICAgY29uc3QgcHJpbmNpcGFsID0gYXdhaXQgdGhpcy5wcmluY2lwYWw7DQoNCiAgICAgIHJldHVybiBwcmluY2lwYWw/LnByaW5jaXBhbFR5cGUgPT09ICdncm91cCcgPyAnZ3JvdXBQcmluY2lwYWxJZCcgOiAndXNlclByaW5jaXBhbElkJzsNCiAgICB9LA0KDQogICAgb25BZGQocHJpbmNpcGFsSWQpIHsNCiAgICAgIHRoaXMuJHNldCh0aGlzLCAncHJpbmNpcGFsSWQnLCBwcmluY2lwYWxJZCk7DQogICAgICB0aGlzLnVwZGF0ZUJpbmRpbmdzKCk7DQogICAgfSwNCg0KICAgIGFzeW5jIHVwZGF0ZUJpbmRpbmdzKCkgew0KICAgICAgaWYgKHRoaXMucHJpbmNpcGFsSWQpIHsNCiAgICAgICAgY29uc3QgcHJpbmNpcGFsUHJvcGVydHkgPSBhd2FpdCB0aGlzLnByaW5jaXBhbFByb3BlcnR5KCk7DQogICAgICAgIGNvbnN0IGJpbmRpbmdQcm9taXNlcyA9IHRoaXMucm9sZVRlbXBsYXRlSWRzLm1hcCgoaWQpID0+IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGByYW5jaGVyL2NyZWF0ZWAsIHsNCiAgICAgICAgICB0eXBlOiAgICAgICAgICAgICAgICBOT1JNQU4uQ0xVU1RFUl9ST0xFX1RFTVBMQVRFX0JJTkRJTkcsDQogICAgICAgICAgY2x1c3RlcklkOiAgICAgICAgICAgdGhpcy5jbHVzdGVyTmFtZSwNCiAgICAgICAgICByb2xlVGVtcGxhdGVJZDogICAgICBpZCwNCiAgICAgICAgICBbcHJpbmNpcGFsUHJvcGVydHldOiB0aGlzLnByaW5jaXBhbElkDQogICAgICAgIH0pKTsNCg0KICAgICAgICBjb25zdCBiaW5kaW5ncyA9IGF3YWl0IFByb21pc2UuYWxsKGJpbmRpbmdQcm9taXNlcyk7DQoNCiAgICAgICAgdGhpcy4kZW1pdCgnaW5wdXQnLCBiaW5kaW5ncyk7DQogICAgICB9DQogICAgfQ0KICB9LA0KfTsNCg=="},{"version":3,"sources":["ClusterPermissionsEditor.vue"],"names":[],"mappings":";AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA","file":"ClusterPermissionsEditor.vue","sourceRoot":"node_modules/@rancher/shell/components/form/Members","sourcesContent":["\r\n<script>\r\nimport CreateEditView from '@shell/mixins/create-edit-view';\r\nimport SelectPrincipal from '@shell/components/auth/SelectPrincipal';\r\nimport { MANAGEMENT, NORMAN } from '@shell/config/types';\r\nimport { RadioGroup } from '@components/Form/Radio';\r\nimport { Card } from '@components/Card';\r\nimport Loading from '@shell/components/Loading';\r\nimport { Checkbox } from '@components/Form/Checkbox';\r\nimport { DESCRIPTION } from '@shell/config/labels-annotations';\r\n\r\nexport function canViewClusterPermissionsEditor(store) {\r\n  return !!store.getters['management/schemaFor'](MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING) &&\r\n    !!store.getters['management/schemaFor'](MANAGEMENT.ROLE_TEMPLATE) &&\r\n    !!store.getters['management/schemaFor'](MANAGEMENT.USER);\r\n}\r\n\r\nexport default {\r\n  components: {\r\n    Card,\r\n    Checkbox,\r\n    Loading,\r\n    RadioGroup,\r\n    SelectPrincipal\r\n  },\r\n\r\n  mixins: [CreateEditView],\r\n\r\n  props: {\r\n    value: {\r\n      type:     Array,\r\n      required: true\r\n    },\r\n\r\n    useTwoColumnsForCustom: {\r\n      type:    Boolean,\r\n      default: false\r\n    },\r\n\r\n    clusterName: {\r\n      type:    String,\r\n      default: null\r\n    }\r\n  },\r\n  async fetch() {\r\n    const [, roleTemplates] = await Promise.all([\r\n      this.$store.dispatch('management/findAll', { type: MANAGEMENT.USER }),\r\n      this.$store.dispatch('management/findAll', { type: MANAGEMENT.ROLE_TEMPLATE })\r\n    ]);\r\n\r\n    this.roleTemplates = roleTemplates;\r\n  },\r\n  data() {\r\n    return {\r\n      customPermissions: [\r\n        {\r\n          label: this.t('members.clusterPermissions.createProjects'),\r\n          key:   'projects-create',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.manageClusterBackups'),\r\n          key:   'backups-manage',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.manageClusterCatalogs'),\r\n          key:   'clustercatalogs-manage',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.manageClusterMembers'),\r\n          key:   'clusterroletemplatebindings-manage',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.manageNavlinks'),\r\n          key:   'navlinks-manage',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.manageNodes'),\r\n          key:   'nodes-manage',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.manageStorage'),\r\n          key:   'storage-manage',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.viewAllProjects'),\r\n          key:   'projects-view',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.viewClusterCatalogs'),\r\n          key:   'clustercatalogs-view',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.viewClusterMembers'),\r\n          key:   'clusterroletemplatebindings-view',\r\n          value: false\r\n        },\r\n        {\r\n          label: this.t('members.clusterPermissions.viewNodes'),\r\n          key:   'nodes-view',\r\n          value: false\r\n        }\r\n      ],\r\n      permissionGroup: 'member',\r\n      custom:          {},\r\n      roleTemplates:   [],\r\n      principalId:     '',\r\n      bindings:        []\r\n    };\r\n  },\r\n  computed: {\r\n    customRoles() {\r\n      return this.roleTemplates\r\n        .filter((role) => {\r\n          return !role.builtin && !role.external && !role.hidden && role.context === 'cluster';\r\n        });\r\n    },\r\n    roleTemplateIds() {\r\n      if (this.permissionGroup === 'owner') {\r\n        return ['cluster-owner'];\r\n      }\r\n\r\n      if (this.permissionGroup === 'member') {\r\n        return ['cluster-member'];\r\n      }\r\n\r\n      if (this.permissionGroup === 'custom') {\r\n        return this.customPermissions\r\n          .filter((permission) => permission.value)\r\n          .map((permission) => permission.key);\r\n      }\r\n\r\n      return [this.permissionGroup];\r\n    },\r\n    options() {\r\n      const customRoles = this.customRoles.map((role) => ({\r\n        label:       role.nameDisplay,\r\n        description: role.description || role.metadata?.annotations?.[DESCRIPTION] || this.t('members.clusterPermissions.noDescription'),\r\n        value:       role.id\r\n      }));\r\n\r\n      return [\r\n        {\r\n          label:       this.t('members.clusterPermissions.owner.label'),\r\n          description: this.t('members.clusterPermissions.owner.description'),\r\n          value:       'owner'\r\n        },\r\n        {\r\n          label:       this.t('members.clusterPermissions.member.label'),\r\n          description: this.t('members.clusterPermissions.member.description'),\r\n          value:       'member'\r\n        },\r\n        ...customRoles,\r\n        {\r\n          label:       this.t('members.clusterPermissions.custom.label'),\r\n          description: this.t('members.clusterPermissions.custom.description'),\r\n          value:       'custom'\r\n        }\r\n      ];\r\n    },\r\n    principal() {\r\n      const principalId = this.principalId.replace(/\\//g, '%2F');\r\n\r\n      return this.$store.dispatch('rancher/find', {\r\n        type: NORMAN.PRINCIPAL,\r\n        id:   this.principalId,\r\n        opt:  { url: `/v3/principals/${ principalId }` }\r\n      }, { root: true });\r\n    },\r\n    customPermissionsUpdate() {\r\n      return this.customPermissions.reduce((acc, customPermissionsItem) => {\r\n        const lockedExist = this.roleTemplates.find((roleTemplateItem) => roleTemplateItem.displayName === customPermissionsItem.label);\r\n\r\n        if (lockedExist.locked) {\r\n          customPermissionsItem['locked'] = true;\r\n          customPermissionsItem['tooltip'] = this.t('members.clusterPermissions.custom.lockedRole');\r\n        }\r\n\r\n        return [...acc, customPermissionsItem];\r\n      }, []);\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    roleTemplateIds() {\r\n      this.updateBindings();\r\n    }\r\n  },\r\n  methods: {\r\n    async principalProperty() {\r\n      const principal = await this.principal;\r\n\r\n      return principal?.principalType === 'group' ? 'groupPrincipalId' : 'userPrincipalId';\r\n    },\r\n\r\n    onAdd(principalId) {\r\n      this.$set(this, 'principalId', principalId);\r\n      this.updateBindings();\r\n    },\r\n\r\n    async updateBindings() {\r\n      if (this.principalId) {\r\n        const principalProperty = await this.principalProperty();\r\n        const bindingPromises = this.roleTemplateIds.map((id) => this.$store.dispatch(`rancher/create`, {\r\n          type:                NORMAN.CLUSTER_ROLE_TEMPLATE_BINDING,\r\n          clusterId:           this.clusterName,\r\n          roleTemplateId:      id,\r\n          [principalProperty]: this.principalId\r\n        }));\r\n\r\n        const bindings = await Promise.all(bindingPromises);\r\n\r\n        this.$emit('input', bindings);\r\n      }\r\n    }\r\n  },\r\n};\r\n</script>\r\n<template>\r\n  <Loading v-if=\"$fetchState.pending\" />\r\n  <div\r\n    v-else\r\n    class=\"cluster-permissions-editor\"\r\n  >\r\n    <div class=\"row mt-10\">\r\n      <div class=\"col span-12\">\r\n        <SelectPrincipal\r\n          v-focus\r\n          class=\"mb-20\"\r\n          :mode=\"mode\"\r\n          :retain-selection=\"true\"\r\n          data-testid=\"cluster-member-select\"\r\n          @add=\"onAdd\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <Card\r\n      class=\"m-0\"\r\n      :show-highlight-border=\"false\"\r\n      :show-actions=\"false\"\r\n    >\r\n      <template v-slot:title>\r\n        <div class=\"type-title\">\r\n          <h3>{{ t('members.clusterPermissions.label') }}</h3>\r\n          <div class=\"type-description\">\r\n            {{ t('members.clusterPermissions.description') }}\r\n          </div>\r\n        </div>\r\n      </template>\r\n      <template v-slot:body>\r\n        <RadioGroup\r\n          v-model=\"permissionGroup\"\r\n          :options=\"options\"\r\n          name=\"permission-group\"\r\n        />\r\n        <div\r\n          v-if=\"permissionGroup === 'custom'\"\r\n          class=\"custom-permissions ml-20 mt-10\"\r\n          :class=\"{'two-column': useTwoColumnsForCustom}\"\r\n        >\r\n          <div\r\n            v-for=\"permission in customPermissionsUpdate\"\r\n            :key=\"permission.key\"\r\n          >\r\n            <Checkbox\r\n              v-model=\"permission.value\"\r\n              :disabled=\"permission.locked\"\r\n              class=\"mb-5\"\r\n              :label=\"permission.label\"\r\n            />\r\n            <i\r\n              v-if=\"permission.locked\"\r\n              v-clean-tooltip=\"permission.tooltip\"\r\n              class=\"icon icon-lock icon-fw\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </Card>\r\n  </div>\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n$detailSize: 11px;\r\n\r\n::v-deep .type-description {\r\n    font-size: $detailSize;\r\n}\r\n\r\nlabel.radio {\r\n  font-size: 16px;\r\n}\r\n\r\n.custom-permissions {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr 1fr;\r\n  &.two-column {\r\n    grid-template-columns: 1fr 1fr;\r\n  }\r\n  ::v-deep .checkbox-label {\r\n    margin-right: 0;\r\n  }\r\n}\r\n</style>\r\n"]}]}