{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/storage.k8s.io.storageclass/provisioners/driver.harvesterhci.io.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/storage.k8s.io.storageclass/provisioners/driver.harvesterhci.io.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBtYXBHZXR0ZXJzIH0gZnJvbSAndnVleCc7DQppbXBvcnQgc2VtdmVyIGZyb20gJ3NlbXZlcic7DQoNCmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsNCmltcG9ydCBCYW5uZXIgZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyL0Jhbm5lci52dWUnOw0KaW1wb3J0IEtleVZhbHVlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vS2V5VmFsdWUnOw0KDQppbXBvcnQgeyBjbG9uZSB9IGZyb20gJ0BzaGVsbC91dGlscy9vYmplY3QnOw0KaW1wb3J0IHsgYWxsSGFzaCB9IGZyb20gJ0BzaGVsbC91dGlscy9wcm9taXNlJzsNCg0KY29uc3QgREVGQVVMVF9QQVJBTUVURVJTID0gWw0KICAnaG9zdFN0b3JhZ2VDbGFzcycsDQpdOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHsNCiAgICBMYWJlbGVkSW5wdXQsDQogICAgQmFubmVyLA0KICAgIEtleVZhbHVlLA0KICB9LA0KDQogIHByb3BzOiB7DQogICAgdmFsdWU6IHsNCiAgICAgIHR5cGU6ICAgICBPYmplY3QsDQogICAgICByZXF1aXJlZDogdHJ1ZQ0KICAgIH0sDQogICAgbW9kZTogew0KICAgICAgdHlwZTogICAgIFN0cmluZywNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfQ0KICB9LA0KDQogIGFzeW5jIGZldGNoKCkgew0KICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFsbEhhc2goeyBya2UyVmVyc2lvbnM6IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L3JlcXVlc3QnLCB7IHVybDogJy92MS1ya2UyLXJlbGVhc2UvcmVsZWFzZXMnIH0pIH0pOw0KDQogICAgdGhpcy5ya2UyVmVyc2lvbnMgPSByZXMucmtlMlZlcnNpb25zOw0KICB9LA0KDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsgcmtlMlZlcnNpb25zOiB7fSB9Ow0KICB9LA0KDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwR2V0dGVycyhbJ2N1cnJlbnRDbHVzdGVyJ10pLA0KDQogICAgaXNTYXRpc2ZpZXNWZXJzaW9uKCkgew0KICAgICAgY29uc3Qga3ViZXJuZXRlc1ZlcnNpb24gPSB0aGlzLmN1cnJlbnRDbHVzdGVyLmt1YmVybmV0ZXNWZXJzaW9uIHx8ICcnOw0KICAgICAgY29uc3Qga3ViZXJuZXRlc1ZlcnNpb25FeHRlbnNpb24gPSB0aGlzLmN1cnJlbnRDbHVzdGVyLmt1YmVybmV0ZXNWZXJzaW9uRXh0ZW5zaW9uOw0KDQogICAgICBpZiAoa3ViZXJuZXRlc1ZlcnNpb25FeHRlbnNpb24uc3RhcnRzV2l0aCgnK3JrZTInKSkgew0KICAgICAgICBjb25zdCBjaGFydHMgPSAoKHRoaXMucmtlMlZlcnNpb25zPy5kYXRhIHx8IFtdKS5maW5kKCh2KSA9PiB2LmlkID09PSBrdWJlcm5ldGVzVmVyc2lvbikgfHwge30pLmNoYXJ0czsNCiAgICAgICAgbGV0IGNzaVZlcnNpb24gPSBjaGFydHM/LlsnaGFydmVzdGVyLWNzaS1kcml2ZXInXT8udmVyc2lvbiB8fCAnJzsNCg0KICAgICAgICBpZiAoY3NpVmVyc2lvbi5lbmRzV2l0aCgnMDAnKSkgew0KICAgICAgICAgIGNzaVZlcnNpb24gPSBjc2lWZXJzaW9uLnNsaWNlKDAsIC0yKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBzZW12ZXIuc2F0aXNmaWVzKGNzaVZlcnNpb24sICc+PTAuMS4xNScpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICB9DQogICAgfSwNCg0KICAgIHBhcmFtZXRlcnM6IHsNCiAgICAgIGdldCgpIHsNCiAgICAgICAgY29uc3QgcGFyYW1ldGVycyA9IGNsb25lKHRoaXMudmFsdWU/LnBhcmFtZXRlcnMpIHx8IHt9Ow0KDQogICAgICAgIERFRkFVTFRfUEFSQU1FVEVSUy5tYXAoKGtleSkgPT4gew0KICAgICAgICAgIGRlbGV0ZSBwYXJhbWV0ZXJzW2tleV07DQogICAgICAgIH0pOw0KDQogICAgICAgIHJldHVybiBwYXJhbWV0ZXJzOw0KICAgICAgfSwNCg0KICAgICAgc2V0KHZhbHVlKSB7DQogICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy52YWx1ZS5wYXJhbWV0ZXJzLCB2YWx1ZSk7DQogICAgICB9DQogICAgfSwNCiAgfSwNCn07DQo="},{"version":3,"sources":["driver.harvesterhci.io.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"driver.harvesterhci.io.vue","sourceRoot":"node_modules/@rancher/shell/edit/storage.k8s.io.storageclass/provisioners","sourcesContent":["<script>\r\nimport { mapGetters } from 'vuex';\r\nimport semver from 'semver';\r\n\r\nimport { LabeledInput } from '@components/Form/LabeledInput';\r\nimport Banner from '@components/Banner/Banner.vue';\r\nimport KeyValue from '@shell/components/form/KeyValue';\r\n\r\nimport { clone } from '@shell/utils/object';\r\nimport { allHash } from '@shell/utils/promise';\r\n\r\nconst DEFAULT_PARAMETERS = [\r\n  'hostStorageClass',\r\n];\r\n\r\nexport default {\r\n  components: {\r\n    LabeledInput,\r\n    Banner,\r\n    KeyValue,\r\n  },\r\n\r\n  props: {\r\n    value: {\r\n      type:     Object,\r\n      required: true\r\n    },\r\n    mode: {\r\n      type:     String,\r\n      required: true\r\n    }\r\n  },\r\n\r\n  async fetch() {\r\n    const res = await allHash({ rke2Versions: this.$store.dispatch('management/request', { url: '/v1-rke2-release/releases' }) });\r\n\r\n    this.rke2Versions = res.rke2Versions;\r\n  },\r\n\r\n  data() {\r\n    return { rke2Versions: {} };\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters(['currentCluster']),\r\n\r\n    isSatisfiesVersion() {\r\n      const kubernetesVersion = this.currentCluster.kubernetesVersion || '';\r\n      const kubernetesVersionExtension = this.currentCluster.kubernetesVersionExtension;\r\n\r\n      if (kubernetesVersionExtension.startsWith('+rke2')) {\r\n        const charts = ((this.rke2Versions?.data || []).find((v) => v.id === kubernetesVersion) || {}).charts;\r\n        let csiVersion = charts?.['harvester-csi-driver']?.version || '';\r\n\r\n        if (csiVersion.endsWith('00')) {\r\n          csiVersion = csiVersion.slice(0, -2);\r\n        }\r\n\r\n        return semver.satisfies(csiVersion, '>=0.1.15');\r\n      } else {\r\n        return true;\r\n      }\r\n    },\r\n\r\n    parameters: {\r\n      get() {\r\n        const parameters = clone(this.value?.parameters) || {};\r\n\r\n        DEFAULT_PARAMETERS.map((key) => {\r\n          delete parameters[key];\r\n        });\r\n\r\n        return parameters;\r\n      },\r\n\r\n      set(value) {\r\n        Object.assign(this.value.parameters, value);\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <Banner\r\n      v-if=\"!isSatisfiesVersion\"\r\n      color=\"warning\"\r\n    >\r\n      {{ t('storageClass.harvesterhci.warning.unSatisfiesVersion', null, true) }}\r\n    </Banner>\r\n    <div v-else>\r\n      <div\r\n        class=\"row mb-10\"\r\n      >\r\n        <div class=\"col span-6\">\r\n          <LabeledInput\r\n            v-model=\"value.parameters.hostStorageClass\"\r\n            :label=\"t('storageClass.harvesterhci.hostStorageClass.label')\"\r\n            :placeholder=\"t('storageClass.harvesterhci.hostStorageClass.placeholder')\"\r\n            :mode=\"mode\"\r\n            :tooltip=\"t('storageClass.harvesterhci.hostStorageClass.tooltip')\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <KeyValue\r\n        v-model=\"parameters\"\r\n        :add-label=\"t('storageClass.longhorn.addLabel')\"\r\n        :read-allowed=\"false\"\r\n        :mode=\"mode\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n"]}]}