{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/secret.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/secret.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IFNFQ1JFVF9UWVBFUyBhcyBUWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvc2VjcmV0JzsKaW1wb3J0IHsgYmFzZTY0RGVjb2RlIH0gZnJvbSAnQHNoZWxsL3V0aWxzL2NyeXB0byc7CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgUmVzb3VyY2VUYWJzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vUmVzb3VyY2VUYWJzJzsKaW1wb3J0IERldGFpbFRleHQgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvRGV0YWlsVGV4dCc7CmltcG9ydCBUYWIgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvVGFiYmVkL1RhYic7Cgpjb25zdCB0eXBlcyA9IFsKICBUWVBFUy5PUEFRVUUsCiAgVFlQRVMuRE9DS0VSX0pTT04sCiAgVFlQRVMuVExTLAogIFRZUEVTLlNTSCwKICBUWVBFUy5CQVNJQywKXTsKY29uc3QgcmVnaXN0cnlBZGRyZXNzZXMgPSBbCiAgJ0RvY2tlckh1YicsICdRdWF5LmlvJywgJ0FydGlmYWN0b3J5JywgJ0N1c3RvbScKXTsKCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBSZXNvdXJjZVRhYnMsCiAgICBEZXRhaWxUZXh0LAogICAgVGFiLAogIH0sCgogIG1peGluczogW0NyZWF0ZUVkaXRWaWV3XSwKCiAgcHJvcHM6IHsKICAgIHZhbHVlOiB7CiAgICAgIHR5cGU6ICAgIE9iamVjdCwKICAgICAgZGVmYXVsdDogKCkgPT4gewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICBsZXQgdXNlcm5hbWU7CiAgICBsZXQgcGFzc3dvcmQ7CiAgICBsZXQgcmVnaXN0cnlVcmw7CiAgICBsZXQgcmVnaXN0cnlQcm92aWRlciA9ICdDdXN0b20nOwogICAgbGV0IGtleTsKICAgIGxldCBjcnQ7CgogICAgaWYgKHRoaXMudmFsdWUuX3R5cGUgPT09IFRZUEVTLkRPQ0tFUl9KU09OKSB7CiAgICAgIGNvbnN0IGpzb24gPSBiYXNlNjREZWNvZGUodGhpcy52YWx1ZS5kYXRhWycuZG9ja2VyY29uZmlnanNvbiddKTsKCiAgICAgIGNvbnN0IHsgYXV0aHMgfSA9IEpTT04ucGFyc2UoanNvbik7CgogICAgICByZWdpc3RyeVVybCA9IE9iamVjdC5rZXlzKGF1dGhzKVswXTsKCiAgICAgIGlmIChyZWdpc3RyeVVybCA9PT0gJ2luZGV4LmRvY2tlci5pby92MS8nKSB7CiAgICAgICAgcmVnaXN0cnlQcm92aWRlciA9ICdEb2NrZXJIdWInOwogICAgICB9IGVsc2UgaWYgKHJlZ2lzdHJ5VXJsID09PSAncXVheS5pbycpIHsKICAgICAgICByZWdpc3RyeVByb3ZpZGVyID0gJ1F1YXkuaW8nOwogICAgICB9IGVsc2UgaWYgKHJlZ2lzdHJ5VXJsLmluY2x1ZGVzKCdhcnRpZmFjdG9yeScpKSB7CiAgICAgICAgcmVnaXN0cnlQcm92aWRlciA9ICdBcnRpZmFjdG9yeSc7CiAgICAgIH0KCiAgICAgIHVzZXJuYW1lID0gYXV0aHNbcmVnaXN0cnlVcmxdLnVzZXJuYW1lOwogICAgICBwYXNzd29yZCA9IGF1dGhzW3JlZ2lzdHJ5VXJsXS5wYXNzd29yZDsKICAgIH0KCiAgICBjb25zdCBkYXRhID0gdGhpcy52YWx1ZT8uZGF0YSB8fCB7fTsKCiAgICBpZiAodGhpcy52YWx1ZS5fdHlwZSA9PT0gVFlQRVMuVExTKSB7CiAgICAgIC8vIGRvIG5vdCBzaG93IGV4aXN0aW5nIGtleSB3aGVuIGVkaXRpbmcKICAgICAga2V5ID0gdGhpcy5tb2RlID09PSAnZWRpdCcgPyAnJyA6IGJhc2U2NERlY29kZShkYXRhWyd0bHMua2V5J10pOwoKICAgICAgY3J0ID0gYmFzZTY0RGVjb2RlKGRhdGFbJ3Rscy5jcnQnXSk7CiAgICB9CgogICAgaWYgKHRoaXMudmFsdWUuX3R5cGUgPT09IFRZUEVTLlNFUlZJQ0VfQUNDVCkgewogICAgICBrZXkgPSBiYXNlNjREZWNvZGUoZGF0YVsndG9rZW4nXSk7CiAgICAgIGNydCA9IGJhc2U2NERlY29kZShkYXRhWydjYS5jcnQnXSk7CiAgICB9CgogICAgaWYgKCB0aGlzLnZhbHVlLl90eXBlID09PSBUWVBFUy5CQVNJQyApIHsKICAgICAgdXNlcm5hbWUgPSBiYXNlNjREZWNvZGUoZGF0YS51c2VybmFtZSB8fCAnJyk7CiAgICAgIHBhc3N3b3JkID0gYmFzZTY0RGVjb2RlKGRhdGEucGFzc3dvcmQgfHwgJycpOwogICAgfQoKICAgIGlmICggdGhpcy52YWx1ZS5fdHlwZSA9PT0gVFlQRVMuU1NIICkgewogICAgICB1c2VybmFtZSA9IGJhc2U2NERlY29kZShkYXRhWydzc2gtcHVibGlja2V5J10gfHwgJycpOwogICAgICBwYXNzd29yZCA9IGJhc2U2NERlY29kZShkYXRhWydzc2gtcHJpdmF0ZWtleSddIHx8ICcnKTsKICAgIH0KCiAgICBpZiAoIXRoaXMudmFsdWUuX3R5cGUpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMudmFsdWUsICdfdHlwZScsIFRZUEVTLk9QQVFVRSk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgdHlwZXMsCiAgICAgIHJlZ2lzdHJ5QWRkcmVzc2VzLAogICAgICByZWdpc3RyeVByb3ZpZGVyLAogICAgICB1c2VybmFtZSwKICAgICAgcGFzc3dvcmQsCiAgICAgIHJlZ2lzdHJ5VXJsLAogICAgICBrZXksCiAgICAgIGNydCwKICAgICAgcmVsYXRlZFNlcnZpY2VzOiBbXSwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGlzQ2VydGlmaWNhdGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnZhbHVlLl90eXBlID09PSBUWVBFUy5UTFM7CiAgICB9LAoKICAgIGlzU3ZjQWNjdFRva2VuKCkgewogICAgICByZXR1cm4gdGhpcy52YWx1ZS5fdHlwZSA9PT0gVFlQRVMuU0VSVklDRV9BQ0NUOwogICAgfSwKCiAgICBpc1JlZ2lzdHJ5KCkgewogICAgICByZXR1cm4gdGhpcy52YWx1ZS5fdHlwZSA9PT0gVFlQRVMuRE9DS0VSX0pTT047CiAgICB9LAoKICAgIGlzU3NoKCkgewogICAgICByZXR1cm4gdGhpcy52YWx1ZS5fdHlwZSA9PT0gVFlQRVMuU1NIOwogICAgfSwKCiAgICBpc0Jhc2ljQXV0aCgpIHsKICAgICAgcmV0dXJuIHRoaXMudmFsdWUuX3R5cGUgPT09IFRZUEVTLkJBU0lDOwogICAgfSwKCiAgICBwYXJzZWRSb3dzKCkgewogICAgICBjb25zdCByb3dzID0gW107CiAgICAgIGNvbnN0IHsgZGF0YSA9IHt9IH0gPSB0aGlzLnZhbHVlOwoKICAgICAgT2JqZWN0LmtleXMoZGF0YSkuZm9yRWFjaCgoa2V5KSA9PiB7CiAgICAgICAgY29uc3QgdmFsdWUgPSBiYXNlNjREZWNvZGUoZGF0YVtrZXldKTsKCiAgICAgICAgcm93cy5wdXNoKHsKICAgICAgICAgIGtleSwKICAgICAgICAgIHZhbHVlCiAgICAgICAgfSk7CiAgICAgIH0pOwoKICAgICAgcmV0dXJuIHJvd3M7CiAgICB9LAoKICAgIGRhdGFMYWJlbCgpIHsKICAgICAgc3dpdGNoICh0aGlzLnZhbHVlLl90eXBlKSB7CiAgICAgIGNhc2UgVFlQRVMuVExTOgogICAgICAgIHJldHVybiB0aGlzLnQoJ3NlY3JldC5jZXJ0aWZpY2F0ZS5jZXJ0aWZpY2F0ZScpOwogICAgICBjYXNlIFRZUEVTLlNTSDoKICAgICAgICByZXR1cm4gdGhpcy50KCdzZWNyZXQuc3NoLmtleXMnKTsKICAgICAgY2FzZSBUWVBFUy5CQVNJQzoKICAgICAgICByZXR1cm4gdGhpcy50KCdzZWNyZXQuYXV0aGVudGljYXRpb24nKTsKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gdGhpcy50KCdzZWNyZXQuZGF0YScpOwogICAgICB9CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["secret.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"secret.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport { SECRET_TYPES as TYPES } from '@shell/config/secret';\nimport { base64Decode } from '@shell/utils/crypto';\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport DetailText from '@shell/components/DetailText';\nimport Tab from '@shell/components/Tabbed/Tab';\n\nconst types = [\n  TYPES.OPAQUE,\n  TYPES.DOCKER_JSON,\n  TYPES.TLS,\n  TYPES.SSH,\n  TYPES.BASIC,\n];\nconst registryAddresses = [\n  'DockerHub', 'Quay.io', 'Artifactory', 'Custom'\n];\n\nexport default {\n  components: {\n    ResourceTabs,\n    DetailText,\n    Tab,\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    value: {\n      type:    Object,\n      default: () => {\n        return {};\n      }\n    }\n  },\n\n  data() {\n    let username;\n    let password;\n    let registryUrl;\n    let registryProvider = 'Custom';\n    let key;\n    let crt;\n\n    if (this.value._type === TYPES.DOCKER_JSON) {\n      const json = base64Decode(this.value.data['.dockerconfigjson']);\n\n      const { auths } = JSON.parse(json);\n\n      registryUrl = Object.keys(auths)[0];\n\n      if (registryUrl === 'index.docker.io/v1/') {\n        registryProvider = 'DockerHub';\n      } else if (registryUrl === 'quay.io') {\n        registryProvider = 'Quay.io';\n      } else if (registryUrl.includes('artifactory')) {\n        registryProvider = 'Artifactory';\n      }\n\n      username = auths[registryUrl].username;\n      password = auths[registryUrl].password;\n    }\n\n    const data = this.value?.data || {};\n\n    if (this.value._type === TYPES.TLS) {\n      // do not show existing key when editing\n      key = this.mode === 'edit' ? '' : base64Decode(data['tls.key']);\n\n      crt = base64Decode(data['tls.crt']);\n    }\n\n    if (this.value._type === TYPES.SERVICE_ACCT) {\n      key = base64Decode(data['token']);\n      crt = base64Decode(data['ca.crt']);\n    }\n\n    if ( this.value._type === TYPES.BASIC ) {\n      username = base64Decode(data.username || '');\n      password = base64Decode(data.password || '');\n    }\n\n    if ( this.value._type === TYPES.SSH ) {\n      username = base64Decode(data['ssh-publickey'] || '');\n      password = base64Decode(data['ssh-privatekey'] || '');\n    }\n\n    if (!this.value._type) {\n      this.$set(this.value, '_type', TYPES.OPAQUE);\n    }\n\n    return {\n      types,\n      registryAddresses,\n      registryProvider,\n      username,\n      password,\n      registryUrl,\n      key,\n      crt,\n      relatedServices: [],\n    };\n  },\n\n  computed: {\n    isCertificate() {\n      return this.value._type === TYPES.TLS;\n    },\n\n    isSvcAcctToken() {\n      return this.value._type === TYPES.SERVICE_ACCT;\n    },\n\n    isRegistry() {\n      return this.value._type === TYPES.DOCKER_JSON;\n    },\n\n    isSsh() {\n      return this.value._type === TYPES.SSH;\n    },\n\n    isBasicAuth() {\n      return this.value._type === TYPES.BASIC;\n    },\n\n    parsedRows() {\n      const rows = [];\n      const { data = {} } = this.value;\n\n      Object.keys(data).forEach((key) => {\n        const value = base64Decode(data[key]);\n\n        rows.push({\n          key,\n          value\n        });\n      });\n\n      return rows;\n    },\n\n    dataLabel() {\n      switch (this.value._type) {\n      case TYPES.TLS:\n        return this.t('secret.certificate.certificate');\n      case TYPES.SSH:\n        return this.t('secret.ssh.keys');\n      case TYPES.BASIC:\n        return this.t('secret.authentication');\n      default:\n        return this.t('secret.data');\n      }\n    }\n  },\n};\n</script>\n\n<template>\n  <ResourceTabs\n    v-model=\"value\"\n    :mode=\"mode\"\n  >\n    <Tab\n      name=\"data\"\n      :label=\"dataLabel\"\n    >\n      <template v-if=\"isRegistry || isBasicAuth\">\n        <div\n          v-if=\"isRegistry\"\n          class=\"row\"\n        >\n          <div class=\"col span-12\">\n            <DetailText\n              :value=\"registryUrl\"\n              label-key=\"secret.registry.domainName\"\n            />\n          </div>\n        </div>\n        <div class=\"row mt-20\">\n          <div class=\"col span-6\">\n            <DetailText\n              :value=\"username\"\n              label-key=\"secret.registry.username\"\n            />\n          </div>\n          <div class=\"col span-6\">\n            <DetailText\n              :value=\"password\"\n              label-key=\"secret.registry.password\"\n              :conceal=\"true\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <div\n        v-else-if=\"isCertificate\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"key\"\n            label-key=\"secret.certificate.privateKey\"\n            :conceal=\"true\"\n          />\n        </div>\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"crt\"\n            label-key=\"secret.certificate.certificate\"\n          />\n        </div>\n      </div>\n\n      <div\n        v-else-if=\"isSvcAcctToken\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"crt\"\n            label-key=\"secret.serviceAcct.ca\"\n          />\n        </div>\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"key\"\n            label-key=\"secret.serviceAcct.token\"\n            :conceal=\"true\"\n          />\n        </div>\n      </div>\n\n      <div\n        v-else-if=\"isSsh\"\n        class=\"row\"\n      >\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"username\"\n            label-key=\"secret.ssh.public\"\n          />\n        </div>\n        <div class=\"col span-6\">\n          <DetailText\n            :value=\"password\"\n            label-key=\"secret.ssh.private\"\n            :conceal=\"true\"\n          />\n        </div>\n      </div>\n\n      <div v-else>\n        <div\n          v-for=\"(row,idx) in parsedRows\"\n          :key=\"idx\"\n          class=\"entry\"\n        >\n          <DetailText\n            :value=\"row.value\"\n            :label=\"row.key\"\n            :conceal=\"true\"\n          />\n        </div>\n        <div v-if=\"!parsedRows.length\">\n          <div\n            v-t=\"'sortableTable.noRows'\"\n            class=\"m-20 text-center\"\n          />\n        </div>\n      </div>\n    </Tab>\n  </ResourceTabs>\n</template>\n\n<style lang=\"scss\" scoped>\n  .entry {\n    margin-top: 10px;\n\n    &:first-of-type {\n      margin-top: 0;\n    }\n  }\n</style>\n"]}]}