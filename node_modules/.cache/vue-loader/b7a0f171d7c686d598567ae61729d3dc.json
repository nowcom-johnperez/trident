{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/helm.cattle.io.projecthelmchart.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/helm.cattle.io.projecthelmchart.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBpc0VtcHR5IGZyb20gJ2xvZGFzaC9pc0VtcHR5JzsKaW1wb3J0IFRhYmJlZCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgRGFzaGJvYXJkTWV0cmljcyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9EYXNoYm9hcmRNZXRyaWNzJzsKaW1wb3J0IEFsZXJ0VGFibGUgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvQWxlcnRUYWJsZSc7CmltcG9ydCB7IEJhbm5lciB9IGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lcic7CmltcG9ydCB7IEVORFBPSU5UUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBhbGxIYXNoIH0gZnJvbSAnQHNoZWxsL3V0aWxzL3Byb21pc2UnOwoKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIFRhYmJlZCwKICAgIFRhYiwKICAgIERhc2hib2FyZE1ldHJpY3MsCiAgICBBbGVydFRhYmxlLAogICAgQmFubmVyCiAgfSwKICBwcm9wczogewogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAogIH0sCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBhd2FpdCB0aGlzLmZldGNoRGVwcygpOwogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVuZHBvaW50c0hhc2g6ICAgIFtdLAogICAgICBsb2FkaW5nRW5kcG9pbnRzOiB0cnVlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIHRoZXJlIGlzIGEgc2luY2UtZml4ZWQgYnVnIGluIHNvbWUgdmVyc2lvbnMgb2YgcHJvbSBmZWRlcmF0b3Igd2hlcmUgdGhpcyB1cmwgaXMgbWlzc2luZyB0aGUgdHJhaWxpbmcgc2xhc2gsIHdoaWNoIGNhdXNlcyBhIHJlZGlyZWN0IHRvIGFuIGludmFsaWQgZ3JhZmFuYSB1cmwKICAgIGdyYWZhbmFVUkwoKSB7CiAgICAgIGNvbnN0IHsgZ3JhZmFuYVVSTCB9ID0gdGhpcy52YWx1ZS5zdGF0dXMuZGFzaGJvYXJkVmFsdWVzOwoKICAgICAgaWYgKCFncmFmYW5hVVJMLmVuZHNXaXRoKCcvJykpIHsKICAgICAgICByZXR1cm4gYCR7IGdyYWZhbmFVUkwgfS9gOwogICAgICB9CgogICAgICByZXR1cm4gZ3JhZmFuYVVSTDsKICAgIH0sCiAgICBtb25pdG9yaW5nTmFtZXNwYWNlKCkgewogICAgICAvLyBwaWNraW5nIHRoZSBwcm9tZXRoZXVzVVJMIGhlcmUsIHRoZXkncmUgYWxsIGdvaW5nIHRvIGJlIHRoZSBzYW1lLCBidXQgYWxlcnRtYW5hZ2VyIGFuZCBncmFmYW5hIGNhbiBiZSBkZWFjdGl2YXRlZAogICAgICByZXR1cm4gdGhpcy5wdWxsS2V5RnJvbVVybCh0aGlzLnZhbHVlLnN0YXR1cy5kYXNoYm9hcmRWYWx1ZXMucHJvbWV0aGV1c1VSTCwgJ25hbWVzcGFjZXMnKTsKICAgIH0sCiAgICBhbGVydFNlcnZpY2VFbmRwb2ludCgpIHsKICAgICAgcmV0dXJuIHRoaXMucHVsbFNlcnZpY2VFbmRwb2ludEZyb21VcmwodGhpcy52YWx1ZS5zdGF0dXMuZGFzaGJvYXJkVmFsdWVzLmFsZXJ0bWFuYWdlclVSTCk7CiAgICB9LAogICAgYWxlcnRTZXJ2aWNlRW5kcG9pbnRFbmFibGVkKCkgewogICAgICByZXR1cm4gdGhpcy5jaGVja0VuZHBvaW50RW5hYmxlZCh0aGlzLmFsZXJ0U2VydmljZUVuZHBvaW50KTsKICAgIH0sCiAgICBncmFmYW5hU2VydmljZUVuZHBvaW50KCkgewogICAgICByZXR1cm4gdGhpcy5wdWxsU2VydmljZUVuZHBvaW50RnJvbVVybCh0aGlzLnZhbHVlLnN0YXR1cy5kYXNoYm9hcmRWYWx1ZXMuZ3JhZmFuYVVSTCk7CiAgICB9LAogICAgZ3JhZmFuYVNlcnZpY2VFbmRwb2ludEVuYWJsZWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmNoZWNrRW5kcG9pbnRFbmFibGVkKHRoaXMuZ3JhZmFuYVNlcnZpY2VFbmRwb2ludCk7CiAgICB9LAogICAgcHJvbWV0aGV1c1NlcnZpY2VFbmRwb2ludCgpIHsKICAgICAgcmV0dXJuIHRoaXMucHVsbFNlcnZpY2VFbmRwb2ludEZyb21VcmwodGhpcy52YWx1ZS5zdGF0dXMuZGFzaGJvYXJkVmFsdWVzLnByb21ldGhldXNVUkwpOwogICAgfSwKICAgIHByb21ldGhldXNTZXJ2aWNlRW5kcG9pbnRFbmFibGVkKCkgewogICAgICByZXR1cm4gdGhpcy5jaGVja0VuZHBvaW50RW5hYmxlZCh0aGlzLnByb21ldGhldXNTZXJ2aWNlRW5kcG9pbnQpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZmV0Y2hEZXBzKCkgewogICAgICBjb25zdCBoYXNoID0gYXdhaXQgYWxsSGFzaCh7IGVuZHBvaW50czogdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NsdXN0ZXIvZmluZEFsbCcsIHsgdHlwZTogRU5EUE9JTlRTIH0pIH0pOwoKICAgICAgdGhpcy5lbmRwb2ludHNIYXNoID0gaGFzaC5lbmRwb2ludHM7CgogICAgICB0aGlzLmxvYWRpbmdFbmRwb2ludHMgPSBmYWxzZTsKICAgIH0sCiAgICBjaGVja0VuZHBvaW50RW5hYmxlZChlbmRwb2ludFN0cmluZykgewogICAgICBpZiAodGhpcy5lbmRwb2ludHNIYXNoLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMuZW5kcG9pbnRzSGFzaC5maW5kKChlbmRwb2ludCkgPT4gewogICAgICAgIHJldHVybiBlbmRwb2ludC5pZCA9PT0gYCR7IHRoaXMubW9uaXRvcmluZ05hbWVzcGFjZSB9LyR7IGVuZHBvaW50U3RyaW5nIH1gOwogICAgICB9KTsKCiAgICAgIHJldHVybiAhaXNFbXB0eShlbmRwb2ludCkgJiYgIWlzRW1wdHkoZW5kcG9pbnQ/LnN1YnNldHMpOwogICAgfSwKCiAgICBwdWxsS2V5RnJvbVVybCh1cmwgPSAnJywga2V5KSB7CiAgICAgIGNvbnN0IHNwbGl0VXJsID0gdXJsLnNwbGl0KCcvJyk7CiAgICAgIGNvbnN0IGtleUluZGV4ID0gc3BsaXRVcmwuaW5kZXhPZihrZXkpOwoKICAgICAgLy8gdGhlIHZhbHVlIHdlJ3JlIGxvb2tpbmcgZm9yIGlzIGdvaW5nIHRvIGJlIGF0IHRoZSBpbmRleCBpbW1lZGlhdGVseSBhZnRlciB0aGUga2V5CiAgICAgIHJldHVybiBzcGxpdFVybFtrZXlJbmRleCArIDFdOwogICAgfSwKICAgIHB1bGxTZXJ2aWNlRW5kcG9pbnRGcm9tVXJsKHVybCA9ICcnKSB7CiAgICAgIGNvbnN0IHNlcnZpY2VTdHJpbmcgPSB0aGlzLnB1bGxLZXlGcm9tVXJsKHVybCwgJ3NlcnZpY2VzJyk7CgogICAgICAvLyBzdHJpbmcgaXMgZ29pbmcgdG8gY29tZSBiYWNrIGFzICI8cHJvdG9jb2w+OjxzZXJ2aWNlRW5kUG9pbnQ+Ojxwb3J0PiIsIHdlIGRvbid0IG5lZWQgdGhlIHByb3RvY29sIG9yIHRoZSBwb3J0CiAgICAgIHJldHVybiBzZXJ2aWNlU3RyaW5nLnNwbGl0KCc6JylbMV07CiAgICB9LAogICAgc2hvd01lbnUoc2hvdykgewogICAgICBpZiAodGhpcy4kcmVmcy5wb3BvdmVyKSB7CiAgICAgICAgaWYgKHNob3cpIHsKICAgICAgICAgIHRoaXMuJHJlZnMucG9wb3Zlci5zaG93KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuJHJlZnMucG9wb3Zlci5oaWRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogIH0KfTsK"},{"version":3,"sources":["helm.cattle.io.projecthelmchart.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"helm.cattle.io.projecthelmchart.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport isEmpty from 'lodash/isEmpty';\nimport Tabbed from '@shell/components/Tabbed';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport DashboardMetrics from '@shell/components/DashboardMetrics';\nimport AlertTable from '@shell/components/AlertTable';\nimport { Banner } from '@components/Banner';\nimport { ENDPOINTS } from '@shell/config/types';\nimport { allHash } from '@shell/utils/promise';\n\nexport default {\n  components: {\n    Tabbed,\n    Tab,\n    DashboardMetrics,\n    AlertTable,\n    Banner\n  },\n  props: {\n    value: {\n      type:     Object,\n      required: true,\n    },\n  },\n  async fetch() {\n    await this.fetchDeps();\n  },\n  data() {\n    return {\n      endpointsHash:    [],\n      loadingEndpoints: true\n    };\n  },\n  computed: {\n    // there is a since-fixed bug in some versions of prom federator where this url is missing the trailing slash, which causes a redirect to an invalid grafana url\n    grafanaURL() {\n      const { grafanaURL } = this.value.status.dashboardValues;\n\n      if (!grafanaURL.endsWith('/')) {\n        return `${ grafanaURL }/`;\n      }\n\n      return grafanaURL;\n    },\n    monitoringNamespace() {\n      // picking the prometheusURL here, they're all going to be the same, but alertmanager and grafana can be deactivated\n      return this.pullKeyFromUrl(this.value.status.dashboardValues.prometheusURL, 'namespaces');\n    },\n    alertServiceEndpoint() {\n      return this.pullServiceEndpointFromUrl(this.value.status.dashboardValues.alertmanagerURL);\n    },\n    alertServiceEndpointEnabled() {\n      return this.checkEndpointEnabled(this.alertServiceEndpoint);\n    },\n    grafanaServiceEndpoint() {\n      return this.pullServiceEndpointFromUrl(this.value.status.dashboardValues.grafanaURL);\n    },\n    grafanaServiceEndpointEnabled() {\n      return this.checkEndpointEnabled(this.grafanaServiceEndpoint);\n    },\n    prometheusServiceEndpoint() {\n      return this.pullServiceEndpointFromUrl(this.value.status.dashboardValues.prometheusURL);\n    },\n    prometheusServiceEndpointEnabled() {\n      return this.checkEndpointEnabled(this.prometheusServiceEndpoint);\n    }\n  },\n  methods: {\n    async fetchDeps() {\n      const hash = await allHash({ endpoints: this.$store.dispatch('cluster/findAll', { type: ENDPOINTS }) });\n\n      this.endpointsHash = hash.endpoints;\n\n      this.loadingEndpoints = false;\n    },\n    checkEndpointEnabled(endpointString) {\n      if (this.endpointsHash.length === 0) {\n        return false;\n      }\n      const endpoint = this.endpointsHash.find((endpoint) => {\n        return endpoint.id === `${ this.monitoringNamespace }/${ endpointString }`;\n      });\n\n      return !isEmpty(endpoint) && !isEmpty(endpoint?.subsets);\n    },\n\n    pullKeyFromUrl(url = '', key) {\n      const splitUrl = url.split('/');\n      const keyIndex = splitUrl.indexOf(key);\n\n      // the value we're looking for is going to be at the index immediately after the key\n      return splitUrl[keyIndex + 1];\n    },\n    pullServiceEndpointFromUrl(url = '') {\n      const serviceString = this.pullKeyFromUrl(url, 'services');\n\n      // string is going to come back as \"<protocol>:<serviceEndPoint>:<port>\", we don't need the protocol or the port\n      return serviceString.split(':')[1];\n    },\n    showMenu(show) {\n      if (this.$refs.popover) {\n        if (show) {\n          this.$refs.popover.show();\n        } else {\n          this.$refs.popover.hide();\n        }\n      }\n    },\n  }\n};\n</script>\n\n<template>\n  <div>\n    <Tabbed\n      v-if=\"value.status.dashboardValues\"\n      class=\"mt-30\"\n    >\n      <Tab\n        name=\"project-metrics\"\n        :label=\"t('monitoring.tabs.projectMetrics')\"\n        :weight=\"3\"\n      >\n        <template #default=\"props\">\n          <DashboardMetrics\n            v-if=\"props.active && grafanaServiceEndpointEnabled\"\n            :detail-url=\"`${value.status.dashboardValues.grafanaURL}/d/rancher-pod-1/rancher-pod?orgId=1&kiosk`\"\n            :summary-url=\"`${value.status.dashboardValues.grafanaURL}/d/rancher-workload-1/rancher-workload?orgId=1&kiosk`\"\n            graph-height=\"825px\"\n            project\n            :modify-prefix=\"false\"\n          />\n        </template>\n      </Tab>\n      <Tab\n        name=\"active-alarms\"\n        :label=\"t('monitoring.overview.alertsList.label')\"\n        :weight=\"2\"\n      >\n        <template>\n          <AlertTable\n            :monitoring-namespace=\"monitoringNamespace\"\n            :alert-service-endpoint=\"alertServiceEndpoint\"\n          />\n        </template>\n      </Tab>\n      <template #tab-row-extras>\n        <div class=\"tab-row-footer\">\n          <div\n            class=\"resources-dropdown\"\n            :class=\"{disabled: !prometheusServiceEndpointEnabled}\"\n            tabindex=\"0\"\n            @blur=\"showMenu(false)\"\n            @click=\"showMenu(true)\"\n            @focus.capture=\"showMenu(true)\"\n          >\n            <v-popover\n              ref=\"popover\"\n              placement=\"bottom-end\"\n              offset=\"-10\"\n              trigger=\"manual\"\n              :delay=\"{show: 0, hide: 0}\"\n              :popper-options=\"{modifiers: { flip: { enabled: false } } }\"\n              :container=\"false\"\n            >\n              <div class=\"meta-title\">\n                {{ t('monitoring.tabs.prometheus') }} <i class=\"icon icon-chevron-down\" />\n              </div>\n              <template\n                slot=\"popover\"\n                class=\"resources-status-list\"\n              >\n                <ul\n                  class=\"list-unstyled dropdown\"\n                  @click.stop=\"showMenu(false)\"\n                >\n                  <li>\n                    <a\n                      :href=\"`${value.status.dashboardValues.prometheusURL}/graph`\"\n                      target=\"_blank\"\n                    >{{ t('monitoring.overview.linkedList.prometheusPromQl.label') }} <i class=\"icon icon-external-link\" /></a>\n                  </li>\n                  <li>\n                    <a\n                      :href=\"`${value.status.dashboardValues.prometheusURL}/rules`\"\n                      target=\"_blank\"\n                    >{{ t('monitoring.overview.linkedList.prometheusRules.label') }} <i class=\"icon icon-external-link\" /></a>\n                  </li>\n                  <li>\n                    <a\n                      :href=\"`${value.status.dashboardValues.prometheusURL}/targets`\"\n                      target=\"_blank\"\n                    >{{ t('monitoring.overview.linkedList.prometheusTargets.label') }} <i class=\"icon icon-external-link\" /></a>\n                  </li>\n                </ul>\n              </template>\n            </v-popover>\n          </div>\n          <a\n            :class=\"{disabled: !grafanaServiceEndpointEnabled}\"\n            :href=\"grafanaURL\"\n            target=\"_blank\"\n          > {{ t('monitoring.overview.linkedList.grafana.label') }} <i class=\"icon icon-external-link\" /></a>\n          <a\n            :class=\"{disabled: !alertServiceEndpointEnabled}\"\n            :href=\"value.status.dashboardValues.alertmanagerURL\"\n            target=\"_blank\"\n          > {{ t('monitoring.overview.linkedList.alertManager.label') }} <i class=\"icon icon-external-link\" /></a>\n        </div>\n      </template>\n    </Tabbed>\n    <div v-else>\n      <Banner color=\"error\">\n        {{ `${ t('monitoring.projectMonitoring.detail.error') }${ value.status.statusMessage || t('generic.unknown') }` }}\n      </Banner>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  .tab-row-footer {\n    list-style: none;\n    padding: 0;\n    margin-left: auto;\n    display: flex;\n    flex-direction: row;\n\n    A, .resources-dropdown {\n      color: var(--link);\n      display: flex;\n      align-items: center;\n      padding: 10px 15px;\n      &.disabled {\n        cursor: not-allowed;\n        pointer-events: none;\n        filter: grayscale(1);\n        color: var(--muted);\n      }\n    }\n  }\n  .resources-dropdown {\n      li {\n          display: flex;\n          justify-content: space-between;\n          margin: 10px 5px;\n      }\n\n      .list-count {\n          margin-left: 30px;\n      }\n  }\n</style>\n"]}]}