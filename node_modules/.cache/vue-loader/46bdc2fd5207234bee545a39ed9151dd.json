{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster/import.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster/import.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwoKaW1wb3J0IENydVJlc291cmNlIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL0NydVJlc291cmNlJzsKaW1wb3J0IExvYWRpbmcgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvTG9hZGluZyc7CmltcG9ydCBOYW1lTnNEZXNjcmlwdGlvbiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL05hbWVOc0Rlc2NyaXB0aW9uJzsKaW1wb3J0IFRhYiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQvVGFiJzsKaW1wb3J0IFRhYmJlZCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9UYWJiZWQnOwppbXBvcnQgeyBDQVBJLCBIQ0kgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IENsdXN0ZXJNZW1iZXJzaGlwRWRpdG9yLCB7IGNhblZpZXdDbHVzdGVyTWVtYmVyc2hpcEVkaXRvciB9IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTWVtYmVycy9DbHVzdGVyTWVtYmVyc2hpcEVkaXRvcic7CmltcG9ydCB7IEJhbm5lciB9IGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lcic7CgppbXBvcnQgeyBOQU1FIGFzIEhBUlZFU1RFUl9NQU5BR0VSIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9oYXJ2ZXN0ZXItbWFuYWdlci10eXBlcyc7CmltcG9ydCB7IEhBUlZFU1RFUiBhcyBIQVJWRVNURVJfRkVBVFVSRSwgbWFwRmVhdHVyZSB9IGZyb20gJ0BzaGVsbC9zdG9yZS9mZWF0dXJlcyc7CmltcG9ydCB7IGFkZE9iamVjdCB9IGZyb20gJ0BzaGVsbC91dGlscy9hcnJheSc7CmltcG9ydCB7IEhJREVfREVTQywgbWFwUHJlZiB9IGZyb20gJ0BzaGVsbC9zdG9yZS9wcmVmcyc7CmltcG9ydCBMYWJlbHMgZnJvbSAnLi9MYWJlbHMnOwppbXBvcnQgQWdlbnRFbnYgZnJvbSAnLi9BZ2VudEVudic7Cgpjb25zdCBIQVJWRVNURVJfSElERV9LRVkgPSAnY20taGFydmVzdGVyLWltcG9ydCc7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQmFubmVyLAogICAgQ2x1c3Rlck1lbWJlcnNoaXBFZGl0b3IsCiAgICBMb2FkaW5nLAogICAgTmFtZU5zRGVzY3JpcHRpb24sCiAgICBDcnVSZXNvdXJjZSwKICAgIFRhYiwKICAgIFRhYmJlZCwKICAgIExhYmVscywKICAgIEFnZW50RW52CiAgfSwKCiAgbWl4aW5zOiBbQ3JlYXRlRWRpdFZpZXddLAoKICBwcm9wczogewogICAgbW9kZTogewogICAgICB0eXBlOiAgICAgU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgIH0sCgogICAgdmFsdWU6IHsKICAgICAgdHlwZTogICAgIE9iamVjdCwKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICB9LAoKICAgIHByb3ZpZGVyOiB7CiAgICAgIHR5cGU6ICAgICBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgfSwKICB9LAoKICBmZXRjaCgpIHsKICAgIC8vIGlmICggIXRoaXMudmFsdWUuc3BlYy5ya2VDb25maWcgKSB7CiAgICAvLyBzZXQodGhpcy52YWx1ZS5zcGVjLCAncmtlQ29uZmlnJywge30pOwogICAgLy8gfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4geyBtZW1iZXJzaGlwVXBkYXRlOiB7fSB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBjYW5NYW5hZ2VNZW1iZXJzKCkgewogICAgICByZXR1cm4gY2FuVmlld0NsdXN0ZXJNZW1iZXJzaGlwRWRpdG9yKHRoaXMuJHN0b3JlKTsKICAgIH0sCgogICAgaGlkZURlc2NyaXB0aW9uczogbWFwUHJlZihISURFX0RFU0MpLAoKICAgIGhhcnZlc3RlckVuYWJsZWQ6IG1hcEZlYXR1cmUoSEFSVkVTVEVSX0ZFQVRVUkUpLAoKICAgIGhhcnZlc3RlckxvY2F0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5pc0NyZWF0ZSAmJiAhdGhpcy5oaWRlRGVzY3JpcHRpb25zLmluY2x1ZGVzKEhBUlZFU1RFUl9ISURFX0tFWSkgJiYgdGhpcy5oYXJ2ZXN0ZXJFbmFibGVkID8gewogICAgICAgIG5hbWU6ICAgYGMtY2x1c3Rlci1wcm9kdWN0LXJlc291cmNlYCwKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHByb2R1Y3Q6ICBIQVJWRVNURVJfTUFOQUdFUiwKICAgICAgICAgIHJlc291cmNlOiBIQ0kuQ0xVU1RFUiwKICAgICAgICB9CiAgICAgIH0gOiBudWxsOwogICAgfQogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLnJlZ2lzdGVyQWZ0ZXJIb29rKHRoaXMuc2F2ZVJvbGVCaW5kaW5ncywgJ3NhdmUtcm9sZS1iaW5kaW5ncycpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGRvbmUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7CiAgICAgICAgbmFtZTogICAnYy1jbHVzdGVyLXByb2R1Y3QtcmVzb3VyY2UtbmFtZXNwYWNlLWlkJywKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHJlc291cmNlOiAgQ0FQSS5SQU5DSEVSX0NMVVNURVIsCiAgICAgICAgICBuYW1lc3BhY2U6IHRoaXMudmFsdWUubWV0YWRhdGEubmFtZXNwYWNlLAogICAgICAgICAgaWQ6ICAgICAgICB0aGlzLnZhbHVlLm1ldGFkYXRhLm5hbWUsCiAgICAgICAgfSwKICAgICAgfSk7CiAgICB9LAoKICAgIGFzeW5jIHNhdmVSb2xlQmluZGluZ3MoKSB7CiAgICAgIGF3YWl0IHRoaXMudmFsdWUud2FpdEZvck1nbXQoKTsKCiAgICAgIGlmICh0aGlzLm1lbWJlcnNoaXBVcGRhdGUuc2F2ZSkgewogICAgICAgIGF3YWl0IHRoaXMubWVtYmVyc2hpcFVwZGF0ZS5zYXZlKHRoaXMudmFsdWUubWdtdC5pZCk7CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgc2F2ZU92ZXJyaWRlKGJ0bkNiKSB7CiAgICAgIGF3YWl0IHRoaXMuc2F2ZShidG5DYik7CiAgICB9LAoKICAgIG9uTWVtYmVyc2hpcFVwZGF0ZSh1cGRhdGUpIHsKICAgICAgdGhpcy4kc2V0KHRoaXMsICdtZW1iZXJzaGlwVXBkYXRlJywgdXBkYXRlKTsKICAgIH0sCgogICAgaGlkZUhhcnZlc3Rlck5vdGljZSgpIHsKICAgICAgY29uc3QgbmV1ID0gdGhpcy5oaWRlRGVzY3JpcHRpb25zLnNsaWNlKCk7CgogICAgICBhZGRPYmplY3QobmV1LCBIQVJWRVNURVJfSElERV9LRVkpOwoKICAgICAgdGhpcy5oaWRlRGVzY3JpcHRpb25zID0gbmV1OwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["import.vue"],"names":[],"mappings":";AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA","file":"import.vue","sourceRoot":"node_modules/@rancher/shell/edit/provisioning.cattle.io.cluster","sourcesContent":["<script>\nimport CreateEditView from '@shell/mixins/create-edit-view';\n\nimport CruResource from '@shell/components/CruResource';\nimport Loading from '@shell/components/Loading';\nimport NameNsDescription from '@shell/components/form/NameNsDescription';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport Tabbed from '@shell/components/Tabbed';\nimport { CAPI, HCI } from '@shell/config/types';\nimport ClusterMembershipEditor, { canViewClusterMembershipEditor } from '@shell/components/form/Members/ClusterMembershipEditor';\nimport { Banner } from '@components/Banner';\n\nimport { NAME as HARVESTER_MANAGER } from '@shell/config/harvester-manager-types';\nimport { HARVESTER as HARVESTER_FEATURE, mapFeature } from '@shell/store/features';\nimport { addObject } from '@shell/utils/array';\nimport { HIDE_DESC, mapPref } from '@shell/store/prefs';\nimport Labels from './Labels';\nimport AgentEnv from './AgentEnv';\n\nconst HARVESTER_HIDE_KEY = 'cm-harvester-import';\n\nexport default {\n  components: {\n    Banner,\n    ClusterMembershipEditor,\n    Loading,\n    NameNsDescription,\n    CruResource,\n    Tab,\n    Tabbed,\n    Labels,\n    AgentEnv\n  },\n\n  mixins: [CreateEditView],\n\n  props: {\n    mode: {\n      type:     String,\n      required: true,\n    },\n\n    value: {\n      type:     Object,\n      required: true,\n    },\n\n    provider: {\n      type:     String,\n      required: true,\n    },\n  },\n\n  fetch() {\n    // if ( !this.value.spec.rkeConfig ) {\n    // set(this.value.spec, 'rkeConfig', {});\n    // }\n  },\n\n  data() {\n    return { membershipUpdate: {} };\n  },\n\n  computed: {\n    canManageMembers() {\n      return canViewClusterMembershipEditor(this.$store);\n    },\n\n    hideDescriptions: mapPref(HIDE_DESC),\n\n    harvesterEnabled: mapFeature(HARVESTER_FEATURE),\n\n    harvesterLocation() {\n      return this.isCreate && !this.hideDescriptions.includes(HARVESTER_HIDE_KEY) && this.harvesterEnabled ? {\n        name:   `c-cluster-product-resource`,\n        params: {\n          product:  HARVESTER_MANAGER,\n          resource: HCI.CLUSTER,\n        }\n      } : null;\n    }\n  },\n\n  created() {\n    this.registerAfterHook(this.saveRoleBindings, 'save-role-bindings');\n  },\n\n  methods: {\n    done() {\n      return this.$router.replace({\n        name:   'c-cluster-product-resource-namespace-id',\n        params: {\n          resource:  CAPI.RANCHER_CLUSTER,\n          namespace: this.value.metadata.namespace,\n          id:        this.value.metadata.name,\n        },\n      });\n    },\n\n    async saveRoleBindings() {\n      await this.value.waitForMgmt();\n\n      if (this.membershipUpdate.save) {\n        await this.membershipUpdate.save(this.value.mgmt.id);\n      }\n    },\n\n    async saveOverride(btnCb) {\n      await this.save(btnCb);\n    },\n\n    onMembershipUpdate(update) {\n      this.$set(this, 'membershipUpdate', update);\n    },\n\n    hideHarvesterNotice() {\n      const neu = this.hideDescriptions.slice();\n\n      addObject(neu, HARVESTER_HIDE_KEY);\n\n      this.hideDescriptions = neu;\n    },\n  },\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <CruResource\n    v-else\n    :mode=\"mode\"\n    :resource=\"value\"\n    :errors=\"errors\"\n    component-testid=\"cluster-manager-import\"\n    @finish=\"saveOverride\"\n    @error=\"e=>errors = e\"\n  >\n    <Banner\n      v-if=\"harvesterLocation\"\n      color=\"info\"\n      :closable=\"true\"\n      class=\"mb-20\"\n      @close=\"hideHarvesterNotice\"\n    >\n      {{ t('cluster.harvester.importNotice') }}\n      <nuxt-link :to=\"harvesterLocation\">\n        {{ t('product.harvesterManager') }}\n      </nuxt-link>\n    </Banner>\n\n    <NameNsDescription\n      v-if=\"!isView\"\n      v-model=\"value\"\n      :mode=\"mode\"\n      :namespaced=\"false\"\n      name-label=\"cluster.name.label\"\n      name-placeholder=\"cluster.name.placeholder\"\n      description-label=\"cluster.description.label\"\n      description-placeholder=\"cluster.description.placeholder\"\n    />\n\n    <Tabbed :side-tabs=\"true\">\n      <Tab\n        v-if=\"canManageMembers\"\n        name=\"memberRoles\"\n        label-key=\"cluster.tabs.memberRoles\"\n        :weight=\"3\"\n      >\n        <Banner\n          v-if=\"isEdit\"\n          color=\"info\"\n        >\n          {{ t('cluster.memberRoles.removeMessage') }}\n        </Banner>\n        <ClusterMembershipEditor\n          :mode=\"mode\"\n          :parent-id=\"value.mgmt ? value.mgmt.id : null\"\n          @membership-update=\"onMembershipUpdate\"\n        />\n      </Tab>\n      <AgentEnv\n        v-model=\"value\"\n        :mode=\"mode\"\n      />\n      <Labels\n        v-model=\"value\"\n        :mode=\"mode\"\n      />\n    </Tabbed>\n  </CruResource>\n</template>\n"]}]}