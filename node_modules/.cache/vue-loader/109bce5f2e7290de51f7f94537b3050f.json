{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/CatalogList/CatalogLoadDialog.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/CatalogList/CatalogLoadDialog.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IGlzRW1wdHkgZnJvbSAnbG9kYXNoL2lzRW1wdHknOwoKaW1wb3J0IHsgQ0FUQUxPRywgU0VDUkVULCBTRVJWSUNFLCBXT1JLTE9BRF9UWVBFUyB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgeyBVSV9QTFVHSU5fTEFCRUxTLCBVSV9QTFVHSU5fTkFNRVNQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy91aXBsdWdpbnMnOwppbXBvcnQgeyBUWVBFUyBhcyBTRUNSRVRfVFlQRVMgfSBmcm9tICdAc2hlbGwvbW9kZWxzL3NlY3JldCc7CmltcG9ydCB7IGFsbEhhc2ggfSBmcm9tICdAc2hlbGwvdXRpbHMvcHJvbWlzZSc7CgppbXBvcnQgUmVzb3VyY2VNYW5hZ2VyIGZyb20gJ0BzaGVsbC9taXhpbnMvcmVzb3VyY2UtbWFuYWdlcic7CgppbXBvcnQgQXN5bmNCdXR0b24gZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvQXN5bmNCdXR0b24nOwppbXBvcnQgTGFiZWxlZFNlbGVjdCBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9mb3JtL0xhYmVsZWRTZWxlY3QnOwppbXBvcnQgTG9hZGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Mb2FkaW5nLnZ1ZSc7CmltcG9ydCB7IEJhbm5lciB9IGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lcic7CmltcG9ydCB7IExhYmVsZWRJbnB1dCB9IGZyb20gJ0Bjb21wb25lbnRzL0Zvcm0vTGFiZWxlZElucHV0JzsKCmNvbnN0IERFRkFVTFRfREVQTE9ZTUVOVCA9IHsKICB0eXBlOiAgICAgV09SS0xPQURfVFlQRVMuREVQTE9ZTUVOVCwKICBtZXRhZGF0YTogewogICAgbmFtZTogICAgICAnJywKICAgIG5hbWVzcGFjZTogVUlfUExVR0lOX05BTUVTUEFDRSwKICAgIGxhYmVsczogICAge30KICB9LAogIHNwZWM6IHsKICAgIHJlcGxpY2FzOiAxLAogICAgc2VsZWN0b3I6IHsgbWF0Y2hMYWJlbHM6IHt9IH0sCiAgICB0ZW1wbGF0ZTogewogICAgICBtZXRhZGF0YTogewogICAgICAgIG5hbWVzcGFjZTogVUlfUExVR0lOX05BTUVTUEFDRSwKICAgICAgICBsYWJlbHM6ICAgIHt9CiAgICAgIH0sCiAgICAgIHNwZWM6IHsKICAgICAgICBjb250YWluZXJzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGltYWdlOiAgICAgICAgICAgJycsCiAgICAgICAgICAgIGltYWdlUHVsbFBvbGljeTogJ0Fsd2F5cycsCiAgICAgICAgICAgIG5hbWU6ICAgICAgICAgICAgJ2NvbnRhaW5lci0wJwogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgaW1hZ2VQdWxsU2VjcmV0czogW10sCiAgICAgICAgcmVzdGFydFBvbGljeTogICAgJ0Fsd2F5cycKICAgICAgfQogICAgfQogIH0KfTsKCmNvbnN0IERFRkFVTFRfU0VSVklDRSA9IHsKICB0eXBlOiAgICAgU0VSVklDRSwKICBtZXRhZGF0YTogewogICAgbmFtZTogICAgICAnJywKICAgIG5hbWVzcGFjZTogVUlfUExVR0lOX05BTUVTUEFDRSwKICAgIGxhYmVsczogICAgeyBbVUlfUExVR0lOX0xBQkVMUy5DQVRBTE9HX0lNQUdFXTogJycgfQogIH0sCiAgc3BlYzogewogICAgcG9ydHM6IFsKICAgICAgewogICAgICAgIG5hbWU6ICAgICAgICcnLAogICAgICAgIHBvcnQ6ICAgICAgIDgwODAsCiAgICAgICAgcHJvdG9jb2w6ICAgJ1RDUCcsCiAgICAgICAgdGFyZ2V0UG9ydDogODA4MAogICAgICB9CiAgICBdLAogICAgc2VsZWN0b3I6IHsgW1VJX1BMVUdJTl9MQUJFTFMuQ0FUQUxPR19JTUFHRV06ICcnIH0sCiAgICB0eXBlOiAgICAgJ0NsdXN0ZXJJUCcKICB9Cn07Cgpjb25zdCBERUZBVUxUX1JFUE8gPSB7CiAgdHlwZTogICAgIENBVEFMT0cuQ0xVU1RFUl9SRVBPLAogIG1ldGFkYXRhOiB7CiAgICBuYW1lOiAgICcnLAogICAgbGFiZWxzOiB7IFtVSV9QTFVHSU5fTEFCRUxTLkNBVEFMT0dfSU1BR0VdOiAnJyB9CiAgfSwKICBzcGVjOiB7IHVybDogbnVsbCB9Cn07Cgpjb25zdCBpbml0aWFsU3RhdGUgPSAoKSA9PiB7CiAgY29uc3QgZGVwbG95bWVudFZhbHVlcyA9IHN0cnVjdHVyZWRDbG9uZShERUZBVUxUX0RFUExPWU1FTlQpOwogIGNvbnN0IHNlcnZpY2VWYWx1ZXMgPSBzdHJ1Y3R1cmVkQ2xvbmUoREVGQVVMVF9TRVJWSUNFKTsKICBjb25zdCByZXBvVmFsdWVzID0gc3RydWN0dXJlZENsb25lKERFRkFVTFRfUkVQTyk7CgogIHJldHVybiB7CiAgICBkZXBsb3ltZW50VmFsdWVzLAogICAgc2VydmljZVZhbHVlcywKICAgIHJlcG9WYWx1ZXMsCiAgICBjYW5Nb2RpZnlOYW1lOiAgICAgICAgICAgICAgdHJ1ZSwKICAgIGNhbk1vZGlmeUltYWdlOiAgICAgICAgICAgICB0cnVlLAogICAgaW1hZ2VQdWxsU2VjcmV0czogICAgICAgICAgIFtdLAogICAgaW1hZ2VQdWxsTmFtZXNwYWNlZFNlY3JldHM6IFtdLAogICAgZXh0ZW5zaW9uVXJsOiAgICAgICAgICAgICAgIG51bGwsCiAgICBleHRlbnNpb25EZXBsb3ltZW50OiAgICAgICAgbnVsbCwKICAgIGV4dGVuc2lvblN2YzogICAgICAgICAgICAgICBudWxsLAogICAgZXh0ZW5zaW9uUmVwbzogICAgICAgICAgICAgIG51bGwsCiAgICBleHRlbnNpb25DcmQ6ICAgICAgICAgICAgICAgbnVsbAogIH07Cn07CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQXN5bmNCdXR0b24sIEJhbm5lciwgTGFiZWxlZElucHV0LCBMb2FkaW5nLCBMYWJlbGVkU2VsZWN0CiAgfSwKCiAgbWl4aW5zOiBbUmVzb3VyY2VNYW5hZ2VyXSwKCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBjb25zdCBoYXNoID0ge307CgogICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2Nhbkxpc3QnXShXT1JLTE9BRF9UWVBFUy5ERVBMT1lNRU5UKSApIHsKICAgICAgaGFzaC5kZXBsb3ltZW50cyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IFdPUktMT0FEX1RZUEVTLkRFUExPWU1FTlQgfSk7CiAgICB9CgogICAgaWYgKCB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2Nhbkxpc3QnXShTRVJWSUNFKSApIHsKICAgICAgaGFzaC5zZXJ2aWNlcyA9IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IFNFUlZJQ0UgfSk7CiAgICB9CgogICAgYXdhaXQgYWxsSGFzaChoYXNoKTsKCiAgICB0aGlzLnNlY29uZGFyeVJlc291cmNlRGF0YSA9IHRoaXMuc2Vjb25kYXJ5UmVzb3VyY2VEYXRhQ29uZmlnKCk7CiAgICB0aGlzLnJlc291cmNlTWFuYWdlckZldGNoU2Vjb25kYXJ5UmVzb3VyY2VzKHRoaXMuc2Vjb25kYXJ5UmVzb3VyY2VEYXRhKTsKICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLi4uaW5pdGlhbFN0YXRlKCksCiAgICAgIHNlY29uZGFyeVJlc291cmNlRGF0YTogbnVsbAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyh7IGFsbFJlcG9zOiAnY2F0YWxvZy9yZXBvcycgfSksCgogICAgbmFtZXNwYWNlZERlcGxveW1lbnRzKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9hbGwnXShXT1JLTE9BRF9UWVBFUy5ERVBMT1lNRU5UKS5maWx0ZXIoKGRlcCkgPT4gZGVwLm1ldGFkYXRhLm5hbWVzcGFjZSA9PT0gVUlfUExVR0lOX05BTUVTUEFDRSk7CiAgICB9LAoKICAgIG5hbWVzcGFjZWRTZXJ2aWNlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbJ21hbmFnZW1lbnQvYWxsJ10oU0VSVklDRSkuZmlsdGVyKChzdmMpID0+IHN2Yy5tZXRhZGF0YS5uYW1lc3BhY2UgPT09IFVJX1BMVUdJTl9OQU1FU1BBQ0UpOwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHNlY29uZGFyeVJlc291cmNlRGF0YUNvbmZpZygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBuYW1lc3BhY2U6IFVJX1BMVUdJTl9OQU1FU1BBQ0UsCiAgICAgICAgZGF0YTogICAgICB7CiAgICAgICAgICBbU0VDUkVUXTogewogICAgICAgICAgICBhcHBseVRvOiBbCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgdmFyOiAgICAgICAgICdpbWFnZVB1bGxOYW1lc3BhY2VkU2VjcmV0cycsCiAgICAgICAgICAgICAgICBwYXJzaW5nRnVuYzogKGRhdGEpID0+IHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuZmlsdGVyKChzZWNyZXQpID0+IChzZWNyZXQuX3R5cGUgPT09IFNFQ1JFVF9UWVBFUy5ET0NLRVIgfHwgc2VjcmV0Ll90eXBlID09PSBTRUNSRVRfVFlQRVMuRE9DS0VSX0pTT04pKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH07CiAgICB9LAoKICAgIHNob3dEaWFsb2coKSB7CiAgICAgIHRoaXMuJG1vZGFsLnNob3coJ2NhdGFsb2dMb2FkRGlhbG9nJyk7CiAgICB9LAoKICAgIGNsb3NlRGlhbG9nKHJlc3VsdCkgewogICAgICB0aGlzLiRtb2RhbC5oaWRlKCdjYXRhbG9nTG9hZERpYWxvZycpOwogICAgICB0aGlzLiRlbWl0KCdjbG9zZWQnLCByZXN1bHQpOwoKICAgICAgLy8gUmVzZXQgc3RhdGUKICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLiRkYXRhLCBpbml0aWFsU3RhdGUoKSk7CiAgICAgIHRoaXMuc2Vjb25kYXJ5UmVzb3VyY2VEYXRhID0gdGhpcy5zZWNvbmRhcnlSZXNvdXJjZURhdGFDb25maWcoKTsKICAgICAgdGhpcy5yZXNvdXJjZU1hbmFnZXJGZXRjaFNlY29uZGFyeVJlc291cmNlcyh0aGlzLnNlY29uZGFyeVJlc291cmNlRGF0YSk7CiAgICB9LAoKICAgIGFzeW5jIGxvYWRJbWFnZShidG5DYikgewogICAgICB0cnkgewogICAgICAgIGlmICghaXNFbXB0eSh0aGlzLmRlcGxveW1lbnRWYWx1ZXMuc3BlYy50ZW1wbGF0ZS5zcGVjLmNvbnRhaW5lcnNbMF0uaW1hZ2UpKSB7CiAgICAgICAgICBjb25zdCBpbWFnZSA9IHRoaXMuZGVwbG95bWVudFZhbHVlcy5zcGVjLnRlbXBsYXRlLnNwZWMuY29udGFpbmVyc1swXS5pbWFnZTsKICAgICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmV4dHJhY3RJbWFnZU5hbWUoaW1hZ2UpOwoKICAgICAgICAgIGlmIChuYW1lKSB7CiAgICAgICAgICAgIC8vIENyZWF0ZSBkZXBsb3ltZW50CiAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZERlcGxveW1lbnQoaW1hZ2UsIG5hbWUsIGJ0bkNiKTsKCiAgICAgICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbkRlcGxveW1lbnQpIHsKICAgICAgICAgICAgICAvLyBDcmVhdGUgc2VydmljZQogICAgICAgICAgICAgIGF3YWl0IHRoaXMubG9hZFNlcnZpY2UobmFtZSwgYnRuQ2IpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5leHRlbnNpb25TdmMpIHsKICAgICAgICAgICAgICAvLyBDcmVhdGUgaGVsbSByZXBvCiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkUmVwbyhuYW1lLCBidG5DYik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICh0aGlzLmV4dGVuc2lvblJlcG8pIHsKICAgICAgICAgICAgICBidG5DYih0cnVlKTsKICAgICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2dyb3dsL3N1Y2Nlc3MnLCB7CiAgICAgICAgICAgICAgICB0aXRsZTogICB0aGlzLnQoJ3BsdWdpbnMubWFuYWdlQ2F0YWxvZy5pbWFnZUxvYWQuc3VjY2Vzcy50aXRsZScsIHsgbmFtZSB9KSwKICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMudCgncGx1Z2lucy5tYW5hZ2VDYXRhbG9nLmltYWdlTG9hZC5zdWNjZXNzLm1lc3NhZ2UnKSwKICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDQwMDAsCiAgICAgICAgICAgICAgfSwgeyByb290OiB0cnVlIH0pOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3JlZnJlc2gnKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbmFibGUgdG8gZGV0ZXJtaW5lIGltYWdlIG5hbWUnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLmhhbmRsZUdyb3dsRXJyb3IoZSwgdHJ1ZSk7CiAgICAgICAgYnRuQ2IoZmFsc2UpOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIGxvYWREZXBsb3ltZW50KGltYWdlLCBuYW1lLCBidG5DYikgewogICAgICBjb25zdCBleGlzdHMgPSB0aGlzLm5hbWVzcGFjZWREZXBsb3ltZW50cy5maW5kKChkZXApID0+IGRlcC5zcGVjLnRlbXBsYXRlLnNwZWMuY29udGFpbmVyc1swXS5pbWFnZSA9PT0gaW1hZ2UpOwoKICAgICAgaWYgKCFleGlzdHMpIHsKICAgICAgICAvLyBTZXRzIGRlcGxveW1lbnRWYWx1ZXMgd2l0aCBuYW1lLCBsYWJlbHMsIGFuZCBpbWFnZVB1bGxTZWNyZXRzCiAgICAgICAgY29uc3QgZGVwbG95bWVudFZhbHVlcyA9IHRoaXMucGFyc2VEZXBsb3ltZW50VmFsdWVzKG5hbWUpOwoKICAgICAgICB0aGlzLmV4dGVuc2lvbkRlcGxveW1lbnQgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9jcmVhdGUnLCBkZXBsb3ltZW50VmFsdWVzKTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGF3YWl0IHRoaXMuZXh0ZW5zaW9uRGVwbG95bWVudC5zYXZlKCk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgdGhpcy5oYW5kbGVHcm93bEVycm9yKGUsIHRydWUpOwogICAgICAgICAgYnRuQ2IoZmFsc2UpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCBlcnJvciA9IHsKICAgICAgICAgIF9zdGF0dXNUZXh0OiB0aGlzLnQoJ3BsdWdpbnMubWFuYWdlQ2F0YWxvZy5pbWFnZUxvYWQuZXJyb3IuZXhpc3RzLmRlcGxveW1lbnQudGl0bGUnKSwKICAgICAgICAgIG1lc3NhZ2U6ICAgICB0aGlzLnQoJ3BsdWdpbnMubWFuYWdlQ2F0YWxvZy5pbWFnZUxvYWQuZXJyb3IuZXhpc3RzLmRlcGxveW1lbnQubWVzc2FnZScsIHsgaW1hZ2UgfSkKICAgICAgICB9OwoKICAgICAgICB0aGlzLmhhbmRsZUdyb3dsRXJyb3IoZXJyb3IpOwogICAgICAgIGJ0bkNiKGZhbHNlKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBsb2FkU2VydmljZShuYW1lLCBidG5DYikgewogICAgICBjb25zdCBzZXJ2aWNlTmFtZSA9IGAkeyBuYW1lIH0tc3ZjYDsKICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5uYW1lc3BhY2VkU2VydmljZXMuZmluZCgoc3ZjKSA9PiBzdmMubWV0YWRhdGEubmFtZSA9PT0gc2VydmljZU5hbWUpOwoKICAgICAgaWYgKGV4aXN0cykgewogICAgICAgIGNvbnN0IGVycm9yID0gewogICAgICAgICAgX3N0YXR1c1RleHQ6IHRoaXMudCgncGx1Z2lucy5tYW5hZ2VDYXRhbG9nLmltYWdlTG9hZC5lcnJvci5leGlzdHMuc2VydmljZS50aXRsZScpLAogICAgICAgICAgbWVzc2FnZTogICAgIHRoaXMudCgncGx1Z2lucy5tYW5hZ2VDYXRhbG9nLmltYWdlTG9hZC5lcnJvci5leGlzdHMuc2VydmljZS5tZXNzYWdlJywgeyBzdmM6IHNlcnZpY2VOYW1lIH0pCiAgICAgICAgfTsKCiAgICAgICAgdGhpcy5oYW5kbGVHcm93bEVycm9yKGVycm9yLCB0cnVlKTsKICAgICAgICBidG5DYihmYWxzZSk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gU2V0cyBzZXJ2aWNlVmFsdWVzIHdpdGggbmFtZSwgbGFiZWwsIGFuZCBzZWxlY3RvcgogICAgICBjb25zdCBzZXJ2aWNlVmFsdWVzID0gdGhpcy5wYXJzZVNlcnZpY2VWYWx1ZXMobmFtZSwgc2VydmljZU5hbWUpOwogICAgICBjb25zdCBzZXJ2aWNlUmVzb3VyY2UgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9jcmVhdGUnLCBzZXJ2aWNlVmFsdWVzKTsKCiAgICAgIHRyeSB7CiAgICAgICAgYXdhaXQgc2VydmljZVJlc291cmNlLnNhdmUoKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHRoaXMuaGFuZGxlR3Jvd2xFcnJvcihlLCB0cnVlKTsKICAgICAgICBidG5DYihmYWxzZSk7CgogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLmV4dGVuc2lvblN2YyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmQnLCB7CiAgICAgICAgICB0eXBlOiAgICAgIFNFUlZJQ0UsCiAgICAgICAgICBpZDogICAgICAgIGAkeyBVSV9QTFVHSU5fTkFNRVNQQUNFIH0vJHsgc2VydmljZVJlc291cmNlLm1ldGFkYXRhLm5hbWUgfWAsCiAgICAgICAgICBuYW1lc3BhY2U6IFVJX1BMVUdJTl9OQU1FU1BBQ0UKICAgICAgICB9KTsKCiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9uU3ZjKSB7CiAgICAgICAgICB0aGlzLmV4dGVuc2lvblVybCA9IGBodHRwOi8vJHsgdGhpcy5leHRlbnNpb25TdmMuc3BlYy5jbHVzdGVySVAgfTokeyB0aGlzLmV4dGVuc2lvblN2Yy5zcGVjLnBvcnRzWzBdLnBvcnQgfWA7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRXJyb3IgZmV0Y2hpbmcgZXh0ZW5zaW9uIHNlcnZpY2UnKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLmhhbmRsZUdyb3dsRXJyb3IoZSwgdHJ1ZSk7CiAgICAgICAgYnRuQ2IoZmFsc2UpOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIGxvYWRSZXBvKG5hbWUsIGJ0bkNiKSB7CiAgICAgIGNvbnN0IGNoYXJ0TmFtZSA9IGAkeyBuYW1lIH0tY2hhcnRzYDsKICAgICAgY29uc3QgZXhpc3RzID0gdGhpcy5hbGxSZXBvcy5maW5kKChyZXBvKSA9PiByZXBvLm1ldGFkYXRhLm5hbWUgPT09IGNoYXJ0TmFtZSk7CgogICAgICBpZiAoZXhpc3RzKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSB7CiAgICAgICAgICBfc3RhdHVzVGV4dDogdGhpcy50KCdwbHVnaW5zLm1hbmFnZUNhdGFsb2cuaW1hZ2VMb2FkLmVycm9yLmV4aXN0cy5yZXBvLnRpdGxlJyksCiAgICAgICAgICBtZXNzYWdlOiAgICAgdGhpcy50KCdwbHVnaW5zLm1hbmFnZUNhdGFsb2cuaW1hZ2VMb2FkLmVycm9yLmV4aXN0cy5yZXBvLm1lc3NhZ2UnLCB7IHJlcG86IGNoYXJ0TmFtZSB9KQogICAgICAgIH07CgogICAgICAgIHRoaXMuaGFuZGxlR3Jvd2xFcnJvcihlcnJvcik7CiAgICAgICAgYnRuQ2IoZmFsc2UpOwogICAgICAgIHRoaXMuY2xlYW4oKTsKCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICAvLyBTZXQgcmVwb1ZhbHVlcyB3aXRoIG5hbWUsIGxhYmVsLCBhbmQgdXJsCiAgICAgIGNvbnN0IHJlcG9WYWx1ZXMgPSB0aGlzLnBhcnNlUmVwb1ZhbHVlcyhjaGFydE5hbWUpOwoKICAgICAgdGhpcy5leHRlbnNpb25SZXBvID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvY3JlYXRlJywgcmVwb1ZhbHVlcyk7CgogICAgICB0cnkgewogICAgICAgIGF3YWl0IHRoaXMuZXh0ZW5zaW9uUmVwby5zYXZlKCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLmhhbmRsZUdyb3dsRXJyb3IoZSwgdHJ1ZSk7CiAgICAgICAgYnRuQ2IoZmFsc2UpOwogICAgICB9CiAgICB9LAoKICAgIHBhcnNlRGVwbG95bWVudFZhbHVlcyhuYW1lKSB7CiAgICAgIGxldCBvdXQgPSB7fTsKCiAgICAgIHRoaXMuJHNldCh0aGlzLmRlcGxveW1lbnRWYWx1ZXMubWV0YWRhdGEsICduYW1lJywgbmFtZSk7CgogICAgICBjb25zdCBhZGRMYWJlbCA9IHsgW1VJX1BMVUdJTl9MQUJFTFMuQ0FUQUxPR19JTUFHRV06IG5hbWUgfTsKICAgICAgY29uc3QgYWRkVG8gPSBbJ21ldGFkYXRhLmxhYmVscycsICdzcGVjLnNlbGVjdG9yLm1hdGNoTGFiZWxzJywgJ3NwZWMudGVtcGxhdGUubWV0YWRhdGEubGFiZWxzJ107CgogICAgICAvLyBQb3B1bGF0ZXMgd29ya2xvYWRzZWxlY3RvciBsYWJlbHMKICAgICAgb3V0ID0gdGhpcy5hc3NpZ25MYWJlbHModGhpcy5kZXBsb3ltZW50VmFsdWVzLCBhZGRMYWJlbCwgYWRkVG8pOwoKICAgICAgaWYgKHRoaXMuaW1hZ2VQdWxsU2VjcmV0cy5sZW5ndGgpIHsKICAgICAgICBvdXQuc3BlYy50ZW1wbGF0ZS5zcGVjLmltYWdlUHVsbFNlY3JldHMgPSB0aGlzLmltYWdlUHVsbFNlY3JldHMubWFwKChzZWNyZXQpID0+IHsKICAgICAgICAgIHJldHVybiB7IG5hbWU6IHNlY3JldCB9OwogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKCiAgICBwYXJzZVNlcnZpY2VWYWx1ZXMobmFtZSwgc2VydmljZU5hbWUpIHsKICAgICAgY29uc3Qgb3V0ID0gdGhpcy5zZXJ2aWNlVmFsdWVzOwoKICAgICAgb3V0Lm1ldGFkYXRhLm5hbWUgPSBzZXJ2aWNlTmFtZTsKICAgICAgb3V0Lm1ldGFkYXRhLmxhYmVsc1tVSV9QTFVHSU5fTEFCRUxTLkNBVEFMT0dfSU1BR0VdID0gbmFtZTsKICAgICAgb3V0LnNwZWMuc2VsZWN0b3JbVUlfUExVR0lOX0xBQkVMUy5DQVRBTE9HX0lNQUdFXSA9IG5hbWU7CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKCiAgICBwYXJzZVJlcG9WYWx1ZXMoY2hhcnROYW1lKSB7CiAgICAgIGNvbnN0IG91dCA9IHRoaXMucmVwb1ZhbHVlczsKCiAgICAgIG91dC5tZXRhZGF0YS5uYW1lID0gY2hhcnROYW1lOwogICAgICBvdXQubWV0YWRhdGEubGFiZWxzW1VJX1BMVUdJTl9MQUJFTFMuQ0FUQUxPR19JTUFHRV0gPSB0aGlzLmRlcGxveW1lbnRWYWx1ZXMubWV0YWRhdGEubmFtZTsKICAgICAgb3V0LnNwZWMudXJsID0gdGhpcy5leHRlbnNpb25Vcmw7CgogICAgICByZXR1cm4gb3V0OwogICAgfSwKCiAgICBhc3NpZ25MYWJlbHMoc291cmNlLCBsYWJlbHMsIGFyZ3MpIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgcGF0aCA9IGFyZ3NbaV0uc3BsaXQoJy4nKTsKICAgICAgICBsZXQgY3VycmVudE9iaiA9IHNvdXJjZTsKCiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBwYXRoLmxlbmd0aCAtIDE7IGorKykgewogICAgICAgICAgY3VycmVudE9iaiA9IGN1cnJlbnRPYmpbcGF0aFtqXV07CiAgICAgICAgfQoKICAgICAgICBjdXJyZW50T2JqW3BhdGhbcGF0aC5sZW5ndGggLSAxXV0gPSBsYWJlbHM7CiAgICAgIH0KCiAgICAgIHJldHVybiBzb3VyY2U7CiAgICB9LAoKICAgIGV4dHJhY3RJbWFnZVZlcnNpb24oaW1hZ2UpIHsKICAgICAgLy8gUmV0dXJucyB0aGUgdmVyc2lvbiBudW1iZXIgd2l0aCBvcHRpb25hbCBwcmUtcmVsZWFzZSBpZGVudGlmaWVycwogICAgICBjb25zdCByZWdleCA9IC86KFxkK1wuXGQrXC5cZCsoWy1cd1xkXSspKikkLzsKICAgICAgY29uc3QgbWF0Y2hlcyA9IHJlZ2V4LmV4ZWMoaW1hZ2UpOwoKICAgICAgaWYgKG1hdGNoZXMpIHsKICAgICAgICByZXR1cm4gbWF0Y2hlc1sxXTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAoKICAgIGV4dHJhY3RJbWFnZU5hbWUoaW1hZ2UpIHsKICAgICAgLy8gUmV0dXJucyB0aGUgbmFtZSB3aXRoaW4gdGhlIGltYWdlIHRoYXQgcHJlZml4ZXMgdGhlIHZlcnNpb24gbnVtYmVyCiAgICAgIGNvbnN0IHJlZ2V4ID0gL1wvKFteLzpdKykoPzo6XGQrXC5cZCtcLlxkKygtW2EtekEtWjAtOV0rKT98JCkvOwogICAgICBjb25zdCBtYXRjaGVzID0gcmVnZXguZXhlYyhpbWFnZSk7CgogICAgICBpZiAobWF0Y2hlcykgewogICAgICAgIHJldHVybiBtYXRjaGVzWzFdOwogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCgogICAgY2xlYW4oKSB7CiAgICAgIC8vIFJlbW92ZSBmYWlsZWQgcmVzb3VyY2VzCiAgICAgIGlmICh0aGlzLmV4dGVuc2lvbkRlcGxveW1lbnQpIHsKICAgICAgICB0aGlzLmV4dGVuc2lvbkRlcGxveW1lbnQucmVtb3ZlKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9uU3ZjKSB7CiAgICAgICAgdGhpcy5leHRlbnNpb25TdmMucmVtb3ZlKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9uUmVwbykgewogICAgICAgIHRoaXMuZXh0ZW5zaW9uUmVwby5yZW1vdmUoKTsKICAgICAgfQogICAgfSwKCiAgICBoYW5kbGVHcm93bEVycm9yKGUsIGNsZWFuID0gZmFsc2UpIHsKICAgICAgY29uc3QgZXJyb3IgPSBlPy5kYXRhIHx8IGU7CgogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3Jvd2wvZXJyb3InLCB7CiAgICAgICAgdGl0bGU6ICAgZXJyb3IuX3N0YXR1c1RleHQsCiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwKICAgICAgICB0aW1lb3V0OiA1MDAwLAogICAgICB9LCB7IHJvb3Q6IHRydWUgfSk7CgogICAgICBpZiAoY2xlYW4pIHsKICAgICAgICB0aGlzLmNsZWFuKCk7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["CatalogLoadDialog.vue"],"names":[],"mappings":";AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"CatalogLoadDialog.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/uiplugins/CatalogList","sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport isEmpty from 'lodash/isEmpty';\n\nimport { CATALOG, SECRET, SERVICE, WORKLOAD_TYPES } from '@shell/config/types';\nimport { UI_PLUGIN_LABELS, UI_PLUGIN_NAMESPACE } from '@shell/config/uiplugins';\nimport { TYPES as SECRET_TYPES } from '@shell/models/secret';\nimport { allHash } from '@shell/utils/promise';\n\nimport ResourceManager from '@shell/mixins/resource-manager';\n\nimport AsyncButton from '@shell/components/AsyncButton';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport Loading from '@shell/components/Loading.vue';\nimport { Banner } from '@components/Banner';\nimport { LabeledInput } from '@components/Form/LabeledInput';\n\nconst DEFAULT_DEPLOYMENT = {\n  type:     WORKLOAD_TYPES.DEPLOYMENT,\n  metadata: {\n    name:      '',\n    namespace: UI_PLUGIN_NAMESPACE,\n    labels:    {}\n  },\n  spec: {\n    replicas: 1,\n    selector: { matchLabels: {} },\n    template: {\n      metadata: {\n        namespace: UI_PLUGIN_NAMESPACE,\n        labels:    {}\n      },\n      spec: {\n        containers: [\n          {\n            image:           '',\n            imagePullPolicy: 'Always',\n            name:            'container-0'\n          }\n        ],\n        imagePullSecrets: [],\n        restartPolicy:    'Always'\n      }\n    }\n  }\n};\n\nconst DEFAULT_SERVICE = {\n  type:     SERVICE,\n  metadata: {\n    name:      '',\n    namespace: UI_PLUGIN_NAMESPACE,\n    labels:    { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: '' }\n  },\n  spec: {\n    ports: [\n      {\n        name:       '',\n        port:       8080,\n        protocol:   'TCP',\n        targetPort: 8080\n      }\n    ],\n    selector: { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: '' },\n    type:     'ClusterIP'\n  }\n};\n\nconst DEFAULT_REPO = {\n  type:     CATALOG.CLUSTER_REPO,\n  metadata: {\n    name:   '',\n    labels: { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: '' }\n  },\n  spec: { url: null }\n};\n\nconst initialState = () => {\n  const deploymentValues = structuredClone(DEFAULT_DEPLOYMENT);\n  const serviceValues = structuredClone(DEFAULT_SERVICE);\n  const repoValues = structuredClone(DEFAULT_REPO);\n\n  return {\n    deploymentValues,\n    serviceValues,\n    repoValues,\n    canModifyName:              true,\n    canModifyImage:             true,\n    imagePullSecrets:           [],\n    imagePullNamespacedSecrets: [],\n    extensionUrl:               null,\n    extensionDeployment:        null,\n    extensionSvc:               null,\n    extensionRepo:              null,\n    extensionCrd:               null\n  };\n};\n\nexport default {\n  components: {\n    AsyncButton, Banner, LabeledInput, Loading, LabeledSelect\n  },\n\n  mixins: [ResourceManager],\n\n  async fetch() {\n    const hash = {};\n\n    if ( this.$store.getters['management/canList'](WORKLOAD_TYPES.DEPLOYMENT) ) {\n      hash.deployments = this.$store.dispatch('management/findAll', { type: WORKLOAD_TYPES.DEPLOYMENT });\n    }\n\n    if ( this.$store.getters['management/canList'](SERVICE) ) {\n      hash.services = this.$store.dispatch('management/findAll', { type: SERVICE });\n    }\n\n    await allHash(hash);\n\n    this.secondaryResourceData = this.secondaryResourceDataConfig();\n    this.resourceManagerFetchSecondaryResources(this.secondaryResourceData);\n  },\n\n  data() {\n    return {\n      ...initialState(),\n      secondaryResourceData: null\n    };\n  },\n\n  computed: {\n    ...mapGetters({ allRepos: 'catalog/repos' }),\n\n    namespacedDeployments() {\n      return this.$store.getters['management/all'](WORKLOAD_TYPES.DEPLOYMENT).filter((dep) => dep.metadata.namespace === UI_PLUGIN_NAMESPACE);\n    },\n\n    namespacedServices() {\n      return this.$store.getters['management/all'](SERVICE).filter((svc) => svc.metadata.namespace === UI_PLUGIN_NAMESPACE);\n    }\n  },\n\n  methods: {\n    secondaryResourceDataConfig() {\n      return {\n        namespace: UI_PLUGIN_NAMESPACE,\n        data:      {\n          [SECRET]: {\n            applyTo: [\n              {\n                var:         'imagePullNamespacedSecrets',\n                parsingFunc: (data) => {\n                  return data.filter((secret) => (secret._type === SECRET_TYPES.DOCKER || secret._type === SECRET_TYPES.DOCKER_JSON));\n                }\n              }\n            ]\n          }\n        }\n      };\n    },\n\n    showDialog() {\n      this.$modal.show('catalogLoadDialog');\n    },\n\n    closeDialog(result) {\n      this.$modal.hide('catalogLoadDialog');\n      this.$emit('closed', result);\n\n      // Reset state\n      Object.assign(this.$data, initialState());\n      this.secondaryResourceData = this.secondaryResourceDataConfig();\n      this.resourceManagerFetchSecondaryResources(this.secondaryResourceData);\n    },\n\n    async loadImage(btnCb) {\n      try {\n        if (!isEmpty(this.deploymentValues.spec.template.spec.containers[0].image)) {\n          const image = this.deploymentValues.spec.template.spec.containers[0].image;\n          const name = this.extractImageName(image);\n\n          if (name) {\n            // Create deployment\n            await this.loadDeployment(image, name, btnCb);\n\n            if (this.extensionDeployment) {\n              // Create service\n              await this.loadService(name, btnCb);\n            }\n\n            if (this.extensionSvc) {\n              // Create helm repo\n              await this.loadRepo(name, btnCb);\n            }\n\n            if (this.extensionRepo) {\n              btnCb(true);\n              this.closeDialog();\n              this.$store.dispatch('growl/success', {\n                title:   this.t('plugins.manageCatalog.imageLoad.success.title', { name }),\n                message: this.t('plugins.manageCatalog.imageLoad.success.message'),\n                timeout: 4000,\n              }, { root: true });\n              this.$emit('refresh');\n            }\n          } else {\n            throw new Error('Unable to determine image name');\n          }\n        }\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n      }\n    },\n\n    async loadDeployment(image, name, btnCb) {\n      const exists = this.namespacedDeployments.find((dep) => dep.spec.template.spec.containers[0].image === image);\n\n      if (!exists) {\n        // Sets deploymentValues with name, labels, and imagePullSecrets\n        const deploymentValues = this.parseDeploymentValues(name);\n\n        this.extensionDeployment = await this.$store.dispatch('management/create', deploymentValues);\n\n        try {\n          await this.extensionDeployment.save();\n        } catch (e) {\n          this.handleGrowlError(e, true);\n          btnCb(false);\n        }\n      } else {\n        const error = {\n          _statusText: this.t('plugins.manageCatalog.imageLoad.error.exists.deployment.title'),\n          message:     this.t('plugins.manageCatalog.imageLoad.error.exists.deployment.message', { image })\n        };\n\n        this.handleGrowlError(error);\n        btnCb(false);\n      }\n    },\n\n    async loadService(name, btnCb) {\n      const serviceName = `${ name }-svc`;\n      const exists = this.namespacedServices.find((svc) => svc.metadata.name === serviceName);\n\n      if (exists) {\n        const error = {\n          _statusText: this.t('plugins.manageCatalog.imageLoad.error.exists.service.title'),\n          message:     this.t('plugins.manageCatalog.imageLoad.error.exists.service.message', { svc: serviceName })\n        };\n\n        this.handleGrowlError(error, true);\n        btnCb(false);\n\n        return;\n      }\n\n      // Sets serviceValues with name, label, and selector\n      const serviceValues = this.parseServiceValues(name, serviceName);\n      const serviceResource = await this.$store.dispatch('management/create', serviceValues);\n\n      try {\n        await serviceResource.save();\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n\n        return;\n      }\n\n      try {\n        this.extensionSvc = await this.$store.dispatch('management/find', {\n          type:      SERVICE,\n          id:        `${ UI_PLUGIN_NAMESPACE }/${ serviceResource.metadata.name }`,\n          namespace: UI_PLUGIN_NAMESPACE\n        });\n\n        if (this.extensionSvc) {\n          this.extensionUrl = `http://${ this.extensionSvc.spec.clusterIP }:${ this.extensionSvc.spec.ports[0].port }`;\n        } else {\n          throw new Error('Error fetching extension service');\n        }\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n      }\n    },\n\n    async loadRepo(name, btnCb) {\n      const chartName = `${ name }-charts`;\n      const exists = this.allRepos.find((repo) => repo.metadata.name === chartName);\n\n      if (exists) {\n        const error = {\n          _statusText: this.t('plugins.manageCatalog.imageLoad.error.exists.repo.title'),\n          message:     this.t('plugins.manageCatalog.imageLoad.error.exists.repo.message', { repo: chartName })\n        };\n\n        this.handleGrowlError(error);\n        btnCb(false);\n        this.clean();\n\n        return;\n      }\n\n      // Set repoValues with name, label, and url\n      const repoValues = this.parseRepoValues(chartName);\n\n      this.extensionRepo = await this.$store.dispatch('management/create', repoValues);\n\n      try {\n        await this.extensionRepo.save();\n      } catch (e) {\n        this.handleGrowlError(e, true);\n        btnCb(false);\n      }\n    },\n\n    parseDeploymentValues(name) {\n      let out = {};\n\n      this.$set(this.deploymentValues.metadata, 'name', name);\n\n      const addLabel = { [UI_PLUGIN_LABELS.CATALOG_IMAGE]: name };\n      const addTo = ['metadata.labels', 'spec.selector.matchLabels', 'spec.template.metadata.labels'];\n\n      // Populates workloadselector labels\n      out = this.assignLabels(this.deploymentValues, addLabel, addTo);\n\n      if (this.imagePullSecrets.length) {\n        out.spec.template.spec.imagePullSecrets = this.imagePullSecrets.map((secret) => {\n          return { name: secret };\n        });\n      }\n\n      return out;\n    },\n\n    parseServiceValues(name, serviceName) {\n      const out = this.serviceValues;\n\n      out.metadata.name = serviceName;\n      out.metadata.labels[UI_PLUGIN_LABELS.CATALOG_IMAGE] = name;\n      out.spec.selector[UI_PLUGIN_LABELS.CATALOG_IMAGE] = name;\n\n      return out;\n    },\n\n    parseRepoValues(chartName) {\n      const out = this.repoValues;\n\n      out.metadata.name = chartName;\n      out.metadata.labels[UI_PLUGIN_LABELS.CATALOG_IMAGE] = this.deploymentValues.metadata.name;\n      out.spec.url = this.extensionUrl;\n\n      return out;\n    },\n\n    assignLabels(source, labels, args) {\n      for (let i = 0; i < args.length; i++) {\n        const path = args[i].split('.');\n        let currentObj = source;\n\n        for (let j = 0; j < path.length - 1; j++) {\n          currentObj = currentObj[path[j]];\n        }\n\n        currentObj[path[path.length - 1]] = labels;\n      }\n\n      return source;\n    },\n\n    extractImageVersion(image) {\n      // Returns the version number with optional pre-release identifiers\n      const regex = /:(\\d+\\.\\d+\\.\\d+([-\\w\\d]+)*)$/;\n      const matches = regex.exec(image);\n\n      if (matches) {\n        return matches[1];\n      }\n\n      return null;\n    },\n\n    extractImageName(image) {\n      // Returns the name within the image that prefixes the version number\n      const regex = /\\/([^/:]+)(?::\\d+\\.\\d+\\.\\d+(-[a-zA-Z0-9]+)?|$)/;\n      const matches = regex.exec(image);\n\n      if (matches) {\n        return matches[1];\n      }\n\n      return null;\n    },\n\n    clean() {\n      // Remove failed resources\n      if (this.extensionDeployment) {\n        this.extensionDeployment.remove();\n      }\n      if (this.extensionSvc) {\n        this.extensionSvc.remove();\n      }\n      if (this.extensionRepo) {\n        this.extensionRepo.remove();\n      }\n    },\n\n    handleGrowlError(e, clean = false) {\n      const error = e?.data || e;\n\n      this.$store.dispatch('growl/error', {\n        title:   error._statusText,\n        message: error.message,\n        timeout: 5000,\n      }, { root: true });\n\n      if (clean) {\n        this.clean();\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <modal\n    name=\"catalogLoadDialog\"\n    height=\"auto\"\n    :scrollable=\"true\"\n    @closed=\"closeDialog()\"\n  >\n    <Loading\n      v-if=\"$fetchState.loading\"\n      mode=\"relative\"\n    />\n    <div\n      v-else\n      class=\"plugin-install-dialog\"\n    >\n      <template>\n        <div>\n          <h4>\n            {{ t('plugins.manageCatalog.imageLoad.load') }}\n          </h4>\n          <p>\n            {{ t('plugins.manageCatalog.imageLoad.prompt') }}\n          </p>\n\n          <div class=\"custom mt-10\">\n            <Banner\n              color=\"info\"\n              :label=\"t('plugins.manageCatalog.imageLoad.banner')\"\n              class=\"mt-10\"\n            />\n          </div>\n\n          <div class=\"custom mt-10\">\n            <div class=\"fields\">\n              <LabeledInput\n                v-model.trim=\"deploymentValues.spec.template.spec.containers[0].image\"\n                label-key=\"plugins.manageCatalog.imageLoad.fields.image.label\"\n                placeholder-key=\"plugins.manageCatalog.imageLoad.fields.image.placeholder\"\n              />\n            </div>\n          </div>\n          <div class=\"custom mt-10\">\n            <div class=\"fields\">\n              <LabeledSelect\n                v-model=\"imagePullSecrets\"\n                :label=\"t('workload.container.imagePullSecrets')\"\n                :multiple=\"true\"\n                :taggable=\"true\"\n                :options=\"imagePullNamespacedSecrets\"\n                option-label=\"metadata.name\"\n                :reduce=\"service => service.metadata.name\"\n              />\n              <Banner\n                color=\"warning\"\n                class=\"mt-10\"\n              >\n                <span v-clean-html=\"t('plugins.manageCatalog.imageLoad.fields.secrets.banner', {}, true)\" />\n              </Banner>\n            </div>\n          </div>\n        </div>\n      </template>\n\n      <div class=\"custom mt-10\">\n        <div class=\"fields\">\n          <div class=\"dialog-buttons mt-20\">\n            <button\n              class=\"btn role-secondary\"\n              data-testid=\"image-load-ext-modal-cancel-btn\"\n              @click=\"closeDialog()\"\n            >\n              {{ t('generic.cancel') }}\n            </button>\n            <AsyncButton\n              mode=\"load\"\n              data-testid=\"image-load-ext-modal-install-btn\"\n              @click=\"loadImage\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </modal>\n</template>\n\n<style lang=\"scss\" scoped>\n  .plugin-install-dialog {\n    padding: 10px;\n\n    h4 {\n      font-weight: bold;\n    }\n\n    .dialog-panel {\n      display: flex;\n      flex-direction: column;\n      min-height: 100px;\n\n      p {\n        margin-bottom: 5px;\n      }\n\n      .dialog-info {\n        flex: 1;\n      }\n    }\n\n    .dialog-buttons {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 10px;\n\n      > *:not(:last-child) {\n        margin-right: 10px;\n      }\n    }\n  }\n</style>\n"]}]}