{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/InstallDialog.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/pages/c/_cluster/uiplugins/InstallDialog.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBBc3luY0J1dHRvbiBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Bc3luY0J1dHRvbic7CmltcG9ydCBMYWJlbGVkU2VsZWN0IGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vTGFiZWxlZFNlbGVjdCc7CmltcG9ydCB7IENBVEFMT0csIE1BTkFHRU1FTlQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgQ0FUQUxPRyBhcyBDQVRBTE9HX0FOTk9UQVRJT05TIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy9sYWJlbHMtYW5ub3RhdGlvbnMnOwppbXBvcnQgeyBVSV9QTFVHSU5fTkFNRVNQQUNFIH0gZnJvbSAnQHNoZWxsL2NvbmZpZy91aXBsdWdpbnMnOwppbXBvcnQgQmFubmVyIGZyb20gJ0Bjb21wb25lbnRzL0Jhbm5lci9CYW5uZXIudnVlJzsKCi8vIE5vdGU6IFRoaXMgZGlhbG9nIGhhbmRsZXMgaW5zdGFsbGF0aW9uIGFuZCB1cGRhdGUgb2YgYSBwbHVnaW4KCmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBBc3luY0J1dHRvbiwKICAgIEJhbm5lciwKICAgIExhYmVsZWRTZWxlY3QsCiAgfSwKCiAgYXN5bmMgZmV0Y2goKSB7CiAgICB0aGlzLmRlZmF1bHRSZWdpc3RyeVNldHRpbmcgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kJywgewogICAgICB0eXBlOiBNQU5BR0VNRU5ULlNFVFRJTkcsCiAgICAgIGlkOiAgICdzeXN0ZW0tZGVmYXVsdC1yZWdpc3RyeScKICAgIH0pOwogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjdXJyZW50VmVyc2lvbjogICAgICAgICAnJywKICAgICAgZGVmYXVsdFJlZ2lzdHJ5U2V0dGluZzogbnVsbCwKICAgICAgcGx1Z2luOiAgICAgICAgICAgICAgICAgdW5kZWZpbmVkLAogICAgICBidXN5OiAgICAgICAgICAgICAgICAgICBmYWxzZSwKICAgICAgdmVyc2lvbjogICAgICAgICAgICAgICAgJycsCiAgICAgIHVwZGF0ZTogICAgICAgICAgICAgICAgIGZhbHNlLAogICAgICBtb2RlOiAgICAgICAgICAgICAgICAgICAnJywKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIHNob3dWZXJzaW9uU2VsZWN0b3IoKSB7CiAgICAgIHJldHVybiB0aGlzLnZlcnNpb25PcHRpb25zPy5sZW5ndGggPiAxOwogICAgfSwKCiAgICB2ZXJzaW9uT3B0aW9ucygpIHsKICAgICAgaWYgKCF0aGlzLnBsdWdpbikgewogICAgICAgIHJldHVybiBbXTsKICAgICAgfQoKICAgICAgLy8gRG9uJ3QgYWxsb3cgdXBkYXRlL3JvbGxiYWNrIHRvIGN1cnJlbnQgdmVyc2lvbgogICAgICBjb25zdCB2ZXJzaW9ucyA9IHRoaXMucGx1Z2luPy5pbnN0YWxsYWJsZVZlcnNpb25zPy5maWx0ZXIoKHYpID0+IHsKICAgICAgICBpZiAodGhpcy5jdXJyZW50VmVyc2lvbikgewogICAgICAgICAgcmV0dXJuIHYudmVyc2lvbiAhPT0gdGhpcy5jdXJyZW50VmVyc2lvbjsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9KTsKCiAgICAgIHJldHVybiB2ZXJzaW9ucy5tYXAoKHZlcnNpb24pID0+IHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbGFiZWw6IHZlcnNpb24udmVyc2lvbiwKICAgICAgICAgIHZhbHVlOiB2ZXJzaW9uLnZlcnNpb24sCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9LAoKICAgIGJ1dHRvbk1vZGUoKSB7CiAgICAgIHJldHVybiB0aGlzLnVwZGF0ZSA/ICd1cGRhdGUnIDogJ2luc3RhbGwnOwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIHNob3dEaWFsb2cocGx1Z2luLCBtb2RlKSB7CiAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luOwogICAgICB0aGlzLm1vZGUgPSBtb2RlOwoKICAgICAgLy8gRGVmYXVsdCB0byBsYXRlc3QgdmVyc2lvbiBvbiBpbnN0YWxsICh0aGlzIGlzIGRlZmF1bHQgb24gdGhlIHBsdWdpbikKICAgICAgdGhpcy52ZXJzaW9uID0gcGx1Z2luLmRpc3BsYXlWZXJzaW9uOwoKICAgICAgaWYgKG1vZGUgPT09ICd1cGRhdGUnKSB7CiAgICAgICAgdGhpcy5jdXJyZW50VmVyc2lvbiA9IHBsdWdpbi5kaXNwbGF5VmVyc2lvbjsKCiAgICAgICAgLy8gVXBkYXRlIHRvIGxhdGVzdCB2ZXJzaW9uLCBzbyB0YWtlIHRoZSBmaXJzdCB2ZXJzaW9uCiAgICAgICAgaWYgKHBsdWdpbi5pbnN0YWxsYWJsZVZlcnNpb25zPy5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLnZlcnNpb24gPSBwbHVnaW4uaW5zdGFsbGFibGVWZXJzaW9ucz8uWzBdPy52ZXJzaW9uOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChtb2RlID09PSAncm9sbGJhY2snKSB7CiAgICAgICAgLy8gRmluZCB0aGUgbmV3ZXN0IHZlcnNpb24gb25jZSB3ZSByZW1vdmUgdGhlIGN1cnJlbnQgdmVyc2lvbgogICAgICAgIGNvbnN0IHZlcnNpb25OYW1lcyA9IHBsdWdpbi5pbnN0YWxsYWJsZVZlcnNpb25zLmZpbHRlcigodikgPT4gdi52ZXJzaW9uICE9PSBwbHVnaW4uZGlzcGxheVZlcnNpb24pOwoKICAgICAgICB0aGlzLmN1cnJlbnRWZXJzaW9uID0gcGx1Z2luLmRpc3BsYXlWZXJzaW9uOwoKICAgICAgICBpZiAodmVyc2lvbk5hbWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMudmVyc2lvbiA9IHZlcnNpb25OYW1lc1swXS52ZXJzaW9uOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLy8gTWFrZSBzdXJlIHdlIGhhdmUgdGhlIHZlcnNpb24gYXZhaWxhYmxlCiAgICAgIGNvbnN0IHZlcnNpb25DaGFydCA9IHBsdWdpbi5pbnN0YWxsYWJsZVZlcnNpb25zPy5maW5kKCh2KSA9PiB2LnZlcnNpb24gPT09IHRoaXMudmVyc2lvbik7CgogICAgICBpZiAoIXZlcnNpb25DaGFydCkgewogICAgICAgIHRoaXMudmVyc2lvbiA9IHBsdWdpbi5pbnN0YWxsYWJsZVZlcnNpb25zPy5bMF0/LnZlcnNpb247CiAgICAgIH0KCiAgICAgIHRoaXMuYnVzeSA9IGZhbHNlOwogICAgICB0aGlzLnVwZGF0ZSA9IG1vZGUgIT09ICdpbnN0YWxsJzsKICAgICAgdGhpcy4kbW9kYWwuc2hvdygnaW5zdGFsbFBsdWdpbkRpYWxvZycpOwogICAgfSwKCiAgICBjbG9zZURpYWxvZyhyZXN1bHQpIHsKICAgICAgdGhpcy4kbW9kYWwuaGlkZSgnaW5zdGFsbFBsdWdpbkRpYWxvZycpOwogICAgICB0aGlzLiRlbWl0KCdjbG9zZWQnLCByZXN1bHQpOwogICAgfSwKCiAgICBhc3luYyBpbnN0YWxsKCkgewogICAgICB0aGlzLmJ1c3kgPSB0cnVlOwoKICAgICAgY29uc3QgcGx1Z2luID0gdGhpcy5wbHVnaW47CgogICAgICB0aGlzLiRlbWl0KCd1cGRhdGUnLCBwbHVnaW4ubmFtZSwgJ2luc3RhbGwnKTsKCiAgICAgIC8vIEZpbmQgdGhlIHZlcnNpb24gdGhhdCB0aGUgdXNlciB3YW50cyB0byBpbnN0YWxsCiAgICAgIGNvbnN0IHZlcnNpb24gPSBwbHVnaW4udmVyc2lvbnM/LmZpbmQoKHYpID0+IHYudmVyc2lvbiA9PT0gdGhpcy52ZXJzaW9uKTsKCiAgICAgIGlmICghdmVyc2lvbikgewogICAgICAgIHRoaXMuYnVzeSA9IGZhbHNlOwoKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIC8vIGlzIHRoZSBpbWFnZSB1c2VkIGJ5IHRoZSBjaGFydCBpbiB0aGUgcmFuY2hlciBvcmc/CiAgICAgIGxldCBpc1JhbmNoZXJJbWFnZSA9IGZhbHNlOwoKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBjaGFydFZlcnNpb25JbmZvID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ2NhdGFsb2cvZ2V0VmVyc2lvbkluZm8nLCB7CiAgICAgICAgICByZXBvVHlwZTogICAgdmVyc2lvbi5yZXBvVHlwZSwKICAgICAgICAgIHJlcG9OYW1lOiAgICB2ZXJzaW9uLnJlcG9OYW1lLAogICAgICAgICAgY2hhcnROYW1lOiAgIHBsdWdpbi5jaGFydC5jaGFydE5hbWUsCiAgICAgICAgICB2ZXJzaW9uTmFtZTogdGhpcy52ZXJzaW9uLAogICAgICAgIH0pOwoKICAgICAgICBjb25zdCBpbWFnZSA9IGNoYXJ0VmVyc2lvbkluZm8/LnZhbHVlcz8uaW1hZ2U/LnJlcG9zaXRvcnkgfHwgJyc7CgogICAgICAgIGlzUmFuY2hlckltYWdlID0gaW1hZ2Uuc3RhcnRzV2l0aCgncmFuY2hlci8nKTsKICAgICAgfSBjYXRjaCAoZSkge30KCiAgICAgIC8vIFNlZSBpZiB0aGVyZSBpcyBhbHJlYWR5IGEgcGx1Z2luIHdpdGggdGhpcyBuYW1lCiAgICAgIGxldCBleGlzdHMgPSBmYWxzZTsKCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgYXBwID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZCcsIHsKICAgICAgICAgIHR5cGU6IENBVEFMT0cuQVBQLAogICAgICAgICAgaWQ6ICAgYCR7IFVJX1BMVUdJTl9OQU1FU1BBQ0UgfS8keyBwbHVnaW4uY2hhcnQuY2hhcnROYW1lIH1gLAogICAgICAgICAgb3B0OiAgeyBmb3JjZTogdHJ1ZSB9LAogICAgICAgIH0pOwoKICAgICAgICBleGlzdHMgPSAhIWFwcDsKICAgICAgfSBjYXRjaCAoZSkge30KCiAgICAgIGNvbnN0IHJlcG9UeXBlID0gdmVyc2lvbi5yZXBvVHlwZTsKICAgICAgY29uc3QgcmVwb05hbWUgPSB2ZXJzaW9uLnJlcG9OYW1lOwogICAgICBjb25zdCByZXBvID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snY2F0YWxvZy9yZXBvJ10oeyByZXBvVHlwZSwgcmVwb05hbWUgfSk7CgogICAgICBjb25zdCBjaGFydCA9IHsKICAgICAgICBjaGFydE5hbWU6ICAgcGx1Z2luLmNoYXJ0LmNoYXJ0TmFtZSwKICAgICAgICB2ZXJzaW9uOiAgICAgdGhpcy52ZXJzaW9uLAogICAgICAgIHJlbGVhc2VOYW1lOiBwbHVnaW4uY2hhcnQuY2hhcnROYW1lLAogICAgICAgIGFubm90YXRpb25zOiB7CiAgICAgICAgICBbQ0FUQUxPR19BTk5PVEFUSU9OUy5TT1VSQ0VfUkVQT19UWVBFXTogcGx1Z2luLnJlcG9UeXBlLAogICAgICAgICAgW0NBVEFMT0dfQU5OT1RBVElPTlMuU09VUkNFX1JFUE9fTkFNRV06IHBsdWdpbi5yZXBvTmFtZQogICAgICAgIH0sCiAgICAgICAgdmFsdWVzOiB7fQogICAgICB9OwoKICAgICAgLy8gUGFzcyBpbiB0aGUgc3lzdGVtIGRlZmF1bHQgcmVnaXN0cnkgcHJvcGVydHkgaWYgc2V0IC0gb25seSBpZiB0aGUgaW1hZ2UgaXMgaW4gdGhlIHJhbmNoZXIgb3JnCiAgICAgIGNvbnN0IGRlZmF1bHRSZWdpc3RyeSA9IHRoaXMuZGVmYXVsdFJlZ2lzdHJ5U2V0dGluZz8udmFsdWUgfHwgJyc7CgogICAgICBpZiAoaXNSYW5jaGVySW1hZ2UgJiYgZGVmYXVsdFJlZ2lzdHJ5KSB7CiAgICAgICAgY2hhcnQudmFsdWVzLmdsb2JhbCA9IGNoYXJ0LnZhbHVlcy5nbG9iYWwgfHwge307CiAgICAgICAgY2hhcnQudmFsdWVzLmdsb2JhbC5jYXR0bGUgPSBjaGFydC52YWx1ZXMuZ2xvYmFsLmNhdHRsZSB8fCB7fTsKICAgICAgICBjaGFydC52YWx1ZXMuZ2xvYmFsLmNhdHRsZS5zeXN0ZW1EZWZhdWx0UmVnaXN0cnkgPSBkZWZhdWx0UmVnaXN0cnk7CiAgICAgIH0KCiAgICAgIGNvbnN0IGlucHV0ID0gewogICAgICAgIGNoYXJ0czogICAgW2NoYXJ0XSwKICAgICAgICAvLyB0aW1lb3V0OiAgIHRoaXMuY21kT3B0aW9ucy50aW1lb3V0ID4gMCA/IGAkeyB0aGlzLmNtZE9wdGlvbnMudGltZW91dCB9c2AgOiBudWxsLAogICAgICAgIC8vIHdhaXQ6ICAgICAgdGhpcy5jbWRPcHRpb25zLndhaXQgPT09IHRydWUsCiAgICAgICAgbmFtZXNwYWNlOiBVSV9QTFVHSU5fTkFNRVNQQUNFLAogICAgICB9OwoKICAgICAgLy8gSGVsbSBhY3Rpb24KICAgICAgY29uc3QgYWN0aW9uID0gKGV4aXN0cyB8fCB0aGlzLnVwZGF0ZSkgPyAndXBncmFkZScgOiAnaW5zdGFsbCc7CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcG8uZG9BY3Rpb24oYWN0aW9uLCBpbnB1dCk7CiAgICAgICAgY29uc3Qgb3BlcmF0aW9uSWQgPSBgJHsgcmVzLm9wZXJhdGlvbk5hbWVzcGFjZSB9LyR7IHJlcy5vcGVyYXRpb25OYW1lIH1gOwoKICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKHBsdWdpbik7CgogICAgICAgIGF3YWl0IHJlcG8ud2FpdEZvck9wZXJhdGlvbihvcGVyYXRpb25JZCk7CgogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGBtYW5hZ2VtZW50L2ZpbmRgLCB7CiAgICAgICAgICB0eXBlOiBDQVRBTE9HLk9QRVJBVElPTiwKICAgICAgICAgIGlkOiAgIG9wZXJhdGlvbklkCiAgICAgICAgfSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnZ3Jvd2wvZXJyb3InLCB7CiAgICAgICAgICB0aXRsZTogICB0aGlzLnQoJ3BsdWdpbnMuZXJyb3IuZ2VuZXJpYycpLAogICAgICAgICAgbWVzc2FnZTogZS5tZXNzYWdlID8gZS5tZXNzYWdlIDogZSwKICAgICAgICAgIHRpbWVvdXQ6IDEwMDAwCiAgICAgICAgfSwgeyByb290OiB0cnVlIH0pOwoKICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKHBsdWdpbik7CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["InstallDialog.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"InstallDialog.vue","sourceRoot":"node_modules/@rancher/shell/pages/c/_cluster/uiplugins","sourcesContent":["<script>\nimport AsyncButton from '@shell/components/AsyncButton';\nimport LabeledSelect from '@shell/components/form/LabeledSelect';\nimport { CATALOG, MANAGEMENT } from '@shell/config/types';\nimport { CATALOG as CATALOG_ANNOTATIONS } from '@shell/config/labels-annotations';\nimport { UI_PLUGIN_NAMESPACE } from '@shell/config/uiplugins';\nimport Banner from '@components/Banner/Banner.vue';\n\n// Note: This dialog handles installation and update of a plugin\n\nexport default {\n  components: {\n    AsyncButton,\n    Banner,\n    LabeledSelect,\n  },\n\n  async fetch() {\n    this.defaultRegistrySetting = await this.$store.dispatch('management/find', {\n      type: MANAGEMENT.SETTING,\n      id:   'system-default-registry'\n    });\n  },\n\n  data() {\n    return {\n      currentVersion:         '',\n      defaultRegistrySetting: null,\n      plugin:                 undefined,\n      busy:                   false,\n      version:                '',\n      update:                 false,\n      mode:                   '',\n    };\n  },\n\n  computed: {\n    showVersionSelector() {\n      return this.versionOptions?.length > 1;\n    },\n\n    versionOptions() {\n      if (!this.plugin) {\n        return [];\n      }\n\n      // Don't allow update/rollback to current version\n      const versions = this.plugin?.installableVersions?.filter((v) => {\n        if (this.currentVersion) {\n          return v.version !== this.currentVersion;\n        }\n\n        return true;\n      });\n\n      return versions.map((version) => {\n        return {\n          label: version.version,\n          value: version.version,\n        };\n      });\n    },\n\n    buttonMode() {\n      return this.update ? 'update' : 'install';\n    }\n  },\n\n  methods: {\n    showDialog(plugin, mode) {\n      this.plugin = plugin;\n      this.mode = mode;\n\n      // Default to latest version on install (this is default on the plugin)\n      this.version = plugin.displayVersion;\n\n      if (mode === 'update') {\n        this.currentVersion = plugin.displayVersion;\n\n        // Update to latest version, so take the first version\n        if (plugin.installableVersions?.length > 0) {\n          this.version = plugin.installableVersions?.[0]?.version;\n        }\n      } else if (mode === 'rollback') {\n        // Find the newest version once we remove the current version\n        const versionNames = plugin.installableVersions.filter((v) => v.version !== plugin.displayVersion);\n\n        this.currentVersion = plugin.displayVersion;\n\n        if (versionNames.length > 0) {\n          this.version = versionNames[0].version;\n        }\n      }\n\n      // Make sure we have the version available\n      const versionChart = plugin.installableVersions?.find((v) => v.version === this.version);\n\n      if (!versionChart) {\n        this.version = plugin.installableVersions?.[0]?.version;\n      }\n\n      this.busy = false;\n      this.update = mode !== 'install';\n      this.$modal.show('installPluginDialog');\n    },\n\n    closeDialog(result) {\n      this.$modal.hide('installPluginDialog');\n      this.$emit('closed', result);\n    },\n\n    async install() {\n      this.busy = true;\n\n      const plugin = this.plugin;\n\n      this.$emit('update', plugin.name, 'install');\n\n      // Find the version that the user wants to install\n      const version = plugin.versions?.find((v) => v.version === this.version);\n\n      if (!version) {\n        this.busy = false;\n\n        return;\n      }\n\n      // is the image used by the chart in the rancher org?\n      let isRancherImage = false;\n\n      try {\n        const chartVersionInfo = await this.$store.dispatch('catalog/getVersionInfo', {\n          repoType:    version.repoType,\n          repoName:    version.repoName,\n          chartName:   plugin.chart.chartName,\n          versionName: this.version,\n        });\n\n        const image = chartVersionInfo?.values?.image?.repository || '';\n\n        isRancherImage = image.startsWith('rancher/');\n      } catch (e) {}\n\n      // See if there is already a plugin with this name\n      let exists = false;\n\n      try {\n        const app = await this.$store.dispatch('management/find', {\n          type: CATALOG.APP,\n          id:   `${ UI_PLUGIN_NAMESPACE }/${ plugin.chart.chartName }`,\n          opt:  { force: true },\n        });\n\n        exists = !!app;\n      } catch (e) {}\n\n      const repoType = version.repoType;\n      const repoName = version.repoName;\n      const repo = this.$store.getters['catalog/repo']({ repoType, repoName });\n\n      const chart = {\n        chartName:   plugin.chart.chartName,\n        version:     this.version,\n        releaseName: plugin.chart.chartName,\n        annotations: {\n          [CATALOG_ANNOTATIONS.SOURCE_REPO_TYPE]: plugin.repoType,\n          [CATALOG_ANNOTATIONS.SOURCE_REPO_NAME]: plugin.repoName\n        },\n        values: {}\n      };\n\n      // Pass in the system default registry property if set - only if the image is in the rancher org\n      const defaultRegistry = this.defaultRegistrySetting?.value || '';\n\n      if (isRancherImage && defaultRegistry) {\n        chart.values.global = chart.values.global || {};\n        chart.values.global.cattle = chart.values.global.cattle || {};\n        chart.values.global.cattle.systemDefaultRegistry = defaultRegistry;\n      }\n\n      const input = {\n        charts:    [chart],\n        // timeout:   this.cmdOptions.timeout > 0 ? `${ this.cmdOptions.timeout }s` : null,\n        // wait:      this.cmdOptions.wait === true,\n        namespace: UI_PLUGIN_NAMESPACE,\n      };\n\n      // Helm action\n      const action = (exists || this.update) ? 'upgrade' : 'install';\n\n      try {\n        const res = await repo.doAction(action, input);\n        const operationId = `${ res.operationNamespace }/${ res.operationName }`;\n\n        this.closeDialog(plugin);\n\n        await repo.waitForOperation(operationId);\n\n        await this.$store.dispatch(`management/find`, {\n          type: CATALOG.OPERATION,\n          id:   operationId\n        });\n      } catch (e) {\n        this.$store.dispatch('growl/error', {\n          title:   this.t('plugins.error.generic'),\n          message: e.message ? e.message : e,\n          timeout: 10000\n        }, { root: true });\n\n        this.closeDialog(plugin);\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <modal\n    name=\"installPluginDialog\"\n    height=\"auto\"\n    :scrollable=\"true\"\n  >\n    <div\n      v-if=\"plugin\"\n      class=\"plugin-install-dialog\"\n    >\n      <h4 class=\"mt-10\">\n        {{ t(`plugins.${ mode }.title`, { name: plugin.label }) }}\n      </h4>\n      <div class=\"custom mt-10\">\n        <div class=\"dialog-panel\">\n          <p>\n            {{ t(`plugins.${ mode }.prompt`) }}\n          </p>\n          <Banner\n            v-if=\"!plugin.certified\"\n            color=\"warning\"\n            :label=\"t('plugins.install.warnNotCertified')\"\n          />\n          <LabeledSelect\n            v-if=\"showVersionSelector\"\n            v-model=\"version\"\n            label-key=\"plugins.install.version\"\n            :options=\"versionOptions\"\n            class=\"version-selector mt-10\"\n            data-testid=\"install-ext-modal-select-version\"\n          />\n          <div v-else>\n            {{ t('plugins.install.version') }} {{ version }}\n          </div>\n        </div>\n        <div class=\"dialog-buttons\">\n          <button\n            :disabled=\"busy\"\n            class=\"btn role-secondary\"\n            data-testid=\"install-ext-modal-cancel-btn\"\n            @click=\"closeDialog(false)\"\n          >\n            {{ t('generic.cancel') }}\n          </button>\n          <AsyncButton\n            :mode=\"buttonMode\"\n            data-testid=\"install-ext-modal-install-btn\"\n            @click=\"install\"\n          />\n        </div>\n      </div>\n    </div>\n  </modal>\n</template>\n\n<style lang=\"scss\" scoped>\n  .plugin-install-dialog {\n    padding: 10px;\n\n    h4 {\n      font-weight: bold;\n    }\n\n    .dialog-panel {\n      display: flex;\n      flex-direction: column;\n      min-height: 100px;\n\n      p {\n        margin-bottom: 5px;\n      }\n\n      .dialog-info {\n        flex: 1;\n      }\n\n      .toggle-advanced {\n        display: flex;\n        align-items: center;\n        cursor: pointer;\n        margin: 10px 0;\n\n        &:hover {\n          text-decoration: none;\n          color: var(--link);\n        }\n      }\n\n      .version-selector {\n        margin: 0 10px 10px 10px;\n        width: auto;\n      }\n    }\n\n    .dialog-buttons {\n      display: flex;\n      justify-content: flex-end;\n      margin-top: 10px;\n\n      > *:not(:last-child) {\n        margin-right: 10px;\n      }\n    }\n  }\n</style>\n"]}]}