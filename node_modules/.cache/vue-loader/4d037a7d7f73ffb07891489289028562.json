{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/list/node.vue?vue&type=style&index=0&id=1b9debdd&lang=scss&scoped=true","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/list/node.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js","mtime":1716430467357},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1716430467929},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/postcss-loader/src/index.js","mtime":1716430467882},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/sass-loader/dist/cjs.js","mtime":1716430453705},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoubGFiZWxzIHsKICAgIGRpc3BsYXk6IGlubGluZTsKICAgIGZsZXgtd3JhcDogd3JhcDsKCiAgICAubGFiZWwgewogICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgIG1hcmdpbi10b3A6IDJweDsKICAgIH0KCn0KLnRhaW50cyB7CiAgdGQgewogICAgcGFkZGluZy10b3A6MDsKICAgIC50YWcgewogICAgICBtYXJnaW4tcmlnaHQ6IDVweDsKICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgICBtYXJnaW4tdG9wOiAycHg7CiAgICB9CiAgfQogICYuZW1wdHktdGFpbnRzIHsKICAgIC8vIE5vIHRhaW50cy4uLiBzbyBoaWRlIHN1Yi1yb3cgKGJ1dCBub3QgYm90dG9tLWJvcmRlcikKICAgIGhlaWdodDogMDsKICAgIGxpbmUtaGVpZ2h0OiAwOwogICAgdGQgewogICAgICBwYWRkaW5nOiAwOwogICAgfQogIH0KfQoK"},{"version":3,"sources":["node.vue"],"names":[],"mappings":";;AA8OA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"node.vue","sourceRoot":"node_modules/@rancher/shell/list","sourcesContent":["<script>\nimport ResourceTable from '@shell/components/ResourceTable';\nimport Tag from '@shell/components/Tag';\nimport { Banner } from '@components/Banner';\nimport {\n  STATE, NAME, ROLES, VERSION, INTERNAL_EXTERNAL_IP, CPU, RAM, PODS, AGE, KUBE_NODE_OS\n} from '@shell/config/table-headers';\nimport metricPoller from '@shell/mixins/metric-poller';\n\nimport {\n  CAPI,\n  MANAGEMENT, METRIC, NODE, NORMAN, POD\n} from '@shell/config/types';\nimport { allHash } from '@shell/utils/promise';\nimport { GROUP_RESOURCES, mapPref } from '@shell/store/prefs';\nimport { COLUMN_BREAKPOINTS } from '@shell/components/SortableTable/index.vue';\nimport ResourceFetch from '@shell/mixins/resource-fetch';\nexport default {\n  name:       'ListNode',\n  components: {\n    ResourceTable,\n    Tag,\n    Banner\n  },\n  mixins: [metricPoller, ResourceFetch],\n\n  props: {\n    resource: {\n      type:     String,\n      required: true,\n    },\n    schema: {\n      type:     Object,\n      required: true,\n    },\n    useQueryParamsForSimpleFiltering: {\n      type:    Boolean,\n      default: false\n    }\n  },\n\n  async fetch() {\n    this.$initializeFetchData(this.resource);\n\n    const hash = { kubeNodes: this.$fetchType(this.resource) };\n\n    this.canViewPods = this.$store.getters[`cluster/schemaFor`](POD);\n\n    if (this.$store.getters[`management/schemaFor`](MANAGEMENT.NODE)) {\n      // Required for Drain/Cordon action\n      hash.normanNodes = this.$fetchType(NORMAN.NODE, [], 'rancher');\n    }\n\n    if (this.$store.getters[`rancher/schemaFor`](NORMAN.NODE)) {\n      hash.mgmtNodes = this.$fetchType(MANAGEMENT.NODE, [], 'management');\n    }\n\n    if (this.$store.getters[`management/schemaFor`](CAPI.MACHINE)) {\n      // Required for ssh / download key actions\n      hash.machines = this.$fetchType(CAPI.MACHINE, [], 'management');\n    }\n\n    if (this.canViewPods) {\n      // Used for running pods metrics - we don't need to block on this to show the list of nodes\n      this.$fetchType(POD);\n    }\n\n    await allHash(hash);\n  },\n\n  data() {\n    return { canViewPods: false };\n  },\n\n  beforeDestroy() {\n    // Stop watching pods, nodes and node metrics\n    this.$store.dispatch('cluster/forgetType', POD);\n    this.$store.dispatch('cluster/forgetType', NODE);\n    this.$store.dispatch('cluster/forgetType', METRIC.NODE);\n  },\n\n  computed: {\n    hasWindowsNodes() {\n      return (this.rows || []).some((node) => node.status.nodeInfo.operatingSystem === 'windows');\n    },\n\n    tableGroup: mapPref(GROUP_RESOURCES),\n\n    parsedRows() {\n      this.rows.forEach((row) => {\n        row.displayTaintsAndLabels = (row.spec.taints && row.spec.taints.length) || !!row.customLabelCount;\n      });\n\n      return this.rows;\n    },\n\n    headers() {\n      const headers = [\n        STATE,\n        NAME,\n        ROLES,\n        VERSION,\n        INTERNAL_EXTERNAL_IP,\n        {\n          ...KUBE_NODE_OS,\n          breakpoint: COLUMN_BREAKPOINTS.LAPTOP,\n          getValue:   (row) => row.status?.nodeInfo?.operatingSystem\n        },\n        {\n          ...CPU,\n          breakpoint: COLUMN_BREAKPOINTS.LAPTOP,\n          getValue:   (row) => row.cpuUsagePercentage\n        }, {\n          ...RAM,\n          breakpoint: COLUMN_BREAKPOINTS.LAPTOP,\n          getValue:   (row) => row.ramUsagePercentage\n        }];\n\n      if (this.canViewPods) {\n        headers.push({\n          ...PODS,\n          breakpoint: COLUMN_BREAKPOINTS.DESKTOP,\n          getValue:   (row) => row.podConsumedUsage\n        });\n      }\n      headers.push(AGE);\n\n      return headers;\n    },\n  },\n\n  methods: {\n    async loadMetrics() {\n      const schema = this.$store.getters['cluster/schemaFor'](METRIC.NODE);\n\n      if (schema) {\n        await this.$store.dispatch('cluster/findAll', {\n          type: METRIC.NODE,\n          opt:  { force: true }\n        });\n\n        this.$forceUpdate();\n      }\n    },\n\n    toggleLabels(row) {\n      this.$set(row, 'displayLabels', !row.displayLabels);\n    },\n  }\n\n};\n</script>\n\n<template>\n  <div>\n    <Banner\n      v-if=\"hasWindowsNodes\"\n      color=\"info\"\n      :label=\"t('cluster.custom.registrationCommand.windowsWarning')\"\n    />\n    <ResourceTable\n      v-bind=\"$attrs\"\n      :schema=\"schema\"\n      :headers=\"headers\"\n      :rows=\"parsedRows\"\n      :sub-rows=\"true\"\n      :loading=\"loading\"\n      :use-query-params-for-simple-filtering=\"useQueryParamsForSimpleFiltering\"\n      :force-update-live-and-delayed=\"forceUpdateLiveAndDelayed\"\n      v-on=\"$listeners\"\n    >\n      <template #sub-row=\"{fullColspan, row, onRowMouseEnter, onRowMouseLeave}\">\n        <tr\n          class=\"taints sub-row\"\n          :class=\"{'empty-taints': ! row.displayTaintsAndLabels}\"\n          @mouseenter=\"onRowMouseEnter\"\n          @mouseleave=\"onRowMouseLeave\"\n        >\n          <template v-if=\"row.displayTaintsAndLabels\">\n            <td>&nbsp;</td>\n            <td>&nbsp;</td>\n            <td :colspan=\"fullColspan-2\">\n              <span v-if=\"row.spec.taints && row.spec.taints.length\">\n                {{ t('node.list.nodeTaint') }}:\n                <Tag\n                  v-for=\"taint in row.spec.taints\"\n                  :key=\"taint.key + taint.value + taint.effect\"\n                  class=\"mr-5 mt-2\"\n                >\n                  {{ taint.key }}={{ taint.value }}:{{ taint.effect }}\n                </Tag>\n              </span>\n              <span\n                v-if=\"!!row.customLabelCount\"\n                class=\"mt-5\"\n              > {{ t('node.list.nodeLabels') }}:\n                <span\n                  v-for=\"(label, i) in row.customLabels\"\n                  :key=\"i\"\n                  class=\"mt-5 labels\"\n                >\n                  <Tag\n                    v-if=\"i < 7\"\n                    class=\"mr-2 label\"\n                  >\n                    {{ label }}\n                  </Tag>\n                  <Tag\n                    v-else-if=\"i > 6 && row.displayLabels\"\n                    class=\"mr-2 label\"\n                  >\n                    {{ label }}\n                  </Tag>\n                </span>\n                <a\n                  v-if=\"row.customLabelCount > 7\"\n                  href=\"#\"\n                  @click.prevent=\"toggleLabels(row)\"\n                >\n                  {{ t(`node.list.${row.displayLabels? 'hideLabels' : 'showLabels'}`) }}\n                </a>\n              </span>\n            </td>\n          </template>\n          <td\n            v-else\n            :colspan=\"fullColspan\"\n          >\n&nbsp;\n          </td>\n        </tr>\n      </template>\n    </ResourceTable>\n  </div>\n</template>\n\n<style lang='scss' scoped>\n\n.labels {\n    display: inline;\n    flex-wrap: wrap;\n\n    .label {\n      display: inline-block;\n      margin-top: 2px;\n    }\n\n}\n.taints {\n  td {\n    padding-top:0;\n    .tag {\n      margin-right: 5px;\n      display: inline-block;\n      margin-top: 2px;\n    }\n  }\n  &.empty-taints {\n    // No taints... so hide sub-row (but not bottom-border)\n    height: 0;\n    line-height: 0;\n    td {\n      padding: 0;\n    }\n  }\n}\n\n</style>\n"]}]}