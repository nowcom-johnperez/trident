{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/management.cattle.io.user.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/detail/management.cattle.io.user.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBDcmVhdGVFZGl0VmlldyBmcm9tICdAc2hlbGwvbWl4aW5zL2NyZWF0ZS1lZGl0LXZpZXcnOwppbXBvcnQgVGFiIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL1RhYmJlZC9UYWInOwppbXBvcnQgUmVzb3VyY2VUYWJzIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vUmVzb3VyY2VUYWJzJzsKaW1wb3J0IFNvcnRhYmxlVGFibGUgZnJvbSAnQHNoZWxsL2NvbXBvbmVudHMvU29ydGFibGVUYWJsZSc7CmltcG9ydCB7IE1BTkFHRU1FTlQsIE5PUk1BTiB9IGZyb20gJ0BzaGVsbC9jb25maWcvdHlwZXMnOwppbXBvcnQgTG9hZGluZyBmcm9tICdAc2hlbGwvY29tcG9uZW50cy9Mb2FkaW5nJzsKaW1wb3J0IHsgTkFNRSB9IGZyb20gJ0BzaGVsbC9jb25maWcvdGFibGUtaGVhZGVycyc7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgVGFiLAogICAgUmVzb3VyY2VUYWJzLAogICAgU29ydGFibGVUYWJsZSwKICAgIExvYWRpbmcKICB9LAogIG1peGluczogWwogICAgQ3JlYXRlRWRpdFZpZXcKICBdLAogIGFzeW5jIGZldGNoKCkgewogICAgY29uc3QgY2FuU2VlR2xvYmFsUm9sZXMgPSAhIXRoaXMuJHN0b3JlLmdldHRlcnNbYG1hbmFnZW1lbnQvY2FuTGlzdGBdKE1BTkFHRU1FTlQuR0xPQkFMX1JPTEUpOwoKICAgIGlmIChjYW5TZWVHbG9iYWxSb2xlcykgewogICAgICB0aGlzLmdsb2JhbEJpbmRpbmdzID0gYXdhaXQgdGhpcy5mZXRjaEdsb2JhbFJvbGVCaW5kaW5ncyh0aGlzLnZhbHVlLmlkKTsKICAgIH0KCiAgICB0aGlzLmNhblNlZVJvbGVUZW1wbGF0ZXMgPSAhIXRoaXMuJHN0b3JlLmdldHRlcnNbYG1hbmFnZW1lbnQvY2FuTGlzdGBdKE1BTkFHRU1FTlQuUk9MRV9URU1QTEFURSk7CgogICAgaWYgKHRoaXMuY2FuU2VlUm9sZVRlbXBsYXRlcykgewogICAgICAvLyBVcGZyb250IGZldGNoLCBhdm9pZCBhc3luYyBjb21wdXRlcwogICAgICBhd2FpdCBQcm9taXNlLmFsbChbCiAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3JhbmNoZXIvZmluZCcsIHsgdHlwZTogTk9STUFOLlVTRVIsIGlkOiB0aGlzLnZhbHVlLmlkIH0pLAogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuUk9MRV9URU1QTEFURSB9KSwKICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULkNMVVNURVJfUk9MRV9URU1QTEFURV9CSU5ESU5HIH0pLAogICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdtYW5hZ2VtZW50L2ZpbmRBbGwnLCB7IHR5cGU6IE1BTkFHRU1FTlQuUFJPSkVDVF9ST0xFX1RFTVBMQVRFX0JJTkRJTkcgfSkKICAgICAgXSk7CiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgY29uc3Qgcm9sZSA9IHsKICAgICAgbmFtZTogICAgICdyb2xlJywKICAgICAgbGFiZWxLZXk6ICd1c2VyLmRldGFpbC5nZW5lcmljLnRhYmxlSGVhZGVycy5yb2xlJywKICAgICAgdmFsdWU6ICAgICdyb2xlVGVtcGxhdGUuZGlzcGxheU5hbWUnLAogICAgICBzb3J0OiAgICAgJ3JvbGVUZW1wbGF0ZS5kaXNwbGF5TmFtZScsCiAgICB9OwogICAgY29uc3Qgc2luY2UgPSB7CiAgICAgIG5hbWU6ICAgICAgICAgICdzaW5jZScsCiAgICAgIGxhYmVsS2V5OiAgICAgICd1c2VyLmRldGFpbC5nZW5lcmljLnRhYmxlSGVhZGVycy5ncmFudGVkJywKICAgICAgdmFsdWU6ICAgICAgICAgJ21ldGFkYXRhLmNyZWF0aW9uVGltZXN0YW1wJywKICAgICAgc29ydDogICAgICAgICAgJ21ldGFkYXRhLmNyZWF0aW9uVGltZXN0YW1wOmRlc2MnLAogICAgICBzZWFyY2g6ICAgICAgICBmYWxzZSwKICAgICAgZm9ybWF0dGVyOiAgICAgJ0xpdmVEYXRlJywKICAgICAgZm9ybWF0dGVyT3B0czogeyBhZGRTdWZmaXg6IHRydWUgfSwKICAgICAgd2lkdGg6ICAgICAgICAgJzIwJScsCiAgICB9OwoKICAgIHJldHVybiB7CiAgICAgIGhlYWRlcnM6IHsKICAgICAgICBncDogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAgICAgICdwZXJtaXNzaW9uJywKICAgICAgICAgICAgbGFiZWxLZXk6ICAndXNlci5kZXRhaWwuZ2xvYmFsUGVybWlzc2lvbnMudGFibGVIZWFkZXJzLnBlcm1pc3Npb24nLAogICAgICAgICAgICB2YWx1ZTogICAgICdoYXNCb3VuZCcsCiAgICAgICAgICAgIHNvcnQ6ICAgICAgWydoYXNCb3VuZDpkZXNjJ10sCiAgICAgICAgICAgIGZvcm1hdHRlcjogJ0NoZWNrZWQnLAogICAgICAgICAgICB3aWR0aDogICAgIDc1LAogICAgICAgICAgICBhbGlnbjogICAgICdjZW50ZXInCiAgICAgICAgICB9LAogICAgICAgICAgTkFNRSwKICAgICAgICAgIHsKICAgICAgICAgICAgLi4uc2luY2UsCiAgICAgICAgICAgIHZhbHVlOiAnYm91bmQnLAogICAgICAgICAgICBzb3J0OiAgJ2JvdW5kJywKICAgICAgICAgIH0KICAgICAgICBdLAogICAgICAgIGNyOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICAgICAgICAgICdjbHVzdGVyJywKICAgICAgICAgICAgbGFiZWxLZXk6ICAgICAgJ3VzZXIuZGV0YWlsLmNsdXN0ZXJSb2xlcy50YWJsZUhlYWRlcnMuY2x1c3RlcicsCiAgICAgICAgICAgIHZhbHVlOiAgICAgICAgICdjbHVzdGVyRGlzcGxheU5hbWUnLAogICAgICAgICAgICBzb3J0OiAgICAgICAgICAnY2x1c3RlckRpc3BsYXlOYW1lJywKICAgICAgICAgICAgZm9ybWF0dGVyOiAgICAgJ0xpbmtEZXRhaWwnLAogICAgICAgICAgICBmb3JtYXR0ZXJPcHRzOiB7IHJlZmVyZW5jZTogJ2NsdXN0ZXJEZXRhaWxMb2NhdGlvbicgfSwKICAgICAgICAgIH0sIHsgLi4ucm9sZSB9LAogICAgICAgICAgeyAuLi5zaW5jZSB9CiAgICAgICAgXSwKICAgICAgICBwcjogWwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAgICAgICAgICAncHJvamVjdCcsCiAgICAgICAgICAgIGxhYmVsS2V5OiAgICAgICd1c2VyLmRldGFpbC5wcm9qZWN0Um9sZXMudGFibGVIZWFkZXJzLnByb2plY3QnLAogICAgICAgICAgICB2YWx1ZTogICAgICAgICAncHJvamVjdERpc3BsYXlOYW1lJywKICAgICAgICAgICAgc29ydDogICAgICAgICAgJ3Byb2plY3REaXNwbGF5TmFtZScsCiAgICAgICAgICAgIGZvcm1hdHRlcjogICAgICdMaW5rRGV0YWlsJywKICAgICAgICAgICAgZm9ybWF0dGVyT3B0czogeyByZWZlcmVuY2U6ICdwcm9qZWN0RGV0YWlsTG9jYXRpb24nIH0sCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIG5hbWU6ICAgICAgICAgICdjbHVzdGVyJywKICAgICAgICAgICAgbGFiZWxLZXk6ICAgICAgJ3VzZXIuZGV0YWlsLmNsdXN0ZXJSb2xlcy50YWJsZUhlYWRlcnMuY2x1c3RlcicsCiAgICAgICAgICAgIHZhbHVlOiAgICAgICAgICdjbHVzdGVyRGlzcGxheU5hbWUnLAogICAgICAgICAgICBzb3J0OiAgICAgICAgICAnY2x1c3RlckRpc3BsYXlOYW1lJywKICAgICAgICAgICAgZm9ybWF0dGVyOiAgICAgJ0xpbmtEZXRhaWwnLAogICAgICAgICAgICBmb3JtYXR0ZXJPcHRzOiB7IHJlZmVyZW5jZTogJ2NsdXN0ZXJEZXRhaWxMb2NhdGlvbicgfSwKICAgICAgICAgIH0sIHsgLi4ucm9sZSB9LAogICAgICAgICAgeyAuLi5zaW5jZSB9CiAgICAgICAgXQogICAgICB9LAogICAgICBnbG9iYWxCaW5kaW5nczogICAgICBudWxsLAogICAgICBjYW5TZWVSb2xlVGVtcGxhdGVzOiBmYWxzZSwKICAgICAgaXNBZG1pbjogICAgICAgICAgICAgZmFsc2UsCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNsdXN0ZXJCaW5kaW5ncygpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FuU2VlUm9sZVRlbXBsYXRlcyA/IHRoaXMuZmV0Y2hDbHVzdGVyUm9sZXModGhpcy52YWx1ZS5pZCkgOiBudWxsOwogICAgfSwKICAgIHByb2plY3RCaW5kaW5ncygpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FuU2VlUm9sZVRlbXBsYXRlcyA/IHRoaXMuZmV0Y2hQcm9qZWN0Um9sZXModGhpcy52YWx1ZS5pZCkgOiBudWxsOwogICAgfQoKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGZldGNoR2xvYmFsUm9sZUJpbmRpbmdzKHVzZXJJZCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJvbGVzID0gYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZEFsbCcsIHsgdHlwZTogTUFOQUdFTUVOVC5HTE9CQUxfUk9MRSB9KTsKCiAgICAgICAgY29uc3Qgb3V0ID0gYXdhaXQgUHJvbWlzZS5hbGwocm9sZXMKICAgICAgICAgIC5maWx0ZXIoKHIpID0+ICFyLmlzU3BlY2lhbCkKICAgICAgICAgIC5tYXAoKHIpID0+IHRoaXMuJHN0b3JlLmRpc3BhdGNoKGByYW5jaGVyL2Nsb25lYCwgeyByZXNvdXJjZTogciB9KSkKICAgICAgICApOwoKICAgICAgICBvdXQuZm9yRWFjaCgocikgPT4gewogICAgICAgICAgci5oYXNCb3VuZCA9IGZhbHNlOwogICAgICAgIH0pOwoKICAgICAgICBjb25zdCBnbG9iYWxSb2xlQmluZGluZ3MgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kQWxsJywgeyB0eXBlOiBNQU5BR0VNRU5ULkdMT0JBTF9ST0xFX0JJTkRJTkcgfSk7CgogICAgICAgIGdsb2JhbFJvbGVCaW5kaW5ncwogICAgICAgICAgLmZpbHRlcigoYmluZGluZykgPT4gYmluZGluZy51c2VyTmFtZSA9PT0gdXNlcklkKQogICAgICAgICAgLmZvckVhY2goKGJpbmRpbmcpID0+IHsKICAgICAgICAgICAgY29uc3QgZ2xvYmFsUm9sZSA9IHJvbGVzLmZpbmQoKHIpID0+IHIuaWQgPT09IGJpbmRpbmcuZ2xvYmFsUm9sZU5hbWUpOwoKICAgICAgICAgICAgaWYgKGdsb2JhbFJvbGUuaWQgPT09ICdhZG1pbicpIHsKICAgICAgICAgICAgICB0aGlzLmlzQWRtaW4gPSB0cnVlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoZ2xvYmFsUm9sZS5pc1NwZWNpYWwpIHsKICAgICAgICAgICAgICB0aGlzLmdldEVuYWJsZWRSb2xlcyhnbG9iYWxSb2xlLCBvdXQpLmZvckVhY2goKHIpID0+IHsKICAgICAgICAgICAgICAgIHIuaGFzQm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgci5ib3VuZCA9IGJpbmRpbmc/Lm1ldGFkYXRhLmNyZWF0aW9uVGltZXN0YW1wOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gb3V0LmZpbmQoKG8pID0+IG8uaWQgPT09IGJpbmRpbmcuZ2xvYmFsUm9sZU5hbWUpOwoKICAgICAgICAgICAgICBpZiAoZW50cnkpIHsKICAgICAgICAgICAgICAgIGVudHJ5Lmhhc0JvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGVudHJ5LmJvdW5kID0gYmluZGluZz8ubWV0YWRhdGEuY3JlYXRpb25UaW1lc3RhbXA7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuIG91dDsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIC8vIFN3YWxsb3cgdGhlIGVycm9yLiBJdCdzIHByb2JhYmx5IGR1ZSB0byB0aGUgdXNlciBub3QgaGF2aW5nIHRoZSBjb3JyZWN0IHBlcm1pc3Npb25zIHRvIHJlYWQgZ2xvYmFsIHJvbGVzCiAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIGdsb2JhbCByb2xlIGJpbmRpbmdzOiAnLCBlKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlCiAgICAgIH0KICAgIH0sCgogICAgZmV0Y2hDbHVzdGVyUm9sZXModXNlcklkKSB7CiAgICAgIGNvbnN0IHRlbXBsYXRlQmluZGluZ3MgPSB0aGlzLiRzdG9yZS5nZXR0ZXJzWydtYW5hZ2VtZW50L2FsbCddKE1BTkFHRU1FTlQuQ0xVU1RFUl9ST0xFX1RFTVBMQVRFX0JJTkRJTkcpOwogICAgICBjb25zdCB1c2VyVGVtcGxhdGVCaW5kaW5ncyA9IHRlbXBsYXRlQmluZGluZ3MuZmlsdGVyKChiaW5kaW5nKSA9PiBiaW5kaW5nLnVzZXJOYW1lID09PSB1c2VySWQpOwoKICAgICAgLy8gVXBmcm9udCBsb2FkIGNsdXN0ZXJzCiAgICAgIHVzZXJUZW1wbGF0ZUJpbmRpbmdzLm1hcCgoYikgPT4gdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ21hbmFnZW1lbnQvZmluZCcsIHsgdHlwZTogTUFOQUdFTUVOVC5DTFVTVEVSLCBpZDogYi5jbHVzdGVyTmFtZSB9KSk7CgogICAgICByZXR1cm4gdXNlclRlbXBsYXRlQmluZGluZ3M7CiAgICB9LAoKICAgIGZldGNoUHJvamVjdFJvbGVzKHVzZXJJZCkgewogICAgICBjb25zdCB0ZW1wbGF0ZUJpbmRpbmdzID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1snbWFuYWdlbWVudC9hbGwnXShNQU5BR0VNRU5ULlBST0pFQ1RfUk9MRV9URU1QTEFURV9CSU5ESU5HICk7CiAgICAgIGNvbnN0IHVzZXJUZW1wbGF0ZUJpbmRpbmdzID0gdGVtcGxhdGVCaW5kaW5ncy5maWx0ZXIoKGJpbmRpbmcpID0+IGJpbmRpbmcudXNlck5hbWUgPT09IHVzZXJJZCk7CgogICAgICAvLyBVcGZyb250IGxvYWQgcHJvamVjdHMKICAgICAgdXNlclRlbXBsYXRlQmluZGluZ3MubWFwKChiKSA9PiB0aGlzLiRzdG9yZS5kaXNwYXRjaCgnbWFuYWdlbWVudC9maW5kJywgeyB0eXBlOiBNQU5BR0VNRU5ULlBST0pFQ1QsIGlkOiBiLnByb2plY3RJZCB9KSk7CgogICAgICByZXR1cm4gdXNlclRlbXBsYXRlQmluZGluZ3M7CiAgICB9LAoKICAgIC8vIEdsb2JhbCBQZXJtaXNzaW9ucyBIZWxwZXJzIChicm91Z2h0IG92ZXIgZnJvbSBlbWJlcikKICAgIGhhc1Blcm1pc3Npb24oZ2xvYmFsUm9sZVJ1bGVzLCBwZXJtaXNzaW9uKSB7CiAgICAgIHJldHVybiBnbG9iYWxSb2xlUnVsZXMuZmluZCgoZ1J1bGUpID0+IHsKICAgICAgICByZXR1cm4gKChnUnVsZS5hcGlHcm91cHMgfHwgW10pLmluY2x1ZGVzKCcqJykgfHwgKGdSdWxlLmFwaUdyb3VwcyB8fCBbXSkuaW5jbHVkZXMocGVybWlzc2lvbi5hcGlHcm91cCkpICYmCiAgICAgICAgKChnUnVsZS5yZXNvdXJjZXMgfHwgW10pLmluY2x1ZGVzKCcqJykgfHwgKGdSdWxlLnJlc291cmNlcyB8fCBbXSkuaW5jbHVkZXMocGVybWlzc2lvbi5yZXNvdXJjZSkpICYmCiAgICAgICAgKChnUnVsZS52ZXJicyB8fCBbXSkuaW5jbHVkZXMoJyonKSB8fCAoZ1J1bGUudmVyYnMgfHwgW10pLmluY2x1ZGVzKHBlcm1pc3Npb24udmVyYikpOwogICAgICB9KQogICAgICA7CiAgICB9LAogICAgY29udGFpbnNSdWxlKGdsb2JhbFJvbGVSdWxlcywgcnVsZSkgewogICAgICBjb25zdCBhcGlHcm91cHMgPSAocnVsZS5hcGlHcm91cHMgfHwgW10pOwogICAgICBjb25zdCByZXNvdXJjZXMgPSAocnVsZS5yZXNvdXJjZXMgfHwgW10pOwogICAgICBjb25zdCB2ZXJicyA9IChydWxlLnZlcmJzIHx8IFtdKTsKICAgICAgY29uc3QgcGVybWlzc2lvbnMgPSBbXTsKCiAgICAgIGFwaUdyb3Vwcy5mb3JFYWNoKChhcGlHcm91cCkgPT4gcmVzb3VyY2VzLmZvckVhY2goKHJlc291cmNlKSA9PiB2ZXJicy5mb3JFYWNoKCh2ZXJiKSA9PiBwZXJtaXNzaW9ucy5wdXNoKHsKICAgICAgICBhcGlHcm91cCwKICAgICAgICByZXNvdXJjZSwKICAgICAgICB2ZXJiCiAgICAgIH0pKSkpOwoKICAgICAgcmV0dXJuIHBlcm1pc3Npb25zLmV2ZXJ5KChwZXJtaXNzaW9uKSA9PiB0aGlzLmhhc1Blcm1pc3Npb24oZ2xvYmFsUm9sZVJ1bGVzLCBwZXJtaXNzaW9uKSk7CiAgICB9LAogICAgZ2V0RW5hYmxlZFJvbGVzKGdsb2JhbFJvbGUsIG91dCkgewogICAgICBjb25zdCBnbG9iYWxSb2xlUnVsZXMgPSBnbG9iYWxSb2xlLnJ1bGVzIHx8IFtdOwoKICAgICAgcmV0dXJuIG91dC5maWx0ZXIoKHIpID0+IHsKICAgICAgICAvLyBJZiB0aGUgZ2xvYmFsIHJvbGUgZG9lc24ndCBjb250YWluIGFueSBydWxlcy4uLiBkb24ndCBzaG93IHRoZSB1c2VyIGFzIGhhdmluZyB0aGUgcm9sZSAoY29uZnVzaW5nKQogICAgICAgIGlmICghcj8ucnVsZXM/Lmxlbmd0aCkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHIucnVsZXMuZXZlcnkoKHJ1bGUpID0+IHRoaXMuY29udGFpbnNSdWxlKGdsb2JhbFJvbGVSdWxlcywgcnVsZSkpOwogICAgICB9KTsKICAgIH0sCgogIH0KCn07Cg=="},{"version":3,"sources":["management.cattle.io.user.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA","file":"management.cattle.io.user.vue","sourceRoot":"node_modules/@rancher/shell/detail","sourcesContent":["<script>\nimport CreateEditView from '@shell/mixins/create-edit-view';\nimport Tab from '@shell/components/Tabbed/Tab';\nimport ResourceTabs from '@shell/components/form/ResourceTabs';\nimport SortableTable from '@shell/components/SortableTable';\nimport { MANAGEMENT, NORMAN } from '@shell/config/types';\nimport Loading from '@shell/components/Loading';\nimport { NAME } from '@shell/config/table-headers';\n\nexport default {\n  components: {\n    Tab,\n    ResourceTabs,\n    SortableTable,\n    Loading\n  },\n  mixins: [\n    CreateEditView\n  ],\n  async fetch() {\n    const canSeeGlobalRoles = !!this.$store.getters[`management/canList`](MANAGEMENT.GLOBAL_ROLE);\n\n    if (canSeeGlobalRoles) {\n      this.globalBindings = await this.fetchGlobalRoleBindings(this.value.id);\n    }\n\n    this.canSeeRoleTemplates = !!this.$store.getters[`management/canList`](MANAGEMENT.ROLE_TEMPLATE);\n\n    if (this.canSeeRoleTemplates) {\n      // Upfront fetch, avoid async computes\n      await Promise.all([\n        await this.$store.dispatch('rancher/find', { type: NORMAN.USER, id: this.value.id }),\n        await this.$store.dispatch('management/findAll', { type: MANAGEMENT.ROLE_TEMPLATE }),\n        await this.$store.dispatch('management/findAll', { type: MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING }),\n        await this.$store.dispatch('management/findAll', { type: MANAGEMENT.PROJECT_ROLE_TEMPLATE_BINDING })\n      ]);\n    }\n  },\n  data() {\n    const role = {\n      name:     'role',\n      labelKey: 'user.detail.generic.tableHeaders.role',\n      value:    'roleTemplate.displayName',\n      sort:     'roleTemplate.displayName',\n    };\n    const since = {\n      name:          'since',\n      labelKey:      'user.detail.generic.tableHeaders.granted',\n      value:         'metadata.creationTimestamp',\n      sort:          'metadata.creationTimestamp:desc',\n      search:        false,\n      formatter:     'LiveDate',\n      formatterOpts: { addSuffix: true },\n      width:         '20%',\n    };\n\n    return {\n      headers: {\n        gp: [\n          {\n            name:      'permission',\n            labelKey:  'user.detail.globalPermissions.tableHeaders.permission',\n            value:     'hasBound',\n            sort:      ['hasBound:desc'],\n            formatter: 'Checked',\n            width:     75,\n            align:     'center'\n          },\n          NAME,\n          {\n            ...since,\n            value: 'bound',\n            sort:  'bound',\n          }\n        ],\n        cr: [\n          {\n            name:          'cluster',\n            labelKey:      'user.detail.clusterRoles.tableHeaders.cluster',\n            value:         'clusterDisplayName',\n            sort:          'clusterDisplayName',\n            formatter:     'LinkDetail',\n            formatterOpts: { reference: 'clusterDetailLocation' },\n          }, { ...role },\n          { ...since }\n        ],\n        pr: [\n          {\n            name:          'project',\n            labelKey:      'user.detail.projectRoles.tableHeaders.project',\n            value:         'projectDisplayName',\n            sort:          'projectDisplayName',\n            formatter:     'LinkDetail',\n            formatterOpts: { reference: 'projectDetailLocation' },\n          }, {\n            name:          'cluster',\n            labelKey:      'user.detail.clusterRoles.tableHeaders.cluster',\n            value:         'clusterDisplayName',\n            sort:          'clusterDisplayName',\n            formatter:     'LinkDetail',\n            formatterOpts: { reference: 'clusterDetailLocation' },\n          }, { ...role },\n          { ...since }\n        ]\n      },\n      globalBindings:      null,\n      canSeeRoleTemplates: false,\n      isAdmin:             false,\n    };\n  },\n  computed: {\n    clusterBindings() {\n      return this.canSeeRoleTemplates ? this.fetchClusterRoles(this.value.id) : null;\n    },\n    projectBindings() {\n      return this.canSeeRoleTemplates ? this.fetchProjectRoles(this.value.id) : null;\n    }\n\n  },\n  methods: {\n    async fetchGlobalRoleBindings(userId) {\n      try {\n        const roles = await this.$store.dispatch('management/findAll', { type: MANAGEMENT.GLOBAL_ROLE });\n\n        const out = await Promise.all(roles\n          .filter((r) => !r.isSpecial)\n          .map((r) => this.$store.dispatch(`rancher/clone`, { resource: r }))\n        );\n\n        out.forEach((r) => {\n          r.hasBound = false;\n        });\n\n        const globalRoleBindings = await this.$store.dispatch('management/findAll', { type: MANAGEMENT.GLOBAL_ROLE_BINDING });\n\n        globalRoleBindings\n          .filter((binding) => binding.userName === userId)\n          .forEach((binding) => {\n            const globalRole = roles.find((r) => r.id === binding.globalRoleName);\n\n            if (globalRole.id === 'admin') {\n              this.isAdmin = true;\n            }\n\n            if (globalRole.isSpecial) {\n              this.getEnabledRoles(globalRole, out).forEach((r) => {\n                r.hasBound = true;\n                r.bound = binding?.metadata.creationTimestamp;\n              });\n            } else {\n              const entry = out.find((o) => o.id === binding.globalRoleName);\n\n              if (entry) {\n                entry.hasBound = true;\n                entry.bound = binding?.metadata.creationTimestamp;\n              }\n            }\n          });\n\n        return out;\n      } catch (e) {\n        // Swallow the error. It's probably due to the user not having the correct permissions to read global roles\n        console.error('Failed to fetch global role bindings: ', e); // eslint-disable-line no-console\n      }\n    },\n\n    fetchClusterRoles(userId) {\n      const templateBindings = this.$store.getters['management/all'](MANAGEMENT.CLUSTER_ROLE_TEMPLATE_BINDING);\n      const userTemplateBindings = templateBindings.filter((binding) => binding.userName === userId);\n\n      // Upfront load clusters\n      userTemplateBindings.map((b) => this.$store.dispatch('management/find', { type: MANAGEMENT.CLUSTER, id: b.clusterName }));\n\n      return userTemplateBindings;\n    },\n\n    fetchProjectRoles(userId) {\n      const templateBindings = this.$store.getters['management/all'](MANAGEMENT.PROJECT_ROLE_TEMPLATE_BINDING );\n      const userTemplateBindings = templateBindings.filter((binding) => binding.userName === userId);\n\n      // Upfront load projects\n      userTemplateBindings.map((b) => this.$store.dispatch('management/find', { type: MANAGEMENT.PROJECT, id: b.projectId }));\n\n      return userTemplateBindings;\n    },\n\n    // Global Permissions Helpers (brought over from ember)\n    hasPermission(globalRoleRules, permission) {\n      return globalRoleRules.find((gRule) => {\n        return ((gRule.apiGroups || []).includes('*') || (gRule.apiGroups || []).includes(permission.apiGroup)) &&\n        ((gRule.resources || []).includes('*') || (gRule.resources || []).includes(permission.resource)) &&\n        ((gRule.verbs || []).includes('*') || (gRule.verbs || []).includes(permission.verb));\n      })\n      ;\n    },\n    containsRule(globalRoleRules, rule) {\n      const apiGroups = (rule.apiGroups || []);\n      const resources = (rule.resources || []);\n      const verbs = (rule.verbs || []);\n      const permissions = [];\n\n      apiGroups.forEach((apiGroup) => resources.forEach((resource) => verbs.forEach((verb) => permissions.push({\n        apiGroup,\n        resource,\n        verb\n      }))));\n\n      return permissions.every((permission) => this.hasPermission(globalRoleRules, permission));\n    },\n    getEnabledRoles(globalRole, out) {\n      const globalRoleRules = globalRole.rules || [];\n\n      return out.filter((r) => {\n        // If the global role doesn't contain any rules... don't show the user as having the role (confusing)\n        if (!r?.rules?.length) {\n          return false;\n        }\n\n        return r.rules.every((rule) => this.containsRule(globalRoleRules, rule));\n      });\n    },\n\n  }\n\n};\n</script>\n\n<template>\n  <Loading v-if=\"$fetchState.pending\" />\n  <div v-else>\n    <ResourceTabs\n      v-model=\"value\"\n      :mode=\"mode\"\n    >\n      <Tab\n        v-if=\"globalBindings\"\n        label-key=\"user.detail.globalPermissions.label\"\n        name=\"gp\"\n        :weight=\"3\"\n      >\n        <div class=\"subtext\">\n          {{ t(\"user.detail.globalPermissions.description\") }}\n        </div>\n        <div\n          v-if=\"isAdmin\"\n          class=\"admin\"\n        >\n          {{ t(\"user.detail.globalPermissions.adminMessage\") }}\n        </div>\n        <SortableTable\n          v-else\n          :rows=\"globalBindings\"\n          :headers=\"headers.gp\"\n          key-field=\"id\"\n          :table-actions=\"false\"\n          :row-actions=\"false\"\n          :search=\"false\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"clusterBindings\"\n        label-key=\"user.detail.clusterRoles.label\"\n        name=\"cr\"\n        :weight=\"2\"\n      >\n        <div class=\"subtext\">\n          {{ t(\"user.detail.clusterRoles.description\") }}\n        </div>\n        <SortableTable\n          :rows=\"clusterBindings\"\n          :headers=\"headers.cr\"\n          key-field=\"id\"\n          :table-actions=\"false\"\n          :search=\"false\"\n        />\n      </Tab>\n      <Tab\n        v-if=\"projectBindings\"\n        label-key=\"user.detail.projectRoles.label\"\n        name=\"pr\"\n        :weight=\"1\"\n      >\n        <div class=\"subtext\">\n          {{ t(\"user.detail.projectRoles.description\") }}\n        </div>\n        <SortableTable\n          :rows=\"projectBindings\"\n          :headers=\"headers.pr\"\n          key-field=\"id\"\n          :table-actions=\"false\"\n          :search=\"false\"\n        />\n      </Tab>\n    </ResourceTabs>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.subtext {\n  margin-bottom: 10px;\n  font-style: italic;\n}\n.admin {\n  display: flex;\n  justify-content: center;\n  margin: 30px 0 10px;\n  font-weight: bold;\n}\n</style>\n"]}]}