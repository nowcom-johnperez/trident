{"remainingRequest":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/ChangePassword.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@rancher/shell/components/form/ChangePassword.vue","mtime":1716430447141},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/babel-loader/lib/index.js","mtime":1716430465839},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/cache-loader/dist/cjs.js","mtime":1716430465924},{"path":"/Users/nowcom/Documents/nowcom/trident-extension-package/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1716430467929}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICd2dWV4JzsKaW1wb3J0IHsgQmFubmVyIH0gZnJvbSAnQGNvbXBvbmVudHMvQmFubmVyJzsKaW1wb3J0IHsgQ2hlY2tib3ggfSBmcm9tICdAY29tcG9uZW50cy9Gb3JtL0NoZWNrYm94JzsKaW1wb3J0IFBhc3N3b3JkIGZyb20gJ0BzaGVsbC9jb21wb25lbnRzL2Zvcm0vUGFzc3dvcmQnOwppbXBvcnQgeyBOT1JNQU4gfSBmcm9tICdAc2hlbGwvY29uZmlnL3R5cGVzJzsKaW1wb3J0IHsgX0NSRUFURSwgX0VESVQgfSBmcm9tICdAc2hlbGwvY29uZmlnL3F1ZXJ5LXBhcmFtcyc7CgovLyBDb21wb25lbnQgaGFuZGxlcyB0aHJlZSB1c2UgY2FzZXMKLy8gMSkgaXNDaGFuZ2UgLSBDdXJyZW50IHVzZXIgaXMgY2hhbmdpbmcgdGhlaXIgb3duIHBhc3N3b3JkCi8vIDIpIGlzQ3JlYXRlIC0gTmV3IHBhc3N3b3JkIGlzIGZvciBhIG5ldyB1c2VyCi8vIDMpIGlzRWRpdCAtIE5ldyBwYXNzd29yZCBpcyBmb3IgYW4gZXhpc3RpbmcgdXNlcgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgQ2hlY2tib3gsIEJhbm5lciwgUGFzc3dvcmQKICB9LAogIHByb3BzOiB7CiAgICBtb2RlOiB7CiAgICAgIHR5cGU6ICAgIFN0cmluZywKICAgICAgZGVmYXVsdDogbnVsbAogICAgfSwKICAgIG11c3RDaGFuZ2VQYXNzd29yZDogewogICAgICB0eXBlOiAgICBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogIH0sCiAgYXN5bmMgZmV0Y2goKSB7CiAgICBpZiAodGhpcy5pc0NoYW5nZSkgewogICAgICAvLyBGZXRjaCB0aGUgdXNlcm5hbWUgZm9yIGhpZGRlbiBpbnB1dCBmaWVsZHMuIFRoZSB2YWx1ZSBpdHNlbGYgaXMgbm90IG5lZWRlZCBpZiBjcmVhdGUgb3IgY2hhbmdpbmcgYW5vdGhlciB1c2VyJ3MgcGFzc3dvcmQKICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9maW5kQWxsJywgewogICAgICAgIHR5cGU6IE5PUk1BTi5VU0VSLAogICAgICAgIG9wdDogIHsgdXJsOiAnL3YzL3VzZXJzJywgZmlsdGVyOiB7IG1lOiB0cnVlIH0gfQogICAgICB9KTsKICAgICAgY29uc3QgdXNlciA9IHVzZXJzPy5bMF07CgogICAgICB0aGlzLnVzZXJuYW1lID0gdXNlcj8udXNlcm5hbWU7CiAgICB9CiAgICB0aGlzLnVzZXJDaGFuZ2VPbkxvZ2luID0gdGhpcy5tdXN0Q2hhbmdlUGFzc3dvcmQ7CiAgfSwKICBkYXRhKGN0eCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcm5hbWU6ICAgICAgICAgICAgICAgICAgICcnLAogICAgICBlcnJvck1lc3NhZ2VzOiAgICAgICAgICAgICAgW10sCiAgICAgIHBDYW5TaG93TWlzbWF0Y2hlZFBhc3N3b3JkOiBmYWxzZSwKICAgICAgcElzUmFuZG9tR2VuZXJhdGVkOiAgICAgICAgIGZhbHNlLAogICAgICBmb3JtOiAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgIGRlbGV0ZUtleXM6ICAgICAgICBmYWxzZSwKICAgICAgICBjdXJyZW50UDogICAgICAgICAgJycsCiAgICAgICAgbmV3UDogICAgICAgICAgICAgICcnLAogICAgICAgIGdlblA6ICAgICAgICAgICAgICAnJywKICAgICAgICBjb25maXJtUDogICAgICAgICAgJycsCiAgICAgICAgdXNlckNoYW5nZU9uTG9naW46IGZhbHNlLAogICAgICB9LAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBHZXR0ZXJzKHsgdDogJ2kxOG4vdCcgfSksCgogICAgaXNSYW5kb21HZW5lcmF0ZWQ6IHsKICAgICAgZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLnBJc1JhbmRvbUdlbmVyYXRlZDsKICAgICAgfSwKCiAgICAgIHNldChpc1JhbmRvbUdlbmVyYXRlZCkgewogICAgICAgIHRoaXMucElzUmFuZG9tR2VuZXJhdGVkID0gaXNSYW5kb21HZW5lcmF0ZWQ7CiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2VzID0gW107CiAgICAgICAgdGhpcy52YWxpZGF0ZSgpOwogICAgICB9CiAgICB9LAoKICAgIHBhc3N3b3JkR2VuOiB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JtLmdlblA7CiAgICAgIH0sCgogICAgICBzZXQocCkgewogICAgICAgIHRoaXMuZm9ybS5nZW5QID0gcDsKICAgICAgICB0aGlzLnZhbGlkYXRlKCk7CiAgICAgIH0KICAgIH0sCgogICAgcGFzc3dvcmRDdXJyZW50OiB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy5mb3JtLmN1cnJlbnRQOwogICAgICB9LAoKICAgICAgc2V0KHApIHsKICAgICAgICB0aGlzLmZvcm0uY3VycmVudFAgPSBwOwogICAgICAgIHRoaXMudmFsaWRhdGUoKTsKICAgICAgfQogICAgfSwKCiAgICBwYXNzd29yZE5ldzogewogICAgICBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybS5uZXdQOwogICAgICB9LAoKICAgICAgc2V0KHApIHsKICAgICAgICB0aGlzLmZvcm0ubmV3UCA9IHA7CiAgICAgICAgdGhpcy52YWxpZGF0ZSgpOwogICAgICB9CiAgICB9LAoKICAgIHBhc3N3b3JkQ29uZmlybTogewogICAgICBnZXQoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZm9ybS5jb25maXJtUDsKICAgICAgfSwKCiAgICAgIHNldChwKSB7CiAgICAgICAgdGhpcy5mb3JtLmNvbmZpcm1QID0gcDsKICAgICAgICB0aGlzLnZhbGlkYXRlKCk7CiAgICAgIH0KICAgIH0sCgogICAgdXNlckNoYW5nZU9uTG9naW46IHsKICAgICAgZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLmZvcm0udXNlckNoYW5nZU9uTG9naW47CiAgICAgIH0sCgogICAgICBzZXQocCkgewogICAgICAgIHRoaXMuZm9ybS51c2VyQ2hhbmdlT25Mb2dpbiA9IHA7CiAgICAgICAgdGhpcy52YWxpZGF0ZSgpOwogICAgICB9CiAgICB9LAoKICAgIHBhc3N3b3JkQ29uZmlybUJsdXJyZWQ6IHsKICAgICAgZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLnBDYW5TaG93TWlzbWF0Y2hlZFBhc3N3b3JkOwogICAgICB9LAoKICAgICAgc2V0KHApIHsKICAgICAgICB0aGlzLnBDYW5TaG93TWlzbWF0Y2hlZFBhc3N3b3JkID0gcDsKICAgICAgICB0aGlzLnZhbGlkYXRlKCk7CiAgICAgIH0KICAgIH0sCgogICAgcGFzc3dvcmQoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzUmFuZG9tR2VuZXJhdGVkID8gdGhpcy5wYXNzd29yZEdlbiA6IHRoaXMucGFzc3dvcmROZXc7CiAgICB9LAoKICAgIGlzQ2hhbmdlKCkgewogICAgICAvLyBDaGFuZ2UgcGFzc3dvcmQgcHJvbXB0CiAgICAgIHJldHVybiAhdGhpcy5tb2RlOwogICAgfSwKCiAgICBpc0NyZWF0ZUVkaXQoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzQ3JlYXRlIHx8IHRoaXMuaXNFZGl0OwogICAgfSwKCiAgICBpc0NyZWF0ZSgpIHsKICAgICAgcmV0dXJuIHRoaXMubW9kZSA9PT0gX0NSRUFURTsKICAgIH0sCgogICAgaXNFZGl0KCkgewogICAgICAvLyBFZGl0IHVzZXIgcHJvbXB0CiAgICAgIHJldHVybiB0aGlzLm1vZGUgPT09IF9FRElUOwogICAgfSwKCiAgICB1c2VyR2VuZXJhdGVkUGFzc3dvcmRzUmVxdWlyZWQoKSB7CiAgICAgIGlmICh0aGlzLmlzQ2hhbmdlKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNDcmVhdGUpIHsKICAgICAgICByZXR1cm4gIXRoaXMuaXNSYW5kb21HZW5lcmF0ZWQ7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuaXNFZGl0KSB7CiAgICAgICAgcmV0dXJuICEhdGhpcy5wYXNzd29yZE5ldyB8fCAhIXRoaXMucGFzc3dvcmRDb25maXJtOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgLy8gQ2F0Y2ggdGhlICdjcmVhdGUnIGNhc2UgYW5kIHRoZXJlJ3Mgbm8gY29udGVudAogICAgdGhpcy52YWxpZGF0ZSgpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIHBhc3N3b3Jkc01hdGNoKCkgewogICAgICBjb25zdCBtYXRjaCA9IHRoaXMucGFzc3dvcmROZXcgPT09IHRoaXMucGFzc3dvcmRDb25maXJtOwoKICAgICAgdGhpcy5lcnJvck1lc3NhZ2VzID0gdGhpcy5wYXNzd29yZENvbmZpcm1CbHVycmVkICYmICFtYXRjaCA/IFt0aGlzLnQoJ2NoYW5nZVBhc3N3b3JkLmVycm9ycy5taXNtYXRjaGVkUGFzc3dvcmQnKV0gOiBbXTsKCiAgICAgIHJldHVybiBtYXRjaDsKICAgIH0sCgogICAgYmFzZUlzVXNlckdlblBhc3N3b3JkVmFsaWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnBhc3N3b3Jkc01hdGNoKCkgJiYgISF0aGlzLnBhc3N3b3JkTmV3OwogICAgfSwKCiAgICBpc1ZhbGlkKCkgewogICAgICBpZiAodGhpcy5pc0NoYW5nZSkgewogICAgICAgIHJldHVybiAhIXRoaXMucGFzc3dvcmRDdXJyZW50ICYmICh0aGlzLmlzUmFuZG9tR2VuZXJhdGVkID8gdHJ1ZSA6IHRoaXMuYmFzZUlzVXNlckdlblBhc3N3b3JkVmFsaWQoKSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzUmFuZG9tR2VuZXJhdGVkKSB7CiAgICAgICAgLy8gSWYgd2UncmUgbm90IGNoYW5naW5nIGN1cnJlbnQgdXNlci4uLiBhbmQgcGFzc3dvcmQgaXMgcmFuZG9tbHkgZ2VuZXJhdGVkLi4uIHRoZXJlJ2xsIGJlIG5vIG5ldy9jb25maXJtIG1pc21hdGNoCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmlzQ3JlYXRlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuYmFzZUlzVXNlckdlblBhc3N3b3JkVmFsaWQoKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNFZGl0KSB7CiAgICAgICAgLy8gSWYgdGhlIHVzZXIgZ2VuZXJhdGVkIHBhc3N3b3JkIGlzIHJlcXVpcmVkLi4uIGVuc3VyZSBpdCdzIHZhbGlkCiAgICAgICAgcmV0dXJuIHRoaXMudXNlckdlbmVyYXRlZFBhc3N3b3Jkc1JlcXVpcmVkID8gdGhpcy5iYXNlSXNVc2VyR2VuUGFzc3dvcmRWYWxpZCgpIDogdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKCiAgICB2YWxpZGF0ZSgpIHsKICAgICAgY29uc3QgaXNWYWxpZCA9IHRoaXMuaXNWYWxpZCgpOwoKICAgICAgaWYgKGlzVmFsaWQpIHsKICAgICAgICAvLyBDb3ZlcnMgdGhlIGNhc2Ugd2hlcmUgd2UgZG9uJ3QgcmUtZXZhbHVhdGUgdGhlIGVycm9yIG1lc3NhZ2VzIChkb24ndCBuZWVkIHRvIGF0IHRoZSB0aW1lKQogICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlcyA9IFtdOwogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCd2YWxpZCcsIGlzVmFsaWQpOwogICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHsKICAgICAgICBwYXNzd29yZDogICAgICAgICAgdGhpcy5wYXNzd29yZCwKICAgICAgICB1c2VyQ2hhbmdlT25Mb2dpbjogdGhpcy51c2VyQ2hhbmdlT25Mb2dpbgogICAgICB9KTsKICAgIH0sCgogICAgYXN5bmMgc2F2ZSh1c2VyKSB7CiAgICAgIGlmICh0aGlzLmlzQ2hhbmdlKSB7CiAgICAgICAgYXdhaXQgdGhpcy5jaGFuZ2VQYXNzd29yZCgpOwogICAgICAgIGlmICh0aGlzLmZvcm0uZGVsZXRlS2V5cykgewogICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVLZXlzKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHRoaXMuaXNFZGl0KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuc2V0UGFzc3dvcmQodXNlcik7CiAgICAgIH0KICAgIH0sCgogICAgYXN5bmMgc2V0UGFzc3dvcmQodXNlcikgewogICAgICAvLyBFcnJvciBoYW5kbGluZyBpcyBjYXRlcmVkIGZvciBieSBjYWxsZXIKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3JhbmNoZXIvcmVzb3VyY2VBY3Rpb24nLCB7CiAgICAgICAgdHlwZTogICAgICAgTk9STUFOLlVTRVIsCiAgICAgICAgYWN0aW9uTmFtZTogJ3NldHBhc3N3b3JkJywKICAgICAgICByZXNvdXJjZTogICB1c2VyLAogICAgICAgIGJvZHk6ICAgICAgIHsgbmV3UGFzc3dvcmQ6IHRoaXMuaXNSYW5kb21HZW5lcmF0ZWQgPyB0aGlzLmZvcm0uZ2VuUCA6IHRoaXMuZm9ybS5uZXdQIH0sCiAgICAgIH0pOwogICAgfSwKCiAgICBhc3luYyBjaGFuZ2VQYXNzd29yZCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgncmFuY2hlci9jb2xsZWN0aW9uQWN0aW9uJywgewogICAgICAgICAgdHlwZTogICAgICAgTk9STUFOLlVTRVIsCiAgICAgICAgICBhY3Rpb25OYW1lOiAnY2hhbmdlcGFzc3dvcmQnLAogICAgICAgICAgYm9keTogICAgICAgewogICAgICAgICAgICBjdXJyZW50UGFzc3dvcmQ6IHRoaXMuZm9ybS5jdXJyZW50UCwKICAgICAgICAgICAgbmV3UGFzc3dvcmQ6ICAgICB0aGlzLmlzUmFuZG9tR2VuZXJhdGVkID8gdGhpcy5mb3JtLmdlblAgOiB0aGlzLmZvcm0ubmV3UAogICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2VzID0gW2Vyci5tZXNzYWdlIHx8IHRoaXMudCgnY2hhbmdlUGFzc3dvcmQuZXJyb3JzLmZhaWxlZFRvQ2hhbmdlJyldOwogICAgICAgIHRocm93IGVycjsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBkZWxldGVLZXlzKCkgewogICAgICB0cnkgewogICAgICAgIGNvbnN0IHRva2VucyA9IGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdyYW5jaGVyL2ZpbmRBbGwnLCB7CiAgICAgICAgICB0eXBlOiBOT1JNQU4uVE9LRU4sCiAgICAgICAgICBvcHQ6ICB7CiAgICAgICAgICAgIC8vIEVuc3VyZSB3ZSBoYXZlIGFueSBuZXcgdG9rZW5zIHNpbmNlIGxhc3QgZmV0Y2hlZC4uLiBhbmQgdGhhdCB3ZSBkb24ndCBhdHRlbXB0IHRvIGRlbGV0ZSBwcmV2aW91c2x5IGRlbGV0ZWQgdG9rZW5zCiAgICAgICAgICAgIGZvcmNlOiB0cnVlCiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHRva2Vucy5yZWR1Y2UoKHJlcywgdG9rZW4pID0+IHsKICAgICAgICAgIGlmICghdG9rZW4uY3VycmVudCkgewogICAgICAgICAgICByZXMucHVzaCh0b2tlbi5yZW1vdmUoKSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHJlczsKICAgICAgICB9LCBbXSkpOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBpZiAoZXJyLm1lc3NhZ2UpIHsKICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlcyA9IFtlcnIubWVzc2FnZV07CiAgICAgICAgfSBlbHNlIGlmIChlcnIubGVuZ3RoID4gMSkgewogICAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2VzID0gW3RoaXMudCgnY2hhbmdlUGFzc3dvcmQuZXJyb3JzLmZhaWxlZERlbGV0ZUtleXMnKV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlcyA9IFt0aGlzLnQoJ2NoYW5nZVBhc3N3b3JkLmVycm9ycy5mYWlsZWREZWxldGVLZXknKV07CiAgICAgICAgfQogICAgICAgIHRocm93IGVycjsKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["ChangePassword.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ChangePassword.vue","sourceRoot":"node_modules/@rancher/shell/components/form","sourcesContent":["<script>\nimport { mapGetters } from 'vuex';\nimport { Banner } from '@components/Banner';\nimport { Checkbox } from '@components/Form/Checkbox';\nimport Password from '@shell/components/form/Password';\nimport { NORMAN } from '@shell/config/types';\nimport { _CREATE, _EDIT } from '@shell/config/query-params';\n\n// Component handles three use cases\n// 1) isChange - Current user is changing their own password\n// 2) isCreate - New password is for a new user\n// 3) isEdit - New password is for an existing user\nexport default {\n  components: {\n    Checkbox, Banner, Password\n  },\n  props: {\n    mode: {\n      type:    String,\n      default: null\n    },\n    mustChangePassword: {\n      type:    Boolean,\n      default: false\n    }\n  },\n  async fetch() {\n    if (this.isChange) {\n      // Fetch the username for hidden input fields. The value itself is not needed if create or changing another user's password\n      const users = await this.$store.dispatch('rancher/findAll', {\n        type: NORMAN.USER,\n        opt:  { url: '/v3/users', filter: { me: true } }\n      });\n      const user = users?.[0];\n\n      this.username = user?.username;\n    }\n    this.userChangeOnLogin = this.mustChangePassword;\n  },\n  data(ctx) {\n    return {\n      username:                   '',\n      errorMessages:              [],\n      pCanShowMismatchedPassword: false,\n      pIsRandomGenerated:         false,\n      form:                       {\n        deleteKeys:        false,\n        currentP:          '',\n        newP:              '',\n        genP:              '',\n        confirmP:          '',\n        userChangeOnLogin: false,\n      },\n    };\n  },\n  computed: {\n    ...mapGetters({ t: 'i18n/t' }),\n\n    isRandomGenerated: {\n      get() {\n        return this.pIsRandomGenerated;\n      },\n\n      set(isRandomGenerated) {\n        this.pIsRandomGenerated = isRandomGenerated;\n        this.errorMessages = [];\n        this.validate();\n      }\n    },\n\n    passwordGen: {\n      get() {\n        return this.form.genP;\n      },\n\n      set(p) {\n        this.form.genP = p;\n        this.validate();\n      }\n    },\n\n    passwordCurrent: {\n      get() {\n        return this.form.currentP;\n      },\n\n      set(p) {\n        this.form.currentP = p;\n        this.validate();\n      }\n    },\n\n    passwordNew: {\n      get() {\n        return this.form.newP;\n      },\n\n      set(p) {\n        this.form.newP = p;\n        this.validate();\n      }\n    },\n\n    passwordConfirm: {\n      get() {\n        return this.form.confirmP;\n      },\n\n      set(p) {\n        this.form.confirmP = p;\n        this.validate();\n      }\n    },\n\n    userChangeOnLogin: {\n      get() {\n        return this.form.userChangeOnLogin;\n      },\n\n      set(p) {\n        this.form.userChangeOnLogin = p;\n        this.validate();\n      }\n    },\n\n    passwordConfirmBlurred: {\n      get() {\n        return this.pCanShowMismatchedPassword;\n      },\n\n      set(p) {\n        this.pCanShowMismatchedPassword = p;\n        this.validate();\n      }\n    },\n\n    password() {\n      return this.isRandomGenerated ? this.passwordGen : this.passwordNew;\n    },\n\n    isChange() {\n      // Change password prompt\n      return !this.mode;\n    },\n\n    isCreateEdit() {\n      return this.isCreate || this.isEdit;\n    },\n\n    isCreate() {\n      return this.mode === _CREATE;\n    },\n\n    isEdit() {\n      // Edit user prompt\n      return this.mode === _EDIT;\n    },\n\n    userGeneratedPasswordsRequired() {\n      if (this.isChange) {\n        return true;\n      }\n      if (this.isCreate) {\n        return !this.isRandomGenerated;\n      }\n      if (this.isEdit) {\n        return !!this.passwordNew || !!this.passwordConfirm;\n      }\n\n      return false;\n    }\n  },\n  created() {\n    // Catch the 'create' case and there's no content\n    this.validate();\n  },\n\n  methods: {\n    passwordsMatch() {\n      const match = this.passwordNew === this.passwordConfirm;\n\n      this.errorMessages = this.passwordConfirmBlurred && !match ? [this.t('changePassword.errors.mismatchedPassword')] : [];\n\n      return match;\n    },\n\n    baseIsUserGenPasswordValid() {\n      return this.passwordsMatch() && !!this.passwordNew;\n    },\n\n    isValid() {\n      if (this.isChange) {\n        return !!this.passwordCurrent && (this.isRandomGenerated ? true : this.baseIsUserGenPasswordValid());\n      }\n\n      if (this.isRandomGenerated) {\n        // If we're not changing current user... and password is randomly generated... there'll be no new/confirm mismatch\n        return true;\n      }\n\n      if (this.isCreate) {\n        return this.baseIsUserGenPasswordValid();\n      }\n\n      if (this.isEdit) {\n        // If the user generated password is required... ensure it's valid\n        return this.userGeneratedPasswordsRequired ? this.baseIsUserGenPasswordValid() : true;\n      }\n\n      return false;\n    },\n\n    validate() {\n      const isValid = this.isValid();\n\n      if (isValid) {\n        // Covers the case where we don't re-evaluate the error messages (don't need to at the time)\n        this.errorMessages = [];\n      }\n\n      this.$emit('valid', isValid);\n      this.$emit('input', {\n        password:          this.password,\n        userChangeOnLogin: this.userChangeOnLogin\n      });\n    },\n\n    async save(user) {\n      if (this.isChange) {\n        await this.changePassword();\n        if (this.form.deleteKeys) {\n          await this.deleteKeys();\n        }\n      } else if (this.isEdit) {\n        return this.setPassword(user);\n      }\n    },\n\n    async setPassword(user) {\n      // Error handling is catered for by caller\n      await this.$store.dispatch('rancher/resourceAction', {\n        type:       NORMAN.USER,\n        actionName: 'setpassword',\n        resource:   user,\n        body:       { newPassword: this.isRandomGenerated ? this.form.genP : this.form.newP },\n      });\n    },\n\n    async changePassword() {\n      try {\n        await this.$store.dispatch('rancher/collectionAction', {\n          type:       NORMAN.USER,\n          actionName: 'changepassword',\n          body:       {\n            currentPassword: this.form.currentP,\n            newPassword:     this.isRandomGenerated ? this.form.genP : this.form.newP\n          },\n        });\n      } catch (err) {\n        this.errorMessages = [err.message || this.t('changePassword.errors.failedToChange')];\n        throw err;\n      }\n    },\n\n    async deleteKeys() {\n      try {\n        const tokens = await this.$store.dispatch('rancher/findAll', {\n          type: NORMAN.TOKEN,\n          opt:  {\n            // Ensure we have any new tokens since last fetched... and that we don't attempt to delete previously deleted tokens\n            force: true\n          }\n        });\n\n        await Promise.all(tokens.reduce((res, token) => {\n          if (!token.current) {\n            res.push(token.remove());\n          }\n\n          return res;\n        }, []));\n      } catch (err) {\n        if (err.message) {\n          this.errorMessages = [err.message];\n        } else if (err.length > 1) {\n          this.errorMessages = [this.t('changePassword.errors.failedDeleteKeys')];\n        } else {\n          this.errorMessages = [this.t('changePassword.errors.failedDeleteKey')];\n        }\n        throw err;\n      }\n    },\n  },\n};\n</script>\n\n<template>\n  <div\n    class=\"change-password\"\n    :class=\"{'change': isChange, 'create': isCreate, 'edit': isEdit}\"\n  >\n    <div class=\"form\">\n      <div class=\"fields\">\n        <Checkbox\n          v-if=\"isChange\"\n          v-model=\"form.deleteKeys\"\n          label-key=\"changePassword.deleteKeys.label\"\n          class=\"mt-10\"\n        />\n        <Checkbox\n          v-if=\"isCreateEdit\"\n          v-model=\"userChangeOnLogin\"\n          label-key=\"changePassword.changeOnLogin.label\"\n          class=\"mt-10 type\"\n        />\n        <Checkbox\n          v-if=\"isCreateEdit\"\n          v-model=\"isRandomGenerated\"\n          label-key=\"changePassword.generatePassword.label\"\n          class=\"mt-10 type\"\n        />\n\n        <!-- Create two 'invisible fields' for password managers -->\n        <input\n          id=\"username\"\n          type=\"text\"\n          name=\"username\"\n          autocomplete=\"username\"\n          :value=\"username\"\n          tabindex=\"-1\"\n          :data-lpignore=\"!isChange\"\n        >\n        <input\n          id=\"password\"\n          type=\"password\"\n          name=\"password\"\n          autocomplete=\"password\"\n          :value=\"password\"\n          tabindex=\"-1\"\n          :data-lpignore=\"!isChange\"\n        >\n        <Password\n          v-if=\"isChange\"\n          v-model=\"passwordCurrent\"\n          data-testid=\"account__current_password\"\n          class=\"mt-10\"\n          :required=\"true\"\n          :label=\"t('changePassword.currentPassword.label')\"\n        />\n        <div\n          v-if=\"isRandomGenerated\"\n          :class=\"{'row': isCreateEdit}\"\n        >\n          <div :class=\"{'col': isCreateEdit, 'span-8': isCreateEdit}\">\n            <Password\n              v-model=\"passwordGen\"\n              class=\"mt-10\"\n              :is-random=\"true\"\n              :required=\"false\"\n              :label=\"t('changePassword.randomGen.generated.label')\"\n            />\n          </div>\n        </div>\n        <div\n          v-else\n          class=\"userGen\"\n          :class=\"{'row': isCreateEdit}\"\n        >\n          <div :class=\"{'col': isCreateEdit, 'span-4': isCreateEdit}\">\n            <Password\n              v-model=\"passwordNew\"\n              data-testid=\"account__new_password\"\n              class=\"mt-10\"\n              :label=\"t('changePassword.userGen.newPassword.label')\"\n              :required=\"userGeneratedPasswordsRequired\"\n              :ignore-password-managers=\"!isChange\"\n            />\n          </div>\n          <div :class=\"{'col': isCreateEdit, 'span-4': isCreateEdit}\">\n            <Password\n              v-model=\"passwordConfirm\"\n              data-testid=\"account__confirm_password\"\n              class=\"mt-10\"\n              :label=\"t('changePassword.userGen.confirmPassword.label')\"\n              :required=\"userGeneratedPasswordsRequired\"\n              :ignore-password-managers=\"!isChange\"\n              @blur=\"passwordConfirmBlurred = true\"\n            />\n          </div>\n        </div>\n      </div>\n      <Checkbox\n        v-if=\"isChange\"\n        v-model=\"isRandomGenerated\"\n        label-key=\"changePassword.generatePassword.label\"\n        class=\"mt-10 type\"\n      />\n    </div>\n    <div\n      v-if=\"errorMessages && errorMessages.length\"\n      class=\"text-error\"\n      :class=\"{'row': isCreateEdit}\"\n    >\n      <div :class=\"{'col': isCreateEdit, 'span-8': isCreateEdit}\">\n        <Banner\n          v-for=\"(err, i) in errorMessages\"\n          :key=\"i\"\n          color=\"error\"\n          :label=\"err\"\n          class=\"mb-0\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n  .change-password {\n    display: flex;\n    flex-direction: column;\n\n    &.change {\n      .form .fields {\n        height: 240px;\n      }\n    }\n\n    &.create, &.edit {\n      height: 185px;\n      .form {\n        .fields {\n          display: flex;\n          flex-direction: column;\n        }\n      }\n    }\n\n    .form {\n      display: flex;\n      flex-direction: column;\n      .fields{\n        #username, #password {\n          height: 0;\n          width: 0;\n          background-size: 0;\n          padding: 0;\n          border: none;\n        }\n      }\n    }\n\n    .text-error {\n      height: 53px;\n    }\n  }\n\n</style>\n"]}]}